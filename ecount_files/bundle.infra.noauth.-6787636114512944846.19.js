function fnReload(n){try{n&&ecount.router.reload()}catch(t){}}function fnReload2(n){if(n){var i=window.__ecOriginWindow[n],t=i[ecount.page.prefix+n];t&&t.reloadPage&&reloadPage.reloadPage()}}function ecFnClose(n){var i=eocunt.popup.parent,t=window.__ecOriginWindow[n];t[ecount.page.prefix+n].close()}function fnGetPageInstance(n){return window.__ecOriginWindow[n]}function fnGetPageInstance_movePageLoad(n,t){var i=window[ecount.page.prefix+n];i&&i.movePageLoad&&i.movePageLoad(t)}function getCompositeList(n){function t(n){var i={};for(var t in n)i[t]=typeof n[t]=="function"?{__f__:n[t].toString()}:n[t];return i}function i(n,r){for(var o=0;o<r.length;o++){var u=r[o],e="",f={};u.parentType!=="page"?e="child":(u.compositeType==="group"||u.compositeType==="function")&&u.layoutName&&(e=u.layoutName);e&&_.isEmpty(n[e])&&(n[e]=[]);_.each(u,function(n,i){i!=="settingInfo"&&(typeof n=="object"||typeof n=="function")||(f[i]=i==="settingInfo"?t(n):n)});Object.keys(u.__proto__).length&&_.each(u.__proto__,function(n,i){i!=="settingInfo"&&(typeof n=="object"||typeof n=="function")||(f[i]=i==="settingInfo"?t(n):n)});f.compositeType=_.isEmpty(u.compositeType)?"":u.compositeType;f.parentType=_.isEmpty(u.parentType)?"":u.parentType;f.id=_.isEmpty(u.id)?"":u.id;f.type=_.isEmpty(u.skillType)?"":u.skillType;f.subType=_.isEmpty(u.subSkillType)?"":u.subSkillType;f.sortType=_.isEmpty(u.sortType)?"":u.sortType;f.categoryType=u.unitType||u.groupType||u.functionType||"";f.toolbarSearchType=_.isEmpty(u.toolbarSearchType)?"":u.toolbarSearchType;n[e].push(f);u._commonItemList.length&&i(n[e][n[e].length-1],u._commonItemList)}}var r={};return i(r,window["__ec."+n+"_1"].totalEccomposites),r}function fnPdfBeta(n,t,i,r){var u;u="10";fnExportPdf("ECount",t,t,t,u,n,i,r)}function gridCss(){var n=["<style>"];return n.push(".text-bold {font-weight: bold;}"),n.push("a, a:focus, a:hover{cursor:default; text-decoration: none;color:#000000;}"),n.push(".grid-table {display: table; border-spacing: 0; table-layout: fixed; float:left;}"),n.push(".grid-colgroup {display: table-column-group;}"),n.push(".grid-colgroup > span {display: table-column;}"),n.push(".grid-thead {display: table-header-group;}"),n.push(".grid-tbody {display: table-row-group;}"),n.push(".grid-tfoot {display: table-footer-group;}"),n.push(".grid-tr {display: table-row;}"),n.push(".grid-td {display: table-cell;vertical-align:middle;border-right: 1px solid #bbb;border-bottom: 1px solid #bbb;padding: 2px;word-wrap: break-word;}"),n.push(".grid-td {background: #fff;}"),n.push(".grid-tr:hover > .grid-td {background-color: #f2f2f2;}"),n.push(".grid-fixed-cell .grid-td {background-color:#ebebeb;}"),n.push(".grid-fixed-cell:hover .grid-td{background-color:#ebebeb;}"),n.push(".grid-horizontal-first-cell .grid-tr .grid-td:first-child {border-left:1px solid #bbb}"),n.push(".grid-vertical-first-cell .grid-tbody .grid-tr:first-child .grid-td {border-top:1px solid #bbb}"),n.push(".grid-clone-top,.grid-clone-left,.grid-clone-corner {position:fixed;overflow: hidden;}"),n.push(".grid-clone-top{background-color:#fff;z-index:2}"),n.push(".grid-clone-corner {z-index:3}"),n.push(".grid-empty-cell {text-align:center;border:1px solid #bbb;border-top:0;padding:2px;clear:both;}"),n.push(".nowrap {overflow: hidden;white-space: nowrap;}"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.active,.grid-table > .grid-tbody > .grid-tr.active > span{background-color: #f2f2f2; }"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.active:hover,.grid-table > .grid-tbody > .grid-tr.active:hover > span{background-color: #e5e5e5;}"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.success,.grid-table > .grid-tbody > .grid-tr.success > span{background-color: #dff0d8; }"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.success:hover,.grid-table > .grid-tbody > .grid-tr.success:hover > span{background-color: #d0e9c6;}"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.info,.grid-table > .grid-tbody > .grid-tr.info > span{background-color: #d9edf7; }"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.info:hover,.grid-table > .grid-tbody > .grid-tr.info:hover > span{background-color: #c4e3f3;}"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.warning,.grid-table > .grid-tbody > .grid-tr.warning > span{background-color: #fcf8e3; }"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.warning:hover,.grid-table > .grid-tbody > .grid-tr.warning:hover > span{background-color: #faf2cc;}"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.danger,.grid-table > .grid-tbody > .grid-tr.danger > span{background-color: #f2dede; }"),n.push(".grid-table > .grid-tbody > .grid-tr > .grid-td.danger:hover,.grid-table > .grid-tbody > .grid-tr.danger:hover > span{background-color: #ebcccc;}"),n.push(".grid-table.grid-info > .grid-tbody > .grid-tr.grid-fixed-cell > .grid-td{background-color: #d9edf7;}"),n.push(".grid-table.grid-success > .grid-tbody > .grid-tr.grid-fixed-cell > .grid-td{background-color: #dff0d8;}"),n.push(".grid-table.grid-warning > .grid-tbody > .grid-tr.grid-fixed-cell > .grid-td{background-color: #fcf8e3;}"),n.push(".grid-table.grid-danger > .grid-tbody > .grid-tr.grid-fixed-cell > .grid-td{background-color: #f2dede;}"),n.push(".grid-table.grid-transparent > .grid-tbody > .grid-tr.grid-fixed-cell > .grid-td{background-color: transparent;}"),n.push("<\/style>"),n.join("")}function fnExportPdf(n,t,i,r,u,f,e,o){var it=document.getElementsByTagName("body")[0],tt=$("#pdfsetup"),h,s,v,y,p,w,b,k,d,g,nt;tt.length>0&&tt.remove();h=$.extend({paperSize:"A4",PdfMargin:String.format("13{0}5.3{0}4.2{0}4.6",ecount.delimiter),Direction:"P"},o||{});(h.paperSize=="CUSTOM"||h.paperSize=="B5")&&(h.paperSize="A4",alert(ecount.resource.MSG05490));s=document.createElement("form");s.name="pdfsetup";s.id="pdfsetup";s.method="post";window.open("","PdfPopUp","width=330, height=220").focus();s.action=ecount.common.buildSessionUrl("/ECMain/ECount.Common/Export/PdfSetUp.aspx");s.target="PdfPopUp";s.enctype="multipart/form-data";s.style.display="none";v=document.createElement("input");v.type="hidden";v.name="Author";v.id="Author";v.value=n;s.insertBefore(v,null);y=document.createElement("input");y.type="hidden";y.name="Keywords";y.id="Keywords";y.value=t;s.insertBefore(y,null);p=document.createElement("input");p.type="hidden";p.name="Subject";p.id="Subject";p.value=i;s.insertBefore(p,null);w=document.createElement("input");w.type="hidden";w.name="Title";w.id="Title";w.value=r;s.insertBefore(w,null);b=document.createElement("input");b.type="hidden";b.name="DocID";b.id="DocID";b.value=u;s.insertBefore(b,null);k=document.createElement("input");k.type="hidden";k.name="PdfMargin";k.id="PdfMargin";k.value=h.PdfMargin||String.format("13{0}5.3{0}4.2{0}4.6",ecount.delimiter);s.insertBefore(k,null);d=document.createElement("input");d.type="hidden";d.name="SelPaper";d.id="SelPaper";d.value=h.paperSize||"A4";s.insertBefore(d,null);g=document.createElement("input");g.type="hidden";g.name="Direction";g.id="Direction";g.value=h.Direction||"P";s.insertBefore(g,null);nt=document.createElement("textarea");nt.name="HtmlContent";nt.id="HtmlContent";var c=ecount.config.company.FONT1.replace("-"," "),l=ecount.config.company.FONT2.replace("-"," "),a=ecount.config.company.FONT3.replace("-"," "),rt=ecount.config.company.FONT_SIZE;c!=""&&c!="microsoft yahei"&&(c=c.substr(0,1).toUpperCase()+c.substr(1,c.length-1));l!=""&&l!="microsoft yahei"&&(l=l.substr(0,1).toUpperCase()+l.substr(1,l.length-1));a!=""&&a!="microsoft yahei"&&(a=a.substr(0,1).toUpperCase()+a.substr(1,a.length-1));nt.value=fnStripScripts("<style>.font-user-setting {font-family:'"+c+"','"+l+"','"+a+"','Arial','Apple SD Gothic Neo','Gulim';}<\/style><div class='font-user-setting' style='width: "+e+"px; '>"+f+"<\/div>");s.insertBefore(nt,null);it.appendChild(s);document.getElementById("pdfsetup").submit()}function fnStripScripts(n){var r=document.createElement("div"),u,i,t;for(r.innerHTML=n,u=r.getElementsByTagName("script"),t=u.length;t--;)u[t].parentNode.removeChild(u[t]);for(i=r.getElementsByTagName("img"),t=i.length;t--;)i[t].src=i[t].src.replace(/http:\/\/login([0-9]+)?\.ecounterp\.com/ig,""),i[t].src=i[t].src.replace(/http:\/\/login([0-9]+)?\.ecount\.com/ig,"");return r.innerHTML.replace(/javascript(:|;)?/gi,"")}function ExcelPageMovement(n,t,i){function o(n,t){var r=ecount.popup.parent,f=r.$("#ifrmExcel"),i,u;f.length==0&&r.$("body").append($('<iframe id="ifrmExcel" name="ifrmExcel" style="width:0px; height:0px;border:0" class="hidden"><\/iframe>'));i=r.$("#__ecSubmitForm");i.length==0?(i=$('<form id="__ecSubmitForm" method="POST"/>'),r.$("body").append(i)):i.empty();for(u in t)i.append($('<input type="hidden" name="'+u+'"/>').val(t[u]));i.attr("action",ecount.common.buildSessionUrl(n));i.get(0).method="post";i.get(0).target="ifrmExcel";i.submit()}var r=i.keyword,u=i.iMaxCnt,f=i.verisionCheck,e=i.type;if(u>=Number("30000")){ecount.alert(ecount.resource.message.EXCEED_EXCEL);return}f?$.encryptAjax({type:"POST",dataType:"text",url:ecount.common.buildSessionUrl("/ECMAIN/ESG/ESG_CM_DATA.aspx"),data:"Type="+e+"&KeyWord="+r,error:function(n){ecount.alert("error\nfnGetData:"+n)},success:function(i){var f=parseXML(i),e=$(f).find("RESULT"),r,u;if($(e).find("EXCEL_DIC_YN").text()=="Y")ecount.alert(ecount.resource.message.CONVERT_EXCEL);else{r=$("#__ecSubmitForm");r.empty();for(u in t)r.append($('<input type="hidden" name="'+u+'"/>').val(t[u]));r.attr("action",ecount.common.buildSessionUrl(n));r.get(0).method="post";r.get(0).target="ifrmExcel";r.submit()}}}):o(n,t)}function parseXML(n){if(window.ActiveXObject&&window.GetObject){var t=new ActiveXObject("Microsoft.XMLDOM");return t.loadXML(n),t}if(window.DOMParser)return(new DOMParser).parseFromString(n,"text/xml")}function fnOrderPrint(){$("#level_gubun").get(0).value="N";$("#zero_chk").get(0).value="N";var n=ecount.common.buildSessionUrl("http://login"+ecount.config.company.ZONE+".ecount.com/ECMain/ESD/ESD005R.aspx?gubun=1&form_ser="+$("#form_ser").get(0).value+"&level_gubun="+$("#level_gubun").get(0).value+"&zero_chk="+$("#zero_chk").get(0).value+"&hidData="+$("#hidData").get(0).value+"&edms_flag=N&Hits=Y");window.open(n,"orderprint","left=50000,top=50000,width=0,height=0");$("#hidData").get(0).value!=""&&(strData="Type=SALEHISTORY&H_STATUS=O&H_TYPE=02&GB_TYPE=Y&LOOP=Y&hidData="+encodeURIComponent($("#hidData").get(0).value),fnHistoryInser(strData,""))}function fnHistoryInser(n,t,i,r){var f=n.split("&"),e=f[1].split("="),u=eocunt.common.buildSessionUrl;$.encryptAjax({type:"POST",dataType:"text",url:t!=""?u(t):u("/ECMAIN/CM/ES/ES_CM_DATA.aspx"),data:n,async:!1,error:function(n){alert(viewBag.Resource.LBL03306+"\nfnGetData:"+n)},success:function(n){var t=parseXML(n),o=$(t).find("RESULT"),s,f;o.length==1?(s=$(t).find("TYPE").text(),f=$(t).find("ERRFLAG").text(),e[1]=="DELETE"&&(i!=""?i:"form1",r!=""?r:"/ECMAIN/CM2/ES/ES303M.aspx",frm=$("#"+i).get(0),frm.target=window.name,frm.method="post",frm.action=u(r),frm.submit())):f="1"}})}function getPreviewPrint(n,t){function c(){for(var i,n,f,r,u=document.styleSheets,t=0,e=u.length;t<e;t++)if(i=u[t],n=i&&i.href,!_.isNull(n)&&(f=n&&n.split("/"),r=f.find(function(n){return n.indexOf("common-theme")>-1}),r))return r.split(".")[0]}var h=ecount.config.user.UI_ZOOM!=""?ecount.config.user.UI_ZOOM:"",e=navigator.userAgent.toLowerCase(),i;e.indexOf("chrome")==-1&&e.indexOf("opr")==-1&&e.indexOf("safari")==-1&&(h="");var r=ecount.config.company.FONT1.replace("-"," "),u=ecount.config.company.FONT2.replace("-"," "),f=ecount.config.company.FONT3.replace("-"," "),l=ecount.config.company.FONT_SIZE,o=ecount.config.company.FONT_SIZE_STRING,s=c();r!=""&&r!="microsoft yahei"&&(r=r.substr(0,1).toUpperCase()+r.substr(1,r.length-1));u!=""&&u!="microsoft yahei"&&(u=u.substr(0,1).toUpperCase()+u.substr(1,u.length-1));f!=""&&f!="microsoft yahei"&&(f=f.substr(0,1).toUpperCase()+f.substr(1,f.length-1));i=window.open("about:blank");window.setTimeout(function(){i.document.writeln("<!DOCTYPE html><html><head><title>Print Preview<\/title><\/script>");i.document.writeln('<base target="_self">');i.document.writeln("<link href='/static/contents/css/common.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>");i.document.writeln("<link href='/static/contents/css/navigation.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>");i.document.writeln("<link href='/static/contents/css/font-awesome.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>");_.isUndefined(s)||i.document.writeln("<link href='/static/contents/css/"+s+".css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>");o!=""&&i.document.writeln("<link href='/static/contents/css/common-font-size-"+o.toLowerCase()+".css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>");i.document.writeln("<style>a, a:focus, a:hover{cursor:default; text-decoration: none;color:#000000;}");i.document.writeln(".font-user-setting {font-family:'"+r+"','"+u+"','"+f+"','Arial','Apple SD Gothic Neo','Gulim';}");i.document.writeln("<\/style>");i.document.writeln("<\/head>");i.document.writeln("<body class='font-user-setting'>");t&&i.document.writeln("<div style='width: "+(parseInt(t)+10)+"px; '>");i.document.writeln('<div id="mainPage" class="page page-preview page-fluid header-fixed">');i.document.writeln('<div class="contents" style="margin: 33px 5px 0 5px;">');i.document.writeln(n);i.document.writeln("<\/div>");i.document.writeln("<\/div>");i.document.writeln('<script>var anchor = document.getElementsByTagName("a"); for(var i=0, len=anchor.length; i <len; i++){anchor[i].onclick=function(){return false;}}<\/script>');i.document.writeln("<\/body>");i.document.writeln("<\/html>")})}function getPreviewBarCodePrint(n,t,i){var h=ecount.config.user.UI_ZOOM!=""?ecount.config.user.UI_ZOOM:"",o=navigator.userAgent.toLowerCase(),r;o.indexOf("chrome")==-1&&o.indexOf("opr")==-1&&o.indexOf("safari")==-1&&(h="");var u=ecount.config.company.FONT1.replace("-"," "),f=ecount.config.company.FONT2.replace("-"," "),e=ecount.config.company.FONT3.replace("-"," "),c=ecount.config.company.FONT_SIZE,s=ecount.config.company.FONT_SIZE_STRING;u!=""&&u!="microsoft yahei"&&(u=u.substr(0,1).toUpperCase()+u.substr(1,u.length-1));f!=""&&f!="microsoft yahei"&&(f=f.substr(0,1).toUpperCase()+f.substr(1,f.length-1));e!=""&&e!="microsoft yahei"&&(e=e.substr(0,1).toUpperCase()+e.substr(1,e.length-1));r=window.open("about:blank");window.setTimeout(function(){r&&(r.document.writeln("<!DOCTYPE html><HTML><HEAD><title>Print Preview<\/title>"),r.document.writeln('<base target="_self">'),r.document.writeln('<meta charset="UTF-8">'),r.document.writeln('<meta http-equiv="X-UA-Compatible" content="IE=Edge">'),r.document.writeln("<link href='/static/contents/css/common.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.document.writeln("<link href='/static/contents/css/navigation.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.document.writeln("<link href='/static/contents/css/font-awesome.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),s!=""&&r.document.writeln("<link href='/static/contents/css/common-font-size-"+s+".css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.document.writeln("<style>a, a:focus, a:hover{cursor:default; text-decoration: none;color:#000000;}"),r.document.writeln(".font-user-setting {font-family:'"+u+"','"+f+"','"+e+"','Arial','Apple SD Gothic Neo','Gulim';}"),r.document.writeln("<\/style>"),r.document.writeln("<\/HEAD>"),r.document.writeln("<body class='font-user-setting'>"),i=="7"?r.document.writeln('<div id="topBarcodeWidth" style="width: 650px; ">'):r.document.writeln('<div id="topBarcodeWidth" style="width: '+parseInt(t)+'px;">'),r.document.writeln('<div id="mainPage" class="page page-preview page-fluid header-fixed">'),r.document.writeln('<div class="contents" style="margin: 0px 0px 0px 0px;">'),r.document.writeln(n),r.document.writeln("<\/div>"),r.document.writeln("<\/div>"),r.document.writeln("<\/div>"),r.document.writeln('<script>var anchor = document.getElementsByTagName("a"); for(var i=0, len=anchor.length; i <len; i++){anchor[i].onclick=function(){return false;}}<\/script>'),i=="7"&&(r.document.writeln("<script>"),r.document.writeln(' var barcode = document.getElementsByClassName("wrapper-print");'),r.document.writeln(" var maxWidth = 0 ;"),r.document.writeln(" for (var j = 0, blen = barcode.length; j < blen ; j++){ "),r.document.writeln('     var bWidth = barcode[j].getElementsByClassName("wrapper-print-content")[0].clientWidth; '),r.document.writeln("     if ( bWidth > maxWidth ) { maxWidth = bWidth; } "),r.document.writeln(" } "),r.document.writeln(' document.getElementById("topBarcodeWidth").style.cssText = "width: " + (parseInt(maxWidth)) + "px;";  '),r.document.writeln(" for (var k = 0, clen = barcode.length; k < clen; k++){ "),r.document.writeln('     barcode[k].style.cssText = barcode[k].style.cssText.replaceAll("width: 650px;", "width: " + (parseInt(maxWidth)) + "px;");  '),r.document.writeln(" } "),r.document.writeln(" <\/script>")),r.document.writeln("<\/body>"),r.document.writeln("<\/html>"))})}function printURL2(n,t,i){window.onprintcomplete=function(){};printHidden2(n,t,i)}function printHidden2(n,t,i){var c=$("iframe[name=printHiddenFrame]"),l,h,u,r,f;c&&c.remove();l=ecount.config.user.UI_ZOOM!=""?ecount.config.user.UI_ZOOM:"";h=navigator.userAgent.toLowerCase();h.indexOf("chrome")==-1&&h.indexOf("opr")==-1&&h.indexOf("safari")==-1&&(l="");var e=ecount.config.company.FONT1.replace("-"," "),o=ecount.config.company.FONT2.replace("-"," "),s=ecount.config.company.FONT3.replace("-"," "),v=ecount.config.company.FONT_SIZE,a=ecount.config.company.FONT_SIZE_STRING;e!=""&&e!="microsoft yahei"&&(e=e.substr(0,1).toUpperCase()+e.substr(1,e.length-1));o!=""&&o!="microsoft yahei"&&(o=o.substr(0,1).toUpperCase()+o.substr(1,o.length-1));s!=""&&s!="microsoft yahei"&&(s=s.substr(0,1).toUpperCase()+s.substr(1,s.length-1));document.body.insertAdjacentHTML("beforeEnd",'<iframe name=printHiddenFrame width=0 height=0 style="border:0px;"><\/iframe>');u=printHiddenFrame.document;u.open();u.write("<body onload=\"setTimeout('parent.onprintHiddenFrame()', 0);\">");n==""||n=="undefined"||n.length<3?(u.write(" <iframe id='printMe' name='printMe' width=0 height=0 src=\"/ECMain/Scripts/printLoadPage2_new.aspx\" ><\/iframe> "),u.write(' <script language="javascript" type="text/javascript">'),u.write(" function ifmAdd(){ "),t="<div style='width: "+i+"px; '>"+t+"<\/div>",r=["<!DOCTYPE html>"],r.push("<html xmlns='http://www.w3.org/1999/xhtml'>"),r.push("<head>"),r.push("<style>.font-user-setting {font-family:'"+e+"','"+o+"','"+s+"','Arial','Apple SD Gothic Neo','Gulim';}<\/style>"),r.push("<\/head>"),r.push("<body class='font-user-setting'>"),r.push("<link href='/static/contents/css/common.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.push("<link href='/static/contents/css/navigation.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.push("<link href='/static/contents/css/font-awesome.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),a!=""&&r.push("<link href='/static/contents/css/common-font-size-"+a.toLowerCase()+".css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),r.push('<div id="mainPage" class="page page-fluid header-fixed">'),r.push('<div class="contents" style="margin: 33px 5px 0 5px;">'),r.push(t),r.push("<\/div>"),r.push("<\/div>"),r.push("<\/body>"),r.push("<\/html>"),f=r.join("").replace(/"/gm,"'").replace(/(\r\n|\n|\r)/gm,""),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&navigator.userAgent.toLowerCase().indexOf("edge")<0&&(f=f.replace("table-header-group","table-row-group"),f=f.indexOf("table-row-group")<0?f+" <style>thead{ display:table-row-group }<\/style> ":f),u.write(' document.getElementById("printMe").contentWindow.document.body.innerHTML = "'+f+'";'),u.write(" } "),u.write(" <\/script>")):u.write(" <iframe id='printMe' name='printMe' width=0 height=0 src=\""+$.ecrt(ecount.common.buildSessionUrl(n))+'" ><\/iframe> ');u.write("<\/body> ");u.close()}function onprintHiddenFrame(){function n(){printHiddenFrame.outerHTML="";window.onprintcomplete&&window.onprintcomplete()}printFrame(printHiddenFrame.printMe,n)}function printFrame(n,t){var r,u,i;if(n||(n=window),n.document.readyState!=="complete"&&!confirm("The document to print is not downloaded yet! Continue with printing?")){t&&t();return}if(r=function(){var t=window.navigator.userAgent||"";t.indexOf("Firefix")>-1?(n.focus(),n.self.print()):n.document.queryCommandSupported("print")?n.document.execCommand("print",!1,null):(n.focus(),n.self.print())},printIsNativeSupport()){i=document.activeElement;r();t&&t();i&&!i.disabled&&i.focus();navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&window.stop&&window.stop();return}u=printGetEventScope(n);i=document.activeElement;window.printHelper=function(){printFireEvent(n,u,"onafterprint");document.getElementById("printWB").outerHTML="";t&&t();window.printHelper=null};document.body.insertAdjacentHTML("beforeEnd",'<object id="printWB" width=0 height=0  classid="clsid:8856F961-340A-11D0-A96B-00C04FD705A2"><\/object>');printFireEvent(n,u,"onbeforeprint");window.printHelper=printHelper;printIsNativeSupport()?setTimeout("window.printHelper()",0):r()}function printGetEventScope(n){var t=n.document.getElementsByTagName("FRAMESET");return t.length?t[0]:n.document.body}function printFireEvent(n,t,i){var r=t[i];switch(typeof r){case"string":n.execScript(r);break;case"function":r()}}function printIsNativeSupport(){var n=window.navigator.userAgent,i=n.indexOf("MSIE ")+5,t=parseInt(n.substr(i))>=5&&n.indexOf("5.0b1")<0;return n.indexOf("MSIE ")==-1&&(t=!0),t}function fnXmlNodeChange(n,t,i){var r,u,f,e;return $.isEmpty(n)?n:(r=parseXML(n),u=$(r).find("root"),$(u).find(t).text(i),$("*",$(r)).contents().each(function(){(this.nodeType==3||this.nodeType==4)&&(f=r.createCDATASection(this.nodeValue),this.parentNode.appendChild(f),this.parentNode.removeChild(this))}),r.xml==null?(e=new XMLSerializer,e.serializeToString(r)):r.xml)}function parseXML(n){if(window.ActiveXObject&&window.GetObject){var t=new ActiveXObject("Microsoft.XMLDOM");return t.loadXML(n),t}if(window.DOMParser)return(new DOMParser).parseFromString(n,"text/xml")}function fnXmlSingleNodeAdd(n,t,i,r){var e=parseXML(n),f=e.createElement(i),u,o;return window.ActiveXObject&&window.GetObject?f.text=r:f.textContent=r,u=$(e).find(t).get(0),u.appendChild(f),u.xml==null?(o=new XMLSerializer,o.serializeToString(u)):u.xml}function fnNodeCheck(n,t){var i=parseXML(n);return $(i).find(t).get(0)==null?!1:!0}function fnNodeChangeOrAppend(n,t,i){return fnNodeCheck(n,t)?fnXmlNodeChange(n,t,i):fnXmlSingleNodeAdd(n,"root",t,i)}function printHidden2_Pop(n){var h=function(n){return n},o=n.url||"",e=h(n.htmlContent),p=h(n.printCss),c=n.gridWidth,l=$("iframe[name=printHiddenFrame]"),a,s,i,t,y;l&&l.remove();a=ecount.config.user.UI_ZOOM!=""?ecount.config.user.UI_ZOOM:"";s=navigator.userAgent.toLowerCase();s.indexOf("chrome")==-1&&s.indexOf("opr")==-1&&s.indexOf("safari")==-1&&(a="");var r=ecount.config.company.FONT1.replace("-"," "),u=ecount.config.company.FONT2.replace("-"," "),f=ecount.config.company.FONT3.replace("-"," "),w=ecount.config.company.FONT_SIZE,v=ecount.config.company.FONT_SIZE_STRING;r!=""&&r!="microsoft yahei"&&(r=r.substr(0,1).toUpperCase()+r.substr(1,r.length-1));u!=""&&u!="microsoft yahei"&&(u=u.substr(0,1).toUpperCase()+u.substr(1,u.length-1));f!=""&&f!="microsoft yahei"&&(f=f.substr(0,1).toUpperCase()+f.substr(1,f.length-1));document.body.insertAdjacentHTML("beforeEnd",'<iframe name=printHiddenFrame width=0 height=0 style="border:0px;"><\/iframe>');i=printHiddenFrame.document;i.open();i.write("<body onload=\"setTimeout('parent.onprintHiddenFrame1()', 0);\">");o==""||o=="undefined"||o.length<3?(i.write(" <iframe id='printMe' name='printMe' width=0 height=0 src=\"/ECMain/Scripts/printLoadPage2_new.aspx\" ><\/iframe> "),i.write(' <script language="javascript" type="text/javascript">'),i.write(" function ifmAdd(){ "),e.indexOf("wrapper-print-centered")==-1&&e.indexOf("wrapper-print-left")==-1&&e.indexOf("wrapper-print-right")==-1&&(e="<div style='width: "+c+"px; '>"+e+"<\/div>"),t=["<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>"],t.push("<html xmlns='http://www.w3.org/1999/xhtml'>"),t.push("<head><\/head>"),t.push("<body style='width:100%'>"),t.push("<link href='/static/contents/css/common.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),t.push("<link href='/static/contents/css/navigation.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),t.push("<link href='/static/contents/css/font-awesome.css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),v!=""&&t.push("<link href='/static/contents/css/common-font-size-"+v.toLowerCase()+".css?"+Date.now()+"' rel='stylesheet' type='text/css'><\/link>"),y="<style type='text/css'>"+p+" .font-user-setting {font-family:'"+r+"','"+u+"','"+f+"','Arial','Apple SD Gothic Neo','Gulim';} .p_oecount13 div { position: relative !important; }<\/style>",t.push(y),t.push('<div id="mainPage" class="page page-preview page-fluid header-fixed font-user-setting" style="width:'+(parseInt(c)+10)+'px;">'),t.push('<div class="contents" style="margin:'+(n.printMargin?n.printMargin+"px":"33px")+' 5px 0 5px;">'),t.push(e),t.push("<\/div>"),t.push("<\/div>"),t.push("<\/body>"),t.push("<\/html>"),i.write(' document.getElementById("printMe").contentWindow.document.body.innerHTML = "'+t.join("").replace(/"/gm,"'").replace(/(\r\n|\n|\r)/gm,"").replace(/(\\)/gm,"\\\\")+'";'),i.write(" } "),i.write(" <\/script>")):i.write(" <iframe id='printMe' name='printMe' width=0 height=0 src=\""+$.ecrt(ecount.common.buildSessionUrl(o))+'" ><\/iframe> ');i.write("<\/body> ");i.close()}function onprintHiddenFrame1(){function n(){printHiddenFrame.outerHTML="";setTimeout(function(){window.open("about:blank","_self").self.close()},4e3)}printFrame(printHiddenFrame.printMe,n)}var ecenum;window.__define_resource&&__define_resource("MSG08798","MSG08799","MSG07660","MSG06861","MSG01136","MSG01396","MSG04743","MSG02827","MSG02828","MSG02829","MSG02830","MSG02831","MSG01395","LBL10961","LBL10962","LBL10482","LBL07870","MSG02826","LBL07871","LBL07872","LBL93315","LBL93343","LBL09184","LBL09186","LBL14667","LBL14666","LBL09240","LBL14669","LBL14668","LBL10052","LBL08922","LBL12700","LBL12701","LBL80195","LBL02339","LBL35294","LBL01235","LBL14671","LBL09653","LBL09185","MSG00141","LBL20996","LBL40237","LBL08902","LBL05930","LBL08127","MSG11172","LBL05551","LBL00504","LBL01421","BTN00008","LBL01677","LBL15053","MSG05975","MSG08127","LBL07765","MSG06408","MSG00392","LBL20609","MSG09509","LBL00031","LBL00030","LBL03813","LBL19314","MSG10563","LBL09996","LBL01932","LBL01039","LBL10414","LBL10715","LBL09437","MSG05624","MSG05619","MSG05636","MSG05637","MSG05652","LBL03306","MSG70726","LBL12306","LBL12308","MSG04479","MSG04121","MSG05805","MSG05490","MSG05178","MSG10198","MSG07868","LBL09336","LBL03176","LBL09235","MSG07592","MSG08974","LBL07309","LBL01333","LBL10256","LBL01259","LBL10375","LBL10694","LBL07531","LBL12827","LBL12829","LBL12828","LBL12830","LBL13234","LBL13236","LBL13232","LBL02354","LBL08420","LBL02715","LBL10989","LBL09977","LBL12825","LBL12826","LBL00785","LBL02464","LBL00791","LBL06643","LBL00784","LBL06644","LBL12103","LBL12104","LBL09273","LBL09272","LBL02121","LBL02678","BTN00212","BTN00232","BTN00507","BTN00508"),function(){var t=window.opener,i;if(t)try{i=t.location.origin}catch(n){n&&n.message&&typeof n.message=="string"&&n.message.indexOf("cross-origin")&&(t=null,window.opener=null)}}();var ecmodule={},ecount=window.ecount={graph:{}},widget=window.widget={menuContainer:{},menuSection:{},menuItem:{},multiCode:{},code:{},multiDate:{},dualDate:{},dualTime:{},date:{},select:{},radio:{},checkbox:{},button:{},input:{},keyHelper:{},search:{},searchGroup:{},searchBar:{},textarea:{},textEditor:{},label:{},link:{},list:{},toastPopup:{},custom:{},signbox:{},scorebox:{},board:{},menu:{},topBottomSetting:{},liItem:{},gridLineController:{},listView:{},descriptionList:{},service:{},paging:{},board:{},mainMenu:{},image:{},compiler:{},itemList:{},settingHoliday:{},color:{},address:{},calendar:{},fileGroupList:{},category:{},repeatDate:{},verticalCalc:{},gridCell:{},customizer:{},simpleMultiCode:{},jstree:{},barcodeImageTag:{}},widgetview=window.widget.view=$.extend(!0,{},widget);ecount.env||(ecount.env={});ecount.prefix="__ec.";ecount.externalFrameName="__externalEcountIFrame";ecount.parentFrame=function(){function n(t){t=t||window;try{return t[ecount.prefix+"ecp.ecp050m"]?t:t.parent&&t.parent!=t?t.name==ecount.externalFrameName?t:n(t.parent.window):t.ecount!==undefined?t:window}catch(i){return null}}return n()}();ecount.__isEventCaptureMode=function(){try{var n=ecount.parentFrame;return requestUrl.param.__enableEcEventCapture=="true"||n&&n.Tutorial&&n.Tutorial.__STATE!="0"}catch(t){return!1}};ecount.__isScripErrorAlertMode=function(){if(window.requestUrl.isStage&&/stage[a-z]{0,2}3(-dev)?/g.test(window.requestUrl.host))return!0}();ecount.__isScriptDebuggingMode=function(){return ecount.__isScripErrorAlertMode?!0:["ANYZONE"].includes(window.__EC_ZONE)?!0:window.requestUrl.isZeus?!0:!1}();ecount.__isTRecordMode=function(){return ecount.__isEventCaptureMode()&&window.__EC_TUTORIAL_MODE=="record"};ecount.__isTRevokeEventMode=function(){if(ecount.__isEventCaptureMode())try{var n=ecount.parentFrame;return n&&n.Tutorial&&n.Tutorial._REVOKE_EVENT_MODE==!0}catch(t){return!1}return!1};ecount.__isTRevokeAutoOpenMode=function(){if(ecount.__isEventCaptureMode())try{var n=ecount.parentFrame;return n&&n.Tutorial&&n.Tutorial._REVOKE_AUTO_OPEN_MODE==!0}catch(t){return!1}return!1};ecount.__isTRevokeFormoutsetEventMode=function(){if(ecount.__isEventCaptureMode())try{var n=ecount.parentFrame;return n&&n.Tutorial&&n.Tutorial._REVOKE_FORMOUTSET_EVENT_MODE==!0}catch(t){return!1}return!1};ecount.__isEventCaptureModeOnHeadless=function(){return requestUrl.param.__EC_HEADLESS_BROWSER=="1"};ecount.log=function(n,t){ecount.__isEventCaptureMode()&&(t=t||"",ecount.parentFrame.console.info("::: LOG ::: "+n+" ["+(typeof t=="string"?t:t.id+" - "+t.subTitle)+"]",t))};ecount.errorLog=function(n){console.error?console.error(n):console.log(n)};ecount.eventLog=function(n,t){var i,r;ecount.__isEventCaptureMode()&&(ecount.__isEventCaptureModeOnHeadless()&&n.test(/initialize/)&&(i=["controlType","id","name","subTitle","tabID","gridID","ecPageID","__target","dataRules","_readOnly","numericRange","_isPositiveInteger","_useNumericRequired"],requestUrl.param.FILTER&&i.concat(requestUrl.param.FILTER.split("|")),r={},i.forEach(function(n){t.options[n]&&(r[n]=t.options[n])}),t=r,ecount.__ecRecorderInitializedEvent.push(t)),t.isIframe=window!=top,t.frameName=window.name,ecount.parentFrame!==window&&(t.parentName=ecount.parentFrame.name),ecount.parentFrame.console.info("::: EVENT ::: "+n,t))};ecount.gridLog=function(n,t){ecount.__isEventCaptureMode()&&(ecount.__isEventCaptureModeOnHeadless()&&n.test(/initialize/),t=t||{},t.isIframe=window!=top,t.frameName=window.name,ecount.parentFrame!==window&&(t.parentName=ecount.parentFrame.name),ecount.parentFrame.console.info("::: GRID ::: "+n,t||{}))};ecount.getConfig=function(n){var t;return ecount&&ecount.config&&ecount.config.user&&(t=ecount.config.user[n]),$.isNull(t)&&typeof webmail!="undefined"&&webmail.config&&(t=webmail.config[n]),t};ecount.__isEventCaptureModeOnHeadless()&&(ecount.__ecRecorderInitializedEvent=[]);ecount.__isEventCaptureMode()&&(window.onerror=function(n){console.errLog&&console.errLog();ecount.parentFrame.console.log("::::: ERROR ::::::"+n)});ecount.getParentFrame=function(n){return n.name==ecount.externalFrameName?n:n.parent};ecount.pathTracker=function(){var n=[];return{addFootage:function(t){if(ecount.__isScriptDebuggingMode){var t=t.toString();n.length==15&&n.shift();t+="("+(new Date).toLocaleTimeString()+")";n.push(JSON.stringify(t))}},getFootage:function(){return n.join(" >> ")}}}();ecount.eventTracker=function(){var n=[];return{addFootage:function(t,i){if(ecount.__isScriptDebuggingMode){var r={type:i.type,ecPath:t.ecPath,cid:t.cid,pageID:t.ecPageID,targetInstanceLen:t.targetInstance?t.targetInstance.length:0,at:(new Date).toLocaleTimeString()};i.type=="keydown"?(r.shift=i.shiftKey,r.ctrl=i.ctrlKey,r.keyCode=i.keyCode):r.tag=i.target?i.target.tagName:"";n.length==30&&n.shift();n.push(JSON.stringify(r))}},getFootage:function(){return n.join(" >> ")}}}();ecount.requestTracker=function(){var t=[],i,n;if(ecount.__isScriptDebuggingMode&&!~navigator.appVersion.toUpperCase().indexOf("PHANTOMJS")){i=XMLHttpRequest;function r(n){t.length==10&&t.shift();t.push(n+"("+(new Date).toLocaleTimeString()+")")}XMLHttpRequest=function(){function u(n){r(t+" ["+n.type+"]")}var f=Array.prototype.slice,e=f.call(arguments,0),n=new(Function.prototype.bind.apply(i,e)),t="",o=n.open,s=n.send;return n.open=function(){var n=f.call(arguments,0);return t=n[1],t=t.substring(0,t.indexOf("?")),r(arguments[0]+" "+t+" [open]"),o.apply(this,arguments)},n.send=function(){return r(t+" [send]"),s.apply(this,arguments)},n.addEventListener("load",u),n.addEventListener("error",u),n.addEventListener("abort",u),n};for(n in i)Object.hasOwnProperty("send")!==n&&Object.hasOwnProperty("open")!==n&&(XMLHttpRequest[n]=i[n])}return{getHttpRequestTrack:function(){return t.join(" >> ")}}}();ecount.errorLogMode=function(){var n=ecount.__isScriptDebuggingMode;return{on:function(){n=!0},off:function(){n=!1},state:function(){return n}}}();ecount.eventDispatchFilter=function(){var n={};return window.requestUrl.domainType!=="E"?{block:function(){},allow:function(){},isAllowed:function(){return!0}}:{block:function(t){n[t]=!0},allow:function(t){n[t]&&delete n[t]},isAllowed:function(t){return!n[t]}}}();ecount.pageInfo=function(){var n=!1,t="";return{setPageLoading:function(t){n=t},getPageLoading:function(){return n},setPrevMenuID:function(n){t=n},getPrevMenuID:function(){return t}}}(),function(){var n=!1;ecount.setTiggeredApiStatus=function(t){var i=t===undefined?!0:t;n=i};ecount.getTriggeredApiStatus=function(){return n}}(),function(){var n=!1;ecount.setWindowRefreshFlag=function(t){t===undefined&&(t=!0);n=t};ecount.getWindowRefreshFlag=function(){return n}}(),function(){var n=!1;ecount.showFormInfoVersion=function(t){t===undefined&&(t=!0);n=t};ecount.isShowingFormInfoVersion=function(){return n}}();ecount.__isEventCaptureMode()&&(ecount.__EC_EVENTS={MOUSEOUT:"mouseout",MOUSEOVER:"mouseover",CLICK:"click",LOAD_PAGE:"page-loaded",CLOSE_ALERT:"closeAlert",SHOW_ECSELECT_LAYER:"showEcSelectLayer",HIDE_ECSELECT_LAYER:"hideEcSelectLayer",SHOW_DROPDOWN_MENU:"showDropdownMenu",HIDE_DROPDOWN_MENU:"hideDropdownMenu",OPEN_LAYER_WINDOW:"openLayerWindow",RELOAD_LAYER_WINDOW:"reloadLayerWindow",RESIZE_LAYER_WINDOW:"resizeLayer",CLOSE_DATEPICKER:"closeDaterangepicker",OPEN_DATEPICKER:"openDaterangepicker",TOGGLE_DATEPICKER:"toggle-datepicker"},ecount.__EC_FIND_ECPAGEID=function(n,t){return t?ecount.popup.parent.$("iframe#mainbody").contents().find("div[data-ecpageid]"):ecount.popup.parent.$("div[data-ecpageid]").filter(function(t,i){return i.getAttribute("data-ecpageid").indexOf(n)==0})},window.onerror=function(n){console.errLog&&console.errLog();ecount.parentFrame.console.log("::::: ERROR ::::::"+n)});ecount.version="{{version}}";ecount.ecRefreshTimestamp="0";ecount.ecIsShowRefreshMessage=!0,function(n){function f(n,t){var r=ecount.common.isExistNamespace(n),i;if(r===!1)return ecount.common.defineNamespace(n,t);for(i in r)r.hasOwnProperty(i)&&t[i]==undefined&&(t[i]=r[i]);return ecount.common.defineNamespace(n,t)}function e(t,i){var i,u,r;return typeof t=="object"?(t.noContentType||(u=t.contentType||"application/json"),n.isNull(t.ecPageID)&&console.warn("ecPageID 속성을 설정해주세요 - Please set ecPageID property"),t.complete&&t.ecPageID&&(r=t.complete,t.complete=function(){ecount.global.getDestroyedState(t.ecPageID)||r.apply(null,arguments)}),n.extend({type:"POST",contentType:u},t)):{type:"POST",url:t,data:i,success:r}}function o(n){var t=n.url;return(t===undefined&&(t=ecount.infra.url),t.startsWith("http")||t.startsWith("/GMCAPI")||n.isGMC||n.isFixedZone||t.startsWith(ecount.apiPathRoot)||(t=ecount.apiPathRoot+t),ecount.env&&ecount.env.mock&&ecount.env.mock.isRunnig())?ecount.common.buildSessionUrl(ecount.env.mock.getApiUrl(t)):n.useOriginURL||n.isGMC||n.isFixedZone?t:ecount.common.buildSessionUrl(t)}function s(t){if(t.type=="POST")return t.data?t.contentType.find("json",!0)!=-1&&n.isPlainObject(t.data)?Object.toJSON(t.data):t.data:Object.toJSON({ts:Date.now()})}function h(t,i){var e=window.requestUrl.param.ec_req_sid,o,s,u,r,f;if(e){o=n.cookie("ECOUNT_SessionId");s=new RegExp(e.replace(/[\*\!]/g,"\\$&")+"=[^&]+").exec(o);u=[];r={ECOUNT_SessionId:s};t.cookieFilter&&t.cookieFilter(r);for(f in r)u.add(f+"="+r[f]);i.url+="&xck="+encodeURIComponent(u.join("; ").encodeBase64())}i.url+=(i.url.indexOf("?")>0?"&":"?")+"xct="+(i.dataType||"json");i.contentType="application/x-www-form-urlencoded";i.forceContentUrlEncode=!0}function c(t){var i=t.complete,r=t.beforeSend;return{beforeSend:function(){arguments[1].timerReturnValue=window.setTimeout(function(){n(".wrapper-overlay").show();n(".wrapper-page-progress").removeClass("hidden");ecount.__isEventCaptureMode()&&ecount.eventLog("showProgressBar",{type:"showProgressBar"})},1e3);r&&r.apply(null,arguments)},complete:function(){t.ecPageID&&ecount.global.getDestroyedState(t.ecPageID)||(this.timerReturnValue&&clearTimeout(this.timerReturnValue),n(".wrapper-page-progress").addClass("hidden"),n(".wrapper-overlay").hide(),i&&i.apply(null,arguments))}}}function l(n){var t,i,r;ecount.__isEventCaptureMode()&&(t=n.url.encodeBase64(),i=t.substr(0,t.length>30?30:t.length),n.__ecEventCaptureRequestCheckId=i,r={type:"request",displayTitle:n.url+" --> "+n.__ecEventCaptureRequestCheckId,actionTarget:i},ecount.eventLog("request",r))}function a(t){var i=t.success,u=t.error;return function(f,e,o){if(!t.ecPageID||!ecount.global.getDestroyedState(t.ecPageID)){if(i&&(t.successCallback=i),u&&(t.errorCallback=u),(n.isNull(f)||n.isNull(f.AsyncActionKey))&&ecount.common.hideProgressbarInPage&&ecount.common.hideProgressbarInPage(),t.__ecRequestInfo&&(o=o||{},o.__ecRequestInfo=t.__ecRequestInfo,delete t.__ecRequestInfo),t.__ecEventCaptureRequestCheckId&&(n("body").append('<input type="hidden" data-recorder="request-complete" id="'+t.__ecEventCaptureRequestCheckId+'"/>'),delete t.__ecEventCaptureRequestCheckId),t.external===!0){r(">>>> external api",i.bind(null,f,e,o));return}if(t.passErrorAlert===!0){r(">>>> jump to successCallback api",i.bind(null,f,e,o));return}t.refreshMessage=ecount.resource.MSG08798;t.saveTemporaryfnc&&(t.refreshMessage+="<br /><br />"+ecount.resource.MSG08799);f=v(f,t);switch(f.Status){case 200:case"200":y(t,f,e,o);break;case 202:case"202":w(t,f,e,o);break;case 410:case"410":b(t,f,e,o);break;default:k(t,f,e,o)}}}}function v(t,i){if(n.isNull(t)==!0||n.isNull(t.Error)==!0&&n.isEmpty(t.Errors)==!0)return t;if(n.isNull(t.Errors)==!1&&n.isArray(t.Errors)==!0&&(t.Error=n.extend({},t.Errors[0])),!n.isEmpty(i.refreshMessage)){var r=ecount.common.getIsShowRefreshMessage(t);t.Error.Message&&t.Error.Message.indexOf("Model validation state error")>-1?(t.Error.MessageDetail=t.Error.Message||"",r==!0&&(t.Error.MessageDetail=i.refreshMessage)):(t.Error.Message=t.Error.Message||"",r==!0&&(t.Error.Message=i.refreshMessage))}return t}function y(n,t,i,r){var u=n.successCallback;try{if(t.Data&&t.Data.bitMaskMapType&&ecount.bitmask.decode(t.Data),t.Data&&t.Data.ColumnForm&&t.Data.ColumnForm.bitMaskMapType&&ecount.bitmask.decode(t.Data.ColumnForm),t.Data&&n.ecPageID&&n.ecPageID.substr(0,14)=="BulkUploadForm"){u&&u(t,i,r);ecount.common.errorNotice(n,t,!0);return}p(n,t,i,r)}catch(f){ecount.errorLog(">>>> api ERROR >>> ");ecount.errorLog(f)}}function p(t,i,r,u){var f=!1,s=t.successCallback,h=function(n,t,i,r,u){if(u)try{u(t,i,r)}catch(f){var e=n?n.url:"";ecount.errorLog(">>>> ERROR <<<<<");ecount.errorLog("ecount.common.api > doApiErrorActionOnSuccess callback");ecount.errorLog(">>> calback for "+e);ecount.errorLog(f)}},e,o;if(typeof webmail=="undefined"&&n.isEmpty(i.Errors)==!1?f=!0:typeof webmail=="undefined"&&n.isArray(i.Data)==!0&&i.Data.any(function(t){return n.isEmpty(t.Errors)==!1})==!0&&(f=!0,n.isArray(i.Data)&&(e=0,o=0,i.Data.forEach(function(t){n.isEmpty(t.Errors)?e++:o++}),i.Data.SuccessCnt=e,i.Data.FailCnt=o)),f){ecount.common.errorNotice(t,i);t.errorCallback&&t.errorCallback(u,i.Status,i.Errors);return}i.Data&&i.Data.isLimitColumn?ecount.confirm(ecount.resource.MSG07660,function(n){n?t.errorCallback&&t.errorCallback(u,i.Status,i.Errors):h(t,i,r,u,s)}.bind(this)):i.Data&&i.Data.FreqDeployRollback?ecount.alert(t.refreshMessage,function(){this.location.reload(!0)}.bind(this)):h(t,i,r,u,s)}function w(n,t,i,f){var e=n.successCallback;u(t.Error.Message,{title:"Warning",trace:t.Error.MessageDetail,confirmHandler:r(">>>> api",e.bind(null,t,i,f))});r(">>>> api",e.bind(null,t,i,f))}function b(n,t){setTimeout(function(){ecount.parentFrame.location.href=t.Data||"/"},10)}function k(t,i,r,f){var e=t.errorCallback,o;if(e){if(!n.isEmpty(t.refreshMessage)&&(o=ecount.common.getIsShowRefreshMessage(i),o==!0))return ecount.alert(t.refreshMessage,function(){t.saveTemporaryfnc&&t.saveTemporaryfnc();location.reload(!0)}.bind(this)),!1;!n.isNull(i.Errors)&&n.isArray(i.Errors)&&n.isEmpty(i.Error)&&(i.Error=n.extend({},i.Errors[0]));try{e(f,i.Status,t.reqErrorRawResult?i:i.Error,ecount.common.errorNotice.bind(ecount.common,t,i))}catch(s){ecount.errorLog(">>>> api ERROR >>> ");ecount.errorLog("ecount.common.api > doOtherErrorAction callback");ecount.errorLog(s)}return}if(typeof webmail=="undefined"&&(n.isEmpty(i.Errors)==!1||n.isArray(i.Data)==!0&&i.Data.any(function(t){return n.isEmpty(t.Errors)==!1})==!0)){ecount.common.errorNotice(t,i);return}i.Error&&i.Error.Message&&u(i.Error.Message,{title:"System Error "+i.Status,trace:i.Error.MessageDetail})}function d(n){var t=n.error;return function(i,f,e){n.ecPageID&&ecount.global.getDestroyedState(n.ecPageID)||(t&&r(">>>>> get error from server during calling api",t.bind(null,i,f,e)),i.status=="412"&&u(ecount.resource.MSG06861))}}function r(n,t){try{t&&t()}catch(i){ecount.errorLog(n);ecount.errorLog(i)}}function u(n,t){if(!ecount.error){alert(t.msg);t&&t.callback&&r(">>>> api",t.callback);return}ecount.error(n,t)}ecount.class=function(t,i,r){var u=!!(typeof i=="string"&&i.indexOf("ecount.control")>-1);return f(t,n.Class(i?ecount.common.createNamespace(i):null,u,r))};ecount.module=function(n,t){return f(n,t)};ecount.mixins=function(){var t=null,r,u,i,f,e;if(arguments.length==0)throw new Error("ecount.mixins 에 전달된 인자가 없습니다.");else{if(r=Array.prototype.slice.call(arguments,0),t=r.pop(),r.length==0)return t;for(u=r.pop(),i=ecount.common.createNamespace(u[0]),f=1,e=u.length;f<e;f++)i=n.extend(!0,{},i,ecount.common.createNamespace(u[f]));i&&(t=n.extend(!0,{},i,t))}return t};ecount.mixinModule=function(){};ecount.implements=function(t,i){n.Class.implements.apply(t,i)};var t={};n.extend(ecount,{_seqIndex:0,_seqPIndex:0,resource:{},browser:{userAgent:""},common:{number:{defaultLength:12,defaultPointLength:4,amountLength:16,amountPointLength:2,maxnumber:15,maxpoint:4},layout:{dialog:{width:350,height:200,maxHeight:500,minWidth:200,minHeight:200},progressbar:!0},isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||/Macintosh/i.test(navigator.userAgent)&&!!navigator.maxTouchPoints,isExistAgent:function(n){var t=window.navigator.userAgent.toLowerCase();return t.indexOf(n)!==-1}},abstract:{},system:{IsEnableNoL4:null},separator:{thousands:",",ecPath:"∫"},popupIDDelimiter:"∫",delimiter:"∬",cloudFolderName:"ECOUNT",proxyPathRoot:"/ECERP",apiPathRoot:"/ECAPI",isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||/Macintosh/i.test(navigator.userAgent)&&!!navigator.maxTouchPoints,isMobileApp:/Ecount\/android|Ecount\/IOS/i.test(navigator.userAgent),testServerPattern:/^(test|zeus|apollo|hera|hcn|herazone)([a-z|A-Z]+)?([\d]+)?$/i,realServerPattern:/^(login|app)([a-z|A-Z]+)?([\d]+)?$/i,configStorageResetType:["ONLOAD"],splitFlag:"ㆍ",attachment:{file:"01",mystorage:"02",slip:"03",draft:"04",post:"05",video:"06",image:"07",ecdrive:"98"},attachmentCss:{file:"attached-file",mystorage:"attached-personal",slip:"attached-slip",draft:"attached-article",post:"attached-approval",video:"attached-movie",image:"attached-imagebox",ecdrive:"attached-ecdrive"},region:"ko-KR",performance:function(){!ecount.isMobile},isIE:n.browser.msie,isNotSupportedBrowser:n.browser.msie&&parseInt(n.browser.version)==8,isResponsiveMode:function(){return requestUrl.domainType=="W"?n("#responsive-applied").is(":visible"):n("#responsive-applied").is(":visible")&&ecount.user&&ecount.config.user.RESPONSIVE_YN=="Y"}});n.extend(ecount.common,{createNamespace:function(n,t){for(var n=n?n.split("."):"",i=t||window,r=0;r<n.length;r++)typeof i[n[r]]=="undefined"&&(i[n[r]]={}),i=i[n[r]];return i},isExistNamespace:function(n,t){for(var n=n?n.split("."):"",i=t||window,r=0;r<n.length;r++){if(typeof i[n[r]]=="undefined")return!1;i=i[n[r]]}return i},defineNamespace:function(n,t){for(var n=n?n.split("."):"",i=window,r=0,u=n.length;r<u;r++)r==u-1?(i[n[r]]=t,i=i[n[r]]):(i[n[r]]==undefined&&(i[n[r]]={}),i=i[n[r]]);return i==window?null:i},createViewModel:function(t,i){var r=ecount.common.createNamespace(t);return n.extend(!0,r,i),r.domready&&n(document).ready(n.proxy(r.domready,r)),r},buildSessionUrl:function(t,i){var f=n.url(t),h=i||f.param.ec_req_sid||window.requestUrl.param.ec_req_sid,e=f.param.SESSION_ID||window.requestUrl.param.SESSION_ID,o=n.isEmpty(e)?"ec_req_sid":"SESSION_ID",s=n.isEmpty(e)?h:e,r,u,c;if(n.isEmpty(s)||!n.isEmpty(f.param[o]))return f.source;try{r=n.url().param;u=[o+"="+s];r.proxyURL&&u.push("proxyURL="+r.proxyURL);r.PREVIEW_MODE&&u.push("PREVIEW_MODE="+r.PREVIEW_MODE);r.__EC_PROGRAM_CODE&&u.push("__EC_PROGRAM_CODE="+r.__EC_PROGRAM_CODE)}catch(l){}return c="",n.isEmpty(f.query)?t+"?"+u.join("&"):t+"&"+u.join("&")},buildFullSessionUrl:function(t,i){var o=n.url(t),r=i||window.requestUrl.param.ec_req_sid,u=i||window.requestUrl.param.SESSION_ID,f=n.isEmpty(u)?r:u,s,e;return n.isEmpty(o.param.SESSION_ID)?n.isEmpty(r)&&n.isEmpty(u)?t:(n.isEmpty(u)&&(s=n.cookie("ECOUNT_SessionId"),e=new RegExp(r.replace(/[\*\!]/g,"\\$&")+"=([^&]+)").exec(s),e&&(f=e[1]+":"+r)),n.isEmpty(o.query))?t+"?SESSION_ID="+f:t+"&SESSION_ID="+f:t},buildFullSessionId:function(t){var i=t||window.requestUrl.param.ec_req_sid,u=n.cookie("ECOUNT_SessionId"),r=new RegExp(i.replace(/[\*\!]/g,"\\$&")+"=([^&]+)").exec(u);return n.isEmpty(i)||!r?"":r[1]+":"+i},getValidIdentifierString:function(n){return n.replace(/[\?\=\&\/]/gi,"").replace(/^(?:do|if|in|for|function|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/gi,"").replace(/[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc][$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]/gi,"")},setApiProgressbar:function(n,t){ecount.common.showProgressbarInPage=n;ecount.common.hideProgressbarInPage=t},clearApiProgressbar:function(){ecount.common.showProgressbarInPage=null;ecount.common.hideProgressbarInPage=null;delete ecount.common.showProgressbarInPage;delete ecount.common.hideProgressbarInPage},ecwapi:function(t,i){var e="";n.isNull(i)||(e=typeof i=="string"?i:i.ecPageID);console.log("ecwapi ecPageId["+e+"]");var o=t.success,l=t.error,f=t.complete,u=t.ecwtimeout,s=t.timeout;n.isNull(u)&&(u=s);n.isNull(s)||n.isNull(u)||u<s&&(u=s);n.isNull(u);var r={},a=function(t,i,f,e){console.log("ecw settimeout!!!");r.pageID=t;r.tid=i;r.timeoutHandler=null;var o=function(){console.log("ecw timeout!!!");ecount.common.unregisterEcRepository(i);this.endProc&&this.endProc();var n="ecwtimeout:"+u+"(ms)";f({status:0,statusText:"ecwtimeout"},"ecwtimeout",n)}.bind(r);r.timeoutHandler=n.isEmpty(t)?window.setTimeout(o,e):ecount.global.setTimeout(t,o,e);r.endProc=function(){if(console.log("ecw clearTimeout!!!"),!n.isNull(this.timeoutHandler)){var i=this.timeoutHandler;this.timeoutHandler=null;n.isEmpty(t)?window.clearTimeout(i):ecount.global.clearTimeoutByTimerNo(t,i);console.log("ecw clearTimeout OK!!!")}}.bind(r)},v=function(){var i=arguments[0],t;if(!n.isEmpty(i.AsyncActionKey)&&(t=i.AsyncActionKey,t.indexOf("S:")==0)){n.isEmpty(e)?ecount.common.registerEcGlobalRepository(t,h):ecount.common.registerEcGlobalRepository(t,h,e);n.isNull(u)||a(e,t,c,u);return}r&&r.endProc&&r.endProc();o&&o(i);f&&f()},c=function(t,i,r){var e=!1,u="";if(i=="500")try{u=n.isNull(r)||n.isEmpty(r.Message)?r:r.Message;e=!0}catch(o){}if(l)try{l.apply(null,arguments)}catch(o){console.log(o);e||(u=n.isNull(r)||n.isEmpty(r.Message)?r:r.Message,e=!0)}else e||(u=n.isNull(r)||n.isEmpty(r.Message)?r:r.Message,e=!0);!n.isEmpty(u)&&e&&typeof u=="string"?ecount.alert(u,function(){f&&f()}):f&&f()},h=function(i){var s,u;console.log("ecw callback");console.log(i);r&&r.endProc&&r.endProc();s=!0;i.status!="E"?i.status=="EX"&&(u=typeof t.data=="string"?JSON.parse(t.data):t.data,!u||n.isNull(u.isSendMessage)?ecount.common.errorNoticeTrxId(e,i.otrxid):ecount.common.errorNotice(t,i),c(i)):(o&&o(i),f&&f())};h=ecount.common.makeDecoratedCallbackForResCodes(h,0);t.success=v;t.error=c;delete t.complete;ecount.common.api(t)},api:function(t,i){function y(){return ecount.common.showProgressbarInPage&&ecount.common.showProgressbarInPage(),ecount.common.decorateAjaxCallbackForResCodes(r),p?(r.dataTypeCustom="json",n.encryptAjax(r)):n.ajax(r)}var p=!0,b=ecount.runtime.getActivePage&&ecount.runtime.getActivePage()||{},w=b.ecPageID||"",r=e(t,i),u,f,v;if(r.url=o(r),r.data=s(r),ecount.env&&ecount.env.mock&&ecount.env.mock.isRunnig()&&(u=ecount.env.mock.getApiConf(r.url),u&&u.status==500))return r.error&&r.error(),!1;if(w&&(f=w.split("_"),f.pop(),n.cookie("X-EC-API-Referer",f.join("_"),{path:"/"})),r.proxyUrl=ecount.proxyPathRoot||"/",r.external!==!0?r.corsPrefilter=h.bind(null,r):p=!1,r.progressbar&&(v=c(r),r.beforeSend=v.beforeSend,r.complete=v.complete),l(r),r.success=a(r),r.error=d(r),r.isGMC)ecount.common.gmcSessionApi({async:r.async,notUseCN:r.notUseCn,sessionURL:r.url,callbackApi:function(n){r.url=n;y()}});else if(r.isFixedZone)ecount.common.zoneSessionApi({async:r.async,notUseCN:r.notUseCn,sessionURL:r.url,zoneName:r.isFixedZone.ZONE,ComCode:r.isFixedZone.COM_CODE||ecount.config.company.COM_CODE,callbackApi:function(n){r.url=n;y()},ecPageID:t.ecPageID});else return y()},apiToV5:function(n){function t(){var t=window.ecount_browser_framework.GET_APPLICATION_CONTEXT().getFeature("IHttpRequestFeature");t.postAsync(n).then(function(t){n.success&&n.success(t)}).catch(function(t){if(n.error)n.error(t);else throw t;})}if(window.__EC_V3_V5_USE_DEFAULT=="X"){n.error&&n.error();return}window.ecount_browser_framework?t():ecount.common.getV5Application(window["viewBag"+n.ecPageID||window.__EC_PAGE_ID||""]||window.viewBag).then(function(){t()}).catch(function(t){if(n.error)n.error(t);else throw t;})},makeDecoratedCallbackForResCodes:function(t,i){return n.isNull(require)?t:function(){var u=arguments,f=arguments[i],e=ecount.common.extractResourceCode(f),r=ecount.common.makeResourceFileKey(e);if(!n.isNull(t)){if(r.length==0){t.apply(null,u);return}r.push(function(){t.apply(null,u)})}r.length!=0&&require.apply(null,r)}},decorateAjaxCallbackForResCodes:function(n){return n.success=ecount.common.makeDecoratedCallbackForResCodes(n.success,0),n.error=ecount.common.makeDecoratedCallbackForResCodes(n.error,2),n},extractResourceCode:function(n){return __get_resourcecode_fromobject(n)},makeResourceFileKey:function(n){return __get_resourcekey_fromcodes(n)},iframe:function(t,i,r,u){var f={},o,e;n.isString(t)&&(r=i,i=t,t=undefined,u=u||{});typeof t=="object"?(f=t,f.config=f.config||{}):f={url:i,data:r,owner:t,keepAlive:!1,config:u||{}};f=n.extend({type:"POST",overlay:!(f.config.overlay===!1),className:f.config.className||"dialog-iframe",attr:f.config.attr||""},f);f.owner||(f.owner=n(document.body));f.overlay&&(o=n("<div>").addClass("dialog-iframe-overlay"),o.appendTo(f.owner));f.keepAlive&&f.owner.find("iframe[name=ecframe]."+f.className).length>0?e=f.owner.find("iframe[name=ecframe]."+f.className)[0].contentWindow:(e=n('<iframe src="about:blank" class="'+f.className+'" name="ecframe" tabindex="-1"'+f.attr+" />").appendTo(f.owner)[0].contentWindow,e&&(e.document.open(),e.document.write('<!DOCTYPE html><html><head><meta charset="UTF-8"/><\/head><body><\/body><\/html>'),e.document.close()));ecount.common.submit({document:e.document,url:f.url,data:f.data})},submit:function(t,i){var r={},f,u;r=typeof t=="object"?t:{url:t,data:i};(r.url||"").toLowerCase().indexOf("/ecerp/v5/app.board.v5/board_list?")>-1&&(r.url=r.url.toLowerCase().replace("/ecerp/v5/app.board.v5/board_list?","/ECERP/EGM/EGM024M?"));typeof r.data=="string"&&(r.data=n.deparam(r.data));var o=r.document||document,e=o.createElement("form"),s,h={};o.body.appendChild(e);for(f in r.data)if(r.data[f]!=null&&r.data[f]!=undefined){if(n.isPlainObject(r.data[f])||n.isArray(r.data[f])){s=!0;h[f]=r.data[f];continue}u=o.createElement("input");u.setAttribute("type","hidden");u.setAttribute("name",f);u.setAttribute("value",r.data[f]);e.appendChild(u)}s&&(u=o.createElement("input"),u.setAttribute("type","hidden"),u.setAttribute("name","ecjsonp"),u.setAttribute("value",Object.toJSON(h)),e.appendChild(u));n.isEmpty(r.target)||(e.target=r.target);e.method=r.type||"POST";e.action=ecount.common.buildSessionUrl(r.url);n.encryptForm(e,r&&r.l7Param);e.submit()},uuid:function(t,i){return n.uniqueId((t||"ecount")+(i||"_"))},makeServiceKey:function(n,t){return[n,t].join(ecount.separator.ecPath)},seqIndex:function(n){if(ecount.__isEventCaptureMode()){var t={type:"seqIndex",desc:ecount.parentFrame.ecount._seqIndex+1};ecount.eventLog("seqIndex",t)}return n+"_"+ ++ecount.parentFrame.ecount._seqIndex},seqPIndex:function(n){if(ecount.__isEventCaptureMode())ecount.eventLog("seqPIndex",{type:"seqPIndex"});return n+"_p_"+ ++ecount.parentFrame.ecount._seqPIndex},resetSeq:function(){ecount.parentFrame.ecount._seqIndex=0;ecount.parentFrame.ecount._seqPIndex=0},movePage:function(t,i){var u=n('<a href="'+n.ecrt(t)+'" target="'+i+'"><\/a>')[0],r;n.browser.msie||n.browser.chrome?u.click():n.browser.firefox?(r=document.createEvent("MouseEvent"),r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),u.dispatchEvent(r)):(r=document.createEvent("MouseEvents"),r.initMouseEvent("click",!0,!0,window),u.dispatchEvent(r))},verifyIrregularExp:function(n){for(var t,n=n.trim(),i=0,r=n.length;i<r;i++)if(t=n.substring(i,i+1).charCodeAt(0),t==34||t==39||t==92||t==8748||t==8212||t==63||t==44)return!1;return!0},toXML:function(n){var t=["<root>"];for(var i in n)t.push("<"+i+"><![CDATA["+n[i]+"]\]><\/"+i+">");return t.push("<\/root>"),t.join("")},name_check:function(n){var t=n._getActiveControl().control,i=t.getValue().length;if(i>50)return t.showError(String.format(ecount.resource.MSG01136,"50","50")),t.setValue(t.getValue().substr(0,50)),t.setFocus(0),!1},text_check:function(n,t,r){var u=n._getActiveControl().control,f=u.controlType==="widget.searchGroup"?u.getValue().keyword:u.getValue(),h=f.length,e=0,s="",o=0,r=r||"";for(i=0;i<h;i++)s=f.charAt(i),escape(s).length>4?e+=2:e++;return o=Math.floor(t/2),e>t?(r=r.toString().replace(/num1/img,o),r=r.toString().replace(/num2/img,t),r!=""?u.showError(r):u.showError(ecount.resource.MSG01396),u.setValue(f.substr(0,o)),u.setFocus(0),!1):void 0},ValidCheckSpecialForCodeType:function(n){var r,i,t;return(n=n.trim(),r=n.length,i=/response.(flush|write|buffer)|system\(/ig,i.test(n))?{result:!1,message:ecount.resource.MSG04743}:(t=n.isContainsLimitedSpecial("code"),t.result?{result:!1,message:t.message}:{result:!0,data:n.replaceSpecial("code")})},ValidCheckSpecialForCodeName:function(n){var r,i,t;return(n=n.trim(),r=n.length,i=/response.(flush|write|buffer)|system\(/ig,i.test(n))?{result:!1,message:ecount.resource.MSG04743}:(t=n.isContainsLimitedSpecial("name"),t.result?{result:!1,message:t.message}:{result:!0,data:n.replaceSpecial("name")})},ValidCheckSpecialForSearch:function(n){var r,i,t;return(n=n.trim(),r=n.length,i=/response.(flush|write|buffer)|system\(/ig,i.test(n))?{result:!1,message:ecount.resource.MSG04743}:this._noReplacement==!0?{result:!0,data:n}:(t=n.isContainsLimitedSpecial("search"),t.result?{result:!1,message:t.message}:{result:!0,data:n.replaceSpecial("search")})},ValidCheckSpecial:function(n){var r,i,t;return(n=n.trim(),r=n.length,i=/response.(flush|write|buffer)|system\(/ig,i.test(n))?{result:!1,message:ecount.resource.MSG04743}:(t=n.isContainsLimitedSpecial(),t.result?{result:!1,message:t.message}:{result:!0,data:n.replaceSpecial()})},fnRemoveDuplicatesForArray:function(n){var t=[];return n.forEach(function(n){t.indexOf(n)==-1&&t.push(n)}),t},fnPwValidationChk:function(t,i,r,u){var o=t,v=o.search(/[0-9]/g),y=o.search(/[a-z]/ig),s,p=ecount.resource.LBL10961,h,c,e=!0,l=!0,a,f;if(n.isNull(o)||o.length==0)return ecount.common.resultPassword({stepResult:e,passwordResult:l});for(o.length<10&&(s=1,h=ecount.resource.LBL10962,c=ecount.resource.MSG02827,e=!1),!/^[A-Za-z0-9\!\@\#\$\%\^\&\*\(\)\_\+\|\{\}\<\>\:\;\[\]\-\=\,\.\?]{10,15}$/.test(o)&&e&&e&&(s=1,h=ecount.resource.LBL10482,c=ecount.resource.MSG02827,e=!1),(v<0||y<0)&&e&&e&&(s=1,h=ecount.resource.LBL10482,c=ecount.resource.MSG02828,e=!1),/\s/.exec(o)&&e&&(s=1,h=ecount.resource.LBL10482,c=ecount.resource.MSG02829,e=!1),/(\w)\1\1/i.test(o)&&(r>=1&&e?(s=2,h=ecount.resource.LBL07870,c=ecount.resource.MSG02830,e=!1):e&&(s=1,h=ecount.resource.LBL07870,l=!1)),f=0;f<o.length;f++)if(f+3<=o.length&&("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(o.substring(f,f+3))>-1||"ZYXWVUTSRQPONMLKJIHGFEDCBA".indexOf(o.substring(f,f+3))>-1||"abcdefghijklmnopqrstuvwxyz".indexOf(o.substring(f,f+3))>-1||"zyxwvutsrqponmlkjihgfedcba".indexOf(o.substring(f,f+3))>-1||"0123456789".indexOf(o.substring(f,f+3))>-1||"9876543210".indexOf(o.substring(f,f+3))>-1)&&r>1&&e){s=2;h=ecount.resource.LBL07870;c=ecount.resource.MSG02831;e=!1;break}for(i!=""&&o.toUpperCase().indexOf(i)>-1&&r>=1&&e&&(s=2,h=ecount.resource.LBL07870,c=ecount.resource.MSG01395,e=!1),a=o.toUpperCase().toString(),f=1;f<u.length;f++)if(u[f][0]&&u[f][0].toString()!=""&&a.indexOf(u[f][0].toString().toUpperCase())>-1)if(r>1){s=3;e=!1;h=ecount.resource.LBL07871;c=ecount.resource.MSG02826+u[f][1].toString();break}else s=3,h=ecount.resource.LBL07871;else e&&l&&(s="4",h=ecount.resource.LBL07872);return ecount.common.resultPassword({step:s,stepTitle:p,stepText:h,stepGuide:c,stepResult:e,passwordResult:l})},resultPassword:function(n){var t;return t=String.format("<div class='wrapper-password-strength-check step-{0}'>{1} : <span class='password-strength-check-state'>{2}<\/span><div class='progress'><div class='progress-bar'><\/div><\/div><\/div><div class='wrapper-toolbar'>{3}<\/div>",n.step,n.stepTitle,n.stepText,n.stepGuide||""),{message:t,stepResult:n.stepResult,passwordResult:n.passwordResult}},getCheckRightSlipRange:function(t,i){if(n.isEmpty(i)||ecount.user.MNG_FLAG==!0||t=="A")return!0;switch(t){case"F":return ecount.user.IN_PART==(i.WriterInPart||ecount.user.IN_PART);case"W":return ecount.user.ID.toUpperCase()==(i.WriterId||ecount.user.ID.toUpperCase()).toUpperCase();case"D":return ecount.user.IN_PART==i.EditorInPart;case"S":return ecount.user.ID.toUpperCase()==i.EditorId.toUpperCase();case"E":return ecount.user.IN_PART==i.EditorInPart||ecount.user.ID.toUpperCase()==(i.WriterId||ecount.user.ID.toUpperCase()).toUpperCase();case"G":return[i.EditorInPart,i.WriterInPart||ecount.user.IN_PART].contains(ecount.user.IN_PART);case"H":return ecount.user.IN_PART==(i.WriterInPart||ecount.user.IN_PART)||ecount.user.ID.toUpperCase()==i.EditorId.toUpperCase();case"Y":return[(i.WriterId||ecount.user.ID.toUpperCase()).toUpperCase(),i.EditorId.toUpperCase()].contains(ecount.user.ID.toUpperCase())}return!0},getMenuRangeAuthMessage:function(n,t,i){var f="IsSearchRange",r,e,u,o;if(t=="U"?f="IsUpdateRange":t=="D"&&(f="IsDeleteRange"),i&&i.key.length>0&&(n=n.where(function(n){return i.key.contains(n.SlipKey)})),r=n.where(function(n){return n[f]==!1}),r.length>0){for(e=[],u=0;u<r.length;u++)e.push({MenuResource:ecount.resource[r[u].SlipNameResx],PermissionMode:t+"R"});return o=this.getAuthMessage("",e),o.isError=!0,o}return{message:"",detail:"",fullErrorMsg:"",isError:!1}},getAuthMessage:function(n,t){for(var i="",u="",r="",f=0;f<t.length;f++){switch(t[f].PermissionMode){case"CW":case"W":i=ecount.resource.LBL09184;r="IN001";break;case"U":i=ecount.resource.LBL09186;r="MD000";break;case"CUC":i=ecount.resource.LBL14667;r="MD001";break;case"CUUC":i=ecount.resource.LBL14666;r="MD002";break;case"D":i=ecount.resource.LBL09240;r="DT000";break;case"CDC":i=ecount.resource.LBL14669;r="DT001";break;case"CDUC":i=ecount.resource.LBL14668;r="DT002";break;case"C":i=ecount.resource.LBL10052;break;case"SR":i=ecount.resource.LBL08922;break;case"UR":i=ecount.resource.LBL12700;break;case"DR":i=ecount.resource.LBL12701;break;case"O":i=ecount.resource.LBL80195;r="ST001";break;case"CEU":i=ecount.resource.LBL02339;r="ST001";break;case"CP":i=ecount.resource.LBL35294;r="PT001";break;case"CBP":i=ecount.resource.LBL01235;r="PT001";break;case"CS":i=ecount.resource.LBL14671;r="SD001";break;case"CEE":i=ecount.resource.LBL09653;r="EC001";break;default:i=ecount.resource.LBL09185;r="AC001"}u+=String.format("{0}- {1} ({2})",u==""?"":"\r\n",t[f].MenuResource,i)}return{message:n==""?ecount.resource.MSG00141:n,detail:u,fullErrorMsg:(n==""?ecount.resource.MSG00141:n)+"\r\n"+u,permissionResource:i,ATHT_CD:r}},requestAlert:function(n,t,i,r,u){var e=[],o=[],f,s;t=t||{};this.callbackID=ecount.global.registerCallback(n,this.onMessageHandler,this);f=ecount.common.getAuthMessage("",[{MenuResource:i||(t.RESX?ecount.resource[t.RESX]:""),PermissionMode:r}]);u&&u.length>0?(s=[],u.forEach(function(n){s.push({MenuResource:n.menuRex||(n.permission.RESX?ecount.resource[n.permission.RESX]:""),PermissionMode:n.PermissionMode});var t=ecount.common.getAuthMessage("",[{MenuResource:"",PermissionMode:n.PermissionMode}]);o.push({RQST_TGT_ID:n.permission.PID,MenuName:n.permission.RESX?ecount.resource[n.permission.RESX]:"",PermitAction:t.permissionResource,atht_cd:t.ATHT_CD})}),f=ecount.common.getAuthMessage("",s)):o=[{RQST_TGT_ID:t.PID,MenuName:t.RESX?ecount.resource[t.RESX]:"",PermitAction:f.permissionResource,ATHT_CD:f.ATHT_CD}];e.push({label:ecount.resource.dialog.OK,callback:function(){}});e.push({label:ecount.resource.LBL20996,callback:function(){var t={width:"450",height:"400",Request:{Data:{RQST_TYPCD:"M",InsertData:o}},responseID:this.callbackID,__ecPageID:n};ecount.popup.openWindow({url:"/ECERP/SVC/EMM/EMM016P_02",name:ecount.resource.LBL40237,param:t,alreadyIncludedLayout:!0,isOnlyCloseBtn:!0,additional:!0})}.bind(this)});ecount.customAlert(f.fullErrorMsg,{list:e,width:350,height:200})},onMessageHandler:function(n,t){switch(n.pageID){case"EMM016P_02":t.callback&&t.callback()}},showProgressbar:function(){ecount.common.layout.progressbar&&(n(".wrapper-overlay").show(),n(".wrapper-page-progress").removeClass("hidden"),ecount.__isEventCaptureMode()&&ecount.eventLog("showProgressBar",{type:"showProgressBar"}))},hideProgressbar:function(t){var i=_.get(t,"isForce",!1);(ecount.common.layout.progressbar||i)&&(n(".wrapper-page-progress").hasClass("hidden")||(console.log("hide progress ~!"),n(".wrapper-page-progress").addClass("hidden")),n(".wrapper-overlay").hide())},getNumberLength:function(t){return n.isEmpty(t)&&(t=ecount.common.number.defaultPointLength),t=n.parseNumber(t),[ecount.common.number.defaultLength+t,t]},getAmountLength:function(t){return n.isEmpty(t)&&(t=ecount.config.company.DEC_AMT),n.isEmpty(t)&&(t=ecount.common.number.amountPointLength),t=n.parseNumber(t),[ecount.common.number.amountLength+t,t]},parseXML:function(t){return n.parseXML(t)},getXMLNodeData:function(t,i){return n(t).find(i).text()},getXMLNodeNames:function(t){for(var i="",u=[],r=0;r<n(t).find("root").children().length;r++)try{if(i=n(t).find("root").children()[r].nodeName,i==null||i=="")continue;u.push(i)}catch(f){continue}return u},reMakeXMLText:function(t,i){for(var e,f,r,o="<root>",u=0;u<Object.keys(t).length;u++)for(r=0;r<n(i).find("root").children().length;r++)if(Object.keys(t)[u]==n(i).find("root").children()[r].nodeName){o+="<"+n(i).find("root").children()[r].nodeName+"><![CDATA["+t[Object.keys(t)[u]]+"]\]><\/"+n(i).find("root").children()[r].nodeName+">";break}for(e=!0,f="",u=0;u<n(i).find("root").children().length;u++){for(r=0;r<Object.keys(t).length;r++)if(Object.keys(t)[r]==n(i).find("root").children()[u].nodeName){e=!1;break}e&&(f=n(i).find("root").children()[u].nodeName,o+="<"+f+"><![CDATA["+n(i).find(f).text()+"]\]><\/"+f+">");e=!0}return o+"<\/root>"},changeObjectKey:function(n,t){for(var r,u,f=[],i=0;i<n.length;i++)r=n[i],u={},Object.keys(r).forEach(function(n){var i=r[n];u[t[n]||n]=i}),f.push(u);return f},getXPathFromElement:function(n,t){return ecount.common.createXPathFromElementToRoot(n,t)},createXPathFromElement:function(n,t){var f,o,r,e,u;try{t!=undefined&&n[t]&&n[t].tagName.toLowerCase()!="option"&&(n=n[t])}catch(s){}try{t!=undefined&&n[t]&&n[t].tagName.toLowerCase()!="option"&&(n=n[t])}catch(s){}for(f=document.getElementsByTagName("*"),o=function(n){return n},r=[];n&&n.nodeType==1;n=n.parentNode)if(n.hasAttribute("id")){for(e=0,u=0;u<f.length;u++)if(f[u].hasAttribute("id")&&f[u].id==n.id&&e++,e>1)break;if(e==1)return r.unshift('id("'+n.getAttribute("id")+'")'),o(r.join("/"));r.unshift(n.localName.toLowerCase()+'[@id="'+n.getAttribute("id")+'"]')}else if(n.hasAttribute("data-container-id"))r.unshift(n.localName.toLowerCase()+'[@data-container-id="'+n.getAttribute("data-container-id")+'"]');else if(n.hasAttribute("class"))r.unshift(n.localName.toLowerCase()+'[@class="'+n.getAttribute("class")+'"]');else{for(i=1,sib=n.previousSibling;sib;sib=sib.previousSibling)sib.localName==n.localName&&i++;r.unshift(n.localName.toLowerCase()+"["+i+"]")}return r.length?"/"+o(r.join("/")):null},createXPathFromElementToRoot:function(n,t){function r(n,t){for(var u=-1,f=n.nodeName.toLowerCase(),r,i=0;i!=t.length;++i)if(r=t[i],r.nodeName.toLowerCase()===f&&(++u,r===n))return u;return-1}function i(n,t){var u,f,e;return u=n.parentElement,u?(e=n.nodeName.toLowerCase(),f=r(n,u.children)+1,i(u,"/"+e+"["+f+"]"+t)):"//html[1]"+t}try{t!=undefined&&n[t]&&n[t].tagName.toLowerCase()!="option"&&(n=n[t])}catch(u){}return i(n,"")},createXpathFromGrid:function(t){function r(n,t){for(var u=-1,f=n.nodeName.toLowerCase(),r,i=0;i!=t.length;++i)if(r=t[i],r.nodeName.toLowerCase()===f&&(++u,r===n))return u;return-1}function i(n,t){var u,f,e;return u=n.parentElement,u?(e=n.nodeName.toLowerCase(),f=r(n,u.children)+1,i(u,"/"+e+"["+f+"]"+t)):"//html[1]"+t}return n.isArray(t)&&(t=t[0]),i(t,"")},getNoScriptByHtml:function(n){return n.replace(/<style([\s\S]*?)<\/style>/gi,function(n,t){return"<style"+t.replace(/(<!--)|(-->)/g,"")+"<\/style>"}).replace(/<!--[^>]*-->/g,"").replace(/<script[^<]*<\/script>/g,"").replace(/ /g,"&nbsp;")},getRemoveTagAndContent:function(t,i){var u,r;for(n.isArray(i)||(i=[i]),u=0;u<i.length;u++)r=i[u],t=t.replace(new RegExp("<"+r+"([^'\\\"]|\\\"[^\\\"]*\\\"|'[^']*')*?<\/"+r+">","igm"),"").replace(new RegExp("<"+r+".*?/>","igm"),"").replace(new RegExp("<"+r+".*?>","igm"),"");return t},getUrlParameter:function(n){var t={};return document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function n(n){return decodeURIComponent(n.split("+").join(" "))}t[n(arguments[1])]=n(arguments[2])}),n?t[n]:t},getZoomRatio:function(n){var n=document.body.className.match(/zoom\-\d*/g),t=1;if(n&&n.length>0)switch(n[0].replace("zoom-","")){case"70":t=1.3;break;case"80":t=1.2;break;case"90":t=1.1;break;case"100":t=1;break;case"110":t=.9;break;case"120":t=.8;break;case"130":t=.7;break;case"140":t=.6;break;case"150":t=.5}return t},createRandomWord:function(n){var t="",r=0;for(r=n?n:6,i=0;i<r;i++)t+=ecount.common.createRandomChar();return t},createRandomChar:function(){for(var t,i="",r=[],f=0,u=[{min:48,max:57},{min:65,max:90},{min:97,max:122}],e=["I","l","0","O","o","j"],n=0,o=u.length;n<o;n++)for(t=u[n].min;t<=u[n].max;t++)r.push(t);for(;;)if(f=parseInt(Math.random()*r.length),i=String.fromCharCode(r[f]),!e.contains(i))return i},createPageOption:function(t,i){return n.isNull(i)?null:ecount.popup.parent.ecount.global.registerEcRepository(i)},requireImage:function(t,i){var f=0,e=t.length,u=function(){f++;f==e&&i&&i()},s=function(t){return n.browser.msie&&(t.naturalHeight==0||t.naturalWidth==0)},r,o;if(e>0)for(r=0,o=t.length;r<o;r++)(function(){n.isEmpty(t[r].src)||t[r].complete?u():(n(t[r]).load(u),n(t[r]).error(u))})();else i&&i()},requireBackgroundImage:function(t,i,r,u){var e=n("<img />"),s=n('<div style="display: absolute; top: -5000px; left: -5000px;"><\/div>'),f,l;s.append(e);var a=n(document.body),h=0,c=t.length,o=function(t){h++;typeof i=="function"&&i(t);h==c&&(n("body")[0].removeChild(s[0]),r&&r())};if(c>0)for(a.append(s),f=0,l=t.length;f<l;f++)(function(){var i=t[f].src,r;!i&&t[f].style["background-image"]&&(r=t[f].style["background-image"].match(/url\(["']?([^"']+)["']?\)/),i=r&&r[1]);u?(n(t[f]).load(o),n(t[f]).error(o)):(e.attr("src",i),e.load(o),e.error(o))})();else r&&r()},requireChain:function(n){return new Promise(function(t){require(n,t)}).catch(function(n){console.log("invalid file reqruie attempment");console.log(n)})},mouseHoverInTime:400,mouseHoverOutTime:0,makeZoneHost:function(n,t){var f=window.location.host.toLowerCase(),u=window.location.protocol,i={},e={center:/^(login[78]?|cs[78]?|c-portal[78]?|pay[78]?)([a-z]{0,2})(\d*)(-dev|-s3)?(.+)/i,dev:/^(stagecs|stagec-portal|stagepay|stage|zeus|apollo|hera|zcs|zc-portal|acs|ac-portal|hcs|hc-portal|zpay|apay|hpay)([\d]+)?([a-z]{0,2})?([\d]+)?(-dev)?(.+)/i},o=navigator.userAgent.toUpperCase(),r=e.center.exec(f);if(r!=null){if(n==r[2]&&(n+=r[3]||""),i.host=r[1],i.domain=t||r[5],i.hostPostfix=r[4]||"",i.hostPostfix=="-s3")return u+"//"+i.host+i.hostPostfix+i.domain+"/ECAPI"}else return r=e.dev.exec(f),r!=null?(i.host=r[1]+(r[2]||"")+n+(r[4]||"")+(r[5]||""),i.domain=t||r[6],u+"//"+i.host+i.domain+"/ECAPI"):u+"//"+f+"/ECAPI";return u+"//"+i.host+n+i.domain+"/ECAPI"},makeWebMailHost:function(){var t=window.location.host.toLowerCase(),i=window.location.protocol,r={center:/^(login[78]?|cs[78]?|c-portal[78]?|pay[78]?)([a-z]{0,2})(\d*)(-dev)?(.+)/i,test:/^(test)(\d*)([a-z]?)(\d*)(-dev)?(.+)/i,zeus:/^(zeus)(\d*)([a-z]{0,2})(\d*)(-dev)?(.+)/i,apollo:/^(apollo)(\d*)([a-z]{0,2})(\d*)(-dev)?(.+)/i,stage:/^(stage)(\d*)([a-z]{0,2})(\d*)(-dev)?(.+)/i},u=navigator.userAgent.toUpperCase(),n=r.center.exec(t);return n!=null?i+"//wmail.ecount.com":(n=r.zeus.exec(t),n!=null)?i+"//wmailzeus.ecount.com":(n=r.apollo.exec(t),n!=null)?i+"//wmailapollo.ecount.com":(n=r.stage.exec(t),n!=null)?i+"//wmailstage.ecount.com":(n=r.test.exec(t),n!=null?i+"//wmailtest.ecount.com":void 0)},makeGmcHost:function(){var r=window.location.host.toLowerCase(),t="",u="gmc",f=window.location.protocol,o=navigator.userAgent.toUpperCase(),e={center:/^(login[78]?|cs[78]?|c-portal[78]?|pay[78]?)([a-z]{0,2})(\d*)(-dev)?(-s3)?\./i,dev:/^(stage|stagecs|stagec-portal|stagepay|zeus|apollo|hera|zcs|zc-portal|acs|ac-portal|hcs|hc-portal|zpay|apay|hpay)([\d]+)?([a-z]{0,2})?([\d]+)?(-dev)?\./i},n=e.center.exec(r),i;if(n!=null)i=n[1].substring(n[1].length-1),(i=="7"||i=="8")&&(t="login"+i);else if(n=e.dev.exec(r),n!=null)t=n[1].startsWith("z")?"zeus":n[1].startsWith("a")?"apollo":n[1].startsWith("s")?"stage":"hera",t+=n[2]||"",u+=n[4]||"";else return f+"//"+r+"/GMCAPI";return f+"//"+t+u+".ecount.com/GMCAPI"},makeTWInvoiceHost:function(){var r=window.location.host.toLowerCase(),t="",i=window.location.protocol,f=navigator.userAgent.toUpperCase(),u={center:/^(login|etaxtw)(7|1|2)?([a-z]{0,2})(\d*)(-dev)?\./i,dev:/^(zeus|apollo|stage|hera|zeus41e1|ttaxtw|ztaxtw)([\d]+)?([a-z]{0,2})?([\d]+)?(-dev)?\./i},n=u.center.exec(r);if(n!=null)t=n[0].indexOf("etaxtw")>=0?n[0].substring(0,n[0].length-1):"etaxtw";else if(n=u.dev.exec(r),n!=null){if(n[1].startsWith("t"))return i+"//ttaxtw-dev.ecount.com/ECAPI";if(n[1].startsWith("stage")||n[1].startsWith("z")||n[1].startsWith("apollo"))return i+"//ztaxtw-dev.ecount.com:5443/ECAPI";t="htaxtw"}else return r="ttaxtw-dev.ecount.com/ECAPI",i+"//ttaxtw-dev.ecount.com/ECAPI";return t=="ztaxtw"?i+"//"+t+".ecount.com:5443/ECAPI":i+"//"+t+".ecount.com/ECAPI"},getSmsContentByte:function(t){var r=0,u="";if(n.isEmpty(t))return r;for(i=0,len=t.length;i<len;i++)u=t.charAt(i),escape(u).indexOf("%u")!=-1?r+=2:r++;return r},setInsertPtpLog:function(n,t,i,r){ecount.common.api({url:"/SVC/Common/Infra/SaveUserCntPtpLog",ecPageID:ecPageID,data:{ERR_NM:n,MESSAGE:t,TITLE:i,FILENAME:r},success:function(){}})},makeZoneUrl:function(n,t,i){return t?i?ecount.common.makeGmcHost().split("//")[1]:ecount.common.makeGmcHost():i?ecount.common.makeZoneHost(n).split("//")[1]:ecount.common.makeZoneHost(n)},gmcSessionApi:function(n){ecount.common.api({async:n.async,url:"/ECAPI/Common/Infra/MakeGMCSession",ecPageID:n.ecPageID,error:function(n){n&&n.status!==0&&alert("make GMC Session error")},success:function(t){var r=t.Data.apiSessionKey,i=n.sessionURL;if(i=ecount.common.buildFullSessionUrl(i,r),n.callbackApi)n.callbackApi(ecount.common.makeGmcHost().concat(i));else return ecount.common.makeGmcHost().concat(i)}})},zoneSessionApi:function(t){var i;ecount.common.api({ecPageID:t.ecPageID,async:t.async,url:"/ECAPI/Common/Infra/MakeZONESession",data:Object.toJSON({zoneName:t.zoneName,ComCode:t.ComCode,UserId:t.UserId}),error:function(){alert("make ZONE Session error")},success:function(r){var e=r.Data.apiSessionKey,f=t.zoneName&&n.isEmpty(t.zoneName)?t.zoneName:r.Data.zoneName,u=t.sessionURL;if(u=ecount.common.buildFullSessionUrl(u,e),i=f.toUpperCase()=="F"?".ecount.cn":".ecount.com",t.callbackApi)t.callbackApi(ecount.common.makeZoneHost(f,i).concat(u));else return ecount.common.makeZoneHost(f,i).concat(u)}})},zoneSessionApi2:function(t,i){var r;ecount.common.api({async:t.async,url:String.format("{0}?SESSION_ID={1}","/ECAPI/Common/Infra/MakeZONESession",i),data:Object.toJSON({zoneName:t.zoneName,ComCode:t.ComCode,UserId:t.UserId}),error:function(){alert("make ZONE Session error")},success:function(i){var e=i.Data.apiSessionKey,u=t.zoneName&&n.isEmpty(t.zoneName)?t.zoneName:i.Data.zoneName,f=String.format("{0}?SESSION_ID={1}",t.sessionURL,e);if(u.toUpperCase()=="F"&&(r=".ecount.cn"),t.callbackApi)t.callbackApi(ecount.common.makeZoneHost(u,r).concat(f));else return ecount.common.makeZoneHost(u,r).concat(f)}})},zoneSessionApi2:function(t,i){var r;ecount.common.api({ecPageID:t.ecPageID,async:t.async,url:String.format("{0}?SESSION_ID={1}","/ECAPI/Common/Infra/MakeZONESession",i),data:Object.toJSON({zoneName:t.zoneName,ComCode:t.ComCode,UserId:t.UserId}),error:function(){alert("make ZONE Session error")},success:function(i){var e=i.Data.apiSessionKey,u=t.zoneName&&n.isEmpty(t.zoneName)?t.zoneName:i.Data.zoneName,f=String.format("{0}?SESSION_ID={1}",t.sessionURL,e);if(u.toUpperCase()=="F"&&(r=".ecount.cn"),t.callbackApi)t.callbackApi(ecount.common.makeZoneHost(u,r).concat(f));else return ecount.common.makeZoneHost(u,r).concat(f)}})},gmcSessionApi2:function(n){ecount.common.api({ecPageID:n.ecPageID,async:n.async,url:"/ECAPI/Common/Infra/MakeGMCSession",error:function(n){n&&n.status!==0&&alert("make GMC Session error")},success:function(t){var r=t.Data.apiSessionKey,i=n.sessionURL;if(i=i+"?SESSION_ID="+r,n.callbackApi)n.callbackApi(ecount.common.makeGmcHost().concat(i));else return ecount.common.makeGmcHost().concat(i)}})},getAssistantUrl:function(n,t,i){var r;try{return r=n.split("."),n.indexOf("login")>-1&&/[0-9]/.test(n)==!1?(r[0]=r[0].toLowerCase().replace(t.toLowerCase(),i.toLowerCase()),r.join(".")):n}catch(u){return n}},getAssistantDownloadUrl:function(){var i="ucloud.ecounterp.com",t=null,n;try{n=document.location.host.split(".");ecount.common.isFromTest(n[0])&&(t="test");(ecount.common.isFromApollo(n[0])||ecount.common.isFromZeus(n[0]))&&(t="zexapi");ecount.common.isFromStage(n[0])&&(t="stexapi");t&&(n[0]=t,i=n.join("."))}catch(r){}return i},isFromTest:function(n){return n.contains("test",!0)},isFromZeus:function(n){return/^(zeus)([\d]+)?([a-z]+)?([\d]+)?(-dev)?$/.test(n)},isFromApollo:function(n){return/^(apollo)([\d]+)?(gmc|[a-z]{0,2})?([\d]+)?(-dev)?$/.test(n)},isFromStage:function(n){return/^(stage)(gmc|[a-z]{0,2})?([\d]+)?(-dev)?$/.test(n)},getScrapMappingInfo:function(n,t){return new Promise(function(i,r){n==null?i({Flag:!1}):ecount.common.api({url:n,data:Object.toJSON(t),async:!0,error:function(n){n.Error="Get Scrap MappingInfo Error \n\n\n\n\n\n\n\n\n"+n.responseJSON.Error.Message;r(n)},success:function(n){n.Status!="200"?(n.Error=n.fullErrorMsg,r(n)):(n.Flag=!0,i(n))}})})},getAssistantUseCheck:function(n,t){return new Promise(function(i,r){var u=[];t.forEach(function(n){u.indexOf(n.ModuleCode)==-1&&u.add(n.ModuleCode)});ecount.common.api({url:"/SVC/Admin/Manage/GetListScrapPreferences",async:!0,isGMC:!0,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({SCRPN_TYPE_CD:n,JNCOM_CD_LIST:u}),error:function(n){r(n)},success:function(n){i(n)}})})},getAssistantUseCheckNew:function(t,i,r){return new Promise(function(u,f){if(n.isEmpty(r)||r.useCheckFlag!=!0){var e=[],o=[];t=="BANK"||t=="CARD"?i.forEach(function(n){n.ModuleCode==null?e.add(n):e.add(n.ModuleCode)}):i.forEach(function(n){e.add(n.ModuleCode)});t=="BANK"||t=="CARD"?(o.add("P"),o.add("C")):o.add("C");ecount.common.api({url:"/SVC/Admin/Manage/GetListScrapPreferencesNew",async:!0,isGMC:!0,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({SCRPN_TYPE_CD:t,JNCOM_CD_LIST:e,SITE_CONN_TYPCD:o}),error:function(n){f(n)},success:function(n){u(n)}})}else u({Data:[]})})},getAssistantVersionCheck:function(n,t,i){return new Promise(function(r,u){ecount.common.api({url:n+"Version",async:!0,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(n){if(i)r("0");else{var t=[];t.Status="0";t.Error=n.statusText;u(t)}},success:function(n){n.Status!="200"?(n.Status=="-100"&&i&&r("0"),n.Status!="-300"?(n.Error=ecount.common.fnAssistantResourceParse(n),u(n)):r("1")):r("2")}})})},getAssistantUpdate:function(n,t,i,r){return new Promise(function(i,u){r?i(!0):ecount.common.api({url:n+"Update",async:!0,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(n){n.Error=ecount.common.fnAssistantResourceParse(n);u(n)},success:function(n){n.Status!="200"?(n.Error=ecount.common.fnAssistantResourceParse(n),u(n)):i(!0)}})})},getAssistantMappingList:function(t,i){return new Promise(function(r,u){var f,e;n.isEmpty(t.MappingUrl)?r({}):(f=[],i.forEach(function(n){f.indexOf(n.ModuleCode)==-1&&f.add(n.ModuleCode)}),e={Request:{DATA:{COM_CODE:t.COM_CODE,JNCOM_CD_LIST:f}}},ecount.common.getScrapMappingInfo(t.MappingUrl,e).then(function(n){if(n.Flag)if(n.Data!=null)r(n.Data);else{u({Error:"매핑데이터가 없습니다."});return}}))})},getAssistantApi:function(t,i,r){return new Promise(function(u,f){var e=i;e=Object.assign==undefined?n.extend(e,r):Object.assign(e,r);ecount.common.api({url:t+i.RequestFunction,contentType:"application/json; charset=UTF-8",async:!0,crossDomain:!1,data:e,error:function(n){n.Error=n.status!="200"||n.responseJSON==undefined?n.statusText:ecount.common.fnAssistantResourceParse(n.responseJSON);f(n)},success:function(n){n.Status!="200"?(n.Error=ecount.common.fnAssistantResourceParse(n),f(n)):u([!1,n])}})})},executeAssistantSuccess:function(t,i,r,u,f,e){var o=this,s=function(t,r){if(i.ReloadMessageFlag)o.sendMessage(o,{data:"reload"});o.scrapRunFlag=!1;o.hideProgressbar();n.isEmpty(t)||ecount.alert(t);r&&o.setReload?o.setReload():o._ON_REDRAW()},h,c;n.isEmpty(t[1].Description)&&(t[1].Description="");i.MultiFunctionFlag&&i.SuccessCallBack&&typeof i.SuccessCallBack=="function"?(f++,h=f==e,i.SuccessCallBack.call(o,i,r,u,h)):i.RequestFunction=="BankTransfer"?s.call(o,t[1].Description,!0):i.RequestFunction.indexOf("CERT")>-1?t[1].Description==""?i.callBackApi&&typeof i.callBackApi=="function"&&(i.callBackApi.call(o,i,t[1]),s.call(o,"",!1)):s.call(o,t[1].Description,!0):i.RequestFunction.indexOf("RECORDER")>-1||i.RequestFunction.indexOf("REMOTE")>-1||i.RequestFunction.indexOf("Optimizer")>-1?t[1].Status!="500"||n.isEmpty(t[1].Description)?o.close():ecount.alert(eval("ecount.resource."+t[1].Description),function(n){n&&o.close()}):i.RequestFunction.indexOf("Wizard")>-1||i.RequestFunction.indexOf("Credit")>-1?(i.SuccessCallBack&&typeof i.SuccessCallBack=="function"&&i.SuccessCallBack.call(o,i,t[1]),s.call(o,"",!1)):(c={data:"reload"},o.sendMessage(o,c),s.call(o,ecount.resource.LBL08902+" "+ecount.resource.LBL05930+"<br>"+t[1].Description.replace("Search Period",ecount.resource.LBL08127),!0))},SetFontColor:function(){var n="#333333";switch(this.UI_THEME){case"blue":n="#005B9E";break;case"lightblue":n="#5681DD";break;case"green":n="#006400";break;case"lightgreen":n="#26A026";break;case"red":n="#A51F2A";break;case"lightred":n="#D3414D";break;case"olive":n="#696901";break;case"lightolive":n="#9E9E0F";break;case"chocolate":n="#592F1A";break;case"lightchocolate":n="#895338";break;case"purple":n="#760076";break;case"lightpurple":n="#9847A1";break;case"black":n="#333333";break;case"whiteblue":n="#005B9E";break;default:n="#333333"}return n},executeAssistantFail:function(t,i,r,u,f,e){var o=this,h=function(t,r,u){var e,f,s;i.ReloadMessageFlag&&(e={data:"reload"},o.sendMessage(o,e));o.scrapRunFlag=!1;o.hideProgressbar();n.isEmpty(t)||(u!=null&&u.Optimizer!=null&&u.Optimizer==!1?ecount.alert(t):(f="",f=location.href.indexOf("http://")>-1?"http://":"https://",i.Browser=="IE"?(f+="s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountRegSet.exe",s=String.format(ecount.resource.MSG11172,f,privateFn.__setFontColor.call(this),t),ecount.alert(s)):ecount.alert(t)));i.CloseFlag&&o.close();r&&o.setReload?o.setReload():o._ON_REDRAW()},s,c,l,a;if(i.RequestFunction&&i.RequestFunction.indexOf("REMOTE")>-1)s=t.Error,t.responseJSON&&t.responseJSON.Status=="500"&&!n.isEmpty(t.responseJSON.Description)&&(s=eval("ecount.resource."+t.responseJSON.Description)),ecount.alert(s,function(n){n&&o.close()});else if(i.RequestFunction&&i.RequestFunction.indexOf("RECORDER")>-1)s=t.Error,t.responseJSON&&t.responseJSON.Status=="500"&&!n.isEmpty(t.responseJSON.Description)&&(s=eval("ecount.resource."+t.responseJSON.Description)),ecount.alert(s,function(n){n&&o.close()});else if(i.RequestFunction&&(i.RequestFunction.indexOf("Wizard")>-1||i.RequestFunction.indexOf("Credit")>-1)){if(s=t.Error,t.responseJSON&&t.responseJSON.Status=="500")n.isEmpty(t.responseJSON.Description)||(s=ecount.resource[t.responseJSON.Description]),ecount.alert(s,function(n){n&&o.hideProgressbar()});else{if(_.isEmpty(t.responseJSON)){o.hideProgressbar();return}i.FailedCallBack&&typeof i.FailedCallBack=="function"&&i.FailedCallBack.call(o,t.responseJSON,i)}h.call(o,"",!1)}else t.responseJSON&&t.responseJSON.Status=="-300"?(c=function(n){n===!0&&o.openWindow({url:"/ECERP/EBS/EBS002M",param:{height:500,width:740,EditFlag:"M",ACTACCOUNTNUM:t.responseJSON.ErrorRequest,ActServiceType:"F",KR_Flag:!1,PW_Flag:!0},popupType:!1})},l=ecount.resource.LBL00504+":"+t.responseJSON.ErrorRequest+"\n\n"+t.Error,ecount.confirm(l,{callback:c,confirmTitle:ecount.resource.LBL01421,cancelTitle:ecount.resource.BTN00008}),o.close()):t.responseJSON&&t.responseJSON.Status=="-400"?(o.openWindow({url:"/ECERP/SVC/EBQ/EBQ003P_04",param:{height:400,width:800,ErrorRequest:JSON.parse(t.responseJSON.ErrorRequest),TransferList:i.TransferList}}),h.call(o,null,!1)):i.MultiFunctionFlag&&i.FailedCallBack&&typeof i.FailedCallBack=="function"?(f++,a=f==e,i.FailedCallBack.call(o,t,i,r,u,!1,a)):(o.scrapRunFlag=!1,r.AsyncFlag!=undefined&&r.AsyncFlag||h.call(o,t.Error,!0,{Optimizer:(t.responseJSON||{}).Status!="-600"&&(r.ScrapSection||"").indexOf("auto")==-1}))},assistantInstallCheck:function(t,i,r,u){var f=this,e;f.showProgressbar();e=function(t,r,u){var o,e,s;i.ReloadMessageFlag&&(o={data:"reload"},f.sendMessage(f,o));f.hideProgressbar();n.isEmpty(t)||(u!=null&&u.Optimizer!=null&&u.Optimizer==!1?ecount.alert(t):(e="",e=location.href.indexOf("http://")>-1?"http://":"https://",i.Browser=="IE"?(e+="s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountRegSet.exe",s=String.format(ecount.resource.MSG11172,e,privateFn.__setFontColor.call(this),t),ecount.alert(s)):ecount.alert(t)));i.CloseFlag&&f.close();r&&f.setReload&&f.setReload()};try{var h=(Date.now()-t)/1e3,s="https://userpc.ecountassistant.com:57886/",o="https://"+ecount.common.getAssistantDownloadUrl()+"/Download/AssistantV2/Zone"+i.Zone;if(i.URL=o,h>=120){e.call(f,"ECOUNT_ASSISTANT_TIMEOUT",!1,{Optimizer:!1});return}ecount.common.getAssistantVersionCheck(s,o,r).then(function(n){switch(n){case"0":setTimeout(function(){ecount.common.assistantInstallCheck.call(f,t,i,r,u)},2e3);break;case"1":ecount.common.getAssistantUpdate(s,o,r,u).then(function(n){setTimeout(function(){ecount.common.assistantInstallCheck.call(f,t,i,!0,n)},2e3)}).catch(function(n){e.call(f,n.Error,!1,{Optimizer:!1});return});break;case"2":i.callback&&i.callback()}}).catch(function(n){var t;switch(n.Status){case"0":t={gridID:f.gridID||"",width:420,height:250,ReInstallFlag:!1,ScrapPrimaryDto:i};f.openWindow({url:"/ECERP/EBS/EBS003P_13",name:ecount.resource.LBL01677,popupType:!1,additional:!1,param:t});break;case"-100":t={gridID:f.gridID||"",width:420,height:250,ReInstallFlag:!0,ScrapPrimaryDto:i,ReturnMessage:n.Error};f.openWindow({url:"/ECERP/EBS/EBS003P_13",name:ecount.resource.LBL01677,popupType:!1,additional:!1,param:t});break;default:(n.Error==undefined||n.Error==null)&&(n.Error=ecount.resource.LBL15053);e.call(this,n.Error,!1,{Optimizer:n.Status!="-600"})}})}catch(c){e.call(this,ecount.resource.LBL15053,!1,{Optimizer:!0})}},assistantCallFunction:function(t,i,r,u,f,e,o){var s=this,h;if(n.isEmpty(o)&&(o=f?{useCheckFlag:!0}:{}),h=function(t,r,u){var e,f,o;i.ReloadMessageFlag&&(e={data:"reload"},s.sendMessage(s,e));s.scrapRunFlag=!1;s.hideProgressbar();n.isEmpty(t)||(u!=null&&u.Optimizer!=null&&u.Optimizer==!1?ecount.alert(t):(f="",f=location.href.indexOf("http://")>-1?"http://":"https://",i.Browser=="IE"?(f+="s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountRegSet.exe",o=String.format(ecount.resource.MSG11172,f,privateFn.__setFontColor.call(this),t),ecount.alert(o)):ecount.alert(t)));i.CloseFlag&&s.close();r&&s.setReload?s.setReload():s._ON_REDRAW()},s.scrapRunFlag==!0&&f==!1){ecount.alert(ecount.resource.MSG05975);return}try{s.scrapRunFlag=!0;var a=(Date.now()-t)/1e3,c="https://userpc.ecountassistant.com:57886/",l="https://"+ecount.common.getAssistantDownloadUrl()+"/Download/AssistantV2/Zone"+i.Zone;if(i.URL=l,a>=120){h.call(s,"ECOUNT_ASSISTANT_TIMEOUT",!1,{Optimizer:!1});return}ecount.common.getAssistantUseCheckNew(i.SCRPN_TYPE_CD,r,o).then(function(a){var y=[],v;o.useCheckFlag=!0;a.Data.forEach(function(n){n.LCL_INQ_USE_TF==!1?r.forEach(function(t,i){n.Key.JNCOM_CD==t.ModuleCode&&n.Key.SITE_CONN_TYPCD==t.SITE_CONN_TYPCD&&(y.add({ID:t.ID,NAME:t.NAME,GTHR_MTHD_CD:n.GTHR_MTHD_CD,DESCRIPTION:ecount.resource.MSG08127,KEY:t.Key}),r.splice(i,1))}):r.forEach(function(t){n.Key.JNCOM_CD==t.ModuleCode&&n.Key.SITE_CONN_TYPCD==t.SITE_CONN_TYPCD&&(t.ScrapSection=n.ASST_FILE_SCT_VAL)})});v=r.length;y.length>0&&(ecount.common.api({url:"/SVC/Account/Others/SaveScrapHistory",async:!0,isGMC:!1,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({SCRPN_TYPE_CD:i.SCRPN_TYPE_CD,HISTORY_LIST:y}),error:function(){i.MultiFunctionFlag?(y.forEach(function(n){n.KEY!=undefined&&s.contents.getGrid().grid.setCell("tbody",n.GridName,n.KEY,ecount.resource.LBL07765)}),v==0&&(s.scrapRunFlag=!1)):h.call(s,ecount.resource.MSG08127,!1,{Optimizer:!1})},success:function(){i.MultiFunctionFlag?(y.forEach(function(n){n.KEY!=undefined&&s.contents.getGrid().grid.setCell("tbody",n.GridName,n.KEY,ecount.resource.LBL07765)}),v==0&&(s.scrapRunFlag=!1)):h.call(s,ecount.resource.MSG08127,!1,{Optimizer:!1})}}),i.ScrapList=r);(v>0||i.RequestFunction.indexOf("CERT")>-1||i.RequestFunction.indexOf("Optimizer")>-1)&&ecount.common.getAssistantVersionCheck(c,l,f).then(function(a){switch(a){case"0":setTimeout(function(){ecount.common.assistantCallFunction.call(s,t,i,r,u,f,e,o)},2e3);break;case"1":ecount.common.getAssistantUpdate(c,l,f,e).then(function(n){setTimeout(function(){ecount.common.assistantCallFunction.call(s,t,i,r,u,!0,n,o)},2e3)}).catch(function(n){h.call(s,n.Error,!1,{Optimizer:!1});return});break;case"2":ecount.common.getAssistantMappingList(i,r).then(function(t){var e=0,o,a,l;(i.CollectUrl!=undefined||i.CollectUrl!="")&&(i.CollectUrl=ecount.common.buildFullSessionUrl(i.CollectUrl));(i.LockUrl!=undefined||i.LockUrl!="")&&(i.LockUrl=ecount.common.buildFullSessionUrl(i.LockUrl));(i.ErrMsgUrl!=undefined||i.ErrMsgUrl!="")&&(i.ErrMsgUrl=ecount.common.buildFullSessionUrl(i.ErrMsgUrl));i.RequestFunction.indexOf("CERT")>-1||i.RequestFunction.indexOf("Optimizer")>-1||i.RequestFunction.indexOf("Credit")>-1?(o=n.isEmpty(r)?{}:r[0],a=i.AsyncFlag!=undefined&&i.AsyncFlag,_.isObject(o.Data)||(o.Data=encodeURIComponent(o.Data)),i.RequestFunction.indexOf("Credit")>-1&&s.showProgressbar(!0),a&&s.close(),ecount.common.getAssistantApi(c,i,o,f).then(function(n){ecount.common.executeAssistantSuccess.call(s,n,i,o,u,e,v)}).catch(function(n){a||ecount.common.executeAssistantFail.call(s,n,i,o,u,e,v)})):i.AsyncFlag!=undefined&&i.AsyncFlag==!1?(i.MultiFunctionFlag&&r.forEach(function(n){var t=n;t.Key!=undefined&&(s.hideProgressbar(!0),s.contents.getGrid().grid.setCell("tbody",t.GridName,t.Key,ecount.resource.MSG06408))}),l=function(n,i,r,o,c){var y=!1,a;if(o==c||e==v)return!1;if(a=r[o],a.ScrapSection==undefined)return i.MultiFunctionFlag&&i.FailedCallBack&&typeof i.FailedCallBack=="function"?(e++,endFlag=e==v,i.FailedCallBack.call(s,[],i,a,u,endFlag),!1):(h.call(s,ecount.resource.MSG00392+"\n Undefined Module Code : ["+a.ModuleCode+"]",!1,{Optimizer:!1}),!1);a.Data=encodeURIComponent(a.Data);u.length>0&&u.forEach(function(n){n.ModuleCode==a.ModuleCode&&n.WebId==a.WebId&&(y=!0)});y?(e++,o++,endFlag=e==v?!0:!1,i.FailedCallBack.call(s,"[비밀번호오류]",i,a,u,!0,endFlag),l.call(s,n,i,r,o,c)):(i.MappingData=t[a.ModuleCode],ecount.common.getAssistantApi(n,i,a,f).then(function(t){ecount.common.executeAssistantSuccess.call(s,t,i,a,u,e,v);e++;o++;l.call(s,n,i,r,o,c,e,v)}).catch(function(t){t.Error.indexOf("[비밀번호오류]")>-1?(u.push(a),ecount.common.executeAssistantFail.call(s,t,i,a,u,e,v)):ecount.common.executeAssistantFail.call(s,t,i,a,u,e,v);e++;o++;l.call(s,n,i,r,o,c)}))},n.each(r.groupBy("ModuleCode"),function(n,t){var r=t,u=r.length;l.call(s,c,i,r,0,u)})):r.forEach(function(n){var r=n,o;if(n.ScrapSection==undefined)return i.MultiFunctionFlag&&i.FailedCallBack&&typeof i.FailedCallBack=="function"?(e++,o=e==v,i.FailedCallBack.call(s,[],i,r,u,o),!1):(h.call(s,ecount.resource.MSG00392+"\n Undefined Module Code : ["+r.ModuleCode+"]",!1,{Optimizer:!1}),!1);r.Data=encodeURIComponent(r.Data);i.MultiFunctionFlag&&r.Key!=undefined&&(s.hideProgressbar(!0),s.contents.getGrid().grid.setCell("tbody",r.GridName,r.Key,ecount.resource.MSG06408));i.MultiFunctionFlag&&r.ScrapSection.indexOf("auto")==-1&&r.ScrapType!="R"?ecount.common.api({url:"/SVC/Account/Others/SaveScrapHistory",async:!0,isGMC:!1,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({SCRPN_TYPE_CD:i.SCRPN_TYPE_CD,HISTORY_LIST:[{ID:r.ID,NAME:r.NAME,GTHR_MTHD_CD:"M",DESCRIPTION:"수동로그인 상태이므로 수집할 수 없습니다."}]}),error:function(n){r.Key!=undefined&&(s.contents.getGrid().grid.setCell("tbody",r.GridName,r.Key,ecount.resource.LBL07765),s.contents.getGrid().grid.setCell("tbody",r.GridName,r.Key,n.statusText));return},success:function(n){if(i.MultiFunctionFlag&&i.FailedCallBack&&typeof i.FailedCallBack=="function"){e++;var t=e==v;i.FailedCallBack.call(s,n,i,r,u,t)}}}):(t[r.ModuleCode]!=undefined&&(i.MappingData=t[r.ModuleCode]),ecount.common.getAssistantApi(c,i,r,f).then(function(n){ecount.common.executeAssistantSuccess.call(s,n,i,r,u,e,v);e++}).catch(function(n){ecount.common.executeAssistantFail.call(s,n,i,r,u,e,v);e++}))})}).catch(function(n){h.call(this,n.Error,!1,{Optimizer:!1})})}}).catch(function(n){var t;switch(n.Status){case"0":t={gridID:s.gridID||"",width:420,height:250,ReInstallFlag:!1,ScrapPrimaryDto:i,ScrapExtendDto:r,PwErrorDto:u};s.openWindow({url:"/ECERP/EBS/EBS003P_13",name:ecount.resource.LBL01677,popupType:!1,additional:!1,param:t});break;case"-100":t={gridID:s.gridID||"",width:420,height:250,ReInstallFlag:!0,ScrapPrimaryDto:i,ScrapExtendDto:r,PwErrorDto:u,ReturnMessage:n.Error};s.openWindow({url:"/ECERP/EBS/EBS003P_13",name:ecount.resource.LBL01677,popupType:!1,additional:!1,param:t});break;default:(n.Error==undefined||n.Error==null)&&(n.Error=ecount.resource.LBL15053);h.call(this,n.Error,!1,{Optimizer:n.Status!="-600"})}})}).catch(function(){h.call(this,ecount.resource.LBL15053,!1,{Optimizer:!0})})}catch(v){h.call(this,ecount.resource.LBL15053,!1,{Optimizer:!0})}},assistantApi:function(n){var t=n.assistantVerUrl,i=n.callbackApi,r=n.postData,u=this;ecount.common.api({url:"https://userpc.ecountassistant.com:57886/Version",contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(){n.versionErrorCallback&&typeof n.versionErrorCallback=="function"?n.versionErrorCallback(this,n):ecount.alert("Please install EcountAssistant.")},success:function(n){n.Status!="200"?n.Status!="-300"?ecount.alert(ecount.common.fnAssistantResourceParse(n)):ecount.common.api({url:"https://userpc.ecountassistant.com:57886/Update",contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(n){ecount.alert(ecount.common.fnAssistantResourceParse(n))},success:function(n){n.Status!="200"?ecount.alert(ecount.common.fnAssistantResourceParse(n)):ecount.assistantUpdateCheck({assistantVerUrl:t,callbackApi:i,postData:r})}}):i(r)}})},assistantVersionCheck:function(n){var t=n.assistantVerUrl,i=n.callbackApi,r=n.postData,e=this,f=Date.now(),u=function(){var n=(Date.now()-f)/1e3;if(n>=120){alert("ECOUNT_ASSISTANT_TIMEOUT");return}ecount.common.api({url:"https://userpc.ecountassistant.com:57886/Version",contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(){setTimeout(function(){u()},5e3)},success:function(n){n.Status!="200"?n.Status!="-300"?ecount.alert(ecount.common.fnAssistantResourceParse(n)):ecount.common.api({url:"https://userpc.ecountassistant.com:57886/Update",contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:t}),error:function(n){alert(n.Error)},success:function(n){n.Status!="200"?ecount.alert(n.Error):ecount.assistantUpdateCheck({assistantVerUrl:t,callbackApi:i,postData:r})}}):i(r)}})};u()},assistantUpdateCheck:function(n){var i=n.assistantVerUrl,r=n.callbackApi,u=n.postData,e=this,f=Date.now(),t=function(){var n=(Date.now()-f)/1e3;if(n>=120){ecount.alert("ECOUNT_ASSISTANT_TIMEOUT");return}ecount.common.api({url:"https://userpc.ecountassistant.com:57886/Version",contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON({URL:i}),error:function(){setTimeout(function(){t()},5e3)},success:function(n){n.Status!="200"?n.Status!="-300"?ecount.alert(ecount.common.fnAssistantResourceParse(n)):setTimeout(function(){t()},3e3):r(u)}})};t()},fnScrapCheckApi:function(n){ecount.common.api({url:"/SVC/Admin/Manage/CheckScrapFlagMyPageCompany",success:function(t){t.Status!="200"&&ecount.alert(t.fullErrorMsg+t.Data);n.CallBack(self,t)}})},fnAssistantResourceParse:function(t){var f,i;if(n.isEmpty(t))return"Error - Ecount Assistant Request";var r=t.Error||"",u=t.Description||"",e=t.ExecuteFunc||"";return n.isEmpty(r)?"":(n.isEmpty(e)||(u+=" : "+e),f=r.toUpperCase(),f.startsWith("LBL")||f.startsWith("BTN")||f.startsWith("MSG")?(i=r.split("∬"),n.isEmpty(ecount.resource[i[0]]))?"Error - Dose Not Exist Resource":i.length>1?(i.splice(0,1,ecount.resource[i[0]]),String.format.apply(null,i)+u):ecount.resource[i[0]]+u:r+u)},twInvoiceSessionApi:function(n){var t=this.makeTWInvoiceHost()+"/SVC/Invoice/TW/MakeTWSessionId";ecount.common.api({ecPageID:n.ecPageID,async:n.async,url:t,data:{Request:{Data:{ComCode:n.comCode}}},error:function(n){n&&n.status!==0&&alert("make Invoice Session error")},success:function(t){var r=t.Data+":"+n.comCode,i=n.sessionURL,u=n.comCode;if(i=ecount.common.buildFullSessionUrl(i,r),n.callbackApi)n.callbackApi(ecount.common.makeTWInvoiceHost().concat(i));else return ecount.common.makeTWInvoiceHost().concat(i)}})},openKCPType1:function(t,i){var r={callComCode:"",emn_flag:"",access_site:"",ccProdDesc:"",amt:0,scrapCnt:"",scrapGubun:"",scraDate:"",amount:"",box:"",phoneNO:"",writedate:"",payMethod:"",width:800,height:550};i&&(i.width&&(r.width=i.width),i.height&&(r.height=i.height));r=n.extend({},r,t);ecount.popup.openWindow({url:"/ECERP/KCP/KCP001M",name:"KCP",param:r,popupType:!0})},openKCPType2:function(t){var i={width:800,height:550};t&&(i=n.extend({},i,t));ecount.popup.openWindow({url:"/ECERP/KCP/KCP011M",name:"KCP",param:i,popupType:!0})},parseSize:function(n){if("string"!=typeof n)return n;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return n=/^([0-9\.]+)([tmgk]?)$/.exec(n.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),t=n[2],n=+n[1],i.hasOwnProperty(t)&&(n*=i[t])?Math.floor(n):void 0},getAdjustScrollTop:function(n,t){var r=n.offset(),i=document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight,u=t.scrollTop();return u+(i<r.top?r.top-i+i/2:r.top-i/2)},getOffsetControl:function(n){return n.getBoundingClientRect()},isTrue:function(t){return t==undefined||t==null?!1:n.isBoolean(t)?t==!0:n.isString(t)?t=="Y"||t=="1"||t.toLowerCase()=="true":n.isNumber(t)?t==1:!1},isFalse:function(t){return t==undefined||t==null?!1:n.isBoolean(t)?t==!1:n.isString(t)?t=="N"||t=="0"||t.toLowerCase()=="false":n.isNumber(t)?t==0:!1},isBoolean:function(t){return t==undefined||t==null?!1:n.isBoolean(t)?!0:n.isString(t)?["0","1","Y","N"].contains(t)||["true","false"].contains(t.toLowerCase()):n.isNumber(t)?[0,1].contains(t):!1},checkLimitContentSetting:function(){return{LIMIT:5,MSG:String.format(ecount.resource.LBL20609||"{0}를 초과하여 입력할 수 없습니다..<br/>내용을 수정해주시기 바랍니다.","5MB")}},checkLimitContent:function(t,i,r,u,f,e){var o=0,c="",y,h;if(i=i?i:5,(f==undefined||f==null)&&(f=!0),n.isEmpty(t))h=o/1048576,u&&u(h<=i,r);else{var l=n.parseHTML("<div class='wrapper-grid-savedata'>"+t+"<\/div>"),a=n(l).find("img"),v=n(l).find("div").filter(function(n,t){if(t.style["background-image"]){var i=t.style["background-image"].match(/url\(["']?([^"']+)["']?\)/),r=i&&i[1];return!!r}return!1}),s=[];a.each(function(t,i){var r,u;!n.isEmpty(i.src)&&i.src.indexOf(".ecount.com/ECFile/ViewImage/")>0&&(r=i.src.split("/"),r.length>2&&(u=decodeURIComponent(r[r.length-1]),n.isEmpty(u)||s.push(u)))});v.each(function(t,i){var e=i.style["background-image"].match(/url\(["']?([^"']+)["']?\)/),u=e&&e[1],r,f;!n.isEmpty(u)&&u.indexOf("/ECFile/ViewImage/")>-1&&(r=u.split("/"),r.length>2&&(f=decodeURIComponent(r[r.length-1]),n.isEmpty(f)||s.push(f)))});a.length>0&&a.remove();v.length>0&&v.remove();n(l).each(function(n,t){c+=t.outerHTML});o=f==!0?c.trimHtml().byte():c.byte();s.length>0?(y={OWNER_ID_LIST:s.join(ecount.delimiter)},ecount.common.api({ecPageID:e,url:"/Common/File/GetCoflFileUploadListByOwnerId",data:Object.toJSON(y),success:function(n){if(n.Status!="200")ecount.alert("error");else{s.forEach(function(t){var i=n.Data.Data.where(function(n){return n.OWNER_ID==t});o+=i[0]?i[0].TOTAL_SIZE:0});var t=o/1048576;u&&u(t<=i,r)}}})):(h=o/1048576,u&&u(h<=i,r))}},isMacOS:ecount.common.isExistAgent("mac os x")&&!ecount.common.isIOS,isAndroid:ecount.common.isExistAgent("android"),isInApp:ecount.common.isExistAgent("ecount"),isSafari:ecount.common.isExistAgent("safari")&&!ecount.common.isExistAgent("crios")&&!ecount.common.isExistAgent("chrome"),isChrome:ecount.common.isExistAgent("crios")||ecount.common.isExistAgent("chrome"),getChromeVersion:navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./),isNT10:ecount.common.isExistAgent("windows nt 10"),isNT7:ecount.common.isExistAgent("windows nt 6.1"),isChromePrintErrorVersion:function(){return ecount.common.isAndroid&&ecount.common.isChrome&&Number(ecount.common.getChromeVersion[0].split("/")[1])>78},errorNoticeTrxId:function(n,t,i,r){var u={width:750,height:500,Request:{TRXID:t,TRXTYPE:i}};ecount.popup.openWindow({url:r||"/ECERP/SVC/Popup/ErrorNotice",param:u,__ecPageID:n,alreadyIncludedLayout:!0,additional:!0})},errorNotice:function(t,i,r){var u,e,w,o,f;if(r&&!t.parentData)return!1;u=typeof t.data=="string"?JSON.parse(t.data):t.data;var s=ecenum.useYn.none,h=ecenum.useYn.none,c=ecenum.useYn.none,l=ecenum.useYn.none,a=ecenum.useYn.none,v,y,p;if(u.isShowMenuPath&&(s=u.isShowMenuPath),u.isViewCount&&i.Data&&(a=u.isViewCount),u.isShowPanel&&(h=u.isShowPanel,p=ecount.common.setPanelMessage(i.Data)),u.isSendMessage&&(c=u.isSendMessage),i.Data&&i.Data.ResultDetails&&(i.Data=i.Data.ResultDetails),i&&(y=i),u.isReload&&(l=u.isReload),u.fromPage&&(v=u.fromPage),e=ecount.common.getIsShowRefreshMessage(i),e==!0)return ecount.alert(t.refreshMessage,function(){t.saveTemporaryfnc&&t.saveTemporaryfnc();location.reload(!0)}.bind(this)),!1;i&&(i.otrxid||(w=this.errorConverting(u,i)));o={OriginalData:Object.toJSON(u),ErrorList:w,isShowMenuPath:s,IsShowPanel:h,isViewCount:a,PanelMessage:p,IsAddRefreshMessage:e,IsSendMessage:c,baseData:y,TRXID:i.otrxid||null,IsReload:l,FromPage:v};f={url:"/ECERP/SVC/Popup/ErrorNotice",name:"",modal:!0,param:{Request:o,ecRepositoryID:ecount.common.createPageOption("ErrorNotice",o)},popupType:!1,additional:!0,popupLevel:t.popupLevel,alreadyIncludedLayout:!0,parentPageID:t.parentPageID};t.parentData&&(f=n.extend(f,t.parentData),f.param.responseID=t.parentData.responseID);ecount.popup.openWindow(f)},errorConverting:function(t,i){var r=[],u;return n.isArray(i.Data)==!0?n.each(i.Data,function(i,u){n.isEmpty(u.Errors)||(n.isEmpty(t.Key)?n.isEmpty(t.Keys)||r.push([{Key:t.Keys.defaultKey,Errors:u.Errors}]):r.push([{Key:t.Key[i],Errors:u.Errors}]))}.bind(this)):(u=ecount.common.getNoticeKey(t.Keys,i.Errors.ProgramId),r.push([{Key:u,Errors:i.Errors}])),r},getNoticeKey:function(t,i){return i&&t[i]?t[i].key:t&&n.isEmpty(t.defaultKey)==!1?t.defaultKey:""},setPanelMessage:function(n){var t=[String.format(ecount.resource.LBL00031,n.SuccessCnt),"<br/>",String.format(ecount.resource.LBL00030,n.FailCnt),"<br/>"];return t.join("")},traverseJson:function(t,i){var f=i.PARAMS,u,r;for(u in f)t[u]!=undefined&&(i.PARAMS[u]=t[u]);for(r in t){if(n.isEmpty(t[r])==!0)return"";r!==null&&typeof t[r]=="object"&&traverseJson(t[r],i)}},getMessage:function(t,i,r){var u,f;return ecount.errorMap.errorList[t]?(u=n.extend(!0,{},ecount.errorMap.model,ecount.errorMap.errorList[t]),u.MESSAGE.RESOURCE.isResource()==!0&&(u.MESSAGE.RESOURCE=ecount.resource[u.MESSAGE.RESOURCE])):u=n.extend(!0,{},ecount.errorMap.model,ecount.errorMap.errorList.ERR00001),n.isFunction(u.MESSAGE.ARGUMENT)==!0&&(r=u.MESSAGE.ARGUMENT(i)),/{\d+}/gm.test(u.MESSAGE.RESOURCE)&&!n.isEmpty(r)?u.MESSAGE=String.format.apply(this,[u.MESSAGE.RESOURCE,r]):u.MESSAGE.RESOURCE&&!n.isEmpty(r)?(r.forEach(function(n){f=u.MESSAGE.RESOURCE.concat(n)}),u.MESSAGE=f):u.MESSAGE=u.MESSAGE.RESOURCE,n.extend(!0,{},ecount.errorMap.model,u)},getIsShowRefreshMessage:function(t){function r(){return n.isEmpty(t.IsEnableNoL4)==!0?!1:ecount.system.IsEnableNoL4==!1?!1:ecount.system.IsEnableNoL4==t.IsEnableNoL4?!1:!0}function u(){return n.isEmpty(t.RefreshTimestamp)==!0?!1:t.RefreshTimestamp=="0"?!1:ecount.ecRefreshTimestamp==t.RefreshTimestamp?!1:!0}var i=!1;return n.isEmpty(t)==!0?!1:t.Status=="200"?!1:typeof webmail!="undefined"?!1:(i||(i=r()),i||(i=u()),i)},summaryType:{D:"D",S:"S",A:"A",P:"P",L:"L"},limitSummaryDate:function(){var n=ecount.control.date.serverDate();return new Date(n.getFullYear()+1,11,1)},getColumnConfigInfo:function(n,t){var i=1,r=0,u=0;return n.forEach(function(n){n.linechange&&(i+=1);i==1&&(r+=1,t.test(n.id)&&(u+=1))}),{lineCount:i,columnCountPerLine:r,tempColumnCountPerLine:u}},registerEcGlobalRepository:function(i,r,u){function o(i,r,u){n.isNull(t[i])&&(t[i]={});t[i]=n.isNull(u)?r:{data:r,pageId:u}}var e=ecount.getParentFrame(window),f=window.opener;return n.isNull(f)||n.isEmptyObject(f)||f.closed||!f.top||f===f.top||(f=f.top,f.ecount.common.registerEcGlobalRepository||(f=f.opener)),n.isNull(e)||e.closed||!e.top||e===e.top||(e=e.top,e.ecount.common.registerEcGlobalRepository||(e=e.opener)),n.isNull(f)||n.isEmptyObject(f)||f.closed||n.isNull(f.ecount)||n.isNull(f.ecount.ens)||n.isNull(ecount)?!e||e.name===window.name||e.closed||n.isNull(e.ecount)||n.isNull(e.ecount.ens)||n.isNull(ecount)?o(i,r,u):n.isNull(ecount.ens)||e.ecount.ens===e.ens?f.ecount.common.registerEcGlobalRepository(i,r,u):o(i,r,u):n.isNull(ecount.ens)||f.ecount.ens===ecount.ens?f.ecount.common.registerEcGlobalRepository(i,r,u):o(i,r,u),i},unregisterEcRepository:function(i,r){function e(t,i){var r=[];n.isNull(t)&&_.isString(i)&&!_.isEmpty(i)?(_.each(s.getGlobalEcRepository(),function(n,t){_.isPlainObject(n)&&_.isEqual(n.pageId,i)&&r.push(t)}),_.each(r,function(n){o(n)})):o(t)}function o(n){_.forEach(t[n],function(i,r){delete t[n][r]});delete t[n]}var s=this,f=ecount.getParentFrame(window),u=window.opener;n.isNull(u)||n.isEmptyObject(u)||u.closed||!u.top||u===u.top||(u=u.top,u.ecount.common.registerEcGlobalRepository||(u=u.opener));n.isNull(f)||f.closed||!f.top||f===f.top||(f=f.top,f.ecount.common.registerEcGlobalRepository||(f=f.opener));n.isNull(u)||n.isEmptyObject(u)||u.closed||n.isNull(u.ecount)||n.isNull(u.ecount.ens)||n.isNull(ecount)?!f||f.name===window.name||f.closed||n.isNull(f.ecount)||n.isNull(f.ecount.ens)||n.isNull(ecount)?e(i,r):n.isNull(ecount.ens)||u.ecount.ens===ecount.ens?f.ecount.common.unregisterEcRepository(i,r):e(i,r):n.isNull(ecount.ens)||u.ecount.ens===ecount.ens?u.ecount.parentFrame.ecount.common.unregisterEcRepository(i,r):e(i,r)},getGlobalEcRepository:function(){var r=ecount.getParentFrame(window),i=window.opener,u;try{i&&!i.closed&&i.top&&i!==i.top&&(i=i.top,i.ecount.common.registerEcGlobalRepository||(i=i.opener))}catch(f){u=["accesssing opener method::","opener url "+i.location.origin,"self url"+location.origin];throw new Error(u.join(" || "));}if(!n.isNull(r)&&!r.closed&&r.top&&r!==r.top)try{r=r.top;r.ecount.common.registerEcGlobalRepository||(r=r.opener)}catch(f){u=["accesssing parent method::","opener url "+i.location.origin,"self url"+location.origin];throw new Error(u.join(" || "));}if(n.isNull(i)||n.isEmptyObject(i)||i.closed||n.isNull(i.ecount)||n.isNull(i.ecount.ens)||n.isNull(ecount)){if(!r||r.name===window.name||r.closed||n.isNull(r.ecount)||n.isNull(r.ecount.ens)||n.isNull(ecount))return t;if(n.isNull(ecount.ens)||r.ecount.ens===ecount.ens)try{return r.ecount.common.getGlobalEcRepository()}catch(f){u=["invoking opener method::","opener url "+r.location.origin,"self url"+location.origin];throw new Error(u.join(" || "));}else return t}else if(n.isNull(ecount.ens)||i.ecount.ens===ecount.ens)try{return i.ecount.common.getGlobalEcRepository()}catch(f){u=["invoking opener method::","opener url "+i.location.origin,"self url"+location.origin];throw new Error(u.join(" || "));}else return t},getGlobalEcRepositoryByPageId:function(n){var r=this,t=[],i=[];return _.each(this.getGlobalEcRepository(),function(t,r){_.isPlainObject(t)&&t.pageId==n&&i.push(r)}),_.each(i,function(n){t.push({key:n,data:r.getGlobalEcRepositoryByKey(n)})}),t},getGlobalEcRepositoryByKey:function(t){var i=this.getGlobalEcRepository()[t];return n.isNull(i)?undefined:n.isNull(i.pageId)?i:i.data},gridPrintPagingHelper:function(t){var i,r,u;return t?(i={currentPage:1,printItems:n(t).find(".wrapper-print")},r=i.printItems,n(r).addClass("hide"),n(r).length>0&&n(r[0]).removeClass("hide"),u=function(t){var t=parseInt(t,10),r=null,u;return i&&i.printItems[t-1]?(u=t-1,r=i.currentPage-1,r!==u&&(n(i.printItems[i.currentPage-1]).addClass("hide"),n(i.printItems[t-1]).removeClass("hide"),i.currentPage=t),i.currentPage):""},{totalPageCount:r.length,setPage:u,setNext:function(){var n=null;return i?(n=i.currentPage+1,u(n)):""},setPrev:function(){var n=null;return i?(n=i.currentPage-1,u(n)):""},currentPageCount:function(){return i.currentPage}}):{totalPageCount:0,setPage:function(){},setNext:function(){},setPrev:function(){}}},getCalcDefaultOption:function(n,t,i,r,u){var c,s,e,l,a,h,v,y,o,f;return t=t===!0,i=i===!0,r=r!==!1,c=["AND","OR"],s=[">","<","=",">=","<=","<>"],l=[{label:"R(",value:"ROUND("},{label:"C(",value:"CEILING("},{label:"F(",value:"FLOOR("}],a=["(",")"],v=["SUMIFS("],y=[{label:"MAX(",value:"MAX("},{label:"MIN(",value:"MIN("}],o=[","],n=="DATETIME"?(e=["+","-"],f={calcType:n,comparisons:s,calcs:e,comma:o}):n=="NUM"?(e=["+","-","/","*"],f={calcType:n,comparisons:s,calcs:e,bracketFunction:l,bracket:a,comma:o},r&&(f.logics=c),i&&(f.sumIf=v,f.commaBracketFunction=y,f.comma=o)):(n=="JOINSTRING"||n=="TEXT")&&(h=t?[{value:" ",label:ecount.resource.LBL03813},"/","-","_","(",")","[","]",";",":",",",".",'"',"'"]:[{value:" ",label:ecount.resource.LBL03813},"/","-","_","(",")","[","]",";",":",",","."],u&&h.push({value:"(/br)",label:ecount.resource.LBL19314}),f={calcType:n,joinString:h}),f},getAutoCodeSubData:function(n,t){if(!n)return{};var i,u="",r={autoCodeCodeTypeValue:{}};return n.forEach(function(n){i=n.Key.CRIT_TYPE;["F","G","H","I","J","K","B","C","L","N"].contains(i)?r.autoCodeCodeTypeValue[ecount.constValue.autoCodeType[i].trxKey]=t(i):["R"].contains(i)&&(i=="R"&&(u="RepeatCd"),r.autoCodeCodeTypeValue[u]=n.CD_STR)}.bind(this)),r},getAutoCodeRepeatCdForInfo:function(t,i,r){n.isEmptyObject(t)||ecount.common.api({ecPageID:t.ecPageID,url:"/SelfCustomize/Config/GetAutoCodeRepeatCdForInfo",async:t.async===!1?!1:!0,data:Object.toJSON(t),success:function(t){n.isFunction(i)&&i(t.Data)}.bind(this),error:function(t){n.isFunction(r)&&r(t);console.log(t)}})},checkAutoCode:function(t){var i=_.merge({},t);ecount.common.getAutoCodeRepeatCdForInfo(i.apiParam,function(t){if(i.apiParam.makeType=="2")n.isEmpty(t.RepeatCd)||i.setCodeFunc(t.RepeatCd);else{var r="N";n.isEmptyObject(t)?r="Y":t.WarningFlg=="R"||n.isEmpty(t.RepeatCd)?i.apiParam.INPUTMAKE_TYPE=="2"&&(r="Y"):n.isEmpty(t.RepeatCd)||i.setCodeFunc(t.RepeatCd);i.apiParam.INPUTMAKE_TYPE=="1"&&i.apiParam.makeType=="1"&&(r="N");r=="Y"&&(i.openPopupFunc({saveType:"A",MAX_INPUT_FLAG:"N",isMultiFlag:!1,createCount:1}),i.allowFunc())}},i.allowFunc)},cexo:function(t,i){var r=n.url().param.ec_req_sid+i,u;return r.length>16&&(r=r.substring(0,16)),i=i.length<24?i.padRight(24,'\0'):i.substring(0,24),u=CryptoJS.AES.decrypt(t,CryptoJS.enc.Utf8.parse(i),{iv:CryptoJS.enc.Utf8.parse(r)}),JSON.parse(u.toString(CryptoJS.enc.Utf8))},getExceptedControlsInForm:function(n){var t={txtCustGroup1:[{id:"txtCustGroup1",name:"CUST_GROUP1",groupId:"txtSCustCd",type:"txtCustGroup1",controlType:n.controlType,subTitle:n.subTitle+"1"},{id:"txtCustGroup2",name:"CUST_GROUP2",groupId:"txtSCustCd",type:"txtCustGroup2",controlType:n.controlType,subTitle:n.subTitle+"2"},],txtClassCd:[{id:"txtClassCd1",name:"PROD_CLASS_CD1",groupId:"txtSProdCd",type:"txtClassCd1",controlType:n.controlType,subTitle:n.subTitle+"1"},{id:"txtClassCd2",name:"PROD_CLASS_CD2",groupId:"txtSProdCd",type:"txtClassCd2",controlType:n.controlType,subTitle:n.subTitle+"2"},{id:"txtClassCd3",name:"PROD_CLASS_CD3",groupId:"txtSProdCd",type:"txtClassCd3",controlType:n.controlType,subTitle:n.subTitle+"3"},],"widget.multiCode.prodGroup":[{id:n.id+"1",name:n.name+"1",groupId:n.groupId,type:"txtClassCd1",controlType:n.controlType,subTitle:n.subTitle+"1"},{id:n.id+"2",name:n.name+"2",groupId:n.groupId,type:"txtClassCd2",controlType:n.controlType,subTitle:n.subTitle+"2"},{id:n.id+"3",name:n.name+"3",groupId:n.groupId,type:"txtClassCd3",controlType:n.controlType,subTitle:n.subTitle+"3"},]};return t[n.id]||n.groupId&&t[n.controlType]},fnOpenmarketDuplicateChk:function(n){for(var i,r="",t=0;t<n.length;t++)if(n[t].ITEM23=="N"){for(i=t+1;i<n.length;i++)if(n[i].ITEM23=="N"&&n[t].ORDER_NO==n[i].ORDER_NO&&n[t].GROUP_NO==n[i].GROUP_NO){r=String.format("- 주문번호: {0}, 묶음주문번호: {1}",n[t].ORDER_NO,n[t].GROUP_NO);break}if(r!="")return ecount.alert(ecount.resource.MSG10563+r),!0}return!1},unselectable:function(n){document.onselectstart=new Function("return false");n&&(n.setAttribute("unselectable","on"),n.classList.add("unselectable"))},removeUnselectable:function(n){document.onselectstart=new Function("return true");n&&(n.removeAttribute("unselectable"),n.classList.remove("unselectable"))},getPascalCase:function(n){for(var r=n.split("."),t,i="";t=r.shift();)i+=t.substring(0,1).toUpperCase()+t.substring(1);return i},getCamelCase:function(n){for(var i=n.split("."),t,r=i.shift();t=i.shift();)r+=t.substring(0,1).toUpperCase()+t.substring(1);return r},getEventPoint:function(n){var t=n.clientX,i=n.clientY;return{x:t,y:i}},getResizableElement:function(t){var r=n(t),i=r.find(ecount.constValue.drawingPaper.resizablePrefix+ecount.constValue.drawingPaper.resizableSelector);return i.length==0?null:i},getResizableWidthCellElement:function(t){var r=n(t),i=r.find(ecount.constValue.drawingPaper.resizeWidthCellPrefix+ecount.constValue.drawingPaper.resizeWidthCellSelector);return i.length==0?null:i},getResizableHeightCellElement:function(t){var r=n(t),i=r.find(ecount.constValue.drawingPaper.resizeHeightCellPrefix+ecount.constValue.drawingPaper.resizeHeightCellSelector);return i.length==0?null:i},canReiszableCell:function(n,t,i,r){i=i||{scrollLeft:0,scrollTop:0};r=r===void 0&&{}||r;var u=ecount.common.canResizeTableCellWidth(n,t,i,r),f=ecount.common.canResizeTableCellHeight(n,t,i,r);return u||f,u||f},canResizeTableCellWidth:function(t,i,r,u){var f,h;r=r||{scrollLeft:0,scrollTop:0};u=u===void 0&&{}||u;var c=_.isBoolean(u.isStopRelative)?u.isStopRelative:!1,l=u.isStopRelative,a=u.calculateScrollTop,v=u.calculateSCrollLeft,e=n(i),o=!1,s=e.closest("table");return s&&s.length&&(f=e.closest("th, td"),f&&f.length&&f.hasClass(ecount.constValue.drawingPaper.resizeWidthCellSelector)&&(h=ecount.common.getScreenBoundingClientRect(f[0],!1,c,{isStopSelector:l,calculateScrollTop:"minus",calculateSCrollLeft:"minus"}),this.canResizeTableCelLWidthByBoundingClientRect(t,h,u)&&(o=!0))),o},canResizeTableCelLWidthByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var u=i.resizeWidthGapPercent||ecount.constValue.drawingPaper.resizeWidthGapPercent,f=i.resizeMaxWidthPixel||ecount.constValue.drawingPaper.resizeMaxWidthPixel,e=i.resizeMinWidthPixel||ecount.constValue.drawingPaper.resizeMinWidthPixel,r=Math.min(Math.max(Math.ceil(t.width*u),e),f);return t.left<=n.x&&t.left+r>=n.x||t.right>=n.x&&t.right-r<=n.x},canResizeTableLeftWidthInCell:function(t,i,r,u){var f,h;r=r||{scrollLeft:0,scrollTop:0};u=u===void 0&&{}||u;var c=_.isBoolean(u.isStopRelative)?u.isStopRelative:!1,l=u.isStopRelative,a=u.calculateScrollTop,v=u.calculateSCrollLeft,e=n(i),o=!1,s=e.closest("table");return s&&s.length&&(f=e.closest("th, td"),f&&f.length&&f.hasClass(ecount.constValue.drawingPaper.resizeWidthCellSelector)&&(h=ecount.common.getScreenBoundingClientRect(f[0],!1,c,{isStopSelector:l,calculateScrollTop:"minus",calculateSCrollLeft:"minus"}),this.canResizeTableLeftWidthByBoundingClientRect(t,h)&&(o=!0))),o},canResizeTableLeftWidthByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var r=i.resizeWidthGapPercent||ecount.constValue.drawingPaper.resizeWidthGapPercent,u=i.resizeMaxWidthPixel||ecount.constValue.drawingPaper.resizeMaxWidthPixel,f=i.resizeMinWidthPixel||ecount.constValue.drawingPaper.resizeMinWidthPixel,e=Math.min(Math.max(Math.ceil(t.width*r),f),u);return t.left<=n.x&&t.left+e>=n.x},canResizeTableRightWidthInCell:function(t,i,r){var u,s;r=r===void 0&&{}||r;var f=n(i),e=!1,o=f.closest("table");return o&&o.length&&(u=f.closest("th, td"),u&&u.length&&u.hasClass(ecount.constValue.drawingPaper.resizeWidthCellSelector)&&(s=ecount.common.getScreenBoundingClientRect(u[0],!1),canResizeTableRightWidthByBoundingClientRect(t,s,r)&&(e=!0))),e},canResizeTableRightWidthByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var r=i.resizeWidthGapPercent||ecount.constValue.drawingPaper.resizeWidthGapPercent,u=i.resizeMaxWidthPixel||ecount.constValue.drawingPaper.resizeMaxWidthPixel,f=i.resizeMinWidthPixel||ecount.constValue.drawingPaper.resizeMinWidthPixel,e=Math.min(Math.max(Math.ceil(t.width*r),f),u);return t.right>=n.x&&t.right-e<=n.x},canResizeTableCellHeight:function(t,i,r,u){var f,h;r=r||{scrollLeft:0,scrollTop:0};u=u===void 0&&{}||u;var c=_.isBoolean(u.isStopRelative)?u.isStopRelative:!1,l=u.isStopRelative,a=u.calculateScrollTop,v=u.calculateSCrollLeft,e=n(i),o=!1,s=e.closest("table");return s&&s.length&&(f=e.closest("th, td"),f&&f.length&&f.hasClass(ecount.constValue.drawingPaper.resizeHeightCellSelector)&&(h=ecount.common.getScreenBoundingClientRect(f[0],!1,c,{isStopSelector:l,calculateScrollTop:"minus",calculateSCrollLeft:"minus"}),this.canResizeTableCellHeightByBoundingClientRect(t,h,u)&&(o=!0))),o},canResizeTableCellHeightByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var u=i.resizeHeightGapPercent||ecount.constValue.drawingPaper.resizeHeightGapPercent,f=i.resizeMaxHeightPixel||ecount.constValue.drawingPaper.resizeMaxHeightPixel,r=Math.min(Math.ceil(t.height*u),f);return t.top<=n.y&&t.top+r>=n.y||t.bottom>=n.y&&t.bottom-r<=n.y},canResizeTableTopHeightInCell:function(t,i,r,u){var f,h;r=r||{scrollLeft:0,scrollTop:0};u=u===void 0&&{}||u;var c=_.isBoolean(u.isStopRelative)?u.isStopRelative:!1,l=u.isStopRelative,a=u.calculateScrollTop,v=u.calculateSCrollLeft,e=n(i),y=i.parentElement,o=!1,s=e.closest("table");return s&&s.length&&(f=e.closest("th, td"),f&&f.length&&f.hasClass(ecount.constValue.drawingPaper.resizeHeightCellSelector)&&(h=ecount.common.getScreenBoundingClientRect(f[0],!1,c,{isStopSelector:l,calculateScrollTop:"minus",calculateSCrollLeft:"minus"}),this.canResizeTableTopHeightInCellByBoundingClientRect(t,h,u)&&(o=!0))),o},canResizeTableTopHeightInCellByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var r=i.resizeHeightGapPercent||ecount.constValue.drawingPaper.resizeHeightGapPercent,u=i.resizeMaxHeightPixel||ecount.constValue.drawingPaper.resizeMaxHeightPixel,f=Math.min(Math.ceil(t.height*r),u);return t.top<=n.y&&t.top+f>=n.y},canResizeTableBottomHeightInCell:function(t,i){var r=n(i),u=i.parentElement;return!0},canResizeTableBottomHeightByBoundingClientRect:function(n,t,i){i=i===void 0&&{}||i;var r=i.resizeHeightGapPercent||ecount.constValue.drawingPaper.resizeHeightGapPercent,u=i.resizeMaxHeightPixel||ecount.constValue.drawingPaper.resizeMaxHeightPixel,f=Math.min(Math.ceil(t.height*r),u);return t.top+t.height-f<=n.y&&t.top+t.height>=n.y},getElementPoint:function(n,t,i,r){return ecount.common.getScreenPosition(n,t,i,r)},getElementSize:function(t){var i=n(t);return t==null||i.length==0?{width:0,height:0}:{width:i.width(),height:i.height()}},getElementPosition:function(n){var t=ecount.common.getElementPoint(n),i=ecount.common.getElementSize(n);return{top:t.y,left:t.x,width:i.width,height:i.height}},getDistancePoint:function(n,t){var i=t.y-n.y,r=t.x-n.x;return{x:r,y:i}},getElementDistancePoint:function(n,t,i){var r=ecount.common.getDistancePoint(t,i),u=n.y+r.y,f=n.x+r.x;return{x:f,y:u}},getDistancePointToPoint:function(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))},moveElement:function(t,i,r,u,f,e){var o,s;if(!t.classList.contains(ecount.constValue.drawingPaper.containerSelector)){if(o=n(t).closest(ecount.constValue.drawingPaper.containerPrefix+ecount.constValue.drawingPaper.containerSelector),o.length==0)return;t=o[0]}s=ecount.common.elementDistance(i,r,u,f,e);t.style.top=s.top+"px";t.style.left=s.left+"px"},elementDistance:function(t,i,r,u,f){var o=0,s=0,e=ecount.common.getElementDistancePoint(t,i,r);return o=n.isNull(f)?e.y:e.y<f?f:e.y,s=n.isNull(u)?e.x:e.x<u?u:e.x,{top:o,left:s}},moveHorizontalElement:function(t,i,r,u){var e,f;if(!t.classList.contains(ecount.constValue.drawingPaper.containerSelector)){if(e=n(t).closest(ecount.constValue.drawingPaper.containerPrefix+ecount.constValue.drawingPaper.containerSelector),e.length==0)return;t=e[0]}return f=ecount.common.getElementDistancePoint(i,r,u),t.style.left=(f.x<0?0:f.x)+"px",{x:f.x<0?0:f.x}},getCalcRatio:function(n){return n*(2-ecount.common.getZoomRatio())},getScreenPosition:function(n,t,i,r){var u,f,e,o,s,h,c,l;r=r||{isIgnoreBorder:!1,isStopSelector:null};t=typeof t=="boolean"?t:!1;i=typeof i=="boolean"?i:!1;isStopSelector=r.isStopSelector;u=0;f=0;isStopSelector&&(o=isStopSelector.indexOf("#")==0?isStopSelector.substring(1):null,s=isStopSelector.indexOf(".")==0?isStopSelector.substring(1):null,h=isStopSelector!=null&&isStopSelector!=undefined&&isStopSelector);c=0;l=0;do{if(e=window.getComputedStyle?window.getComputedStyle(n,""):n.currentStyle,i&&e.position=="relative")break;if(o&&n.getAttribute("id")==o)break;else if(s&&n.classList.contains(s))break;else if(h&&n.tagName==h)break;if(e.position!="fixed"||/ui-dialog/.test(n.className))r.isIgnoreBorder||n.tagName!="DIV"||(f+=parseFloat(e.borderTopWidth),u+=parseFloat(e.borderLeftWidth)),f+=n.offsetTop,u+=n.offsetLeft;else{f+=parseInt(e.top,10);u+=parseInt(e.left,10);break}c+=n.scrollTop||0;l+=n.scrollLeft||0}while(n=n.offsetParent);return t&&(f=ecount.common.getCalcRatio(f),u=ecount.common.getCalcRatio(u)),{x:u,y:f,left:u,top:f,scrollTop:c,scrollLeft:l}},getOffset:function(n,t){t=typeof t=="boolean"?t:!1;var i=n.offsetLeft,r=n.offsetTop,u=n.offsetWidth,f=n.offsetHeight;return t&&(i=i*(2-ecount.common.getZoomRatio()),r=r*(2-ecount.common.getZoomRatio()),u=u*(2-ecount.common.getZoomRatio()),f=f*(2-ecount.common.getZoomRatio())),{x:i,y:r,width:u,height:f}},getScreenBoundingClientRect:function(n,t,i,r){r=r===void 0?{}:r;t=typeof t=="boolean"?t:!1;i=typeof i=="boolean"?i:!1;var u=_.extend(ecount.common.getOffset(n,t),ecount.common.getScreenPosition(n,t,i,r)),f=u.x,e=u.y,o=u.top,s=u.left,h=u.top+u.height,c=u.left+u.width;return r.calculateScrollTop=="plus"?(e+=u.scrollTop,o+=u.scrollTop,h+=u.scrollTop):r.calculateScrollTop=="minus"&&(e-=u.scrollTop,o-=u.scrollTop,h-=u.scrollTop),r.calculateSCrollLeft=="plus"?(f+=u.scrollLeft,s+=u.scrollLeft,c+=u.scrollLeft):r.calculateSCrollLeft=="minus"&&(f-=u.scrollLeft,s-=u.scrollLeft,c-=u.scrollLeft),{x:f,y:e,left:s,top:o,width:u.width,height:u.height,bottom:h,right:c}},minZIndex:function(t){var i=0;return ecount.common.getAllControlTypeElement(t).each(function(t,r){var f=n(r).closest(ecount.constValue.drawingPaper.containerPrefix+ecount.constValue.drawingPaper.containerSelector),u,r;f.length==1&&(u=f[0],r=parseInt(u.style.zIndex,10),r>ecount.constValue.drawingPaper.defaultMovingZIndex&&(r-=ecount.constValue.drawingPaper.defaultMovingZIndex),n.isNumber(u.style.zIndex)&&(i=i==0?r:Math.min(r,i)))}),i==0?ecount.constValue.drawingPaper.defaultZIndex:i},maxZIndex:function(t,i){i=_.isNumber(i)?i:0;var r=0;return ecount.common.getAllControlTypeElement(t).each(function(t,i){var u=n(i).closest(ecount.constValue.drawingPaper.containerPrefix+ecount.constValue.drawingPaper.containerSelector),f,i;u.length==1&&(f=u[0],i=parseInt(f.style.zIndex,10),i>ecount.constValue.drawingPaper.defaultMovingZIndex&&(i-=ecount.constValue.drawingPaper.defaultMovingZIndex),n.isNumber(i)&&(r=Math.max(r,i)))}),i>r?i:r},getAllControlTypeElement:function(t){var i=n(t);return i.find('[data-controltype^="ecount.report."]')},hasTextNodeInNodeList:function(n){for(var i=!1,t=0,r=n.length;t<r;t++)if(n[t].nodeType==Node.TEXT_NODE){i=!0;break}return i},defineIsReadOnlyProperty:function(n,t,i,r){Object.defineProperty(t,i,{get:function(){return console.log("get %s",r),r},set:function(){throw new Error("할당할 수 없다");},enumerable:!1,configurable:!1})},defineGetterProperty:function(n,t,i,r){Object.defineProperty(t,i,{get:function(){return console.log("get %s",r),r},set:function(){throw new Error("할당할 수 없다");}})},defineSetterProperty:function(n,t,i,r){Object.defineProperty(t,i,{get:function(){throw new Error("가져갈 수 없다");},set:function(n){console.log("set %s",n);r=n},enumerable:!1,configurable:!1})},defineProperty:function(n,t,i,r){Object.defineProperty(t,i,{get:function(){return console.log("get %s",r),r},set:function(n){console.log("set %s",n);r=n},configurable:!1})},defineGetterProperties:function(n,t,i){for(var u={},r=0,f=i;r<f;r++)u[i[r]]={get:function(){return t[i]},configurable:!1,enumerable:!0};Object.defineProperties(t,u)},addMousedownEventListener:function(t,i,r,u,f){ecount.common._mousedownEventListeners=ecount.common._mousedownEventListeners||[];var o=r,e=n(t);if(r="mousedown"+((r||"")==""?"":"."+r),f)e.bindCustom(r,u,f);else e.on(r,u);ecount.common._mousedownEventListeners.push({element:t,group:i,key:o})},addMousemoveEventListener:function(t,i,r,u){var f=n(t);if(i="mousemove"+((i||"")==""?"":"."+i),u)f.bindCustom(i,r,u);else f.on(i,r)},addMouseupEventListener:function(t,i,r,u){var f=n(t);if(i="mouseup"+((i||"")==""?"":"."+i),_.isNumber(u))f.bindCustom(i,r,u);else f.on(i,r)},removeMousedownEventListener:function(t,i){var r=n(t);i="mousedown"+((i||"")==""?"":"."+i);r.off(i)},removeMousemoveEventListener:function(t,i){var r=n(t);i="mousemove"+((i||"")==""?"":"."+i);r.off(i)},removeMouseupEventListener:function(t,i){var r=n(t);i="mouseup"+((i||"")==""?"":"."+i);r.off(i)},clearMousedownEventListener:function(n,t){ecount.common._mousedownEventListeners&&(ecount.common._mousedownEventListeners.filter(function(i){return(!n||i.group==n)&&(!t||i.key==t)}).forEach(function(n){this.removeMousedownEventListener(n.element,n.key);n.isClear=!0}.bind(this)),ecount.common._mousedownEventListeners.remove(function(n){return n.isClear}))},closest:function(n,t){var i=n,r,u;if(!t)return null;for(r="tagName",t[0]=="."?(r="className",t=t.substring(1)):t[0]=="#"&&(r="id",t=t.substring(1)),u=new RegExp("(\\s)"+t+"(?!(\\w|-))|^"+t+"(?!(\\w|-))");i;){if(i[r]&&u.test(i[r]))break;i=i.parentNode}return i==document||i==document.body?null:i},closestFirstElementType:function(n){while(n){if(n.nodeType==Node.ELEMENT_NODE)break;n=n.parentNode}return n==document||n==document.body?null:n},getTextareaElement:function(t){var i=n(t).closest(ecount.constValue.drawingPaper.textareaPrefix+ecount.constValue.drawingPaper.textareaSelector);return!i||i.length==0?null:i[0]},getIndexOfNodeInTextarea:function(t){var r=-1,u=n(t).closest(ecount.constValue.drawingPaper.textareaPrefix+ecount.constValue.drawingPaper.textareaSelector),o,f,i,s,e;if(!u||u.length==0)return r;for(o=u[0],f=o.childNodes,i=0,s=f.length;i<s;i++)if(e=f[i],e==t||e.contains(t)){r=i;break}return r},getIndexOfNodeInTextContainer:function(t){var r=-1,u=n(t).closest(ecount.constValue.drawingPaper.textcontainerPrefix+ecount.constValue.drawingPaper.textcontainerSelector),o,f,i,s,e;if(!u||u.length==0)return r;for(o=u[0],f=o.childNodes,i=0,s=f.length;i<s;i++)if(e=f[i],e==t||e.contains(t)){r=i;break}return r},isLastCursorOfMappingData:function(n,t){var i=!1,r=ecount.common.closestFirstElementType(n),u=r&&r.previousElementSibling;return u&&u.classList.contains(ecount.constValue.drawingPaper.mappingDataSelector)&&t==0&&(i=!0),i},isCursorInMappingData:function(t,i){var u=!1,e=n(t),r=e.closest(ecount.constValue.drawingPaper.mappingDataPrefix+ecount.constValue.drawingPaper.mappingDataSelector),f;return r&&r.length&&(f=r[0],i<f.innerText.length&&(u=!0)),u},isLastCursorOfNode:function(n,t){var i=!1;return n.nodeType==Node.TEXT_NODE&&t==n.textContent.length&&(i=!0),i},isLastCursorInMappingData:function(t,i,r){t=t||"keyup";var f=!1,s=n(i),o=s.closest(ecount.constValue.drawingPaper.mappingDataPrefix+ecount.constValue.drawingPaper.mappingDataSelector),e=ecount.common.closestFirstElementType(i),u=e;return t=="keyup"?(u=e&&e.previousElementSibling,u&&u.classList.contains(ecount.constValue.drawingPaper.mappingDataSelector)&&r==0&&(f=!0)):t=="mouseup"&&o&&o.length&&r==u.innerText.length&&(f=!0),f},getMappingDataElement:function(n){var t=null;return n.nodeType==Node.TEXT_NODE?t=ecount.common.closest(n,ecount.constValue.drawingPaper.mappingDataPrefix+ecount.constValue.drawingPaper.mappingDataSelector):n.nodeType==Node.ELEMENT_NODE&&(n.classList.contains(ecount.constValue.drawingPaper.mappingDataSelector)||(t=ecount.common.closest(n,ecount.constValue.drawingPaper.mappingDataPrefix+ecount.constValue.drawingPaper.mappingDataSelector))),t},getNodeIndexInContainer:function(n,t){for(var u,r=-1,i=0,f=n.childNodes.length;i<f;i++)if(u=n.childNodes[i],u.contains(t)){r=i;break}return r},getFirstTextNode:function(n){return n.nodeType==Node.TEXT_NODE?n:n.nodeType==Node.ELEMENT_NODE?n.firstChild?n.firstChild.nodeType==Node.ELEMENT_NODE&&n.firstChild.tagName=="BR"?n:ecount.common.getFirstTextNode(n.firstChild):null:null},getLastTextNode:function(n){return n.nodeType==Node.TEXT_NODE?n:n.nodeType==Node.ELEMENT_NODE?ecount.common.getLastTextNode(n.lastChild):null},getLastChildrenElementNode:function(n){return n.nodeType==Node.TEXT_NODE?n.parentElement:n.nodeType==Node.ELEMENT_NODE?n.children.length?ecount.common.getLastChildrenElementNode(n.children[n.children.length-1]):n:null},getFirstInputNode:function(n){for(var t,i=null,r=0,u=n.childNodes.length;r<u;r++)if(t=n.childNodes[r],t.nodeType==Node.TEXT_NODE){i=t;break}else if(t.nodeType==Node.ELEMENT_NODE&&["P","DIV","SPAN"].contains(t.tagName)){i=t;break}return i},clearRange:function(){var u=window.getSelection(),e,t,i,o;if(u.rangeCount){var s=u.getRangeAt(0),f=s.commonAncestorContainer,h=n(f),r;if(f.nodeType==Node.ELEMENT_NODE&&f.classList.contains(ecount.constValue.drawingPaper.textcontainerSelector))r=f;else{if(e=h.closest(ecount.constValue.drawingPaper.textcontainerPrefix+ecount.constValue.drawingPaper.textcontainerSelector),!e||!e.length)return;r=e[0]}if(r&&r.childNodes.length&&(t=ecount.common.getFirstInputNode(r),t)){if(i=document.createRange(),u.removeAllRanges(),t.nodeType==Node.TEXT_NODE)i.setStart(t,0),i.setEnd(t,0);else if(t.nodeType==Node.ELEMENT_NODE){if(o=ecount.common.getFirstTextNode(t),!o)return;i.setStart(o,0);i.setEnd(o,0)}u.addRange(i)}}},getDrawingPaperColor:function(n){return(n=(n||"").trim(),ecount.constValue.drawingPaper.nativeColorname[n])?n:n!=""&&n.indexOf("#")!=0?"#"+n:n},getPreviousSibling:function(n){var t=n.previousSibling;return t?t:ecount.common.getPreviousSibling(n.parentNode)},getNextSibling:function(n){var t=n.nextSibling;return t?t:ecount.common.getNextSibling(n.parentNode)},convertToStyle:function(t){var i,u,r;if(typeof t=="string")return"style='"+t+"'";if(!n.isPlainObject(t))return"";i="";u="";for(r in t)if(t.hasOwnProperty(r)){if(t[r]=="")continue;u="";i!=""&&(i+=" ");i+=r+":"+t[r]+u+";"}return i!=""&&(i="style='"+i+"'"),i},convertToClassName:function(t){return n.isArray(t)?t.length==0?"":"class='"+t.join(" ")+"'":""},convertToAttribute:function(t,i){var u,f,r;if(!n.isPlainObject(t))return"";u="";for(r in t)if((!i||!i.contains(r))&&t.hasOwnProperty(r)){if(t[r]=="")continue;f="";u!=""&&(u+=" ");u+=r+"='"+this.replaceEscapeString(t[r].toString())+f+"'"}return u},replaceEscapeString:function(n){return typeof n=="boolean"?n:n.escapeHTML(!0)},setAutoAlignPosition:function(t,i){var r;i=_.extend({autoAlignStandard:"none"},i||{});switch(i.autoAlignStandard){case"table":r=t.find("table[id='grid-main']:eq(0)")}if(r&&r.length){var f=parseInt(r[0].style.width,10),u=r[0].offsetLeft,e=t.find("[data-wrapper]");e.each(function(t,i){n(i).find(">.ec-container").each(function(n,t){var i=/pin-fixed-(top|bottom)?(-)?(left|center|right)/.exec(t.className);if(i)switch(i[3]){case"left":t.style.left=u+"px";break;case"center":t.style.left=f/2-t.getBoundingClientRect().width/2+u+"px";break;case"right":t.style.left=f-t.getBoundingClientRect().width+u+"px"}})})}},setAdjustAbsoluteElementHeight:function(t,i,r){var u=t,s,h,e,c,l;t instanceof jQuery||(u=n(t));i.wrapperSelector||(i.wrapperSelector="div.wrapper-print");i.wrapperContentSelector||(i.wrapperContentSelector=".wrapper-print-content");i.printCutLineSelector||(i.printCutLineSelector=".grid-print-cut-line");i.$images||(i.$images=u.find("img"));n.isNumber(i.zIndex)||(i.zIndex="4000");i.tableId||(i.tableId="grid-main");typeof i.isRequireImage!="boolean"&&(i.isRequireImage=!1);typeof i.callbackPageInfo!="function"&&(i.callbackPageInfo=function(){return[]});typeof i.setTypeSpecTranMaxWidth!="function"&&(i.setTypeSpecTranMaxWidth=function(){});var a=n.isNumber(r.marginBottom)?parseInt(r.marginBottom):0,o=!1,v=0,f=u.filter(i.wrapperSelector);if(f.length==0&&(f=u.find(i.wrapperSelector)),i.renderType||(i.renderType=f.attr("data-rendertype")||""),i.formType||(i.formType=f.attr("data-formtype")||""),i.renderType){if(i.renderType=i.renderType.toLowerCase(),s=u.hasClass("hidden"),s&&(u.removeClass("hidden"),u.css({position:"absolute",top:"-5000px",left:"-5000px"})),i.renderType===_.get(ecount,"ecount.grid.constValue.gridRenderType.typeSpecTran","").toLowerCase()&&i.formType=="SF030")for(h=f.find("div.print-contents-page-number"),e=0;e<h.length;e++)c=n(h[e]),c.text()==""&&c.remove();l=function(){i.$images.each(function(n,t){var s=i.$images.eq(n),h=s.closest("[data-isoldhtmlbox='true']").length==1,u,f,e,o;h?(u=s.closest("td"),f=u.closest("tr")):(e=s.closest(".ec-textcontainer"),e&&e.length&&(u=e.closest("td, th"),f=u.closest("tr")));f&&f.length&&u&&u.length&&r&&r.isNotUsePadding==!1&&(o=parseFloat(f.height()||0),o<=0&&(o=u[0].offsetHeight),t.naturalHeight>o&&u.css({padding:"3px 0px 2px 0px"}))});var t=0,h=0,c=0,e;r.isInitailize&&i.renderType===_.get(ecount,"ecount.grid.constValue.gridRenderType.salaryPayrollBookList","").toLowerCase()&&(e=callbackPageInfo(),n.isArray(e)&&(t=e.length==0?0:e[e.length-1].bottomHeight,h=t,c=u.scrollParent().get(0).scrollHeight));f.each(function(u,f){var s=n(f),w={},d=!1,nt=s.attr("print-page"),p,b,tt,k,l,g,it,rt,ut,y,ft;o=s.hasClass("hide");o&&s.removeClass("hide");nt&&r.printableSize&&!n.isEmptyObject(r.printableSize[nt])?(p=r.printableSize[nt],w.width=typeof p.width=="number"?p.width+"px":p.width,w.height=typeof p.height=="number"?p.height+"px":p.height,d=!0):(b=s.find(i.wrapperContentSelector),tt=s.find("[data-wrapper]"),b.each(function(n){var r=b.eq(n),u=r.find("[data-isoldhtmlbox]").length>0,t;u&&(t=r.find("#"+i.tableId),t&&t.length&&t.css({position:"relative","z-index":i.zIndex}))}),n(tt.get().reverse()).each(function(t,r){var u=n(r),h=r.getBoundingClientRect().top,o=u.find(".ec-container"),f=0,e,s;o.each(function(n,t){var u,i,r,e;if(f=Math.max(f,parseFloat(t.style.top||0)+t.offsetHeight),!t.style||t.style.overflow!="hidden"||!t.style.height)for(u=Math.max(t.getBoundingClientRect().top,h),i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1);i.nextNode();)if(r=i.currentNode.getBoundingClientRect(),r.height>0&&(e=r.top-u+r.height,f=Math.max(f,e)),i.currentNode.style&&i.currentNode.style.overflow=="hidden"&&i.currentNode.style.height)break});e=u.height();s=u.attr("data-origin-height");o&&o.length>0&&(i.renderType!="draft"||u.closest(".ecount4900").length||u.closest(".ecount4925").length||u.children().length!=1||u.children().first().attr("data-isoldhtmlbox")!="true"?f>e?(s||u.attr("data-origin-height",e),u.css({height:f+"px"})):f<e&&u.css({height:Math.max(f,s)+"px"}):(u.css({height:""}),u.children().first().find("[data-controltype='ecount.report.shape.rectangle']").first().css({height:""})))}),r.isSetWidth&&(k=0,tt.each(function(t,i){var r=0,u=!1;n(i).find(">.ec-container").each(function(t,i){n(i).attr("data-isoldhtmlbox")!="true"?r=Math.max(r,parseFloat(i.style.left)+n(i).outerWidth()):u=!0});!u&&r>0&&(n(i).css({width:r+"px"}),k=Math.max(k,r))}),l=0,g=0,b.filter(function(n){var t=b.eq(n);g=t.length>0?t.outerWidth():0;l=g>l?g:l}),k>l&&(l=k),l>0&&(l=l<650?650:l,v===0&&i.setTypeSpecTranMaxWidth(l),w.width=l+"px",d=!0)),r.isSetHeight&&(it=s.find(i.wrapperContentSelector+":last"),rt=it.position(),ut=s.find(i.printCutLineSelector).position()||{top:0},y=it.outerHeight(),rt&&(y=y+rt.top),y=ut.top>y?Math.ceil(ut.top):y,h=h==0?t+y+10+2:t+y+2,r.isInitailize&&i.renderType===_.get(ecount,"ecount.grid.constValue.gridRenderType.salaryPayrollBookList","").toLowerCase()&&(ft=s.attr("print-page"),e&&e.push({key:ft,el:s[0],topHeight:t,bottomHeight:h})),y>0&&(w.height=y+"px",d=!0,a>0&&(w["margin-bottom"]=a+"px"))));this.setAutoAlignPosition(s,{autoAlignStandard:r.autoAlignStandard});d===!0&&s.css(w);r.isHideBack===!0&&o&&s.addClass("hide");r.isInitailize&&i.renderType===_.get(ecount,"ecount.grid.constValue.gridRenderType.salaryPayrollBookList","").toLowerCase()&&(i.isOverScrollHeight||t>c)&&(i.isOverScrollHeight=!0,s.addClass("hide"));v++;t=h}.bind(this));s&&(u.addClass("hidden"),u.css({position:"",top:"",left:""}));i.completeCallback&&i.completeCallback()}.bind(this);i.isRequireImage?ecount.common.requireImage(i.$images,l):l()}},findChildIndex:function(n,t){for(var u=t.tagName,r=-1,i=0,f=n.children.length;i<f;i++)if(n.children[i].tagName==u&&(r+=1,n.children[i]==t))break;return r},getConvertPdfToImageBlob:function(n,t){return t.isBreak===!0?(ecount.testLog&&console.log(" ####PASS#### [getConvertPdfToImageBlob] PDF not loaded [id: %o] [maxSize: %o] [maxPageCount: %o]",n.id,t.pdfToImageMaxSize,t.pdfToImageMaxPageCount),n.isDelete=!0,Promise.resolve()):new Promise(function(i,r){var u,f;u=window["pdfjs-dist/build/pdf"];u.GlobalWorkerOptions.workerSrc=window["pdfjs-dist/build/pdf.worker"];f=u.getDocument({url:n.fileDataUrl,cMapUrl:"/ECErp/contents/js/lib/pdfjs/cmaps/",cMapPacked:!0});f.promise.then(function(u){var e,f;for(ecount.testLog&&console.log(" ****SUCCESS**** [getConvertPdfToImageBlob] PDF loaded ",n.id),e=[],f=1;f<u.numPages+1;f++)(function(n){e.push(new Promise(function(t,i){u.getPage(n).then(function(i){var s,h;ecount.testLog&&console.log(" ****SUCCESS**** [getConvertPdfToImageBlob getPage] ",i._pageIndex);var u=1.2,o=i.getViewport({scale:u}),c=o.width,f=o.height;u=c>f?1210/f:1710/f;var e=i.getViewport({scale:u}),l="myCanvas"+n,r=document.createElement("canvas"),a=r.getContext("2d");r.id=l;r.height=e.height;r.width=e.width;s={canvasContext:a,viewport:e};h=i.render(s);h.promise.then(function(){r.toBlob(function(n){t(n);r.remove()}.bind(this))}.bind(this))}).catch(function(n){console.log(" %%%%ERROR%%%% [pdf getPage error] ",n);i({code:4001,msg:"pdf getPage error",error:n})})}.bind(this)))})(f);ecount.testLog&&console.log(" ****SUCCESS**** [getConvertPdfToImageBlob promise all start] ",n.id);Promise.all(e).then(function(r){var f=r.length,u=r.reduce(function(n,t){return n+t.size},0);ecount.testLog&&console.log(" ****SUCCESS**** [getConvertPdfToImageBlob promise all end 변환 성공] [id: %o] [size: %o]",n.id,u);t.prevPdfToImageMaxPageCount+=f;t.prevPdfToImageMaxSize+=u;t.pdfToImageMaxPageCount!==0&&t.pdfToImageMaxPageCount<=t.prevPdfToImageMaxPageCount?(ecount.testLog&&console.log(" ####CHECK#### [getConvertPdfToImageBlob max page count] [pdfToImageMaxPageCount: %o] [prevPdfToImageMaxPageCount: %o]",t.pdfToImageMaxPageCount,t.prevPdfToImageMaxPageCount),t.isBreak=!0,n.isDelete=!0,n.isDeleteType="maxPageCount",i(n)):t.pdfToImageMaxSize!==0&&t.pdfToImageMaxSize<=t.prevPdfToImageMaxSize?(ecount.testLog&&console.log(" ####CHECK#### [getConvertPdfToImageBlob max size] [pdfToImageMaxSize: %o] [prevPdfToImageMaxSize: %o]",t.pdfToImageMaxSize,t.prevPdfToImageMaxSize),t.isBreak=!0,n.isDelete=!0,n.isDeleteType="maxSize",i(n)):(n.imageData=r,n.imageCount=f,n.imageSize=u,n.file.isBlobSize=u,i(n))},function(n){console.log(" %%%%ERROR%%%% [getConvertPdfToImageBlob getPage] ",n);r({code:4002,msg:"getConvertPdfToImageBlob getPage",error:n})}).catch(function(n){console.log(" %%%%ERROR%%%% [getConvertPdfToImageBlob promise all] ",n);r({code:4003,msg:"getConvertPdfToImageBlob promise all",error:n})})}).catch(function(n){console.log(" %%%%ERROR%%%% [getConvertPdfToImageBlob loadingTask promise] ",n);r({code:4004,msg:"getConvertPdfToImageBlob loadingTask promise",error:n})})})},getBlobImageDownload:function(n,t){if(window.navigator&&window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,n+".jpg");else{var i=document.createElement("a");i.style="display: none";i.download=n+".jpg";i.href=(window.URL||window.webkitURL).createObjectURL(t);i.click();i.remove()}},findMaxRightBottomIn:function(n){for(var i=[n],r=n,u=n,t,f;i.length!==0;)t=i.shift(),f=Array.prototype.slice.call(t.children),i=i.concat(f),r.getBoundingClientRect().right<t.getBoundingClientRect().right&&(r=t),u.getBoundingClientRect().bottom<t.getBoundingClientRect().bottom&&(u=t);return{maxRight:r,maxBottom:u}},getOverflowedSizeOf:function(n){function r(n){return parseInt(n.replace("px"))}var t=ecount.common.findMaxRightBottomIn(n),u=t.maxRight,f=t.maxBottom,i=n.getBoundingClientRect(),e=u.getBoundingClientRect(),o=f.getBoundingClientRect(),s=Math.abs(i.right-e.right)+r(getComputedStyle(n).width),h=Math.abs(i.bottom-o.bottom)+r(getComputedStyle(n).height);return{width:s,height:h}},switchV5DomainGroup:function(n){var t=new URL(top.location.href);t.searchParams.set("__v5domains",n);top.location=t.href},loadV5DomainGroup:function(){if(!window.__EC_V5_DOMAINS){var n=localStorage.getItem("__EC_V5_DOMAINS");n&&n!=""&&(window.__EC_V5_DOMAINS=JSON.parse(n))}window.__EC_V5_DOMAINS||(window.__EC_V5_DOMAINS={})},appendV5DomainGroup:function(n,t){ecount.common.loadV5DomainGroup();window.__EC_V5_DOMAINS[n]=t;localStorage.setItem("__EC_V5_DOMAINS",JSON.stringify(window.__EC_V5_DOMAINS))},getV5Application:function(t){function a(){window.v5||(window.v5={});window.v5.application=new window.ecount_application_entry.ErpApp(function(n){n.addConfig({HOST_PATH:s,WEBROOT_PATH:r,MODULEROOT_PATH:h,VERSION_PATH:c,PRESENTATION_PATH:y,RESOURCE_PATH:l,DEPENDENCY_PATH:p,DEV_MODE:e})})}var h="/modules",c="/version",y="/presentation",l="/resources",p="/dependencies",o={parse:function(n,t,i,r){var c,f,e,o;t.toLowerCase().indexOf("-s3")!=-1&&(t=t.replace(/-s3\.ecount/ig,".ecount"));i.endsWith(":")&&(i=i.substring(0,i.length-1));r||(r="default");var v=n[r][i],s=/([^.#]+)#?\.ecount\.com(?::([0-9]+))?/i.exec(v),h=s?s[1]:undefined;h=h?h:"";c=s?s[2]:undefined;c=c?c:"";var y=i+"://"+v,a=/^https?:\/\/([^:\/\r\n]*)(?::[0-9]+)?/i.exec(y);if(!a||a.length<=1)throw y+" is invalid url format";var p=a[1],w=p.replace(".","\\.").replace("#","(([a-zA-Z]+)([0-9]+)?(-dev)?)?"),b=new RegExp("^"+w,"i"),u=b.exec(t),l=u?u[1]:undefined;return l=l?l:"",f=u?u[2]:undefined,f=f?f:"",e=u?u[3]:undefined,e=e?e:"",o=u?u[4]:undefined,o=o?o:"",{target:t,group:h,zone:f,server:e,dev:o,dynamic:l}},get:function(n,t,i,r,u){return r.endsWith(":")&&(r=r.substring(0,r.length-1)),n[i][r].replace("#",u?u:t.dynamic)},makeDynamic:function(n,t,i){return n+(t?t:"")+(i?"-dev":"")}},v=location.search.match(/__v5domains=([a-zA-Z0-9_\-]*)/),u,f,i,s,r,e;return v&&(u=v[1],u&&u!=""&&(u=u.toLowerCase(),ecount.common.loadV5DomainGroup(),f=window.__EC_V5_DOMAINS[u],f||u!="test"||(f={v5http:{http:"test.ecount.com:5000/ec5",https:"test.ecount.com:5001/ec5"},v5res:{http:"test.ecount.com:5000/ec5/static",https:"test.ecount.com:5001/ec5/static"}},ecount.common.appendV5DomainGroup(u,f)),f&&(window.__EC_BASE_HOST_INFO=n.extend(!0,{},window.__EC_BASE_HOST_INFO,f),window.__EC_V3_V5_USE_DEFAULT="N"))),i=o.parse(window.__EC_BASE_HOST_INFO,location.hostname,location.protocol),s=location.protocol+"//"+o.get(window.__EC_BASE_HOST_INFO,i,"v5http",location.protocol,o.makeDynamic(i.zone,"",i.dev=="-dev")),window.__EC_V3_V5_USE_DEFAULT!="Y"||i.dev=="-dev"||i.server!=""||(s="/ec5"),r=location.protocol+"//"+o.get(window.__EC_BASE_HOST_INFO,i,"v5res",location.protocol,o.makeDynamic(i.zone,"",i.dev=="-dev")),e=i&&i.dev=="-dev",e&&(r=s+"/static"),new Promise(function(n,i){if(window.v5&&window.v5.application){n(window.v5.application);return}if(!window.ecount_browser_framework){var u=[r+"/ecountv5/static/contents/js/lib/__ec__core__loader.v1.js",r+"/ecountv5/static/contents/js/lib/tslib.js",r+"/ecountv5/static/contents/js/lib/velox.polyfill.js",];require(u,function(){function u(){return fetch(s+"/static/ecountv5/version/version.app.json?"+(new Date).getTime(),{credentials:"include"}).then(function(n){return n.json()}).then(function(n){return n}).catch(function(n){i(n)})}u().then(function(u){fetch(r+"/ecountv5/version/ecount.browser.framework/modules/version.ecount.browser.framework."+u["version.ecount.browser.framework"]+".json",{credentials:"include"}).then(function(n){return n.json()}).then(function(f){var o=e?"-debug":"",s=f["ecount.browser.framework"];require(r+"/ecountv5/modules/ecount.browser.framework/ecount.browser.framework."+s+o+".js",function(){if(window.ecount_browser_framework.ModuleLoader){var f=new window.ecount_browser_framework.ModuleLoader;f.setConfig({versionMap:u,language:t.Language,isDevMode:e,rootPath:r,modulePath:h,versionPath:c,resourcePath:l});f.loader={json:function(n){return fetch(n,{credentials:"include"}).then(function(n){return n.json()}).then(function(n){return n})},asset:function(n){return Array.isArray||(n=[n]),new Promise(function(t){require(n,function(){t()})})}};f.loadV5Core().then(function(){return f.loadV5BrowserApp()}).then(function(){a();n(window.v5.application)}).catch(function(n){i(n)})}else window.ecount_browser_framework.LOAD_APP_DEPENDENCIES(u,r,e,t.Language).then(function(){a();n(window.v5.application)})})}).catch(function(n){i(n)})}).catch(function(n){i(n)})},function(n){i(n)});return}})},isEcountMxDns:function(t){if(n.isEmpty(t))return!1;return/wmx.(?:ecount|ecounterp).com/ig.test(t)?!0:!1},isEcountTxtDns:function(t){if(n.isEmpty(t))return!1;return/v=spf1 mx include:spf.(?:ecount|ecounterp).com ~all/ig.test(t)?!0:!1}});n.extend(ecount.abstract,{report:{common:{getNewId:function(n){return n=n||this.prefixId||"",ecount.common.uuid(n)}},convertShape:{convertAllShapeInOuterHTML:function(){}},actionInstance:{getItem:function(t,i,r){if(!t)return null;var f=t.getDataProperty("controlType"),u=this.getActionInstance(f,null,r);return u?(r=n.extend({actionInstanceManager:this.actionInstanceManager,instanceManager:this.instanceManager},r||{}),i||(i={}),i=_.extend(i,{areaDivisionCalculation:"each"}),u.setConfig(_.extend(this.getDefaultConfig(),i)),this.isResetCanvasBoundingClientRect(f)&&(u.resetCanvasBoundingClientRect(),this.setResetCanvasBoundingClientRect(!1,f)),u.setLineHandlerPool(this._lineHandlerPool),u.setEntity(r.entity||t),u.setParentId(t.parentId),u.setChildren(t.children),u.setCanvas(this.$wrapperEl||this.$canvas),u.setParent(t.getDataProperty("container")),u.set$El(t.getDataProperty("el")),u.setTableStructure&&u.setTableStructure(r.instanceManager.tableStructure,r),u.setTableResize&&u.setTableResize(r.instanceManager.tableResize),u.setTableSelector&&u.setTableSelector(r.instanceManager.tableSelector),u.bindTextContainerMousedown&&u.bindTextContainerMousedown(),u.bindTextContainerDBLClick&&u.bindTextContainerDBLClick(),u.bindTextContainerFocusout&&u.bindTextContainerFocusout(),u.bindTextContainerDragStart&&u.bindTextContainerDragStart(),u):null},getFormItem:function(n,t,i){return this.formActionInstanceManager||(this.formActionInstanceManager={}),i=i||{},i.actionInstanceManager=this.formActionInstanceManager,i.instanceManager=_.extend(this.formInstanceManager,{tableSelector:this.instanceManager.tableSelector}),this.getItem(n,t,i)},getTempItem:function(n,t,i){return this.tempActionInstanceManager||(this.tempActionInstanceManager={}),this.tempInstanceManager||(this.tempInstanceManager={}),i=i||{},i.actionInstanceManager=this.tempActionInstanceManager,i.instanceManager=this.tempInstanceManager,i.entity=this.entityTree.getEntityById(n.id),this.getItem(n,t,i)},getActionInstanceInitializeData:function(){return{ecPath:this.ecPath,ecIKey:this.ecIKey,ecPageID:this.ecPageID,delegator:this.events,canvasSelector:"#"+this.id,stageSelector:this.config.stageSelector,scrollContainerSelctor:".wrapper-report-stage",_global:this._global,_doc:this._doc,_selection:this._selection,_node:this._node,_range:this._range,_cursor:this._cursor,_font:this._font,_clipbaord:this._clipboard,_bookmark:this._bookmark,_rangeApi:this._rangeApi,_nodeApi:this._nodeApi}},setResetCanvasBoundingClientRect:function(n,t){var r,u,f,i;if(this.config||(this.config={}),this.config.shapeConfig||(this.config.shapeConfig={}),arguments.length===1)for(r in this.config.shapeConfig)this.config.shapeConfig.hasOwnProperty(r)&&(this.config.shapeConfig[r].resetCanvasBoundingClientRect=n);else{if(u=t&&t.split&&t.split("."),!u)return null;f=u.pop();i=this.reportConstValue.shapeType[f];this.config.shapeConfig[i]||(this.config.shapeConfig[i]={});this.config.shapeConfig[i].resetCanvasBoundingClientRect=n}},isResetCanvasBoundingClientRect:function(n){var t,r,i;return(this.config||(this.config={}),this.config.shapeConfig||(this.config.shapeConfig={}),t=n&&n.split&&n.split("."),!t)?null:(r=t.pop(),i=this.reportConstValue.shapeType[r],this.config.shapeConfig[i]===void 0)?!0:this.config.shapeConfig[i].resetCanvasBoundingClientRect},getActionInstance:function(t,i,r){var s,u,f,e,o,h;if((r=n.extend({actionInstanceManager:null,instanceManager:null},r||{}),this.actionInstanceManager||(this.actionInstanceManager={}),this.instanceManager||(this.instanceManager={}),actionInstanceManager=r.actionInstanceManager||this.actionInstanceManager,instanceManager=r.instanceManager||this.instanceManager,ecount)&&ecount.report&&ecount.report.shape){if(s=t&&t.split&&t.split("."),!s)return null;if(u=s.pop(),f=u+"ActionInstance",!actionInstanceManager[f]&&ecount.report.shape[u]&&(e=this.getActionInstanceInitializeData(),i&&(e=n.extend(e,i)),o=this.config.inputMode==this.reportConstValue.inputMode.viewNEdit?"View":this.config.inputMode==this.reportConstValue.inputMode.editNView?"Edit":"",this.reportConstValue.shapeType[u]?ecount.report["shape"+o]&&ecount.report["shape"+o][u]&&(actionInstanceManager[f]=new ecount.report["shape"+o][u].action(e,this.events)):actionInstanceManager[f]=new ecount.report.shape[u].action(e,this.events),u=="table")){if(!instanceManager.tableStructure){h=new ecount.events(this);h.on({"shape.createUniqueId":function(){return this.createUniqueId(this.tableRowPrefixId)}.bind(actionInstanceManager[f]),"shape.getMakeRawTd":function(n){return n=n===void 0?{}:n,_.isBoolean(n.isManagedShape)||(n.isManagedShape=this.config.isManagedShape),this.getMakeRawTd(n.rowId,n.columnIndex,n.isManagedShape)}.bind(actionInstanceManager[f])});instanceManager.tableStructure=new ecount.report.table.structure(h)}this.config.mode==this.reportConstValue.mode.edit&&(instanceManager.tableSelector||(instanceManager.tableSelector=new ecount.report.table.selector))}return this.config&&this.config.shapeConfig&&this.config.shapeConfig[t]||this.setResetCanvasBoundingClientRect(!0,t),actionInstanceManager&&actionInstanceManager[f]}}},config:{getDefaultConfig:function(t){t=n.extend({removeAttr:!1,removeStyle:!1},t||{});var i={ecPageID:this.ecPageID||this.config.ecPageID,mode:this.config.mode,inputMode:this.config.inputMode,id:null,scrollContainer:this.scrollContainer||this.config.scrollContainer,eventContainer:this.eventContainer||this.config.eventContainer,eventContainerBoundingClientRect:this.eventContainerBoundingClientRect||function(n){var t=n.eventContainer||n.config.eventContainer;return t?(n.config.eventContainerBoundingClientRect=t[0].getBoundingClientRect(),n.config.eventContainerBoundingClientRect):{}}(this),savedCursorInfo:this.config.savedCursorInfo,html:"",placeHolder:null,isOldHTML:!1,isVisibleMove:!1,textContainerClass:null,wrapperContentStyle:null};return t.removeAttr||(i.attr={id:null}),t.removeStyle||(i.style={}),i},getDefaultShapeConfig:function(t){var i={shape:{}};return i.shape=n.extend(!0,i.shape,this.shape),t&&n.extend(!0,i,t)||i},getServiceKey:function(n,t){return ecount.common.makeServiceKey(n,t)}},event:{},keyboard:{setCursor:function(){var n=this.entityTree.getEntityById(this.$el.attr("id"));if(!n)return!1;switch(n.controlType){}},forwardCursor:function(n){var t=this.entityTree.getEntityById(n),i,r;if(t)return!1;switch(t.controlType){case this.reportConstValue.shapeType.rectangle:return t.children&&t.children.some(function(n){var t=this.entityTree.getEntityById(n);if([this.reportConstValue.shapeType.rectangle,this.reportConstValue.shapeType.textbox,this.reportConstValue.shapeType.table].contains(i.controlType))return i=t,!0}.bind(this)),i?(r=this.getById(i.id),!r)?!1:r.setCursor():!1}t.children&&entitiy.children.length},backwardCursor:function(){}},util:{getElementSize:function(n){return{width:n.offsetWidth,height:n.offsetHeight}},getElementPoint:function(n,t,i,r,u){var f=ecount.common.getScreenPosition(n,t,i,r);return u&&(f.top+=parseFloat(u.style.top||0),f.left+=parseFloat(u.style.left||0),f.y=f.top,f.x=f.left),f},getCommand:function(n,t){var i="on."+t;return ecount.common.getCamelCase(i)},appendZWSAtInOut:function(n,t){var r,i,u,f,o,e;if((t=t||{isAppendSelf:!1,isAppendParent:!1,isAppendChild:!1},r=this.entityTree.getEntityById(n),r)&&(i=r.$el[0],t.isAppendSelf&&i.childNodes.length==0&&this._node.appendZWS(i),i.previousSibling?this._node.isText(i.previousSibling)&&this._node.getText(i.previousSibling).length==0&&this._node.appendZWS(i.previousSibling):this._node.insertBefore(this._doc.createZWSPElement(),i),i.nextSibling?this._node.isText(i.nextSibling)&&this._node.getText(i.nextSibling).length==0&&this._node.appendZWS(i.nextSibling):this._node.insertAfter(this._doc.createZWSPElement(),i),t.isAppendParent&&r.parentId&&(u=this.entityTree.getEntityById(r.parentId),u&&u.parentId&&this.appendZWSAtInOut(u.id,{isAppendSelf:!1,isAppendParent:!0,isAppendChild:!1})),t.isAppendChild&&r.children))for(f=0,o=r.children.length;f<o;f++)e=this.entityTree.getEntityById(r.children[f]),e&&this.appendZWSAtInOut(e.id,{isAppendSelf:!1,isAppendParent:!1,isAppendChild:!0})},removeZWSAtInOut:function(n,t){var r,i,u,f,o,e;if((t=t||{isRemoveSelf:!1,isRemoveParent:!1,isRemoveChild:!1},r=this.entityTree.getEntityById(n),r)&&(i=r.$el[0],t.isRemoveSelf&&i.childNodes.length==0&&this._node.appendZWS(i),i.previousSibling?this._node.isText(i.previousSibling)&&this._node.getText(i.previousSibling).length==0&&this._node.appendZWS(i.previousSibling):this._node.insertBefore(this._doc.createZWSPElement(),i),i.nextSibling?this._node.isText(i.nextSibling)&&this._node.getText(i.nextSibling).length==0&&this._node.appendZWS(i.nextSibling):this._node.insertAfter(this._doc.createZWSPElement(),i),t.isAppendParent&&r.parentId&&(u=this.entityTree.getEntityById(r.parentId),u&&u.parentId&&this.appendZWSAtInOut(u.id,{isRemoveSelf:!1,isRemoveParent:!0,isRemoveChild:!1})),t.isAppendChild&&r.children))for(f=0,o=r.children.length;f<o;f++)e=this.entityTree.getEntityById(r.children[f]),e&&this.appendZWSAtInOut(e.id,{isRemoveSelf:!1,isRemoveParent:!1,isRemoveChild:!0})},getFullPathToBefore:function(t,i){for(var u=[],f,r,e;t=t.parentElement;){if(t.classList.contains(i))break;f=n(t);switch(t.tagName){case"DIV":t.getAttribute("data-controltype")&&u.unshift({id:t.getAttribute("id")});break;case"TD":case"TH":r=f.closest("[data-controltype]");r&&r.length&&(e=f.closest("thead, tbody, tfoot"),u.unshift({id:r.attr("id"),sectionType:e[0].tagName.toLowerCase(),sectionIndex:ecount.common.findChildIndex(r[0],e[0]),columnId:t.getAttribute("data-columnid"),rowId:t.getAttribute("data-key")}))}}return u}}}})}(jQuery);window.__ecPageInvoke=function(){var f,n,i,e;if(arguments.length>1){var r=Array.prototype.slice.call(arguments,0),t=r.shift(),o=r.shift(),u;$.isPlainObject(t)&&(f=$.extend({},t),t=f.PopupID,u=f.__ecPageID);n=window[ecount.page.prefix+t];n||(i=window.__ecOriginWindow[t],i&&(n=i[i.ecPageID||i.__ecPageID]));n||$.isEmpty(u)||(n=window[ecount.page.prefix+u]);n||(n=ecount.global.findPageInstance(t),n||(e=window.__ecOriginWindow[t],e&&(n=e.ecount.global.findPageInstance(t))));n&&n[o]&&n[o].apply(n,r)}},function(n){var t=ecount.common.createNamespace("ecount.infra");n.extend(t,{url:"/Common/Form/GetFormView",configMap:{"config.account":"/Common/Infra/GetConfigAccount","config.inventory":"/Common/Infra/GetConfigInventory","config.groupware":"/Common/Infra/GetConfigGroupware","config.company":"/Common/Infra/GetConfigCompany","config.user":"/Common/Infra/GetConfigUser","config.limited.feature":"/Common/Infra/GetConfigLimitedFeature","config.limited.menu":"/Common/Infra/GetConfigLimitedMenu","config.nation":"/Common/Infra/GetConfigNation",company:"/Common/Infra/GetCompany",user:"/Common/Infra/GetUser"},cacheEraNameMaps:new n.HashMap,getForm:function(t,i){var r,u={FormType:null,FormSeq:null,FormTypeMaster:null,ReturnType:null,BasicType:null,IsConvertColumnCode:null,ViewType:null},f;return u=n.extend({},u,t||{}),f={url:this.url,async:t.async===!1?!1:!0,data:Object.toJSON(u),success:function(n){r=n.Data;t.callback&&t.callback(r)}},i===!0?f:(ecount.common.api(f),r)},getFormList:function(t,i){var r,u;return t=n.extend({},{formType:null,isShowBasicForm:null},t||{}),u={url:"/Common/Infra/GetFormAllowList",async:t.async===!1?!1:!0,data:Object.toJSON(t),success:function(n){r=n.Data;t.callback&&t.callback(r)}},i===!0?u:(ecount.common.api(u),r)},getCommonCode:function(t,i){var r,u=t,e,f;return n.isArray(t)||(u=[],u.push(t.toString())),e={CODE_CLASS:u},f={url:"/Common/Infra/GetListCommonCode",async:t.async===!1?!1:!0,data:Object.toJSON(e),success:function(n){r=n.Data;t.callback&&t.callback(r)}},i===!0?f:(ecount.common.api(f),r)},getConfig:function(n,t){var i=ecount.common.createNamespace("ecount."+n);ecount.configStorage.init(i,{domain:n,url:"/Common/Infra/GetListMultipleConfig",callback:t})},getPageWidthFromConfig:function(t){var r=ecount.getParentFrame(window),i=parseInt(n(ecount.parentFrame).innerWidth(),10)-10;return Math.min(750,i)+(t?45:30)},getMinimnumWidthOfForm:function(n){switch(n){case 4:case"4":return 1330;case 3:case"3":return 950;case 2:case"2":return 640;default:return 320}},convertPdf:function(n,t,i,r){fnPdfBeta(n,t,i,r)},convertExcel:function(n,t,i){ecount.common.isIOS||ExcelPageMovement(n,t,i||{})},optimization:function(n){var t=navigator.userAgent.toLowerCase(),i="";if(navigator.appName=="Netscape"&&navigator.userAgent.search("Trident")!=-1||t.indexOf("msie")!=-1)i=location.href.indexOf("http://")>-1?"http://s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountRegSet.exe":"https://s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountRegSet.exe";else if(t.indexOf("chrome")>-1&&t.indexOf("opr")==-1)i=location.href.indexOf("http://")>-1?"http://s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountChromeSet.exe":"https://s3.ap-northeast-2.amazonaws.com/ec.guide-p/Download/IE_Opt/EcountChromeSet.exe";else{alert(getResource("LBL09996",strSelLanType));return}ecount.document.downloadFile({ecPageID:n,downloadURL:i})},preview:function(n,t){getPreviewPrint(n,t)},previewBarCode:function(n,t,i){getPreviewBarCodePrint(n,t,i)},print:function(n,t){printURL2("",n,t)},openMultiManualNotice:function(t){var r=ecount.common.buildSessionUrl("/ECERP/SVC/EAM/EAM012M"),u={boardType:t.boardType,prgid:t.programId,mpType:!n.isEmpty(t.mpType)&&t.mpType?t.mpType:"",OPEN_TARGET:"NOTICE"},i,e,f;if(n.isEmpty(t.seq)||(u.seq=t.seq),i=t.noticeData?n.decryptJson(t.noticeData):{},i&&i.MANUAL_SEQ&&(u.BLTN_SNO=i.MANUAL_SEQ),i&&i.SEQ&&(u.MPPG_SNO=i.SEQ),r+="&ReqeustJson="+encodeURIComponent(Object.toJSON(u)),t.boardType.equals("C"))ecount.router.go({url:r});else switch(t.windowType){case"U":case"2":e=setTimeout("window.open('"+r+"', 'menuNotice', 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600')",200);break;case"P":ecount.router.go({url:r});break;case"T":f=function(i){var f=String.format("{0}{1}",i.WINDOW_TYPE,i.MANUAL_SEQ),r,u;if(n.cookie(String.format("MENUNOTICE_{0}_{1}",t.programId,i.SEQ))!="done"&&!n.isEmpty(f)&&n.cookie(f)!="done")return r="notification-warning",textcss="text-warning",i.POINT_COLOR=="R"?(r="notification-danger",textcss="text-danger"):i.POINT_COLOR=="G"?(r="notification-success",textcss="text-success"):i.POINT_COLOR=="B"&&(r="notification-info",textcss="text-info"),u={notiType:"1",css:r,textCss:textcss,title:i.TITLE,content:i.TXT,menuSeq:t.programId,NOTICE_OPEN_FLAG:i.NOTICE_OPEN_FLAG,popName:String.format("MENUNOTICE_{0}_{1}",t.programId,i.SEQ),isDisplay:!0,cookieExpire:i.BUTTON_CHK2=="Y"?1:30,cookieName:String.format("{0}{1}",i.WINDOW_TYPE,i.MANUAL_SEQ),CNNT_CONTENTS_CLASS:i.CNNT_CONTENTS_CLASS||"C",INFO_CONTENS_CLASS:i.INFO_CONTENS_CLASS||"M",NOTICE_INFO_DATA:i,BLTN_SNO:i.MANUAL_SEQ},ecount.popup?ecount.popup.parent.window.ecount&&ecount.popup.parent.window.ecmodule.navigation&&ecount.popup.parent.window.ecmodule.navigation.drawNotification(u):ecount.parentFrame&&ecount.parentFrame.ecount&&ecount.parentFrame.ecmodule.navigation&&ecount.parentFrame.ecmodule.navigation.drawNotification(u),!1};t.noticeData?f.call(this,n.decryptJson(t.noticeData)):ecount.common.api({ecPageID:t.ecPageID,url:"/SVC/Common/Infra/GetNoticeViewtByPrgIdEcMppgNotice",data:Object.toJSON({prg_Id:t.programId}),async:!1,success:function(n){n&&n.Data&&f.call(this,n.Data)}.bind(this)})}},openMultiManualNoticeForMany:function(t){for(var u,r,o,e,f=ecount.common.buildSessionUrl("/ECERP/SVC/EAM/EAM012M"),i=0;i<t.length;i++)if(u={boardType:t[i].boardType,prgid:t[i].programId,mpType:!n.isEmpty(t[i].mpType)&&t[i].mpType?t[i].mpType:"",OPEN_TARGET:"NOTICE"},n.isEmpty(t[i].seq)||(u.seq=t[i].seq),r=t[i].noticeData?n.decryptJson(t[i].noticeData):{},r&&r.MANUAL_SEQ&&(u.BLTN_SNO=r.MANUAL_SEQ),r&&r.SEQ&&(u.MPPG_SNO=r.SEQ),f+="&ReqeustJson="+encodeURIComponent(Object.toJSON(u)),t[i].boardType.equals("C"))ecount.router.go({url:f});else switch(t[i].windowType){case"U":case"2":o=setTimeout("window.open('"+f+"', 'menuNotice', 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600')",200);break;case"P":ecount.router.go({url:f});break;case"T":e=function(r){var e=String.format("{0}{1}",r.WINDOW_TYPE,r.MANUAL_SEQ),u,f;if(n.cookie(String.format("MENUNOTICE_{0}_{1}",t[i].programId,r.SEQ))!="done"&&!n.isEmpty(e)&&n.cookie(e)!="done")return u="notification-warning",textcss="text-warning",r.POINT_COLOR=="R"?(u="notification-danger",textcss="text-danger"):r.POINT_COLOR=="G"?(u="notification-success",textcss="text-success"):r.POINT_COLOR=="B"&&(u="notification-info",textcss="text-info"),f={notiType:"1",css:u,textCss:textcss,title:r.TITLE,content:r.TXT,menuSeq:t[i].programId,NOTICE_OPEN_FLAG:r.NOTICE_OPEN_FLAG,popName:String.format("MENUNOTICE_{0}_{1}",t[i].programId,r.SEQ),isDisplay:!0,cookieExpire:r.BUTTON_CHK2=="Y"?1:30,cookieName:String.format("{0}{1}",r.WINDOW_TYPE,r.MANUAL_SEQ),CNNT_CONTENTS_CLASS:r.CNNT_CONTENTS_CLASS||"C",INFO_CONTENS_CLASS:r.INFO_CONTENS_CLASS||"M",NOTICE_INFO_DATA:r,BLTN_SNO:r.MANUAL_SEQ},t[i].programId=="CSA011M"?window.setTimeout(function(){this.drawNotificationForManyCs(f)}.bind(this),100):ecount.popup?ecount.popup.parent.window.ecount&&ecount.popup.parent.window.ecmodule.navigation&&ecount.popup.parent.window.ecmodule.navigation.drawNotificationForMany(f):ecount.parentFrame&&ecount.parentFrame.ecount&&ecount.parentFrame.ecmodule.navigation&&ecount.parentFrame.ecmodule.navigation.drawNotificationForMany(f),!1};t[i].noticeData?e.call(this,n.decryptJson(t[i].noticeData)):ecount.common.api({url:"/SVC/Common/Infra/GetNoticeViewtByPrgIdEcMppgNotice",data:Object.toJSON({prg_Id:t[i].programId}),async:!1,success:function(n){n&&n.Data&&e.call(this,n.Data)}.bind(this)})}},drawNotificationForManyCs:function(t){var p=this,y;if(t.notiType==1&&n("#Notice_List").find("#MENULIST_"+t.popName).length>0&&n("#Notice_List").find("#MENULIST_"+t.popName).remove(),t.notiType==27&&n("#Notice_List").find("#MENULIST_ECA011M").length>0&&n("#Notice_List").find("#MENULIST_ECA011M").remove(),t.isDisplay==!0){var w=["notification","notification-primary","animated","bounceInUp",t.css],e="",o="";o=t.isShowCloseButton?"<button class='close'><\/button>":["<a href='javascript:;'>",viewBag.Resource[[1,7].contains(t.cookieExpire)?"LBL01932":"LBL01039"],"<\/a>"].join("");t.closeButtonDropDownResource&&(e=["<ul class='dropdown-menu'>","<li class='dropdown-menu-text'>",viewBag.Resource[t.closeButtonDropDownResource],"<\/li>","<\/ul>"].join(""));var s=["<div class='notification-close'>",o,e,"<\/div>"],h=["<div class='notification-heading'>",t.title,"<\/div>"],c=[String.format("<div class='{0}' id='MENULIST_{1}'>",w.join(" "),t.popName),"<div class='notification-icon'><\/div>",t.isShowCloseButton?s.join(""):h.join(""),t.isShowCloseButton?h.join(""):s.join(""),"<\/div>"],i=n(c.join(""));i.data("NOTI_TYPE",t.notiType).data("NOTI_SEQ",t.NOTI_SEQ).data("MANU_SEQ",t.MANU_SEQ).data("LINK_SEQ",t.NOTICE_INFO_DATA&&t.NOTICE_INFO_DATA.LINK_SEQ).data("MANUAL_SEQ",t.NOTICE_INFO_DATA&&t.NOTICE_INFO_DATA.MANUAL_SEQ).data("URL",t.url).data("WIDTH",t.width).data("HEIGHT",t.height).data("POP_NAME",t.popName).data("COOKIE_EXPIRE",t.cookieExpire).data("COOKIE_NAME",t.cookieName||t.popName).data("ADD_INFO",t.addInfo);n("#Notice_List").append(i);i.click(function(){p.openNoticePopUpCs(n(this))});i.find(".notification-close > button.close").click(function(t){t.stopPropagation();n(this).parent().parent().removeClass("bounceInUp").addClass("bounceOutRight").delay(500).fadeOut(1)});i.find(".notification-close > a").click(function(t){var i;t.stopPropagation();var f=n(this).parent().parent().data("POP_NAME"),c=n(this).parent().parent().data("COOKIE_NAME"),l=n(this).parent().parent().data("COOKIE_EXPIRE"),a=function(n,t,i){var r=new Date;r.setDate(r.getDate()+i);document.cookie=n+"="+escape(t)+"; path=/; expires="+r.toGMTString()+";"};a(c||f,"done",l||30);n(this).parent().parent().removeClass("bounceInUp").addClass("bounceOutRight").delay(500).fadeOut(1);var e=n("#ecNotification"),r=e.find("#ecNotificationList"),o=e.find("#ecNotificationCount"),u=n("span[data-origin=ecNotificationCount]");if(r.find("#MENULI_"+f).remove(),i=parseInt(u.text()||"0"),i--,o.empty().append(i),u.empty().append(i),i==0)if(o.addClass("hidden"),u.addClass("hidden"),r.find("#noNotification").length>0)r.find("#noNotification").removeClass("hidden");else{var s=n("<li id='noNotification'>"),v=n("<a>").attr("href","javascript:;"),h=n("<span>");v.append(viewBag.Resource.LBL10414).appendTo(h);s.append(h);r.append(s)}});i.find(".notification-close > .dropdown-menu > .dropdown-menu-text").click(function(n){n.stopPropagation()})}if(["1","16"].contains(t.notiType)){n("#Notice_Contents").find("#MENUCONTENT_"+t.popName).remove();var c=[String.format("<div class='notification animated hidden {0}' id='MENUCONTENT_{1}'>",t.css,t.popName),"<div class='notification-close'><button class='close'><\/button><\/div>","<div class='notification-heading'>",t.title,"<\/div>","<\/div>"],r=n(c.join("")),u=n("<div>").addClass("notification-contents");if((t.CNNT_CONTENTS_CLASS||"C")=="C"&&(["V","F"].contains(t.INFO_CONTENS_CLASS||"M")||["M"].contains(t.INFO_CONTENS_CLASS||"M")&&_.get(t.NOTICE_INFO_DATA,"URL"))){var l=n("<div>").addClass("wrapper-toolbar article-attached-file").css({textAlign:"left"}),a=n("<ul>"),v=n("<li>").addClass("attached-movie"),f=n('<a data-trigger="hover" data-container="body" data-toggle="popover">').attr("href","javascript:;").popover({content:t.NOTICE_INFO_DATA&&t.NOTICE_INFO_DATA.SCENARIO_NM_GL?t.NOTICE_INFO_DATA.SCENARIO_NM_GL:"",container:n("#Notice_Contents"),placement:"auto",trigger:"hover",html:!0,delay:{show:ecount.common.mouseHoverInTime,hide:ecount.common.mouseHoverOutTime}});f.append(String.format("{0}",t.title));this.openVideo&&f.on("click",this.openVideo.bind(this,{mppgSno:t.NOTICE_INFO_DATA?t.NOTICE_INFO_DATA.SEQ:0,bltnSno:t.BLTN_SNO?t.BLTN_SNO:t.NOTICE_INFO_DATA?t.NOTICE_INFO_DATA.MANUAL_SEQ:0}));v.append(f);a.append(v);l.append(a);u.append(l)}else u.html(t.content);r.append(u);y=n("#Notice_Contents");y.append(r);t.NOTICE_OPEN_FLAG=="O"&&(n(".wrapper-notification.main > .notification").removeClass("bounceInUp").addClass("hidden fadeOut").fadeOut(1),n(".wrapper-notification.main > .notification-custom").removeClass("bounceInUp").addClass("hidden fadeOut").fadeOut(1),n(".wrapper-notification.main > #MENUCONTENT_"+t.popName).show().removeClass("hidden fadeOut").addClass("bounceInUp"));r.find(".notification-close > button.close").click(function(){n(this).parent().parent().removeClass("bounceInUp").addClass("fadeOut").delay(500).fadeOut(1)})}},openNoticePopUpCs:function(t){var h,u,i,o;h=ecount.company&&ecount.company.FOREIGN_YN||"00";u=t.data("NOTI_TYPE");switch(u){case"1":var f=t.data("MANUAL_SEQ"),e=t.data("LINK_SEQ"),r=!1;window.requestUrl.isApollo||window.requestUrl.isTest?(f==18448||e==3462)&&(r=!0):(f==19425||e==3522)&&(r=!0);r==!0?(i={width:1024,height:800,responseID:this.callbackID,__ecPageID:this.ecPageID},ecount.popup.openWindow({url:"/ECERP/ECU/ECU600M",name:ecount.resource.LBL10715,param:i,popupType:!1})):(n(".wrapper-notification.main > .notification").removeClass("bounceInUp").addClass("hidden fadeOut").fadeOut(1),n(".wrapper-notification.main > .notification-custom").removeClass("bounceInUp").addClass("hidden fadeOut").fadeOut(1),o=t.data("POP_NAME"),n(".wrapper-notification.main > #MENUCONTENT_"+o).show().removeClass("hidden fadeOut").addClass("bounceInUp"));break;default:var c=ecount.common.buildSessionUrl(t.data("URL")),l=t.data("WIDTH"),a=t.data("HEIGHT"),s=t.data("ADD_INFO"),i={width:l,height:a,responseID:this.callbackID,__ecPageID:this.ecPageID};n.isEmpty(s)||(i.Request={Data:JSON.parse(s)});ecount.popup.openWindow({url:c,name:t.data("TITLE"),param:i,popupType:t.data("NOTI_TYPE")=="5"?!0:!1,additional:!1})}},openFavorityAdd:function(t,i,r,u){ecount.popup.openWindow("/ECERP/Popup.Common/CM400P_01",ecount.resource.LBL09437,n.extend({width:500,height:270,parentPageID:r,responseID:i},t||{}),u)},getAutoCodeItems:function(t,i){var r={CodeType:[42,43,62]},u,f;return r=n.extend({},r,t||{}),f={url:"/SelfCustomize/Config/GetListAutoCodeItem",async:t.async===!1?!1:!0,data:Object.toJSON(r),success:function(n){u=n.Data;t.callback&&t.callback(u)}},i===!0?f:(ecount.common.api(f),u)},getAutoCodeRepeatCdForViewWithList:function(t,i){var r={IsView:!0,CodeType:0,IoDate:"",AutoCodeEditType:ecenum.autoCodeEditFlag.none,UpLoadYn:ecenum.useYn.none,RepeatCd:"",RepeatCd1:"",RepeatCd2:"",RepeatCd3:""},u,f;return r=n.extend({},r,t||{}),f={url:"/SelfCustomize/Config/GetAutoCodeRepeatCdForViewWithList",async:t.async===!1?!1:!0,data:Object.toJSON(r),success:function(n){u=n.Data;t.callback&&t.callback(u)}},i===!0?f:(ecount.common.api(f),u)},checkEnableSendSmsBySvc:function(n,t){n.push({apiUrl:"/SVC/Common/Infra/CheckEnableSendBySms",authBusinessLicensePopupURL:"/ECErp/SVC/Popup/EGA008M",authPopupURL:"/ECErp/SVC/Popup/EGA008P_05"});this.checkEnableSendSms.apply(t,n)},checkEnableSendSms:function(){var o=arguments[0],i=arguments[1],r=arguments[2],s=JSON.stringify({CALLER:o}),t=!1,u={width:660,height:470},f="",a="?ec_req_sid="+window.requestUrl.param.ec_req_sid,h=this,c=r&&r.apiUrl||"/Common/Infra/CheckEnableSendBySms",l=r&&r.authBusinessLicensePopupURL||"/ECErp/Popup.Common/EGA008M",e=r&&r.authPopupURL||"/ECErp/Popup.Common/EGA008P_05";ecount.common.api({ecPageID:this.ecPageID,url:c,data:s,success:function(r){if(r.Status=="200")switch(r.Data.ERROR_CODE){case"E000":t=!0;i(t,r.Data.CALLER);break;case"":case"E001":ecount.alert(ecount.resource.MSG05624,function(){i(t)});break;case"E002":ecount.confirm(ecount.resource.MSG05619,function(n){n===!0?(this.openWindow({url:l,param:u,popupType:!0}),i(t)):i(t)}.bind(this));break;case"E003":ecount.confirm(String.format(ecount.resource.MSG05636,r.Data.CALLER),{height:320,callback:function(o){o?(f=e,n.extend(u,{DirectOpen:"Y",Caller:r.Data.CALLER}),this.openWindow({url:f,param:u,popupType:!1}),i(t)):i(t)}.bind(this)});break;case"E004":ecount.confirm(ecount.resource.MSG05637,function(n){n?(f=e,this.openWindow({url:f,param:u,popupType:!1}),i(t)):i(t)}.bind(this));break;case"E009":case"E010":ecount.confirm(String.format(ecount.resource.MSG05652,r.Data.CALLER),function(o){o&&(f=e,n.extend(u,{DirectOpen:"Y",Caller:r.Data.CALLER,Status:"C",AuthType:"1"}),this.openWindow({url:f,param:u,popupType:!1}),i(t))}.bind(this));break;case"E999":ecount.alert(ecount.resource.LBL033064,function(){i(t)})}}.bind(h)})},checkIsDemoUser:function(){var n=ecount.config.company.COM_CODE;return isNaN(parseInt(n))&&["G1080","G2180","G0321","G2080","G2050","G2070","G7021","G8021","G9021","G1011","G1121"].contains(n.toUpperCase())},checkIsAvailableForDemoUser:function(n){return ecount.infra.checkIsDemoUser()&&!n?(ecount.alert(ecount.resource.MSG70726),!1):!0},getGroupwarePermissionByPopup:function(t,i,r){var u={};return u.IsGroupWareFree=t,u.GroupWarePermission=i,u.ecPageID=r,u.InfoFunction=function(){var n={width:ecount.infra.getPageWidthFromConfig(),height:400,modal:!1};ecount.popup.openWindow({url:"/ECERP/Popup.Common/EGM024P_01",name:ecount.resource.LBL12306,param:n,popupType:!1,additional:!1})},u.ExcessFunction=function(){ecount.popup.openWindow({url:"/ECERP/Popup.Common/EGM024P_02",name:ecount.resource.LBL12308,param:{width:550,height:450,modal:!1},popupType:!1,additional:!0})},u.Remain100Function=function(){ecount.popup.openWindow({url:"/ECERP/Popup.Common/EGM024P_02",name:ecount.resource.LBL12308,param:{width:550,height:450,modal:!1,IsMoreCheckbox:!0},popupType:!1,additional:!0})},{SetInfoFunction:function(n){return arguments.length>0&&(u.InfoFunction=n),this},SetExcessFunction:function(n){return arguments.length>0&&(u.ExcessFunction=n),this},SetRemain100Function:function(n){return arguments.length>0&&(u.Remain100Function=n),this},Excute:function(t){var i=!0,r={IsGroupWareFree:u.IsGroupWareFree};if(n.isEmpty(u.GroupWarePermission))ecount.common.api({ecPageID:u.ecPageID,url:"/Groupware/File/CheckFileSize",data:r,success:function(n){if(n.Status=="200"){u.GroupWarePermission=n.Data.ResultType;switch(u.GroupWarePermission){case"Info":u.IsGroupWareFree?i=!0:(u.InfoFunction(),i=!1);break;case"Excess":u.ExcessFunction();i=!1;break;case"Remain100":i=!0}t&&t({locationAllow:i,GroupWarePermission:u.GroupWarePermission})}}.bind(this)});else{i=!1;switch(u.GroupWarePermission){case"Info":u.InfoFunction();break;case"Excess":u.ExcessFunction();break;case"Remain100":u.Remain100Function()}t&&t({locationAllow:i,GroupWarePermission:u.GroupWarePermission})}}}},getGroupwarePermissionByAlert:function(n){var t={};return t.GroupWarePermission=n,t.NoUseNoFreeFunction=function(){ecount.alert(ecount.resource.MSG04479)},t.NoUseFreeFunction=function(){ecount.alert(ecount.resource.MSG04479)},t.ExpireDatePassByMasterFunction=function(){ecount.alert(ecount.resource.MSG04121)},t.ExpireDatePassByUserFunction=function(){ecount.alert(ecount.resource.MSG04121)},t.NoPermissionFunction=function(){ecount.alert(ecount.resource.MSG05805)},t.FileSizeExceedByMasterFunction=function(){},t.FileSizeExceedByUserFunction=function(){},t.FileSizeRemaining10Function=function(){},{SetNoUseNoFreeFunction:function(n){return arguments.length>0&&(t.NoUseNoFreeFunction=n),this},SetNoUseFreeFunction:function(n){return arguments.length>0&&(t.NoUseFreeFunction=n),this},SetExpireDatePassByMasterFunction:function(n){return arguments.length>0&&(t.ExpireDatePassByMasterFunction=n),this},SetExpireDatePassByUserFunction:function(n){return arguments.length>0&&(t.ExpireDatePassByUserFunction=n),this},SetNoPermissionFunction:function(n){return arguments.length>0&&(t.NoPermissionFunction=n),this},SetFileSizeExceedByMasterFunction:function(n){return arguments.length>0&&(t.FileSizeExceedByMasterFunction=n),this},SetFileSizeExceedByUserFunction:function(n){return arguments.length>0&&(t.FileSizeExceedByUserFunction=n),this},SetFileSizeRemaining10Function:function(n){return arguments.length>0&&(t.FileSizeRemaining10Function=n),this},Excute:function(){var n=!0;switch(t.GroupWarePermission){case"NOUSENOFREE":t.NoUseNoFreeFunction();n=!1;break;case"NOUSEFREE":t.NoUseFreeFunction();n=!1;break;case"EXPIREDATEPASSBYMASTER":t.ExpireDatePassByMasterFunction();n=!1;break;case"EXPIREDATEPASSBYUSER":t.ExpireDatePassByUserFunction();n=!1;break;case"NOPERMISSION":t.NoPermissionFunction();n=!1;break;case"EXPIREDATEPASSBYMASTER":t.FileSizeExceedByMasterFunction();break;case"FILESIZEEXCEEDBYUSER":t.FileSizeExceedByUserFunction();break;case"FILESIZEREMAINING10":t.FileSizeRemaining10Function()}return n}}},getVersionCheck:function(t){var i={Version_No:null,IO_DATE:null,IO_NO:null,IO_TYPE:null,UID:null,EDMS_FLAG:null,ResultData:null,EDMS_IDX:null,VoucherType:null},r;return i=n.extend({},i,t||{}),ecount.common.api({ecPageID:t.ecPageID,url:"/Common/Infra/CheckVersionManage",data:Object.toJSON(i),success:function(n){r=n.Data;t.callback&&t.callback(r,t)}}),r},getEraList:function(t){var i="";if(n.isNull(t)||n.isEmpty(t.GROUP_CD)?n.isNull(ecount.config.company.MYPAGECOMPANY_DATE)||(i=ecount.config.company.MYPAGECOMPANY_DATE.GROUP_CD_OUTPUT):i=t.GROUP_CD,!n.isEmpty(i))return n.isNull(ecount.config.company.ERA_LIST)?void 0:ecount.config.company.ERA_LIST.where(function(n){return n.GROUP_CD==i})},getEraYear:function(t){var u,i,r;return n.isNull(t)||n.isEmpty(t.YEAR)?(new Date).format("yyyy"):(u=String.format("{0}_{1}",t.GROUP_CD||"",t.YEAR),this.cacheEraNameMaps.has(u))?this.cacheEraNameMaps.get(u):(i=this.getEraList({GROUP_CD:t.GROUP_CD}),r=t.YEAR,n.isNull(i)||(i=i.last(function(n){return parseInt(n.BEGIN_YEAR)<=parseInt(t.YEAR)}),n.isNull(i)||(r=i.GROUP_CD==="00002"&&t.YEAR>=2020?(+(parseInt(t.YEAR)-parseInt(i.BEGIN_YEAR))+2).toString():i.GROUP_CD==="00003"?+(parseInt(t.YEAR)+1-parseInt(i.BEGIN_YEAR)).toString().substring(2):+(parseInt(t.YEAR)+1-parseInt(i.BEGIN_YEAR)).toString(),r=i.ERA_NM+r)),this.cacheEraNameMaps.set(u,r),r)},EcYear:["DATE01","DATE10","DATE11","DATE12","DATE13","DATE20","DEFAULT"],EcMonth:["DATE02","DATE10","DATE11","DATE12","DATE13","DATE20","DATE30","DATE31","DATE32","DATE33","DEFAULT"],EcDay:["DATE03","DATE10","DATE11","DATE12","DATE13","DATE30","DATE31","DATE32","DATE33","DEFAULT"],EcWeekday:["DATE04","DATE13","DATE33","DATE60","DEFAULT"],EcHour:["DATE05","DATE11","DATE12","DATE31","DATE32","DATE40","DATE50","DEFAULT"],EcMin:["DATE06","DATE11","DATE12","DATE31","DATE32","DATE40","DATE50","DEFAULT"],EcSec:["DATE07","DATE11","DATE31","DATE40","DEFAULT"],EcForm:/^(DATE7|DATE8)[0-9]/ig,getECDateFormat:function(t,i,r){var u=ecount.config.company.MYPAGECOMPANY_DATE,f=t.toUpperCase(),s,e,o;return f=="DATE16"||n.isEmpty(u)?(s=Date.CultureInfo.name.substring(0,2),r.format(f+"_"+s,r)):t.match(this.EcForm)?this.DateTimeFormTypeExecutor[t](u,f,i,r,this):(e=[],n.isEmpty(r)&&(r=new Date),o=u.DATETIME_ORDER.split(""),e.push(this.DateTimeOrderExecutor[o[0].toLowerCase()](u,f,i,r,this)),e.push(this.DateTimeOrderExecutor[o[1].toLowerCase()](u,f,i,r,this)),e.push(this.DateTimeOrderExecutor[o[2].toLowerCase()](u,f,i,r,this)),e.join(""))},DatetimeFormTypebExecutor:{DATE70:function(){},DATE71:function(){},DATE80:function(){},DATE81:function(){}},getCompanyDateFormat:function(n,t,i,r){var u=[],f=r?n.DATE_INPUT_ORDER.split(""):n.DATE_OUTPUT_ORDER.split("");return u.push(this.DateOrderExecutor[f[0].toLowerCase()](n,t,i,r,this)),u.push(this.DateOrderExecutor[f[1].toLowerCase()](n,t,i,r,this)),u.push(this.DateOrderExecutor[f[2].toLowerCase()](n,t,i,r,this)),u.join("")},getCompanyTimeFormat:function(t,i,r,u){var f=[],e=u?t.TIME_INTPUT_ORDER.split(""):t.TIME_OUTPUT_ORDER.split("");return!u&&n.inArray(i,this.EcHour)>-1&&t.HS_TYPE==1&&f.push(r.format("tt ")),f.push(this.TimeOrderExecutor[e[0].toLowerCase()](t,i,r,u,this)),f.push(this.TimeOrderExecutor[e[1].toLowerCase()](t,i,r,u,this)),u||f.push(this.TimeOrderExecutor[e[2].toLowerCase()](t,i,r,u,this)),!u&&n.inArray(i,this.EcHour)>-1&&t.HS_TYPE==2&&f.push(r.format(" tt")),f.join("")},DateTimeOrderExecutor:{d:function(t,i,r,u,f){var e=[];return(n.inArray(i,f.EcYear)>-1||n.inArray(i,f.EcMonth)>-1||n.inArray(i,f.EcDay)>-1)&&(e.push(t.DATE_FRONT_BLANK?" ":""),e.push(t.DATE_FRONT_CHAR),e.push(f.getCompanyDateFormat(t,i,u,r)),e.push(t.DATE_BACK_CHAR),e.push(t.DATE_BACK_BLANK?" ":"")),e.join("")},w:function(t,i,r,u,f){var e=[];return n.inArray(i,f.EcWeekday)>-1&&(e.push(t.WEEKDAY_FRONT_BLANK?" ":""),e.push(t.WEEKDAY_FRONT_CHAR),e.push(t.AWD_FLAG?u.format("ddd"):u.format("dddd")),e.push(t.WEEKDAY_BACK_CHAR),e.push(t.WEEKDAY_BACK_BLANK?" ":"")),e.join("")},t:function(t,i,r,u,f){var e=[];return(n.inArray(i,f.EcHour)>-1||n.inArray(i,f.EcMin)>-1||n.inArray(i,f.EcSec)>-1)&&(e.push(t.TIME_FRONT_BLANK?" ":""),e.push(t.TIME_FRONT_CHAR),e.push(f.getCompanyTimeFormat(t,i,u,r)),e.push(t.TIME_BACK_CHAR),e.push(t.TIME_BACK_BLANK?" ":"")),e.join("")}},DateOrderExecutor:{y:function(t,i,r,u,f){var e;return u?n.inArray(i,f.EcYear)>-1?(e=[],e.push(t.YEAR_INPUT_FRONT_BLANK?" ":""),e.push(t.YEAR_INPUT_FRONT_CHAR),n.isNull(ecount.config.company.MYPAGECOMPANY_DATE)||n.isEmpty(ecount.config.company.MYPAGECOMPANY_DATE.GROUP_CD_INPUT)?e.push(r.format(t.YEAR_INPUT_FORMAT.toLowerCase())):e.push(f.getEraYear({GROUP_CD:ecount.config.company.MYPAGECOMPANY_DATE.GROUP_CD_INPUT,YEAR:r.format("yyyy")})),e.push(t.YEAR_INPUT_BACK_CHAR),e.push(t.YEAR_INPUT_BACK_BLANK?" ":""),e.join("")):"":n.inArray(i,f.EcYear)>-1?(e=[],e.push(t.YEAR_FRONT_BLANK?" ":""),e.push(t.YEAR_FRONT_CHAR),n.isNull(ecount.config.company.MYPAGECOMPANY_DATE)||n.isEmpty(ecount.config.company.MYPAGECOMPANY_DATE.GROUP_CD_OUTPUT)?e.push(r.format(t.YEAR_OUTPUT_FORMAT.toLowerCase())):e.push(f.getEraYear({GROUP_CD:null,YEAR:r.format("yyyy")})),e.push(t.YEAR_BACK_CHAR),e.push(t.YEAR_BACK_BLANK?" ":""),e.join("")):""},m:function(t,i,r,u,f){var e;return u?n.inArray(i,f.EcMonth)>-1?(e=[],e.push(t.MONTH_INPUT_FRONT_BLANK?" ":""),e.push(t.MONTH_INPUT_FRONT_CHAR),t.MONTH_INPUT_FORMAT=="M"?e.push(r.getMonth()+1):(Date.CultureInfo.LANG=="ko-KR"&&t.MONTH_INPUT_FORMAT=="MMM"&&(t.MONTH_INPUT_FORMAT="MMMM"),e.push(r.format(t.MONTH_INPUT_FORMAT))),e.push(t.MONTH_INPUT_BACK_CHAR),e.push(t.MONTH_INPUT_BACK_BLANK?" ":""),e.join("")):"":n.inArray(i,f.EcMonth)>-1?(e=[],e.push(t.MONTH_FRONT_BLANK?" ":""),e.push(t.MONTH_FRONT_CHAR),t.MONTH_OUTPUT_FORMAT=="M"?e.push(r.getMonth()+1):(Date.CultureInfo.LANG=="ko-KR"&&t.MONTH_OUTPUT_FORMAT=="MMM"&&(t.MONTH_OUTPUT_FORMAT="MMMM"),e.push(r.format(t.MONTH_OUTPUT_FORMAT))),e.push(t.MONTH_BACK_CHAR),e.push(t.MONTH_BACK_BLANK?" ":""),e.join("")):""},d:function(t,i,r,u,f){var e,o;return u?n.inArray(i,f.EcDay)>-1?(e=[],e.push(t.DAY_INPUT_FRONT_BLANK?" ":""),e.push(t.DAY_INPUT_FRONT_CHAR),o=t.DAY_INPUT_FORMAT.toLowerCase()=="d"?r.getDate():r.format("MM"+t.DAY_INPUT_FORMAT.toLowerCase()).substr(2),e.push(o),e.push(t.DAY_INPUT_BACK_CHAR),e.push(t.DAY_INPUT_BACK_BLANK?" ":""),e.join("")):"":n.inArray(i,f.EcDay)>-1?(e=[],e.push(t.DAY_FRONT_BLANK?" ":""),e.push(t.DAY_FRONT_CHAR),o=t.DAY_OUTPUT_FORMAT.toLowerCase()=="d"?r.getDate():r.format("MM"+t.DAY_OUTPUT_FORMAT.toLowerCase()).substr(2),e.push(o),e.push(t.DAY_BACK_CHAR),e.push(t.DAY_BACK_BLANK?" ":""),e.join("")):""}},TimeOrderExecutor:{h:function(t,i,r,u,f){var e,o;return u?n.inArray(i,f.EcHour)>-1?(e=[],e.push(t.HOUR_INPUT_FRONT_BLANK?" ":""),e.push(t.HOUR_INPUT_FRONT_CHAR),t.HS_TYPE==3?e.push(r.format(t.HOUR_INPUT_FORMAT.toUpperCase())):t.HOUR_INPUT_FORMAT.toLowerCase()=="h"?e.push(r.format("h")):(o=r.format("h"),e.push(o<10?"0"+o:o)),e.push(t.HOUR_INPUT_BACK_CHAR),e.push(t.HOUR_INPUT_BACK_BLANK?" ":""),e.join("")):"":n.inArray(i,f.EcHour)>-1?(e=[],e.push(t.HOUR_FRONT_BLANK?" ":""),e.push(t.HOUR_FRONT_CHAR),t.HS_TYPE==3?e.push(r.format(t.HOUR_OUTPUT_FORMAT.toUpperCase())):t.HOUR_OUTPUT_FORMAT.toLowerCase()=="h"?e.push(r.format("h")):(o=r.format("h"),e.push(o<10?"0"+o:o)),e.push(t.HOUR_BACK_CHAR),e.push(t.HOUR_BACK_BLANK?" ":""),e.join("")):""},m:function(t,i,r,u,f){var e;return u?n.inArray(i,f.EcMin)>-1?(e=[],e.push(t.MIN_INPUT_FRONT_BLANK?" ":""),e.push(t.MIN_INPUT_FRONT_CHAR),e.push(r.format("hh"+t.MIN_INPUT_FORMAT.toLowerCase()).substr(2)),e.push(t.MIN_INPUT_BACK_CHAR),e.push(t.MIN_INPUT_BACK_BLANK?" ":""),e.join("")):"":n.inArray(i,f.EcMin)>-1?(e=[],e.push(t.MIN_FRONT_BLANK?" ":""),e.push(t.MIN_FRONT_CHAR),e.push(r.format("hh"+t.MIN_OUTPUT_FORMAT.toLowerCase()).substr(2)),e.push(t.MIN_BACK_CHAR),e.push(t.MIN_BACK_BLANK?" ":""),e.join("")):""},s:function(t,i,r,u,f){if(!u&&n.inArray(i,f.EcSec)>-1){var e=[];return e.push(t.SEC_FRONT_BLANK?" ":""),e.push(t.SEC_FRONT_CHAR),e.push(r.format("mm"+t.SEC_OUTPUT_FORMAT.toLowerCase()).substr(2)),e.push(t.SEC_BACK_CHAR),e.push(t.SEC_BACK_BLANK?" ":""),e.join("")}return""}},getCompareDate:function(n,t,i){function s(n){return typeof n=="string"?n:n.toISOString().slice(0,10).replace(/-/g,"")}function h(n,t){for(var r,u=t!=undefined?Number(t)-1:0,o=n.getDay(),s=-7,f={},e,i=u;i<7+u;i++)e=i>6?i-7:i,f[e]=s--;return r=n.addDays(f[o]),[r,r.addDays(6)]}var e=new Date(n[0]),o=new Date(n[1]),u,f,r;switch(t){case"1":u=e.addDays(-1);f=o.addDays(-1);break;case"2":u=e.addDays(-7);f=o.addDays(-7);break;case"3":u=e.addMonths(-1);f=o.addMonths(-1);break;case"4":u=e.addYears(-1);f=o.addYears(-1);break;case"5":r=h(e,i);u=r[0];f=r[1];break;case"6":r=e.addMonths(-1);u=r.format("yyyyMM")+"01";f=r.format("yyyyMM")+Date.daysInMonth(r.getMonth(),r.getFullYear()).toString();break;case"7":r=e.addYears(-1).format("yyyy");u=r+"0101";f=r+"1231"}return[s(u),s(f)]},getScreenThemeCd:function(){return ecount&&ecount.config&&ecount.config.user&&ecount.config.user.SCREEN_THEME_CD&&["B","D"].contains(ecount.config.user.SCREEN_THEME_CD)?ecount.config.user.SCREEN_THEME_CD:"B"},getZoomRatio:function(){var n=ecount.constValue.isIE;return n?1:parseFloat(getComputedStyle(document.body).zoom)}})}(jQuery);ecenum=window.ecenum={},function(n){function t(n){var i={},t;for(k in n)t=n[k],t instanceof Array?i[n[k]=t[0]]={name:t[0],value:t[1],type:t[2]}:i[t]={name:t,value:k,type:k};return n.pro=i,Object.freeze?Object.freeze(n):n}n.extend(ecenum,{selectTab:t({tabApproval:["tabApproval","Z","Z"],tabCS:["tabCS","0","Y"],tabIng:["tabIng","1","Y"],tabFinishes:["tabFinishes","9","Y"],tabAll:["tabAll","ALL","A"],tabSentFax:["tabSentFax","","Y"],tabSentEmil:["tabSentEmail","","Y"],tabUnsent:["tabUnsent","E","Y"]}),gbType:{unConfirmed:"N",confirmed:"Y",eApproval:"Z",cs:"C"},progressStatus:{cs:"0",inProgress:"1",complete:"9"},foreignFlag:{domestic:"0",foreign:"1"},dataLoadingMethod:{bySlip:"1",byItem:"2",byLine:"0"},editFlag:{New:"I",newImportCopy:"Copy",newImportOrder:"C",newImportPurchases:"CopyBuy",newImportQc:"QC",newImportQcResult:"QC_RESULT",newImportGoodsReceipt:"GoodsReceipt",newImportPlan:"CopyPlan",newImportPurchasesOrder:"CopyPurchaseOrder",newImportEcTax:"EctaxSell",modify:"M",orderMgmtImport:"ORDER"},editMode:{"new":"01",modify:"02","delete":"03",deleteCancel:"04",confirm:"05",confirmCancel:"06",connect:"07",disconnect:"08",view:"09",copy:"10","return":"11",finish:"12",finishedCancel:"13",slipUpdate:"14",priceAmtUpdate:"15",exportExcel:"16",slipPrint:"17",PDF:"18",smsFaxEmailSend:"19",csConfirm:"20",webUpload:"21",barcodePrint:"22",changeState:"23",accessRead:"24",setting:"25"},permissionType:{none:"X",read:"R",write:"U",all:"W"},historyStatus:{New:"I",modify:"M",unUse:"S",modifyingBatch:"A",deleted:"D",deleteCancel:"B",email:"E",fax:"F",excel:"X",word:"W",pdf:"P",print:"O",approve:"Z",finishedCancel:"R",confirmC:"C",newGoodsReceipt:"N",modifyGoodsReceipt:"U",newPushShippingOrder:"G",modifyPushShippingOrder:"H",newPushGoodsReceiptAndShippingOrder:"J",modifyPushGoodsReceiptAndShippingOrder:"K",modifyUnConfirmed:"L",confirm:"V",confirmCancel:"T"},autoCodeEditFlag:{none:"N",New:"I",modify:"M"},useYn:{none:"N",yes:"Y"},sharedFlag:{none:"0",yes:"1"},filemenuCode:{dopr:"DOPR",logo:"LOGO",toplogo:"TLGO",comtoptabcilogo:"CTLGO",sign:"SIGN",custlogo:"CLGO",custsign:"CSGN",usersign:"USGN",cms:"CMS",imagebox:"GWMY",my:"MY",myimg:"MYIMG",face:"FACE",file:"FILE",customer:"CUS",popup:"POP",gw01:"GW01",gw02:"GW02",gw03:"GW03",gw04:"GW04",gw05:"GW05",gw06:"GW06",gw07:"GW07",gw08:"GW08",gw09:"GW09",gw10:"GW10",gwin:"GWIN",gwpm:"GWPM",pdf:"PDF",mht:"MHT",mhtm:"MHTM",tax:"TAX",pay:"PAY",etc01:"ET01",etc02:"ET02",etc03:"ET03",etc04:"ET04",etc05:"ET05",etc06:"ET06",etc07:"ET07",etc08:"ET08",etc09:"ET09",etc10:"ET10",etc11:"ET11",etc12:"ET12",etc13:"ET13",etc14:"ET14",etc15:"ET15",etc16:"ET16",etc17:"ET17",etc18:"ET18",etc19:"ET19",etc20:"ET20",cont:"CONT"},tempfileLifetime:{infinity:"0",oneHour:"1h",twoHour:"2h",foruHour:"4h",sixHour:"6h",twelveHour:"12h",oneDay:"1d",threeDay:"3d",oneWeek:"1w",twoWeek:"2w",oneMonth:"1m",threeMonth:"3m"},prodFlag:{basic:"S",multiSize:"M",multiProcess:"G",oem:"O"},prodType:{rowMaterial:"0",subMaterial:"4",semiFinishedGoods:"2",finishedGoods:"1",merchandise:"3",intangibleGoods:"7"},inputMethod:{keyboard:"K",mouse:"M"}})}(jQuery);ecount.module("ecount.calc",{nullifchk:function(n,t){return(isNaN(n)||Number(n)==0)&&(n=t),n},toFixed:function(n,t,i){var r,f={F:1,C:0,R:4},u;return t=t||0,$.type(n)=="number"&&(u=Decimal.pow(10,t),n=n*u/u),n=new Decimal(n||0),r=f[i],$.isEmpty(r)&&(r=f.R),new Decimal(n.toFixed(t,r))},toFixedAmount:function(n){return this.toFixed(n,ecount.config.company.DEC_AMT,ecount.config.company.AMT_CALC)},toFixedVat:function(n){return this.toFixed(n,ecount.config.company.DEC_AMT,ecount.config.company.VAT_CALC)},toFixedFloor:function(n,t){return this.toFixed(n,t,"F")},toFixedRound:function(n,t){return this.toFixed(n,t,"R")},toFixedCeil:function(n,t){return this.toFixed(n,t,"C")},calcByString:function(n){return n=this.calExecute(n),$.isNumeric(n)&&$.isNumeric(new Decimal(n).toString())||(n="0"),new Decimal(n)},calcByEval:function(n){return n=this.calExecute(n),eval(n)},calExecute:function(n){function f(n,t,i,r,u){var f=new Decimal(n),e;$.isNull(u)&&(u=null);switch(t){case"+":f=f.plus(new Decimal(i));break;case"-":f=f.minus(new Decimal(i));break;case"*":f=f.times(new Decimal(i));break;case"/":f=f.dividedBy(new Decimal(i))}switch(r){case 1:case 2:case 3:return e=Decimal.pow(10,u),n<0&&(e*=-1),(Math[a(r)](f*e)/e).toString();case 99:return f.toString();default:return $.isNumeric(u)||(u=0),$.isNumeric(f.toString())||(f=new Decimal(u)),f.toString()}}function a(n){var t="";return n==1?t="ceil":n==2?t="round":n==3&&(t="floor"),t}function l(n){for(var t="",i=[],r=/nullifchk\([\r\w,.+-/*/]+\)/,e=/fnMathCutCalc\([\r\w,.+-/*/]+\)/,o=/fnMathRound\([\r\w,.+-/*/]+\)/,s=/fnMathIncrease\([\r\w,.+-/*/]+\)/,h=/[\.\/\d\*\+\-]+/g;n.match(r)!=null||n.match(e)!=null||n.match(o)!=null||n.match(s)!=null;)n.match(r)!=null&&(t=n.match(r)[0],i=t.match(h),t=f(i[0],"","",0,i[1]||"0"),n=n.replace(r,t)),n.match(e)!=null&&(t=n.match(e)[0],i=t.match(h),t=u(i[0],3,i[1]||"0"),n=n.replace(e,t)),n.match(o)!=null&&(t=n.match(o)[0],i=t.match(h),t=u(i[0],2,i[1]||"0"),n=n.replace(o,t)),n.match(s)!=null&&(t=n.match(s)[0],i=t.match(h),t=u(i[0],1,i[1]||"0"),n=n.replace(s,t));return n}function u(n,t,i){var u,o,s;if(i&&n.match(/[-]?\d+[.]?\d*[\\*/+-][-]?\d+[.]?\d*/)==null)n=f(n,"",0,t,i);else{while(n.match(/[-]?\d+[.]?\d*[\\*/][-]?\d+[.]?\d*/)!=null){u=/\d+[.]?\d*[/*/][-]?\d+[.]?\d*/;n.match(/[-]\d+[.]?\d*[/*/][-]?\d+[.]?\d*/)&&!n.match(/\d+[-]\d+[.]?\d*[/*/][-]?\d+[.]?\d*/)&&(u=/[-]?\d+[.]?\d*[/*/][-]?\d+[.]?\d*/);var r=n.match(u)[0],h=r.match(/[-]?\d+[.]?\d*/g)[0],c=r.match(/[/*/]/)[0],e=t;r!=n&&(e="99");o=r.match(/[-]?\d+[.]?\d*/g)[1];s=f(h,c,o,e,i);n=n.replace(u,s)}while(n.match(/[-]?\d+[.]?\d*[+-][-]?\d+[.]?\d*/)!=null){var u=/[-]?\d+[.]?\d*[+-][-]?\d+[.]?\d*/,r=n.match(u)[0],h=r.match(/[-]?\d+[.]?\d*/g)[0],c=r.replace(/[-]?\d+[.]?\d*/,"").match(/[+-]/)[0],e=t;r!=n&&(e="99");o=r.split(/[-]?\d+[.]?\d?[+-]/)[1];s=f(h,c,o,e,i);n=n.replace(u,s)}}return n.replace(/[()]/g,"")}var e=/\([\d\w+-\\*/]*\)/,s=/Math\.(round|floor|ceil)\((-?\d+\.?\d*|0),?(-?\d+)\)/,i,r,h,c,o,t;for(n=l(n),n="("+n+")";$.isNull(n.match(e))==!1;){if(i=n.match(s),i){r=0;switch(i[1]){case"round":r=2;break;case"floor":r=3;break;case"ceil":r=1}h=i[2]||0;c=i[3]||0;n=n.replace(s,u(h,r,c))}if(n=l(n),o=n.match(e),!o)return n;t=o[0];t.match(/[(][-]{2}?\d+[.]?\d*/)&&(t=t.replace(/[-]{2}/,""));t=u(t,0);$.isNull(n.match(/[\d]+\([\d\w+-\\*/]*\)/))==!1&&(t="*"+t);$.isNull(n.match(/\([\d\w+-\\*/]*\)[\d]+/))==!1&&(t=t+"*");n=n.replace(e,t)}return n},toFixedBasicPoint:function(n,t,i,r){r==undefined&&(r="R");switch(n){case"G":switch(t){case"Q":return this.toFixed(i,ecount.config.inventory.DEC_Q,r);case"A":return this.toFixed(i,ecount.config.inventory.ETC_DEC_UQ,r);case"P":return this.toFixed(i,ecount.config.inventory.DEC_P,r)}break;case"S":switch(t){case"Q":return this.toFixed(i,ecount.config.inventory.OUT_DEC_Q,r);case"A":return this.toFixed(i,ecount.config.inventory.DEC_UQ,r);case"P":return this.toFixed(i,ecount.config.inventory.OUT_DEC_P,r)}break;case"P":switch(t){case"Q":return this.toFixed(i,ecount.config.inventory.IN_DEC_Q,r);case"A":return this.toFixed(i,ecount.config.inventory.IN_DEC_UQ,r);case"P":return this.toFixed(i,ecount.config.inventory.IN_DEC_P,r)}}}});ecount.module("ecount.calcData",{datas:{},hashKeys:{},register:function(n){if(n&&n.formCalcDataList){var t=_.filter(n.formCalcDataList,function(n){return!this._getData(n.formType,n.hash)}.bind(this));this._setData(n,t)}},get:function(n,t,i){var r,u;if(!n.formCalcDataList){i&&i(null);return}if(r=_.find(n.formCalcDataList,function(n){return n.formType===t}),!r){i&&i(null);return}if(u=this._getData(r.formType,r.hash),u){i&&i(u);return}this._setData(n,r,function(n){i&&i(n[0])})},_getData:function(n,t){var r=this.hashKeys[n],i;return r&&r==t&&(i=this.datas[n],i)?i:null},_setData:function(n,t,i){if(_.isEmpty(t)){i&&i(null);return}t=_.isArray(t)?t:[t];var r=_.map(t,function(t){return{ComInfo:n.cacheKey.ComInfo,ComCode:n.cacheKey.ComCode,UserId:n.cacheKey.UserId,DomainFlag:n.cacheKey.DomainFlag,EcountFlag:n.cacheKey.EcountFlag,LanType:n.cacheKey.LanType,FormType:t.formType,Hash:t.hash}}),u=Object.toJSON(r).encryptXor("ecount");$.ajax({url:"/ECERP/SVC/Popup/GetXFormCacheCalcNew?v="+u,method:"GET",success:function(n){_.forEach(t,function(t){this.datas[t.formType]=n[t.formType];this.hashKeys[t.formType]=t.hash}.bind(this));i&&i(n)}.bind(this)})}});ecount.module("ecount.formDataCache",{calc:{key:"calc",datas:{},hashKeys:{},path:"formCalcDataList",api:"/ECERP/SVC/Popup/GetXFormCacheCalcNew?v=",get:function(n,t,i){ecount.formDataCache.get.call(this,this.path,n,t,i)}},search:{key:"search",datas:{},hashKeys:{},path:"formSearchData",api:"/ECERP/SVC/Popup/GetXFormCacheSearch?v=",isTransaction:!0,get:function(n,t,i){ecount.formDataCache.get.call(this,this.path,n,t,i)},set:function(n,t){_.isEmpty(t)||_.forEach(n,function(n){this.datas[n.formType]=_.head(t)[n.formType];this.hashKeys[n.formType]=n.hash}.bind(this))}},register:function(n,t){var i=_.filter(this,function(n){return _.isObject(n)&&n.hasOwnProperty("key")});_.forEach(i,function(i){if(n&&n[i.path]){var r=_.filter(n[i.path],function(n){return!this._getData.call(i,n.formType,n.hash)}.bind(this));this._setData.call(i,{cacheInfo:n,list:r,transaction:t})}}.bind(this))},get:function(n,t,i,r){var u,f;if(!t[n]){r&&r(null);return}if(u=_.find(t[n],function(n){return n.formType===i}),!u){r&&r(null);return}if(f=ecount.formDataCache._getData.call(this,u.formType,u.hash),f){r&&r(f);return}ecount.formDataCache._setData.call(this,{cacheInfo:t,list:u,callback:function(n){r&&r(n[0])}})},_getData:function(n,t){var r=this.hashKeys[n],i;return r&&r==t&&(i=this.datas[n],i)?i:null},_setData:function(n){var t=n.list,i=n.cacheInfo,r=n.callback,u=n.transaction,e,f;if(_.isEmpty(t)){r&&r(null);return}t=_.isArray(t)?t:[t];e=_.map(t,function(n){return{ComInfo:i.cacheKey.ComInfo,ComCode:i.cacheKey.ComCode,UserId:i.cacheKey.UserId,DomainFlag:i.cacheKey.DomainFlag,EcountFlag:i.cacheKey.EcountFlag,LanType:i.cacheKey.LanType,FormType:n.formType,Hash:n.hash}});f=Object.toJSON(e).encryptXor("ecount");this.isTransaction?(u.target(this.key),u[String.format("{0}HashKeys",this.key)]=t,u.add({url:String.format("{0}{1}",this.api,f),method:"GET",contentType:"application/json"})):$.ajax({url:String.format("{0}{1}",this.api,f),method:"GET",success:function(n){_.forEach(t,function(t){this.datas[t.formType]=n[t.formType];this.hashKeys[t.formType]=t.hash}.bind(this));r&&r(n)}.bind(this)})}});window.__isOldLayout==!0?function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"&&typeof module=="object"?module.exports=n:n(jQuery)}(function(n,t){"use strict";function s(t,i,r,u){for(var e,f,h,c,a,v,o=[],s=0;s<t.length;s++)e=t[s],e?(f=tinycolor(e),h=f.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",h+=tinycolor.equals(i,e)?" sp-thumb-active":"",c=f.toString(u.preferredFormat||"rgb"),a=l?"background-color:"+f.toRgbString():"filter:"+f.toFilter(),o.push('<span title="'+c+'" data-color="'+f.toRgbString()+'" class="'+h+'"><span class="sp-thumb-inner" style="'+a+';" /><\/span>')):(v="sp-clear-display",o.push(n("<div />").append(n('<span data-color="" style="background-color:transparent;" class="'+v+'"><\/span>').attr("title",u.noColorSelectedText)).html()));return"<div class='sp-cf "+r+"'>"+o.join("")+"<\/div>"}function y(){for(var n=0;n<i.length;n++)i[n]&&i[n].hide()}function p(t,i){var r=n.extend({},c,t);return r.callbacks={move:f(r.move,i),change:f(r.change,i),show:f(r.show,i),hide:f(r.hide,i),beforeShow:f(r.beforeShow,i)},r}function w(u,f){function fr(){var t,i,r;if(h.showPaletteOnly&&(h.showPalette=!0),ir.text(h.showPaletteOnly?h.togglePaletteMoreText:h.togglePaletteLessText),h.palette)for(li=h.palette.slice(0),ui=n.isArray(li[0])?li:[li],ai={},t=0;t<ui.length;t++)for(i=0;i<ui[t].length;i++)r=tinycolor(ui[t][i]).toRgbString(),ai[r]=!0;c.toggleClass("sp-flat",ut);c.toggleClass("sp-input-disabled",!h.showInput);c.toggleClass("sp-alpha-enabled",h.showAlpha);c.toggleClass("sp-clear-enabled",st);c.toggleClass("sp-buttons-disabled",!h.showButtons);c.toggleClass("sp-palette-buttons-disabled",!h.togglePaletteOnly);c.toggleClass("sp-palette-disabled",!h.showPalette);c.toggleClass("sp-palette-only",h.showPaletteOnly);c.toggleClass("sp-initial-disabled",!h.showInitial);c.addClass(h.className).addClass(h.containerClassName);at()}function vu(){function u(t){return t.data&&t.data.ignore?(ct(n(t.target).closest(".sp-thumb-el").data("color")),kt()):(ct(n(t.target).closest(".sp-thumb-el").data("color")),kt(),lt(!0),h.hideAfterPaletteSelect&&ht()),!1}var t,i;r&&c.find("*:not(input)").attr("unselectable","on");fr();rr&&w.after(pt).hide();st||tr.hide();ut?w.after(c).hide():(t=h.appendTo==="parent"?w.parent():n(h.appendTo),t.length!==1&&(t=n("body")),t.append(c));nu();ei.bind("click.spectrum touchstart.spectrum",function(t){gi||ru();t.stopPropagation();n(t.target).is("input")||t.preventDefault()});(w.is(":disabled")||h.disabled===!0)&&eu();c.click(k);it.change(hr);it.bind("paste",function(){setTimeout(hr,1)});it.keydown(function(n){n.keyCode==13&&hr()});dr.text(h.cancelText);dr.bind("click.spectrum",function(n){n.stopPropagation();n.preventDefault();pu();ht()});tr.attr("title",h.clearText);tr.bind("click.spectrum",function(n){n.stopPropagation();n.preventDefault();et=!0;kt();ut&&lt(!0)});gr.text(h.chooseText);gr.bind("click.spectrum",function(n){n.stopPropagation();n.preventDefault();r&&it.is(":focus")&&it.trigger("change");wu()&&(lt(!0),ht())});ir.text(h.showPaletteOnly?h.togglePaletteMoreText:h.togglePaletteLessText);ir.bind("click.spectrum",function(n){n.stopPropagation();n.preventDefault();h.showPaletteOnly=!h.showPaletteOnly;h.showPaletteOnly||ut||c.css("left","-="+(cu.outerWidth(!0)+5));fr()});o(wr,function(n,t,i){nt=n/di;et=!1;i.shiftKey&&(nt=Math.round(nt*10)/10);kt()},or,sr);o(nr,function(n,t){ti=parseFloat(t/ci);et=!1;h.showAlpha||(nt=1);kt()},or,sr);o(yi,function(n,t,i){var r,u;if(i.shiftKey){if(!ft){var f=ii*yt,e=rt-ri*rt,o=Math.abs(n-f)>Math.abs(t-e);ft=o?"x":"y"}}else ft=null;r=!ft||ft==="x";u=!ft||ft==="y";r&&(ii=parseFloat(n/yt));u&&(ri=parseFloat((rt-t)/rt));et=!1;h.showAlpha||(nt=1);kt()},or,sr);oi?(ct(oi),dt(!0),si=ur||tinycolor(oi).format,er(oi)):dt();ut&&cr();i=r?"mousedown.spectrum":"click.spectrum touchstart.spectrum";br.delegate(".sp-thumb-el",i,u);kr.delegate(".sp-thumb-el:nth-child(1)",i,{ignore:!0},u)}function nu(){if(vt&&window.localStorage){try{var t=window.localStorage[vt].split(",#");t.length>1&&(delete window.localStorage[vt],n.each(t,function(n,t){er(t)}))}catch(i){}try{tt=window.localStorage[vt].split(";")}catch(i){}}}function er(t){if(ou){var i=tinycolor(t).toRgbString();if(!ai[i]&&n.inArray(i,tt)===-1)for(tt.push(i);tt.length>hu;)tt.shift();if(vt&&window.localStorage)try{window.localStorage[vt]=tt.join(";")}catch(r){}}}function yu(){var t=[],n,i;if(h.showPalette)for(n=0;n<tt.length;n++)i=tinycolor(tt[n]).toRgbString(),ai[i]||t.push(tt[n]);return t.reverse().slice(0,h.maxSelectionSize)}function tu(){var t=g(),i=n.map(ui,function(n,i){return s(n,t,"sp-palette-row sp-palette-row-"+i,h)});nu();tt&&i.push(s(yu(),t,"sp-palette-row sp-palette-row-selection",h));br.html(i.join(""))}function iu(){if(h.showInitial){var t=bt,n=g();kr.html(s([t,n],n,"sp-palette-row-initial",h))}}function or(){(rt<=0||yt<=0||ci<=0)&&at();c.addClass(pr);ft=null;w.trigger("dragstart.spectrum",[g()])}function sr(){c.removeClass(pr);w.trigger("dragstop.spectrum",[g()])}function hr(){var n=it.val(),t;(n===null||n==="")&&st?(ct(null),lt(!0)):(t=tinycolor(n),t.isValid()?(ct(t),lt(!0)):it.addClass("sp-validation-error"))}function ru(){ni?ht():cr()}function cr(){var t=n.Event("beforeShow.spectrum");if(ni){at();return}(w.trigger(t,[g()]),gt.beforeShow(g())===!1||t.isDefaultPrevented())||(y(),ni=!0,n(vi).bind("click.spectrum",uu),n(window).bind("resize.spectrum",ar),pt.addClass("sp-active"),c.removeClass("sp-hidden"),at(),dt(),bt=g(),iu(),gt.show(bt),w.trigger("show.spectrum",[bt]))}function uu(n){n.button!=2&&(au&&lt(!0),ht())}function ht(){ni&&!ut&&(ni=!1,n(vi).unbind("click.spectrum",uu),n(window).unbind("resize.spectrum",ar),pt.removeClass("sp-active"),c.addClass("sp-hidden"),gt.hide(g()),w.trigger("hide.spectrum",[g()]))}function pu(){ct(bt,!0)}function ct(n,t){if(tinycolor.equals(n,g())){dt(!0);return}var i,r;!n&&st?et=!0:(et=!1,i=tinycolor(n),r=i.toHsv(),ti=r.h%360/360,ii=r.s,ri=r.v,nt=r.a);dt(!0);i&&i.isValid()&&!t&&(si=ur||i.getFormat())}function g(n){return(n=n||{},st&&et)?null:tinycolor.fromRatio({h:ti,s:ii,v:ri,a:Math.round(nt*100)/100},{format:n.format||si})}function wu(){return!it.hasClass("sp-validation-error")}function kt(){dt();gt.move(g());w.trigger("move.spectrum",[g()])}function dt(n){var c,t,i,o,u,a,s,f,e;it.removeClass("sp-validation-error");fu();c=tinycolor.fromRatio({h:ti,s:1,v:1});yi.css("background-color",c.toHexString());t=si;nt<1&&!(nt===0&&t==="name")&&(t==="hex"||t==="hex3"||t==="hex6"||t==="name")&&(t="rgb");n&&(i=g({format:t}),o="",wt.removeClass("sp-clear-display"),wt.css("background-color","transparent"),!i&&st?wt.addClass("sp-clear-display"):(u=i.toHexString(),a=i.toRgbString(),l||i.alpha===1?wt.css("background-color",a):(wt.css("background-color","transparent"),wt.css("filter",i.toFilter())),h.showAlpha&&(s=i.toRgb(),s.a=0,f=tinycolor(s).toRgbString(),e="linear-gradient(left, "+f+", "+u+")",r?fi.css("filter",tinycolor(f).toFilter({gradientType:1},u)):(fi.css("background","-webkit-"+e),fi.css("background","-moz-"+e),fi.css("background","-ms-"+e),fi.css("background","linear-gradient(to right, "+f+", "+u+")"))),o=i.toString(t)),h.showInput&&it.val(o));h.showPalette&&tu();iu()}function fu(){var u=ii,f=ri,n,t,i,r;st&&et?(bi.hide(),wi.hide(),pi.hide()):(bi.show(),wi.show(),pi.show(),n=u*yt,t=rt-f*rt,n=Math.max(-ot,Math.min(yt-ot,n-ot)),t=Math.max(-ot,Math.min(rt-ot,t-ot)),pi.css({top:t+"px",left:n+"px"}),i=nt*di,bi.css({left:i-vr/2+"px"}),r=ti*ci,wi.css({top:r-yr+"px"}))}function lt(n){var t=g(),i="",r=!tinycolor.equals(t,bt);t&&(i=t.toString(si),er(t));ki&&w.val(i);n&&r&&(gt.change(t),w.trigger("change",[t]))}function at(){yt=yi.width();rt=yi.height();ot=pi.height();su=nr.width();ci=nr.height();yr=wi.height();di=wr.width();vr=bi.width();ut||(c.css("position","absolute"),h.offset?c.offset(h.offset):c.offset(b(c,ei)));fu();h.showPalette&&tu();w.trigger("reflow.spectrum")}function bu(){w.show();ei.unbind("click.spectrum touchstart.spectrum");c.remove();pt.remove();i[hi.id]=null}function ku(i,r){if(i===t)return n.extend({},h);if(r===t)return h[i];h[i]=r;fr()}function du(){gi=!1;w.attr("disabled",!1);ei.removeClass("sp-disabled")}function eu(){ht();gi=!0;w.attr("disabled",!0);ei.addClass("sp-disabled")}function gu(n){h.offset=n;at()}var h=p(f,u),ut=h.flat,ou=h.showSelectionPalette,vt=h.localStorageKey,lr=h.theme,gt=h.callbacks,ar=d(at,10),ni=!1,yt=0,rt=0,ot=0,ci=0,su=0,di=0,vr=0,yr=0,ti=0,ii=0,ri=0,nt=1,li=[],ui=[],ai={},tt=h.selectionPalette.slice(0),hu=h.maxSelectionSize,pr="sp-dragging",ft=null,vi=u.ownerDocument,nf=vi.body,w=n(u),gi=!1,c=n(v,vi).addClass(lr),cu=c.find(".sp-picker-container"),yi=c.find(".sp-color"),pi=c.find(".sp-dragger"),nr=c.find(".sp-hue"),wi=c.find(".sp-slider"),fi=c.find(".sp-alpha-inner"),wr=c.find(".sp-alpha"),bi=c.find(".sp-alpha-handle"),it=c.find(".sp-input"),br=c.find(".sp-palette"),kr=c.find(".sp-initial"),dr=c.find(".sp-cancel"),tr=c.find(".sp-clear"),gr=c.find(".sp-choose"),ir=c.find(".sp-palette-toggle"),ki=w.is("input"),lu=ki&&w.attr("type")==="color"&&e(),rr=ki&&!ut,pt=rr?n(a).addClass(lr).addClass(h.className).addClass(h.replacerClassName):n([]),ei=rr?pt:w,wt=pt.find(".sp-preview-inner"),oi=h.color||ki&&w.val(),bt=!1,ur=h.preferredFormat,si=ur,au=!h.showButtons||h.clickoutFiresChange,et=!oi,st=h.allowEmpty&&!lu,hi;return vu(),hi={show:cr,hide:ht,toggle:ru,reflow:at,option:ku,enable:du,disable:eu,offset:gu,set:function(n){ct(n);lt()},get:g,destroy:bu,container:c},hi.id=i.push(hi)-1,hi}function b(t,i){var s=0,u=t.outerWidth(),f=t.outerHeight(),h=i.outerHeight(),e=t[0].ownerDocument,c=e.documentElement,o=c.clientWidth+n(e).scrollLeft(),l=c.clientHeight+n(e).scrollTop(),r=i.offset();return r.top+=h,r.left-=Math.min(r.left,r.left+u>o&&o>u?Math.abs(r.left+u-o):0),r.top-=Math.min(r.top,r.top+f>l&&l>f?Math.abs(f+h-s):s),r}function u(){}function k(n){n.stopPropagation()}function f(n,t){var i=Array.prototype.slice,r=i.call(arguments,2);return function(){return n.apply(t,r.concat(i.call(arguments)))}}function o(t,i,u,f){function h(n){n.stopPropagation&&n.stopPropagation();n.preventDefault&&n.preventDefault();n.returnValue=!1}function y(n){if(s){if(r&&o.documentMode<9&&!n.button)return p();var u=n.originalEvent&&n.originalEvent.touches&&n.originalEvent.touches[0],f=u&&u.pageX||n.pageX,e=u&&u.pageY||n.pageY,y=Math.max(0,Math.min(f-c.left,a)),w=Math.max(0,Math.min(e-c.top,l));v&&h(n);i.apply(t,[y,w,n])}}function w(i){var r=i.which?i.which==3:i.button==2;r||s||u.apply(t,arguments)!==!1&&(s=!0,l=n(t).height(),a=n(t).width(),c=n(t).offset(),n(o).bind(e),n(o.body).addClass("sp-dragging"),v||y(i),h(i))}function p(){s&&(n(o).unbind(e),n(o.body).removeClass("sp-dragging"),f.apply(t,arguments));s=!1}i=i||function(){};u=u||function(){};f=f||function(){};var o=document,s=!1,c={},l=0,a=0,v="ontouchstart"in window,e={};e.selectstart=h;e.dragstart=h;e["touchmove mousemove"]=y;e["touchend mouseup"]=p;n(t).bind("touchstart mousedown",w)}function d(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;n.apply(u,f)};i&&clearTimeout(r);(i||!r)&&(r=setTimeout(e,t))}}function e(){return n.fn.spectrum.inputTypeColorSupport()}var c={beforeShow:u,move:u,change:u,show:u,hide:u,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},i=[],r=!!/msie/i.exec(window.navigator.userAgent),l=function(){function t(n,t){return!!~(""+n).indexOf(t)}var i=document.createElement("div"),n=i.style;return n.cssText="background-color:rgba(0,0,0,.5)",t(n.backgroundColor,"rgba")||t(n.backgroundColor,"hsla")}(),a="<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'><\/div><\/div><div class='sp-dd'>&#9660;<\/div><\/div>",v=function(){var t="",n;if(r)for(n=1;n<=6;n++)t+="<div class='sp-"+n+"'><\/div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'><\/div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'><\/button>","<\/div>","<\/div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'><\/div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'><\/div>","<\/div>","<\/div>","<\/div>","<div class='sp-clear sp-clear-display'>","<\/div>","<div class='sp-hue'>","<div class='sp-slider'><\/div>",t,"<\/div>","<\/div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'><\/div><\/div><\/div>","<\/div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","<\/div>","<div class='sp-initial sp-thumb sp-cf'><\/div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'><\/a>","<button type='button' class='sp-choose'><\/button>","<\/div>","<\/div>","<\/div>"].join("")}(),h="spectrum.id";n.fn.spectrum=function(t){if(typeof t=="string"){var r=this,u=Array.prototype.slice.call(arguments,1);return this.each(function(){var f=i[n(this).data(h)],e;if(f){if(e=f[t],!e)throw new Error("Spectrum: no such method: '"+t+"'");t=="get"?r=f.get():t=="container"?r=f.container:t=="option"?r=f.option.apply(f,u):t=="destroy"?(f.destroy(),n(this).removeData(h)):e.apply(f,u)}}),r}return this.spectrum("destroy").each(function(){var i=n.extend({},t,n(this).data()),r=w(this,i);n(this).data(h,r.id)})};n.fn.spectrum.load=!0;n.fn.spectrum.loadOpts={};n.fn.spectrum.draggable=o;n.fn.spectrum.defaults=c;n.fn.spectrum.inputTypeColorSupport=function e(){if(typeof e._cachedResult=="undefined"){var t=n("<input type='color' value='!' />")[0];e._cachedResult=t.type==="color"&&t.value!=="!"}return e._cachedResult};n.spectrum={};n.spectrum.localization={};n.spectrum.palettes={};n.fn.spectrum.processNativeColorInputs=function(){var t=n("input[type=color]");t.length&&!e()&&t.spectrum({preferredFormat:"hex6"})},function(){function tt(n){var t={r:0,g:0,b:0},i=1,f=!1,e=!1;return typeof n=="string"&&(n=ii(n)),typeof n=="object"&&(n.hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")?(t=it(n.r,n.g,n.b),f=!0,e=String(n.r).substr(-1)==="%"?"prgb":"rgb"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("v")?(n.s=h(n.s),n.v=h(n.v),t=ut(n.h,n.s,n.v),f=!0,e="hsv"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("l")&&(n.s=h(n.s),n.l=h(n.l),t=rt(n.h,n.s,n.l),f=!0,e="hsl"),n.hasOwnProperty("a")&&(i=n.a)),i=k(i),{ok:f,format:n.format||e,r:r(255,u(t.r,0)),g:r(255,u(t.g,0)),b:r(255,u(t.b,0)),a:i}}function it(n,t,r){return{r:i(n,255)*255,g:i(t,255)*255,b:i(r,255)*255}}function v(n,t,f){var s;n=i(n,255);t=i(t,255);f=i(f,255);var e=u(n,t,f),h=r(n,t,f),o,c,l=(e+h)/2;if(e==h)o=c=0;else{s=e-h;c=l>.5?s/(2-e-h):s/(e+h);switch(e){case n:o=(t-f)/s+(t<f?6:0);break;case t:o=(f-n)/s+2;break;case f:o=(n-t)/s+4}o/=6}return{h:o,s:c,l:l}}function rt(n,t,r){function h(n,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?n+(t-n)*6*i:i<1/2?t:i<2/3?n+(t-n)*(2/3-i)*6:n}var e,o,s,u,f;return n=i(n,360),t=i(t,100),r=i(r,100),t===0?e=o=s=r:(u=r<.5?r*(1+t):r+t-r*t,f=2*r-u,e=h(f,u,n+1/3),o=h(f,u,n),s=h(f,u,n-1/3)),{r:e*255,g:o*255,b:s*255}}function y(n,t,f){n=i(n,255);t=i(t,255);f=i(f,255);var e=u(n,t,f),h=r(n,t,f),o,c,l=e,s=e-h;if(c=e===0?0:s/e,e==h)o=0;else{switch(e){case n:o=(t-f)/s+(t<f?6:0);break;case t:o=(f-n)/s+2;break;case f:o=(n-t)/s+4}o/=6}return{h:o,s:c,v:l}}function ut(n,t,r){n=i(n,360)*6;t=i(t,100);r=i(r,100);var h=s.floor(n),c=n-h,u=r*(1-t),f=r*(1-c*t),e=r*(1-(1-c)*t),o=h%6,l=[r,f,u,u,e,r][o],a=[e,r,r,f,u,u][o],v=[u,u,e,r,r,f][o];return{r:l*255,g:a*255,b:v*255}}function p(n,i,r,u){var f=[o(t(n).toString(16)),o(t(i).toString(16)),o(t(r).toString(16))];return u&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0):f.join("")}function w(n,i,r,u){var f=[o(ni(u)),o(t(n).toString(16)),o(t(i).toString(16)),o(t(r).toString(16))];return f.join("")}function ft(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.s-=i/100,r.s=l(r.s),n(r)}function et(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.s+=i/100,r.s=l(r.s),n(r)}function ot(t){return n(t).desaturate(100)}function st(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.l+=i/100,r.l=l(r.l),n(r)}function ht(i,f){f=f===0?0:f||10;var e=n(i).toRgb();return e.r=u(0,r(255,e.r-t(255*-(f/100)))),e.g=u(0,r(255,e.g-t(255*-(f/100)))),e.b=u(0,r(255,e.b-t(255*-(f/100)))),n(e)}function ct(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.l-=i/100,r.l=l(r.l),n(r)}function lt(i,r){var u=n(i).toHsl(),f=(t(u.h)+r)%360;return u.h=f<0?360+f:f,n(u)}function at(t){var i=n(t).toHsl();return i.h=(i.h+180)%360,n(i)}function vt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+120)%360,s:i.s,l:i.l}),n({h:(r+240)%360,s:i.s,l:i.l})]}function yt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+90)%360,s:i.s,l:i.l}),n({h:(r+180)%360,s:i.s,l:i.l}),n({h:(r+270)%360,s:i.s,l:i.l})]}function pt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+72)%360,s:i.s,l:i.l}),n({h:(r+216)%360,s:i.s,l:i.l})]}function wt(t,i,r){i=i||6;r=r||30;var u=n(t).toHsl(),f=360/r,e=[n(t)];for(u.h=(u.h-(f*i>>1)+720)%360;--i;)u.h=(u.h+f)%360,e.push(n(u));return e}function bt(t,i){i=i||6;for(var r=n(t).toHsv(),e=r.h,o=r.s,u=r.v,f=[],s=1/i;i--;)f.push(n({h:e,s:o,v:u})),u=(u+s)%1;return f}function kt(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[n[t]]=t);return i}function k(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function i(n,t){dt(n)&&(n="100%");var i=gt(n);return(n=r(t,u(0,parseFloat(n))),i&&(n=parseInt(n*t,10)/100),s.abs(n-t)<1e-6)?1:n%t/parseFloat(t)}function l(n){return r(1,u(0,n))}function f(n){return parseInt(n,16)}function dt(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function gt(n){return typeof n=="string"&&n.indexOf("%")!=-1}function o(n){return n.length==1?"0"+n:""+n}function h(n){return n<=1&&(n=n*100+"%"),n}function ni(n){return Math.round(parseFloat(n)*255).toString(16)}function ti(n){return f(n)/255}function ii(n){var i,t;if(n=n.replace(d,"").replace(g,"").toLowerCase(),i=!1,c[n])n=c[n],i=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(t=e.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=e.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=e.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=e.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=e.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=e.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=e.hex8.exec(n))?{a:ti(t[1]),r:f(t[2]),g:f(t[3]),b:f(t[4]),format:i?"name":"hex8"}:(t=e.hex6.exec(n))?{r:f(t[1]),g:f(t[2]),b:f(t[3]),format:i?"name":"hex"}:(t=e.hex3.exec(n))?{r:f(t[1]+""+t[1]),g:f(t[2]+""+t[2]),b:f(t[3]+""+t[3]),format:i?"name":"hex"}:!1}var d=/^[\s,#]+/,g=/\s+$/,nt=0,s=Math,t=s.round,r=s.min,u=s.max,a=s.random,n=function(i,r){if(i=i?i:"",r=r||{},i instanceof n)return i;if(!(this instanceof n))return new n(i,r);var u=tt(i);this._originalInput=i;this._r=u.r;this._g=u.g;this._b=u.b;this._a=u.a;this._roundA=t(100*this._a)/100;this._format=r.format||u.format;this._gradientType=r.gradientType;this._r<1&&(this._r=t(this._r));this._g<1&&(this._g=t(this._g));this._b<1&&(this._b=t(this._b));this._ok=u.ok;this._tc_id=nt++},c,b,e;n.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},setAlpha:function(n){return this._a=k(n),this._roundA=t(100*this._a)/100,this},toHsv:function(){var n=y(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=y(this._r,this._g,this._b),i=t(n.h*360),r=t(n.s*100),u=t(n.v*100);return this._a==1?"hsv("+i+", "+r+"%, "+u+"%)":"hsva("+i+", "+r+"%, "+u+"%, "+this._roundA+")"},toHsl:function(){var n=v(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=v(this._r,this._g,this._b),i=t(n.h*360),r=t(n.s*100),u=t(n.l*100);return this._a==1?"hsl("+i+", "+r+"%, "+u+"%)":"hsla("+i+", "+r+"%, "+u+"%, "+this._roundA+")"},toHex:function(n){return p(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(){return w(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:t(this._r),g:t(this._g),b:t(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+t(this._r)+", "+t(this._g)+", "+t(this._b)+")":"rgba("+t(this._r)+", "+t(this._g)+", "+t(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:t(i(this._r,255)*100)+"%",g:t(i(this._g,255)*100)+"%",b:t(i(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+t(i(this._r,255)*100)+"%, "+t(i(this._g,255)*100)+"%, "+t(i(this._b,255)*100)+"%)":"rgba("+t(i(this._r,255)*100)+"%, "+t(i(this._g,255)*100)+"%, "+t(i(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:b[p(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var i="#"+w(this._r,this._g,this._b,this._a),r=i,f=this._gradientType?"GradientType = 1, ":"",u;return t&&(u=n(t),r=u.toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+f+"startColorstr="+i+",endColorstr="+r+")"},toString:function(n){var i=!!n;n=n||this._format;var t=!1,r=this._a<1&&this._a>=0,u=!i&&r&&(n==="hex"||n==="hex6"||n==="hex3"||n==="name");return u?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(t=this.toRgbString()),n==="prgb"&&(t=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(t=this.toHexString()),n==="hex3"&&(t=this.toHexString(!0)),n==="hex8"&&(t=this.toHex8String()),n==="name"&&(t=this.toName()),n==="hsl"&&(t=this.toHslString()),n==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},_applyModification:function(n,t){var i=n.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(st,arguments)},brighten:function(){return this._applyModification(ht,arguments)},darken:function(){return this._applyModification(ct,arguments)},desaturate:function(){return this._applyModification(ft,arguments)},saturate:function(){return this._applyModification(et,arguments)},greyscale:function(){return this._applyModification(ot,arguments)},spin:function(){return this._applyModification(lt,arguments)},_applyCombination:function(n,t){return n.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(wt,arguments)},complement:function(){return this._applyCombination(at,arguments)},monochromatic:function(){return this._applyCombination(bt,arguments)},splitcomplement:function(){return this._applyCombination(pt,arguments)},triad:function(){return this._applyCombination(vt,arguments)},tetrad:function(){return this._applyCombination(yt,arguments)}};n.fromRatio=function(t,i){var u,r;if(typeof t=="object"){u={};for(r in t)t.hasOwnProperty(r)&&(u[r]=r==="a"?t[r]:h(t[r]));t=u}return n(t,i)};n.equals=function(t,i){return!t||!i?!1:n(t).toRgbString()==n(i).toRgbString()};n.random=function(){return n.fromRatio({r:a(),g:a(),b:a()})};n.mix=function(t,i,r){var s,l;r=r===0?0:r||50;var f=n(t).toRgb(),e=n(i).toRgb(),h=r/100,o=h*2-1,c=e.a-f.a,u;return u=o*c==-1?o:(o+c)/(1+o*c),u=(u+1)/2,s=1-u,l={r:e.r*u+f.r*s,g:e.g*u+f.g*s,b:e.b*u+f.b*s,a:e.a*h+f.a*(1-h)},n(l)};n.readability=function(t,i){var f=n(t),e=n(i),r=f.toRgb(),u=e.toRgb(),o=f.getBrightness(),s=e.getBrightness(),h=Math.max(r.r,u.r)-Math.min(r.r,u.r)+Math.max(r.g,u.g)-Math.min(r.g,u.g)+Math.max(r.b,u.b)-Math.min(r.b,u.b);return{brightness:Math.abs(o-s),color:h}};n.isReadable=function(t,i){var r=n.readability(t,i);return r.brightness>125&&r.color>500};n.mostReadable=function(t,i){for(var h=null,o=0,r=!1,u=0;u<i.length;u++){var f=n.readability(t,i[u]),e=f.brightness>125&&f.color>500,s=3*(f.brightness/125)+f.color/500;(e&&!r||e&&r&&s>o||!e&&!r&&s>o)&&(r=e,o=s,h=n(i[u]))}return h};c=n.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};b=n.hexNames=kt(c);e=function(){var n="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+i),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=n}();n(function(){n.fn.spectrum.load&&n.fn.spectrum.processNativeColorInputs()})}):function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"&&typeof module=="object"?module.exports=n:n(jQuery)}(function(n,t){"use strict";function o(t,i,r,u){for(var e,f,c,l,a,v,o=[],s=0;s<t.length;s++)e=t[s],e?(f=tinycolor(e),c=f.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",c+=tinycolor.equals(i,e)?" sp-thumb-active":"",l=f.toString(u.preferredFormat||"rgb"),a=h?"background-color:"+f.toRgbString():"filter:"+f.toFilter(),o.push('<span title="'+l+'" data-color="'+f.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" data-function="spectrum" data-function-id="spectrum.color" data-service="service.layer" style="'+a+';" /><\/span>')):(v="sp-clear-display",o.push(n("<div />").append(n('<span data-color="" style="background-color:transparent;" class="'+v+'"><\/span>').attr("title",u.noColorSelectedText)).html()));return"<div class='sp-cf "+r+"'>"+o.join("")+"<\/div>"}function v(){for(var n=0;n<i.length;n++)i[n]&&i[n].hide()}function y(t,i){var r=n.extend({},s,t);return r.callbacks={change:b(r.change,i)},r}function p(u,s){function gi(){var t,i,r;if(c.showPaletteOnly&&(c.showPalette=!0),c.isAlwaysShowPalette&&(c.showPalette=!0),vr.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText),c.palette)for(si=c.palette.slice(0),ti=n.isArray(si[0])?si:[si],hi={},t=0;t<ti.length;t++)for(i=0;i<ti[t].length;i++)r=tinycolor(ti[t][i]).toRgbString(),hi[r]=!0;p.toggleClass("sp-flat",lt);p.toggleClass("sp-input-disabled",!c.showInput);p.toggleClass("sp-alpha-enabled",c.showAlpha);p.toggleClass("sp-clear-enabled",ot);p.toggleClass("sp-buttons-disabled",!c.showButtons);p.toggleClass("sp-palette-buttons-disabled",!c.togglePaletteOnly);p.toggleClass("sp-palette-disabled",!c.showPalette);p.toggleClass("sp-palette-only",c.showPaletteOnly);p.toggleClass("sp-initial-disabled",!c.showInitial);p.addClass(c.className).addClass(c.containerClassName);ct()}function lu(){n(this).data("spectrumButton",{cancel:function(n){n.stopPropagation();n.preventDefault();pu();wt()},moreToggle:function(){c.showPaletteOnly=!c.showPaletteOnly;c.showPaletteOnly||lt||c.appendTo.css("left","-="+(uu.outerWidth(!0)+5));gi()},clickPalette:function(t,i){return i.data&&i.data.ignore?(it(n(i.target).closest(".sp-thumb-el").data("color")),st()):(it(n(i.target).closest(".sp-thumb-el").data("color")),st(),ht(!1)),n.extend(rt(),{ecRole:c.ecRole,ecRoleIndex:c.ecRoleIndex})},clickChoose:function(){return r&&nt.is(":focus")&&nt.trigger("change"),wu()&&ht(!1),n.extend(rt(),{ecRole:c.ecRole,ecRoleIndex:c.ecRoleIndex})},destroy:function(){dr()}})}function au(){if(lu.call(u),r&&p.find("*:not(input)").attr("unselectable","on"),gi(),ki&&b.after(yt).hide(),ot||ar.hide(),lt)b.after(p).hide();else{var t=c.appendTo==="parent"?b.parent():n(c.appendTo);t.length!==1&&(t=n("body"));t.append(p)}yr();(b.is(":disabled")||c.disabled===!0)&&gr();nt.change(rr);nt.bind("paste",function(){setTimeout(rr,1)});nt.keydown(function(n){n.keyCode==13&&rr()});ou.text(c.cancelText);ar.attr("title",c.clearText);su.text(c.chooseText);vr.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText);e(lr,function(n,t,i){d=n/wi;et=!1;i.shiftKey&&(d=Math.round(d*10)/10);st()},tr,ir);e(bi,function(n,t){dt=parseFloat(t/oi);et=!1;c.showAlpha||(d=1);st()},tr,ir);e(ci,function(n,t,i){var r,u;if(i.shiftKey){if(!ut){var f=gt*vt,e=tt-ni*tt,o=Math.abs(n-f)>Math.abs(t-e);ut=o?"x":"y"}}else ut=null;r=!ut||ut==="x";u=!ut||ut==="y";r&&(gt=parseFloat(n/vt));u&&(ni=parseFloat((tt-t)/tt));et=!1;c.showAlpha||(d=1);st()},tr,ir);ui?(it(ui),bt(!0),fi=di||tinycolor(ui).format,nr(ui)):bt()}function yr(){if(at&&window.localStorage){try{var t=window.localStorage[at].split(",#");t.length>1&&(delete window.localStorage[at],n.each(t,function(n,t){nr(t)}))}catch(i){}try{g=window.localStorage[at].split(";")}catch(i){}}}function nr(t){if(nu){var i=tinycolor(t).toRgbString();if(!hi[i]&&n.inArray(i,g)===-1)for(g.push(i);g.length>ru;)g.shift();if(at&&window.localStorage)try{window.localStorage[at]=g.join(";")}catch(r){}}}function vu(){var t=[],n,i;if(c.showPalette)for(n=0;n<g.length;n++)i=tinycolor(g[n]).toRgbString(),hi[i]||t.push(g[n]);return t.reverse().slice(0,c.maxSelectionSize)}function pr(){var t=rt(),i=n.map(ti,function(n,i){return o(n,t,"sp-palette-row sp-palette-row-"+i,c)});yr();g&&i.push(o(vu(),t,"sp-palette-row sp-palette-row-selection",c));fu.html(i.join(""))}function wr(){if(c.showInitial){var t=pi,n=rt();eu.html(o([t,n],n,"sp-palette-row-initial",c))}}function tr(){(tt<=0||vt<=0||oi<=0)&&ct();p.addClass(sr);ut=null}function ir(){p.removeClass(sr)}function rr(){var n=nt.val(),t;(n===null||n==="")&&ot?(it(null),ht(!0)):(t=tinycolor(n),t.isValid()?(it(t),ht(!0)):nt.addClass("sp-validation-error"))}function yu(){kt?wt():br()}function br(){var t=n.Event("beforeShow.spectrum");if(kt){ct();return}v();kt=!0;n(window).bind("resize.spectrum",fr);yt.addClass("sp-active");p.removeClass("sp-hidden");ct();bt();pi=rt();wr()}function wt(){kt&&!lt&&(kt=!1,n(window).unbind("resize.spectrum",fr),yt.removeClass("sp-active"),p.addClass("sp-hidden"))}function pu(){it(pi,!0)}function it(n,t){if(tinycolor.equals(n,rt())){bt(!0);return}var i,r;!n&&ot?et=!0:(et=!1,i=tinycolor(n),r=i.toHsv(),dt=r.h%360/360,gt=r.s,ni=r.v,d=r.a);bt(!0);i&&i.isValid()&&!t&&(fi=di||i.getFormat())}function rt(n){return(n=n||{},ot&&et)?null:tinycolor.fromRatio({h:dt,s:gt,v:ni,a:Math.round(d*100)/100},{format:n.format||fi})}function wu(){return!nt.hasClass("sp-validation-error")}function st(){bt()}function bt(n){var l,t,i,o,u,a,s,f,e;nt.removeClass("sp-validation-error");kr();l=tinycolor.fromRatio({h:dt,s:1,v:1});ci.css("background-color",l.toHexString());t=fi;d<1&&!(d===0&&t==="name")&&(t==="hex"||t==="hex3"||t==="hex6"||t==="name")&&(t="rgb");n&&(i=rt({format:t}),o="",pt.removeClass("sp-clear-display"),pt.css("background-color","transparent"),!i&&ot?pt.addClass("sp-clear-display"):(u=i.toHexString(),a=i.toRgbString(),h||i.alpha===1?pt.css("background-color",a):(pt.css("background-color","transparent"),pt.css("filter",i.toFilter())),c.showAlpha&&(s=i.toRgb(),s.a=0,f=tinycolor(s).toRgbString(),e="linear-gradient(left, "+f+", "+u+")",r?ii.css("filter",tinycolor(f).toFilter({gradientType:1},u)):(ii.css("background","-webkit-"+e),ii.css("background","-moz-"+e),ii.css("background","-ms-"+e),ii.css("background","linear-gradient(to right, "+f+", "+u+")"))),o=i.toString(t)),c.showInput&&nt.val(o));c.showPalette&&pr();wr()}function kr(){var u=gt,f=ni,n,t,i,r;ot&&et?(vi.hide(),ai.hide(),li.hide()):(vi.show(),ai.show(),li.show(),n=u*vt,t=tt-f*tt,n=Math.max(-ft,Math.min(vt-ft,n-ft)),t=Math.max(-ft,Math.min(tt-ft,t-ft)),li.css({top:t+"px",left:n+"px"}),i=d*wi,vi.css({left:i-er/2+"px"}),r=dt*oi,ai.css({top:r-or+"px"}))}function ht(t){var i=rt(),r="",u=!tinycolor.equals(i,pi);i&&(r=i.toString(fi),nr(i));yi&&b.val(r);t&&u&&tu.change(n.extend(i,{ecRole:c.ecRole,ecRoleIndex:c.ecRoleIndex}))}function ct(){function u(){var n=ri.offset();return{width:ri.outerWidth(),heigth:ri.outerHeight(),top:n.top,left:n.left}}var t,r,i;vt=ci.width();tt=ci.height();ft=li.height();iu=bi.width();oi=bi.height();or=ai.height();wi=lr.width();er=vi.width();lt||(t=c.appendTo||p,t.css("position","absolute"),c.offset?t.offset(c.offset):(r=n.extend({},c.offsetSpectrumParent||u()),i=w(t,r),t.css("top",i.top),t.css("left",i.left)));kr();c.showPalette&&pr()}function dr(){b.show();p.remove();yt.remove();i[ei.id]=null}function bu(i,r){if(i===t)return n.extend({},c);if(r===t)return c[i];c[i]=r;gi()}function ku(){cr=!1;b.attr("disabled",!1);ri.removeClass("sp-disabled")}function gr(){wt();cr=!0;b.attr("disabled",!0);ri.addClass("sp-disabled")}function du(n){c.offset=n;ct()}var c=y(s,u),lt=c.flat,nu=c.showSelectionPalette,at=c.localStorageKey,ur=c.theme,tu=c.callbacks,fr=k(ct,10),kt=!1,vt=0,tt=0,ft=0,oi=0,iu=0,wi=0,er=0,or=0,dt=0,gt=0,ni=0,d=1,si=[],ti=[],hi={},g=c.selectionPalette.slice(0),ru=c.maxSelectionSize,sr="sp-dragging",ut=null,hr=u.ownerDocument,gu=hr.body,b=n(u),cr=!1,p=n(a,hr).addClass(ur),uu=p.find(".sp-picker-container"),ci=p.find(".sp-color"),li=p.find(".sp-dragger"),bi=p.find(".sp-hue"),ai=p.find(".sp-slider"),ii=p.find(".sp-alpha-inner"),lr=p.find(".sp-alpha"),vi=p.find(".sp-alpha-handle"),nt=p.find(".sp-input"),fu=p.find(".sp-palette"),eu=p.find(".sp-initial"),ou=p.find(".sp-cancel"),ar=p.find(".sp-clear"),su=p.find(".sp-choose"),vr=p.find(".sp-palette-toggle"),yi=b.is("input"),hu=yi&&b.attr("type")==="color"&&f(),ki=yi&&!lt,yt=ki?n(l).addClass(ur).addClass(c.className).addClass(c.replacerClassName):n([]),ri=ki?yt:b,pt=yt.find(".sp-preview-inner"),ui=c.color||yi&&b.val(),pi=!1,di=c.preferredFormat,fi=di,cu=!c.showButtons||c.clickoutFiresChange,et=!ui,ot=c.allowEmpty&&!hu,ei;return au(),ei={show:br,hide:wt,toggle:yu,reflow:ct,option:bu,enable:ku,disable:gr,offset:du,set:function(n){it(n);ht()},get:rt,destroy:dr,container:p},ei.id=i.push(ei)-1,ei}function w(t,i){var o=0,r=t.outerWidth(),u=t.outerHeight(),s=i.height,f=t[0].ownerDocument,h=f.documentElement,e=h.clientWidth+n(f).scrollLeft(),c=h.clientHeight+n(f).scrollTop();return i.top+=s,i.left-=Math.min(i.left,i.left+r>e&&e>r?Math.abs(i.left+r-e):0),i.top-=Math.min(i.top,i.top+u>c&&c>u?Math.abs(u+s-o):o),i}function u(){}function b(n,t){var i=Array.prototype.slice,r=i.call(arguments,2);return function(){return n.apply(t,r.concat(i.call(arguments)))}}function e(t,i,u,f){function h(n){n.stopPropagation&&n.stopPropagation();n.preventDefault&&n.preventDefault();n.returnValue=!1}function y(n){if(s){if(r&&o.documentMode<9&&!n.button)return p();var u=n.originalEvent&&n.originalEvent.touches&&n.originalEvent.touches[0],f=u&&u.pageX||n.pageX,e=u&&u.pageY||n.pageY,y=Math.max(0,Math.min(f-c.left,a)),w=Math.max(0,Math.min(e-c.top,l));v&&h(n);i.apply(t,[y,w,n])}}function w(i){var r=i.which?i.which==3:i.button==2;r||s||u.apply(t,arguments)!==!1&&(s=!0,l=n(t).height(),a=n(t).width(),c=n(t).offset(),n(o).bind(e),n(o.body).addClass("sp-dragging"),v||y(i),h(i))}function p(){s&&(n(o).unbind(e),n(o.body).removeClass("sp-dragging"),f.apply(t,arguments));s=!1}i=i||function(){};u=u||function(){};f=f||function(){};var o=document,s=!1,c={},l=0,a=0,v="ontouchstart"in window,e={};e.selectstart=h;e.dragstart=h;e["touchmove mousemove"]=y;e["touchend mouseup"]=p;n(t).bind("touchstart mousedown",w)}function k(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;n.apply(u,f)};i&&clearTimeout(r);(i||!r)&&(r=setTimeout(e,t))}}function f(){return n.fn.spectrum.inputTypeColorSupport()}var s={beforeShow:u,move:u,change:u,show:u,hide:u,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},i=[],r=!!/msie/i.exec(window.navigator.userAgent),h=function(){function t(n,t){return!!~(""+n).indexOf(t)}var i=document.createElement("div"),n=i.style;return n.cssText="background-color:rgba(0,0,0,.5)",t(n.backgroundColor,"rgba")||t(n.backgroundColor,"hsla")}(),l="<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'><\/div><\/div><div class='sp-dd'>&#9660;<\/div><\/div>",a=function(){var t="",n;if(r)for(n=1;n<=6;n++)t+="<div class='sp-"+n+"'><\/div>";return["<div class='sp-container sp-hidden position-static'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'><\/div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle' data-function='spectrum' data-function-id='spectrum.more' data-service='service.layer'><\/button>","<\/div>","<\/div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'><\/div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'><\/div>","<\/div>","<\/div>","<\/div>","<div class='sp-clear sp-clear-display'>","<\/div>","<div class='sp-hue'>","<div class='sp-slider'><\/div>",t,"<\/div>","<\/div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'><\/div><\/div><\/div>","<\/div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false' data-service='service.layer' />","<\/div>","<div class='sp-initial sp-thumb sp-cf'><\/div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'><\/a>","<button type='button' class='sp-choose' data-function='spectrum' data-function-id='spectrum.choose' data-service='service.layer'><\/button>","<\/div>","<\/div>","<\/div>"].join("")}(),c="spectrum.id";n.fn.spectrum=function(t){if(typeof t=="string"){var r=this,u=Array.prototype.slice.call(arguments,1);return this.each(function(){var f=i[n(this).data(c)],e;if(f){if(e=f[t],!e)throw new Error("Spectrum: no such method: '"+t+"'");t=="get"?r=f.get():t=="container"?r=f.container:t=="option"?r=f.option.apply(f,u):t=="destroy"?(f.destroy(),n(this).removeData(c)):e.apply(f,u)}}),r}return this.spectrum("destroy").each(function(){var i=n.extend({},t,n(this).data()),r=p(this,i);n(this).data("spectrum",r)})};n.fn.spectrum.load=!0;n.fn.spectrum.loadOpts={};n.fn.spectrum.draggable=e;n.fn.spectrum.defaults=s;n.fn.spectrum.inputTypeColorSupport=function f(){if(typeof f._cachedResult=="undefined"){var t=n("<input type='color' value='!' />")[0];f._cachedResult=t.type==="color"&&t.value!=="!"}return f._cachedResult};n.spectrum={};n.spectrum.localization={};n.spectrum.palettes={};n.fn.spectrum.processNativeColorInputs=function(){var t=n("input[type=color]");t.length&&!f()&&t.spectrum({preferredFormat:"hex6"})},function(){function tt(n){var t={r:0,g:0,b:0},i=1,f=!1,e=!1;return typeof n=="string"&&(n=ii(n)),typeof n=="object"&&(n.hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")?(t=it(n.r,n.g,n.b),f=!0,e=String(n.r).substr(-1)==="%"?"prgb":"rgb"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("v")?(n.s=h(n.s),n.v=h(n.v),t=ut(n.h,n.s,n.v),f=!0,e="hsv"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("l")&&(n.s=h(n.s),n.l=h(n.l),t=rt(n.h,n.s,n.l),f=!0,e="hsl"),n.hasOwnProperty("a")&&(i=n.a)),i=k(i),{ok:f,format:n.format||e,r:r(255,u(t.r,0)),g:r(255,u(t.g,0)),b:r(255,u(t.b,0)),a:i}}function it(n,t,r){return{r:i(n,255)*255,g:i(t,255)*255,b:i(r,255)*255}}function v(n,t,f){var s;n=i(n,255);t=i(t,255);f=i(f,255);var e=u(n,t,f),h=r(n,t,f),o,c,l=(e+h)/2;if(e==h)o=c=0;else{s=e-h;c=l>.5?s/(2-e-h):s/(e+h);switch(e){case n:o=(t-f)/s+(t<f?6:0);break;case t:o=(f-n)/s+2;break;case f:o=(n-t)/s+4}o/=6}return{h:o,s:c,l:l}}function rt(n,t,r){function h(n,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?n+(t-n)*6*i:i<1/2?t:i<2/3?n+(t-n)*(2/3-i)*6:n}var e,o,s,u,f;return n=i(n,360),t=i(t,100),r=i(r,100),t===0?e=o=s=r:(u=r<.5?r*(1+t):r+t-r*t,f=2*r-u,e=h(f,u,n+1/3),o=h(f,u,n),s=h(f,u,n-1/3)),{r:e*255,g:o*255,b:s*255}}function y(n,t,f){n=i(n,255);t=i(t,255);f=i(f,255);var e=u(n,t,f),h=r(n,t,f),o,c,l=e,s=e-h;if(c=e===0?0:s/e,e==h)o=0;else{switch(e){case n:o=(t-f)/s+(t<f?6:0);break;case t:o=(f-n)/s+2;break;case f:o=(n-t)/s+4}o/=6}return{h:o,s:c,v:l}}function ut(n,t,r){n=i(n,360)*6;t=i(t,100);r=i(r,100);var h=s.floor(n),c=n-h,u=r*(1-t),f=r*(1-c*t),e=r*(1-(1-c)*t),o=h%6,l=[r,f,u,u,e,r][o],a=[e,r,r,f,u,u][o],v=[u,u,e,r,r,f][o];return{r:l*255,g:a*255,b:v*255}}function p(n,i,r,u){var f=[o(t(n).toString(16)),o(t(i).toString(16)),o(t(r).toString(16))];return u&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0):f.join("")}function w(n,i,r,u){var f=[o(ni(u)),o(t(n).toString(16)),o(t(i).toString(16)),o(t(r).toString(16))];return f.join("")}function ft(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.s-=i/100,r.s=l(r.s),n(r)}function et(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.s+=i/100,r.s=l(r.s),n(r)}function ot(t){return n(t).desaturate(100)}function st(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.l+=i/100,r.l=l(r.l),n(r)}function ht(i,f){f=f===0?0:f||10;var e=n(i).toRgb();return e.r=u(0,r(255,e.r-t(255*-(f/100)))),e.g=u(0,r(255,e.g-t(255*-(f/100)))),e.b=u(0,r(255,e.b-t(255*-(f/100)))),n(e)}function ct(t,i){i=i===0?0:i||10;var r=n(t).toHsl();return r.l-=i/100,r.l=l(r.l),n(r)}function lt(i,r){var u=n(i).toHsl(),f=(t(u.h)+r)%360;return u.h=f<0?360+f:f,n(u)}function at(t){var i=n(t).toHsl();return i.h=(i.h+180)%360,n(i)}function vt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+120)%360,s:i.s,l:i.l}),n({h:(r+240)%360,s:i.s,l:i.l})]}function yt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+90)%360,s:i.s,l:i.l}),n({h:(r+180)%360,s:i.s,l:i.l}),n({h:(r+270)%360,s:i.s,l:i.l})]}function pt(t){var i=n(t).toHsl(),r=i.h;return[n(t),n({h:(r+72)%360,s:i.s,l:i.l}),n({h:(r+216)%360,s:i.s,l:i.l})]}function wt(t,i,r){i=i||6;r=r||30;var u=n(t).toHsl(),f=360/r,e=[n(t)];for(u.h=(u.h-(f*i>>1)+720)%360;--i;)u.h=(u.h+f)%360,e.push(n(u));return e}function bt(t,i){i=i||6;for(var r=n(t).toHsv(),e=r.h,o=r.s,u=r.v,f=[],s=1/i;i--;)f.push(n({h:e,s:o,v:u})),u=(u+s)%1;return f}function kt(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[n[t]]=t);return i}function k(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function i(n,t){dt(n)&&(n="100%");var i=gt(n);return(n=r(t,u(0,parseFloat(n))),i&&(n=parseInt(n*t,10)/100),s.abs(n-t)<1e-6)?1:n%t/parseFloat(t)}function l(n){return r(1,u(0,n))}function f(n){return parseInt(n,16)}function dt(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function gt(n){return typeof n=="string"&&n.indexOf("%")!=-1}function o(n){return n.length==1?"0"+n:""+n}function h(n){return n<=1&&(n=n*100+"%"),n}function ni(n){return Math.round(parseFloat(n)*255).toString(16)}function ti(n){return f(n)/255}function ii(n){var i,t;if(n=n.replace(d,"").replace(g,"").toLowerCase(),i=!1,c[n])n=c[n],i=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(t=e.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=e.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=e.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=e.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=e.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=e.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=e.hex8.exec(n))?{a:ti(t[1]),r:f(t[2]),g:f(t[3]),b:f(t[4]),format:i?"name":"hex8"}:(t=e.hex6.exec(n))?{r:f(t[1]),g:f(t[2]),b:f(t[3]),format:i?"name":"hex"}:(t=e.hex3.exec(n))?{r:f(t[1]+""+t[1]),g:f(t[2]+""+t[2]),b:f(t[3]+""+t[3]),format:i?"name":"hex"}:!1}var d=/^[\s,#]+/,g=/\s+$/,nt=0,s=Math,t=s.round,r=s.min,u=s.max,a=s.random,n=function(i,r){if(i=i?i:"",r=r||{},i instanceof n)return i;if(!(this instanceof n))return new n(i,r);var u=tt(i);this._originalInput=i;this._r=u.r;this._g=u.g;this._b=u.b;this._a=u.a;this._roundA=t(100*this._a)/100;this._format=r.format||u.format;this._gradientType=r.gradientType;this._r<1&&(this._r=t(this._r));this._g<1&&(this._g=t(this._g));this._b<1&&(this._b=t(this._b));this._ok=u.ok;this._tc_id=nt++},c,b,e;n.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},setAlpha:function(n){return this._a=k(n),this._roundA=t(100*this._a)/100,this},toHsv:function(){var n=y(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=y(this._r,this._g,this._b),i=t(n.h*360),r=t(n.s*100),u=t(n.v*100);return this._a==1?"hsv("+i+", "+r+"%, "+u+"%)":"hsva("+i+", "+r+"%, "+u+"%, "+this._roundA+")"},toHsl:function(){var n=v(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=v(this._r,this._g,this._b),i=t(n.h*360),r=t(n.s*100),u=t(n.l*100);return this._a==1?"hsl("+i+", "+r+"%, "+u+"%)":"hsla("+i+", "+r+"%, "+u+"%, "+this._roundA+")"},toHex:function(n){return p(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(){return w(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:t(this._r),g:t(this._g),b:t(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+t(this._r)+", "+t(this._g)+", "+t(this._b)+")":"rgba("+t(this._r)+", "+t(this._g)+", "+t(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:t(i(this._r,255)*100)+"%",g:t(i(this._g,255)*100)+"%",b:t(i(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+t(i(this._r,255)*100)+"%, "+t(i(this._g,255)*100)+"%, "+t(i(this._b,255)*100)+"%)":"rgba("+t(i(this._r,255)*100)+"%, "+t(i(this._g,255)*100)+"%, "+t(i(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:b[p(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var i="#"+w(this._r,this._g,this._b,this._a),r=i,f=this._gradientType?"GradientType = 1, ":"",u;return t&&(u=n(t),r=u.toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+f+"startColorstr="+i+",endColorstr="+r+")"},toString:function(n){var i=!!n;n=n||this._format;var t=!1,r=this._a<1&&this._a>=0,u=!i&&r&&(n==="hex"||n==="hex6"||n==="hex3"||n==="name");return u?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(t=this.toRgbString()),n==="prgb"&&(t=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(t=this.toHexString()),n==="hex3"&&(t=this.toHexString(!0)),n==="hex8"&&(t=this.toHex8String()),n==="name"&&(t=this.toName()),n==="hsl"&&(t=this.toHslString()),n==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},_applyModification:function(n,t){var i=n.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(st,arguments)},brighten:function(){return this._applyModification(ht,arguments)},darken:function(){return this._applyModification(ct,arguments)},desaturate:function(){return this._applyModification(ft,arguments)},saturate:function(){return this._applyModification(et,arguments)},greyscale:function(){return this._applyModification(ot,arguments)},spin:function(){return this._applyModification(lt,arguments)},_applyCombination:function(n,t){return n.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(wt,arguments)},complement:function(){return this._applyCombination(at,arguments)},monochromatic:function(){return this._applyCombination(bt,arguments)},splitcomplement:function(){return this._applyCombination(pt,arguments)},triad:function(){return this._applyCombination(vt,arguments)},tetrad:function(){return this._applyCombination(yt,arguments)}};n.fromRatio=function(t,i){var u,r;if(typeof t=="object"){u={};for(r in t)t.hasOwnProperty(r)&&(u[r]=r==="a"?t[r]:h(t[r]));t=u}return n(t,i)};n.equals=function(t,i){return!t||!i?!1:n(t).toRgbString()==n(i).toRgbString()};n.random=function(){return n.fromRatio({r:a(),g:a(),b:a()})};n.mix=function(t,i,r){var s,l;r=r===0?0:r||50;var f=n(t).toRgb(),e=n(i).toRgb(),h=r/100,o=h*2-1,c=e.a-f.a,u;return u=o*c==-1?o:(o+c)/(1+o*c),u=(u+1)/2,s=1-u,l={r:e.r*u+f.r*s,g:e.g*u+f.g*s,b:e.b*u+f.b*s,a:e.a*h+f.a*(1-h)},n(l)};n.readability=function(t,i){var f=n(t),e=n(i),r=f.toRgb(),u=e.toRgb(),o=f.getBrightness(),s=e.getBrightness(),h=Math.max(r.r,u.r)-Math.min(r.r,u.r)+Math.max(r.g,u.g)-Math.min(r.g,u.g)+Math.max(r.b,u.b)-Math.min(r.b,u.b);return{brightness:Math.abs(o-s),color:h}};n.isReadable=function(t,i){var r=n.readability(t,i);return r.brightness>125&&r.color>500};n.mostReadable=function(t,i){for(var h=null,o=0,r=!1,u=0;u<i.length;u++){var f=n.readability(t,i[u]),e=f.brightness>125&&f.color>500,s=3*(f.brightness/125)+f.color/500;(e&&!r||e&&r&&s>o||!e&&!r&&s>o)&&(r=e,o=s,h=n(i[u]))}return h};c=n.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};b=n.hexNames=kt(c);e=function(){var n="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+i),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=n}();n(function(){n.fn.spectrum.load&&n.fn.spectrum.processNativeColorInputs()})}),function(){ecount.document={ts:Date.now(),exceptionCallback:function(n,t){if(n=="DataLimitException"){ecount.alert(ecount.resource.MSG05178);var i;i=window.name=="body"&&window.$("#__ecSubmitForm").length>0?window.$("#__ecSubmitForm"):ecount.popup.parent.$("#__ecSubmitForm");i.attr("action",i.attr("action")+"&csv=Y");i.submit()}else ecount.alert(t)},exportExcel:function(n,t,i,r,u){var o={pageSessionKey:(window.requestUrl.param.ec_req_sid||window.requestUrl.param.SESSION_ID)+(i||this.ts)},s=this,e=$.extend({},o,t),f=t.ecPageID;t&&t.Request&&(t=t.Request);ecount.common.api({ecPageID:f,url:"/Common/Infra/CheckExcelVersion",data:Object.toJSON(o),success:function(i){var h=i.Data;if(h=="Y")ecount.alert(ecount.resource.message.CONVERT_EXCEL,function(){r&&r()});else{u==!0?(ecount.common.gmcSessionApi({ecPageID:f,sessionURL:n,callbackApi:o}),r&&r()):t&&(t.EXCEL_CONVERT_MODE=="T"||t.Data&&t.Data.EXCEL_CONVERT_MODE=="T")?(n.startsWith("http")||n.startsWith(ecount.apiPathRoot)||(n=ecount.apiPathRoot+n),n=ecount.common.buildSessionUrl(n),ecount.common.api({ecPageID:f,url:n,data:Object.toJSON(e),success:function(n){sessionStorage.setItem(t.Data.pageSessionKey,Date.now());r&&r(n)}.bind(this),error:function(n,t,i){ecount.alert(i.Message);r&&r()}.bind(this)})):o();function o(i){var u;if(ecount.document._isDownloadApp(null,{method:"POST",message:"download",url:ecount.apiPathRoot+n,type:"excel",param:e})){r&&r();return}var o=window.name=="body"?window:ecount.popup.parent,c=o.$("#ifrmExcel"),h="ifrmExcel";if(!o||o.$("body").length===0){ecount.alert(ecount.resource.MSG07868);r&&r();return}c.length==0&&o.$("body").append($('<iframe id="ifrmExcel" name="ifrmExcel" style="width:0px; height:0px;border:0" class="hidden"><\/iframe>'));u=o.$("#__ecSubmitForm");u.length==0?(u=$('<form id="__ecSubmitForm" method="POST"/>'),o.$("body").append(u)):u.empty();$.isNull(i)?(n.startsWith("http")||n.startsWith(ecount.apiPathRoot)||(n=ecount.apiPathRoot+n),n=ecount.common.buildSessionUrl(n)):n=i;u.append($('<input type="hidden" name="jsonp"/>').val(Object.toJSON(e)));u.attr("action",n+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback");u.attr("method","post");ecount.common.isIOS===!0&&(h=ecount.common.isInApp?"":" ");u.attr("target",h);u.submit();(t.isSaveHistory||!1)&&s.setHistory({CS_FLAG:t.CS_FLAG||"None",LOG_STATUS:t.LOG_STATUS||"X",Slips:t.Slips,SlipsInfos:Object.toJSON(t.Slips),SAL_TYPE_CD:$.isEmpty(t.SAL_TYPE_CD)?null:t.SAL_TYPE_CD,ecPageID:f},function(){},function(){});r&&r()}}}})},getSearchConditionTitle:function(n,t){var r={};switch(n){case"manage":var u=" "+ecount.resource.LBL09336,f=" / ",i=[];t.customer&&t.customer.length>0&&i.push(t.customer[0]+(t.customer.length!=1?u:""));t.site&&t.site.length>0&&i.push(t.site[0]+(t.site.length!=1?u:""));t.project&&t.project.length>0&&i.push(t.project[0]+(t.project.length!=1?u:""));t.empCd&&t.empCd.length>0&&i.push(t.empCd[0]+(t.empCd.length!=1?u:""));t.itemCd&&t.itemCd.length>0&&i.push(t.itemCd[0]+(t.itemCd.length!=1?u:""));t.ioType&&t.ioType!=""&&i.push(t.ioType);t.ioTypes&&t.ioTypes.length>0&&i.push(t.ioTypes[0]+(t.ioTypes.length!=1?u:""));t.userid&&t.userid.length>0&&i.push(t.userid[0]+(t.userid.length!=1?u:""));r.leftTitle=ecount.resource.LBL03176+" : "+(ecount.company.COM_DES||"COM_DES Create!!! ")+(i.length>0?" / ":"")+i.join(f);t.dateFrom?ecount.config.company&&ecount.config.company.MYPAGECOMPANY_DATE?(r.period=t.dateTo?String.format("{0} ~ {1}",ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),ecount.infra.getECDateFormat("DATE10",!1,t.dateTo.toDate())):ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),r.excelTitle=r.leftTitle+f+r.period):(r.period=String.format("{0}/{1}/{2} ~ {3}/{4}/{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)),r.excelTitle=r.leftTitle+f+String.format("{0}.{1}.{2} ~ {3}.{4}.{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2))):r.excelTitle=r.leftTitle;break;case"inventory":var u=" "+ecount.resource.LBL09336,f=" / ",i=[];t.wh&&t.wh.length>0&&i.push(t.wh[0]+(t.wh.length!=1?u:""));t.wh_f&&t.wh_f.length>0&&i.push(t.wh_f[0]+(t.wh_f.length!=1?u:""));t.wh_t&&t.wh_t.length>0&&i.push(t.wh_t[0]+(t.wh_t.length!=1?u:""));t.customer&&t.customer.length>0&&i.push(t.customer[0]+(t.customer.length!=1?u:""));t.product&&t.product.length>0&&i.push(t.product[0]+(t.product.length!=1?u:""));t.project&&t.project.length>0&&i.push(t.project[0]+(t.project.length!=1?u:""));t.site&&t.site.length>0&&i.push(t.site[0]+(t.site.length!=1?u:""));t.empCd&&t.empCd.length>0&&i.push(t.empCd[0]+(t.empCd.length!=1?u:""));t.itemCd&&t.itemCd.length>0&&i.push(t.itemCd[0]+(t.itemCd.length!=1?u:""));t.ioType&&t.ioType!=""&&i.push(t.ioType);t.ioTypes&&t.ioTypes.length>0&&i.push(t.ioTypes[0]+(t.ioTypes.length!=1?u:""));t.userid&&t.userid.length>0&&i.push(t.userid[0]+(t.userid.length!=1?u:""));r.leftTitle=ecount.resource.LBL03176+" : "+(ecount.company.COM_DES||"COM_DES Create!!! ")+(i.length>0?" / ":"")+i.join(f);t.dateFrom?ecount.config.company&&ecount.config.company.MYPAGECOMPANY_DATE?(r.period=t.dateTo?String.format("{0} ~ {1}",ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),ecount.infra.getECDateFormat("DATE10",!1,t.dateTo.toDate())):ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),r.excelTitle=r.leftTitle+f+r.period):(r.period=String.format("{0}/{1}/{2} ~ {3}/{4}/{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)),r.excelTitle=r.leftTitle+f+String.format("{0}.{1}.{2} ~ {3}.{4}.{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2))):r.excelTitle=r.leftTitle;break;case"account":var u=" "+ecount.resource.LBL09336,f=" / ",i=[],e="";t.trackingNo&&i.push(t.trackingNo);t.customer&&t.customer.length>0&&i.push(t.customer[0]+(t.customer.length!=1?u:""));t.gyeCode&&t.gyeCode.length>0&&($.isArray(t.gyeCode)?i.push(t.gyeCode[0]+(t.gyeCode.length!=1?u:"")):i.push(t.gyeCode));t.site&&t.site.length>0&&i.push(t.site[0]+(t.site.length!=1?u:""));t.project&&t.project.length>0&&i.push(t.project[0]+(t.project.length!=1?u:""));t.empCd&&t.empCd.length>0&&i.push(t.empCd[0]+(t.empCd.length!=1?u:""));t.assetsCode&&t.assetsCode.length>0&&i.push(t.assetsCode[0]+(t.assetsCode.length!=1?u:""));t.contract&&t.contract.length>0&&i.push(t.contract[0]+(t.contract.length!=1?u:""));t.contractBilling&&t.contractBilling.length>0&&i.push(t.contractBilling[0]+(t.contractBilling.length!=1?u:""));t.contractItem&&t.contractItem.length>0&&i.push(t.contractItem[0]+(t.contractItem.length!=1?u:""));t.billingUnit&&t.billingUnit.length>0&&i.push(t.billingUnit[0]+(t.billingUnit.length!=1?u:""));ecount.config.company&&ecount.config.company.MYPAGECOMPANY_DATE?t.dateFrom?(r.period=t.dateTo?String.format("{0} ~ {1}",ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),ecount.infra.getECDateFormat("DATE10",!1,t.dateTo.toDate())):ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),r.excelTitle=r.leftTitle+f+r.period):r.excelTitle=r.leftTitle:r.period=t.dateTo&&t.dateTo.length>0?String.format("{0}/{1}/{2} ~ {3}/{4}/{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)):String.format("{0}/{1}/{2}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2));t.taxType&&t.taxType.length>0&&i.push(t.taxType[0]+(t.taxType.length!=1?u:""));e=$.isEmpty(t.comDes)?ecount.company.COM_DES||"COM_DES Create!!! ":t.comDes;r.leftTitle=ecount.resource.LBL03176+" : "+e+(i.length>0?" / ":"")+i.join(f);r.excelTitle=ecount.config.company&&ecount.config.company.MYPAGECOMPANY_DATE?r.leftTitle+f+r.period:t.dateTo&&t.dateTo.length>0?r.leftTitle+f+String.format("{0}.{1}.{2} ~ {3}.{4}.{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)):r.leftTitle+f+String.format("{0}.{1}.{2}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2));break;case"common":var u=" "+ecount.resource.LBL09336,f=" / ",i=[];t.wh&&t.wh.length>0&&i.push(t.wh[0]+(t.wh.length!=1?u:""));t.customer&&t.customer.length>0&&i.push(t.customer[0]+(t.customer.length!=1?u:""));t.product&&t.product.length>0&&i.push(t.product[0]+(t.product.length!=1?u:""));t.gyeCode&&t.gyeCode.length>0&&($.isArray(t.gyeCode)?i.push(t.gyeCode[0]+(t.gyeCode.length!=1?u:"")):i.push(t.gyeCode));t.site&&t.site.length>0&&i.push(t.site[0]+(t.site.length!=1?u:""));t.project&&t.project.length>0&&i.push(t.project[0]+(t.project.length!=1?u:""));t.ioType&&t.ioType!=""&&i.push(t.ioType);t.ioTypes&&t.ioTypes.length>0&&i.push(t.ioTypes[0]+(t.ioTypes.length!=1?u:""));t.empCd&&t.empCd.length>0&&i.push(t.empCd[0]+(t.empCd.length!=1?u:""));t.itemCd&&t.itemCd.length>0&&i.push(t.itemCd[0]+(t.itemCd.length!=1?u:""));t.contract&&t.contract.length>0&&i.push(t.contract[0]+(t.contract.length!=1?u:""));t.contractBilling&&t.contractBilling.length>0&&i.push(t.contractBilling[0]+(t.contractBilling.length!=1?u:""));t.contractItem&&t.contractItem.length>0&&i.push(t.contractItem[0]+(t.contractItem.length!=1?u:""));t.billingUnit&&t.billingUnit.length>0&&i.push(t.billingUnit[0]+(t.billingUnit.length!=1?u:""));r.leftTitle=ecount.resource.LBL03176+" : "+(ecount.company.COM_DES||"COM_DES Create!!! ")+(i.length>0?" / ":"")+i.join(f);ecount.config.company&&ecount.config.company.MYPAGECOMPANY_DATE?(r.period=t.dateTo?String.format("{0} ~ {1}",ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),ecount.infra.getECDateFormat("DATE10",!1,t.dateTo.toDate())):ecount.infra.getECDateFormat("DATE10",!1,t.dateFrom.toDate()),r.excelTitle=r.leftTitle+f+r.period):(r.period=String.format("{0}/{1}/{2} ~ {3}/{4}/{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)),r.excelTitle=r.leftTitle+f+String.format("{0}.{1}.{2} ~ {3}.{4}.{5}",t.dateFrom.substr(0,4),t.dateFrom.substr(4,2),t.dateFrom.substr(6,2),t.dateTo.substr(0,4),t.dateTo.substr(4,2),t.dateTo.substr(6,2)))}return r},print:function(n,t){var r=t.gridWidth,i={};window.onprintcomplete=function(){};i=$.browser.msie?{width:1,height:1,left:5e4,top:5e4,printCss:t.printCss}:{width:window.screen.width-10,height:window.screen.height-60,left:5e4,top:5e4,printCss:t.printCss};$.isEmpty(t.data)||(t.data.isOpenPopupPrint||!1)!=!1?ecount.popup.openWindow({url:"/ECErp/Popup.Common/PrintPage",name:ecount.resource.LBL09235,param:$.extend(i,n||{}),popupType:!0,fAlreadyIncludedLayout:!1}):ecount.document.printPop2(t)},printImageSource:function(n,t){var r=["<!DOCTYPE html>","<head><\/head>","<body>",'<script type="text/javascript">',"var $imgTag = new Image();",'$imgTag.src ="'+n+'";','$imgTag.style.width = "90%";',"$imgTag.onload = function printImg() { ",'if (document.queryCommandSupported("print")) { ','document.execCommand("print", false, null);',"} else {","print();","}",'window.setTimeout(function () { window.open("about:blank", "_self").close();}, 200);',"};","document.body.appendChild($imgTag);","<\/script>","<\/body>","<\/html>"].join(""),i=window.open(ecount.common.buildSessionUrl(),t,"_blank");i.document.open();i.document.write(r)},previewImageSource:function(n){var t=["<!DOCTYPE html>","<head><\/head>","<body>",'<script type="text/javascript">',"var $imgTag = new Image();",'$imgTag.src ="'+n+'";','$imgTag.style.width = "90%";',"document.body.appendChild($imgTag);","<\/script>","<\/body>","<\/html>"].join(""),i=window.open("about:blank");i.document.write(t)},openPdfSetting:function(n,t){var i=t.pageSetup||{},r={width:ecount.infra.getPageWidthFromConfig(),height:370,pageSet:Object.toJSON(i),responseID:n.responseID,strLanguage:t.strLanguage,CheckPermissionRequest:t.CheckPermissionRequest||""};ecount.popup.openWindow($.extend({url:"/ECErp/Popup.Common/PdfSetup",name:ecount.resource.LBL09235,param:r,popType:!1},n||{}))},convertPdf:function(n,t,i,r,u,f){var o=this,e;r||ecount.common.showProgressbar(!0);u=u==!0;f=f==!0;e=o.preConvertPdf(t,i,f);ecount.common.api({ecPageID:t.ecPageID,url:"/Common/Infra/ConvertPdfTemplate",data:{dto:e,Type:i,IsSync:u,IsOld:f},success:function(i){var r=i.Data;f==!1&&(r.HtmlContent=r.HtmlContent.replaceAll("[changeBody]",e.htmlContent).replaceAll("&#36;","$"));r.JobId=r.JobId||0;r.FileName=r.FileName||"";r.ComCode=r.ComCode||"";r.CollectionString=r.CollectionString||"";r.Partition=r.Partition||"";o.callConvertPdf({postData:r,callback:n,isSync:u,ecPageID:t.ecPageID})},error:function(){r||ecount.common.hideProgressbar(!0);t.errorCallback&&t.errorCallback()}})},preConvertPdf:function(n,t,i){var c={A3:1132,A4:803,A4_SMALL:803,A5:570,LETTER:826,LETTER_SMALL:826,LEGAL:826,B4:982,ISO_B4:955},l={A3:1598,A4:1132,A4_SMALL:1132,A5:803,LETTER:1066,LETTER_SMALL:1066,LEGAL:1354,B4:1386,ISO_B4:1344},u=ecount.config.company.FONT1.replace("-"," "),f=ecount.config.company.FONT2.replace("-"," "),e=ecount.config.company.FONT3.replace("-"," "),p=ecount.config.company.FONT_SIZE,s="",r,o,a,v;if(u!=""&&u!="microsoft yahei"&&(u=u.substr(0,1).toUpperCase()+u.substr(1,u.length-1)),f!=""&&f!="microsoft yahei"&&(f=f.substr(0,1).toUpperCase()+f.substr(1,f.length-1)),e!=""&&e!="microsoft yahei"&&(e=e.substr(0,1).toUpperCase()+e.substr(1,e.length-1)),r=$.extend({uiFont:"arial",author:"ECount",keywords:"ECount",subject:"ECount",title:"ECount",templateName:"PdfBasicV2"},n),r.templateName=i?"PdfBasic":"PdfBasicV2",r.gridWidth++,o=r.gridWidth,r.PaperSize&&l[r.PaperSize]&&c[r.PaperSize]||(r.PaperSize="A4"),r.IsReduce=!ecount.common.isFalse(n.ReduceYn),s=" * {text-underline-position: auto;} @page{} ",r.IsReduce?(a=r.Landscape?l[r.PaperSize]:c[r.PaperSize],a>o+(parseInt(n.MarginLeft)+parseInt(n.MarginRight))*3.779527559&&(o="")):o="",r.htmlContent=t=="SIGN"?ecount.document.adjustPdfHtml("<style type='text/css'>"+s+".font-user-setting {font-family:'"+u+"','"+f+"','"+e+"','Arial','Apple SD Gothic Neo','Gulim';} .p_oecount13 div { position: relative !important; }<\/style><div class='font-user-setting' style = 'width: "+o+"px; '>"+r.htmlContent+"<\/div>"):n.isFromComposite?ecount.document.adjustPdfHtml("<style type='text/css'>"+s+".font-user-setting {font-family:'"+u+"','"+f+"','"+e+"','Arial','Apple SD Gothic Neo','Gulim';} .p_oecount13 div { position: relative !important; }<\/style><div class='font-user-setting' style='overflow:hidden; display: inline; width: "+(parseInt(o)+10)+"px;'><div class='contents' style='margin:0px 5px 0px 5px;'>"+r.htmlContent+"<\/div><\/div>"):ecount.document.adjustPdfHtml("<style type='text/css'>"+s+".font-user-setting {font-family:'"+u+"','"+f+"','"+e+"','Arial','Apple SD Gothic Neo','Gulim';} .p_oecount13 div { position: relative !important; }<\/style><div class='font-user-setting' style='overflow:hidden; display: inline; width: "+o+"px; '>"+r.htmlContent+"<\/div>"),r.isFormsetApply!=undefined&&r.isFormsetApply==!0&&(v=r.htmlContent.replace(/(<td[^>]+class\s*=\s*['\"]?)(\w*[^'\"]+)(['\"][^>]*>)/gi,function(n,t,i,r){var h="",c=/style\s*=\s*['\"](\w*[^'\"]*)['\"]/gi,s=c.exec(r),f,v,y;s&&(h=s[1]?s[1]+";":"",r=r.replace(c,""));var u=[],e=i.split(" "),l=!1,a=!1,o=_.get(ecount,"grid.constValue.styleClassName",{italic:"text-italic ",bold:"text-bold ",strike:"text-line-through ",underline:"text-uline ",strikeUnderline:"grid-text-uline-through "});for(f=0,v=e.length;f<v;f++){switch(e[f].toLowerCase()){case"text-left":u.push("text-align: left");break;case"text-right":u.push("text-align: right");break;case"text-center":u.push("text-align: center");break;case"valign-top":u.push("vertical-align: top");break;case"valign-middle":u.push("vertical-align: middle");break;case"valign-bottom":u.push("vertical-align: bottom");break;case o.bold.trim():u.push("font-weight: bold");break;case o.italic.trim():u.push("font-style: italic");break;case o.strike.trim():u.push("text-decoration: line-through;");break;case o.underline.trim():u.push("text-decoration: underline;");break;case o.strikeUnderline.trim():u.push("text-decoration: line-through underline;")}a||!e[f].startsWith("font-")||e[f].test(/font-(\d+)px/)||(e[f].split("-")[1].toLowerCase()=="malgun"?u.push("font-family: 'Malgun Gothic'"):u.push("font-family: "+e[f].split("-")[1]),a=!0);l||e[f].test(/font-(\d+)px/)&&(y=/font-(\d+)px/.exec(e[f]),u.push(String.format("font-size: {0}px",y[1])),l=!0)}return String.format('{0}{1}" style="{2}{3}{4}',t,i,h,u.join(";"),r)}),r.htmlContent=v),i==!1){var y=requestUrl.authority,h="http://"+y.replace(/(\w+)(-dev)?\.ecount\.(\w+)/,"$1.ecount.$3");r.htmlContent=r.htmlContent.replace(/(url\(https:\/\/)/gi,"url(http://");r.htmlContent=r.htmlContent.replace(/\<img[^>]+src\s*=\s*['"]\//gi,function(n){return n.replace('img src="/','img src="'+h+"/")});r.htmlContent=r.htmlContent.replace(/url\((\/.+?)\)([\s;'"])/gi,function(){var n=arguments[1],t=arguments[2]||"";return n?"url('"+h+n+"')"+t:""+t});r.htmlContent=r.htmlContent.replace(/(url\(['"]\/)|src\s*=\s*['"]\//gi,function(n){return n.replace("/",h+"/")});r.htmlContent=r.htmlContent.replace(/<(marquee|\/marquee)([^>]*)>/gi,"");r.htmlContent=r.htmlContent.replace(/<a (href=)?([^>]*)>/gi,function(n){return n.replace(/ href=(\"|\')+([^\"\']+)(\"|\')/gi,"")})}return r},callConvertPdf:function(n){var r=n.postData,t=n.callback,u=n.isSync,i=ecount.zoneBaseDatas.PdfServiceZoneEndpoint;i=i+(u==!0?"/ConvertNewPDF":"/ConvertNewPDFAsync");ecount.common.api({ecPageID:n.ecPageID,url:i,contentType:"application/json; charset=UTF-8",crossDomain:!1,external:!0,data:Object.toJSON(r),error:function(){ecount.alert("Convert PDF error")},success:function(n){u?t(n):setTimeout(function(){r.TargetFileServerSocket==""?ecount.document.checkConvertPdfForInner(n,t):ecount.document.checkConvertPdf(n,t)},4e3)}})},checkConvertPdf:function(n,t){var r=Date.now(),i=function(){var s=(Date.now()-r)/1e3;if(s>=120){ecount.alert("CONVERT_PDF_TIMEOUT",function(){t(!1)});return}if(!n||!n.FileName){ecount.alert("CONVERT_PDF_ERROR:"+n.Status,function(){t(!1)});return}var e=n.FileName,o=e.replace(".PDF",".txt"),u=encodeURIComponent([ecmodule.common.fileStorage.tempComCode,ecount.company.COM_CODE].join(ecount.delimiter)),f=[ecenum.tempfileLifetime.oneHour,u,o];ecmodule.common.fileStorage.etcFileStorageHost=n.Host;ecmodule.common.fileStorage.checkFileExists(f,2,function(n){n.Data=="false"?setTimeout(function(){i()},4e3):(u=encodeURIComponent([ecmodule.common.fileStorage.tempComCode,ecount.company.COM_CODE].join(ecount.delimiter)),f=[ecenum.tempfileLifetime.oneHour,u,o],ecmodule.common.fileStorage.viewFile(f,2,function(n){var i=n.split(","),r;i.length!=2?ecount.alert("CONVERT_PDF_ERROR",function(){t(!1)}):i[0]!="STATUS_CONVERTED"?ecount.alert(i[0],function(){t(!1)}):(r={Status:i[0],PageCount:i[1],FileName:e},t(r))}))})};i()},downloadPdf:function(n,t,i,r){if(!n||!n.FileName)return!1;if($.isEmpty(n.DownloadFileName)&&(n.DownloadFileName=n.FileName),n.EtcOption)ecmodule.common.fileStorage.downloadFileV2(n,t,null,i);else{var u=[ecenum.tempfileLifetime.oneHour,ecmodule.common.fileStorage.tempComCode,n.FileName,n.DownloadFileName];ecmodule.common.fileStorage.downloadFile(u,2,t,null,i,null,null,r)}},downloadFile:function(n){var r=ecount.popup.parent,t=r.$("#__ecSubmitForm"),a=r.$("#ifrmDownloadFile"),y,h,p,s,e,u,f,c,v,i,w,o,l;if(t.length==0?(t=$('<form id="__ecSubmitForm" method="POST"/>'),r.$("body").append(t)):t.empty(),a&&a.length!=0||r.$("body").append($('<iframe id="ifrmDownloadFile" name="ifrmDownloadFile" style="width:0px; height:0px;border:0" class="hidden"><\/iframe>')),t.attr("target","ifrmDownloadFile"),a=r.$("#ifrmDownloadFile")[0],n.FsComCode&&n.FsOwnerKey&&n.FsFileName&&($.isEmpty(n.FileStorage)&&(n.FileStorage=ecmodule.common.fileStorage.getFileStorageHost(0)),$.isEmpty(n.FsLifeTime)&&(n.FsLifeTime=ecenum.tempfileLifetime.infinity),$.isEmpty(n.FsFileName2)&&(n.FsFileName2=n.FsFileName),n.downloadURL="//"+n.FileStorage+"/DownloadFile/"+n.FsLifeTime+"/"+n.FsComCode+"/"+encodeURIComponent(n.FsFileName)+"/"+encodeURIComponent(n.FsFileName2)+"/"+n.FsOwnerKey+"?_t="+(new Date).getTime(),ecount.isMobile&&ecount.common.isIOS)){if(y=n.downloadURL||n.DownloadURL,ecmodule.common.fileStorage.isAwsS3StorageHost(y)){if(s=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(y),s==null)throw"Invalid aws request";for(e=s.path.split("/"),u=[],f=0;f<e.length;f++)if(e[f]){c=e[f];try{c=decodeURIComponent(e[f])}catch(b){}u.push(c)}u.length>1&&(u=u.splice(1));v=ecmodule.common.fileStorage.getFileStorageType(s.host);ecmodule.common.fileStorage.downloadFile(u,v,function(){n.callback&&n.callback()},function(){},n.ecPageID,n.byPassCheckFileAllowed,n.programId)}else $.browser.safari?(t.attr("action",$.ecrt(n.downloadURL)),t.attr("target",""),t.attr("method","get"),t.submit()):(r=ecount.popup.parent,i=r.document.createElement("a"),i.setAttribute("href",$.ecrt(n.downloadURL)),$.browser.netscape||i.setAttribute("target"," "),i.style.display="none",r.document.body.appendChild(i),i.click(),window.setTimeout(function(){r.document.body.removeChild(i)})),n.callback&&n.callback();return}if(h=n.downloadURL||n.DownloadURL){if(ecount.common.isIOS&&$.browser.safari&&n.isWebMail===!0){n.isFullDownloadUrl===!0?window.open(String.format("{0}://{1}{2}",window.requestUrl.protocol,window.requestUrl.host,n.downloadURL)):window.open(n.downloadURL);n.callback&&n.callback();return}if(n.usePrefix!=!0&&(h=h.replace(/^ht{2}ps?:/i,"")),p=h.split(".").pop(),p.toLowerCase()==="pdf")n.DownloadURL=h,n.width=1020,n.height=800,ecount.popup.openWindow({url:"/ECErp/Popup.Common/FileDownloadPage",name:ecount.resource.LBL02339,param:n,popupType:!0,unUseAutoResize:!1});else if(ecmodule.common.fileStorage.isAwsS3StorageHost(h)&&!n.isEcDrive){if(s=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(h),s==null)throw"Invalid aws request";for(e=s.path.split("/"),u=[],f=0;f<e.length;f++)if(e[f]){c=e[f];try{c=decodeURIComponent(e[f])}catch(b){}u.push(c)}u.length>1&&(u=u.splice(1));v=ecmodule.common.fileStorage.getFileStorageType(s.host);ecmodule.common.fileStorage.downloadFile(u,v,function(){},function(){ecount.alert(ecount.resource.MSG07592)},n.ecPageID,n.byPassCheckFileAllowed,null,n.programId)}else ecount.document.cfdrLegacy(h,function(t){var f,i,e,o;if(ecount.document._isDownloadApp(function(){return _.some(["/WMAPI/Mail/GetFileDownload"],function(n){return t.Data.match(new RegExp(n,"g"))})},{method:"GET",message:"download",url:t.Data,type:"email",fileInfo:n.fileInfo})){n.callback&&n.callback();return}if(ecount.isMobile||_.isEmpty(_.get(n,"fileInfo"))){a.src=t.Data;n.callback&&n.callback();return}if(f=n.fileInfo,i=_.get(f,"name","unknown").split(" "),i.length>1&&i.pop(),i=i.join(" "),ecount.document._fileDownloadMap[t.Data]&&(e=ecount.document._fileDownloadMap[t.Data],e.status=="progress")){o=ecount.resource.MSG08974||"{0} \n\nFile download in progress.";ecount.alert(String.format(o,i));return}ecount.document._fileDownloadMap[t.Data]={status:"progress"};var s=function(t){try{ecount.document._initFileSaver();ecount.document.fileSaver&&t&&(ecount.document.fileSaver(t,i,{autoBOM:!0,downloadToOpen:null}),n.callback&&n.callback())}catch(r){n.callback&&n.callback()}return null},u={httpMethod:"GET",url:t.Data,responseType:"blob",handler:{onComplete:function(n){n.target.status==200&&s(n.target.response)},onError:function(){ecount.document._fileDownloadMap[t.Data]&&setTimeout(function(){delete ecount.document._fileDownloadMap[t.Data]},1e3)}}},r=new XMLHttpRequest;r.onreadystatechange=function(n){if(r.readyState==4){if(r.status==200)u.handler.onComplete(n);ecount.document._fileDownloadMap[t.Data]&&setTimeout(function(){delete ecount.document._fileDownloadMap[t.Data]},1e3)}};r.open(u.httpMethod,u.url);r.responseType=u.responseType;r.send()},n.ecPageID);return}ecount.isMobile?ecount.common.isIOS?$.browser.safari?(w='<input type="hidden" name="{0}" value="{1}" />',n.ec_req_sid=window.requestUrl.param.ec_req_sid,Object.keys(n).forEach(function(i){if(i.toUpperCase()!="COMCODE"){var r=n[i];t.append($(String.format(w,i,r)))}}),t.attr("action",$.ecrt(ecount.common.buildSessionUrl("/ECAPI/Common/Infra/DownloadFile")+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback")),t.attr("target",""),t.attr("method","get"),t.submit()):(o=ecount.common.buildSessionUrl("/ECAPI/Common/Infra/DownloadFile")+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback",Object.keys(n).forEach(function(t){t.toUpperCase()!="COMCODE"&&(value=typeof n[t]=="object"?Object.toJSON(postData[t]):n[t],o=o+"&"+t+"="+value)}),r=ecount.popup.parent,i=r.document.createElement("a"),o=o,i.setAttribute("href",$.ecrt(o)),$.browser.netscape||i.setAttribute("target"," "),i.style.display="none",r.document.body.appendChild(i),i.click(),window.setTimeout(function(){r.document.body.removeChild(i)})):(o=ecount.common.buildSessionUrl("/ECAPI/Common/Infra/DownloadFile")+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback",Object.keys(n).forEach(function(t){t.toUpperCase()!="COMCODE"&&(value=typeof n[t]=="object"?Object.toJSON(postData[t]):n[t],o=o+"&"+t+"="+value)}),l=$("#ifrmPdf"),l.length==0&&(l=$('<iframe name="ifrmPdf" style="width:0px; height:0px;border:0" class="hidden"><\/iframe>'),$("body").append(l)),l[0].src=$.ecrt(o)):(t.append($('<input type="hidden" name="jsonp"/>').val(Object.toJSON(n))),t.attr("action",$.ecrt(ecount.common.buildSessionUrl("/ECAPI/Common/Infra/DownloadFile")+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback")),t.attr("method","post"),t.submit());n.callback&&n.callback()},cfdr:function(n,t,i,r,u){var s=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n),e={Data:n},o,f;if(ecmodule.common.fileStorage.isAwsS3StorageHost(n))if(ecount.isMobile){o=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n);f=ecmodule.common.fileStorage.getHostPrefix(o.host)+"/ECFST"+o.path;try{f=decodeURIComponent(f)}catch(h){}finally{f=encodeURIComponent(f)}$.encryptAjax({url:ecount.common.buildSessionUrl(ecmodule.common.fileStorage.ecfileRequestApiPath),method:"POST",data:{Key:f,ProgramId:u},dataTypeCustom:"json",async:!1,success:function(i){var r=ecount.document._createDownloadProcedure(n,t,i);e=r.getDownloadUrl(r);e.forceDownload=!0;t&&$.isFunction(t)&&t(e)}})}else{o=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n);f=ecmodule.common.fileStorage.getHostPrefix(o.host)+"/ECFST"+o.path;try{f=decodeURIComponent(f.replaceAll("%","%25"))}catch(h){}finally{f=encodeURIComponent(f.replaceAll("%","%25"))}$.encryptAjax({url:ecount.common.buildSessionUrl(ecmodule.common.fileStorage.ecfileRequestApiPath),method:"POST",data:{Key:f,ProgramId:u},dataTypeCustom:"json",async:!1,success:function(i){var u=ecount.document._createDownloadProcedure(n,t,i);u.download(u,r)}})}else/(https?:)?\/\/[^\.]{2,}\.ecounterp.com\/DownloadFile/gi.test(n)?ecount.common.api({ecPageID:i,url:ecount.common.buildSessionUrl("/ECAPI/SVC/Common/Infra/CFDR"),method:"POST",data:{Request:{FileName:s.path}},async:!1,success:function(i){if(i.Status!="200")ecount.alert("error");else{n+=n.indexOf("?")!=-1?"&_t2="+i.Data.encryptXor("ecount"):"?_t2="+i.Data.encryptXor("ecount");var r=$.ecrt(n);e={Data:r};t&&$.isFunction(t)&&t(e)}}}):t&&$.isFunction(t)&&t(e);return e},cfdrLegacy:function(n,t,i){var u=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n),e={Data:n},r,f,o,s,h;if(/(https?:)?\/\/[^\.]{2,}\.ecounterp.com\/DownloadFile/gi.test(n)){if(r=u.path.split("/"),r&&r.length>0){for(f=0,o=r.length;f<o;f++)try{r[f]=decodeURIComponent(r[f])}catch(c){}finally{r[f]=encodeURIComponent(r[f])}s=(u.protocol||"").length>0?u.protocol+":":"";h=(u.query||"").length>0?"?"+u.query:"";n=s+"//"+u.host+r.join("/")+h;u=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n)}ecount.common.api({ecPageID:i,url:ecount.common.buildSessionUrl("/ECAPI/SVC/Common/Infra/CFDR"),method:"POST",data:{Request:{FileName:u.path}},async:!1,success:function(i){if(i.Status!="200")ecount.alert("error");else{n+=n.indexOf("?")!=-1?"&_t2="+i.Data.encryptXor("ecount"):"?_t2="+i.Data.encryptXor("ecount");var r=$.ecrt(n);e={Data:r};t&&$.isFunction(t)&&t(e)}}})}else t&&$.isFunction(t)&&t(e);return e},_initLocalStorage:function(n){typeof ecount.document.isLocalForageInitialized=="undefined"?(localforage.config({name:"ecount-localstorage",driver:localforage.INDEXEDDB}),ecount.document.isLocalForageInitialized=!0,ecount.document.filedownloadcache=localforage.createInstance({name:"filedownloadcache"}),ecount.document.filedownloadcache.getItem("filecachemap").then(function(t){ecount.document.filedownloadcachemap=t?t:[];n&&n()})):n&&n()},_initFileSaver:function(){typeof ecount.document.fileSaver=="undefined"&&(ecount.document.fileSaver=saveAs)},_fileDownloadMap:{},_createDownloadProcedure:function(n,t,i){return{url:n,resultCallback:t,result:i,download:function(r,u){n=r.url;t=r.resultCallback;i=r.result;var f=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n),e={Data:n};i.Status!="200"?ecount.alert("error"):ecount.document._initLocalStorage(function(){var s=i.Data.r1.decryptXor("ecount"),h=i.Data.r2,n=f.path.encryptXor("ecount"),o=null,r=function(){o?t&&$.isFunction(t)&&t(o):ecount.common.api({url:ecount.common.buildSessionUrl("/ECAPI/SVC/Common/Infra/CFDR"),method:"POST",data:{Request:{FileName:f.path}},success:function(n){if(n.Status!="200")ecount.alert("error");else{var t=n.Data.decryptXor("ecount");o={Data:t};r()}}})},e=function(n){if(t&&$.isFunction(t))try{ecount.document._initFileSaver();ecount.document.fileSaver&&n&&(ecount.document.fileSaver(n,s,{autoBOM:!0,downloadToOpen:u}),t())}catch(i){r()}return null};try{typeof ecount.document.filedownloadcache!="undefined"&&ecount.document.filedownloadcache.getItem(n).then(function(t){var p,w,l,v,y,c,a,u;if(t&&t.d1==h){e(t.d2);return}if(ecount.document._fileDownloadMap[n]&&(p=ecount.document._fileDownloadMap[n],p.status=="progress")){w=ecount.resource.MSG08974||"{0} \n\nFile download in progress.";ecount.alert(String.format(w,s));return}ecount.document._fileDownloadMap[n]={status:"progress"};l=ecmodule.common.fileStorage.getHostPrefix(f.host)+"/ECFDR"+f.path;try{l=decodeURIComponent(l)}catch(b){}finally{l=encodeURIComponent(l)}if(v=i.Data.r3,v){y=v.decryptXor("ecount");o={Data:y};c=function(n,t){if(t==2){ecount.document.filedownloadcache.removeItem(n.name,function(){c(n)});return}var i=function(n,t){if(n.length==0)t&&t();else{var r=n.splice(1);ecount.document.filedownloadcache.removeItem(n[0].key,function(){i(r,t)})}};ecount.document.filedownloadcache.getItem("filecachemap").then(function(t){for(var r=t.sort(function(n,t){return n.Date<t.Date?-1:n.Date>t.Date?1:0}),f=[],u=n.value.d2.size,o;u>0&&r.length>0;)u-=r[0].size,o=r.splice(1),f.push(r[0]),r=o;ecount.document.filedownloadcache.setItem("filecachemap",r).then(function(){u<=0?i(f,function(){ecount.document.filedownloadcache.setItem(n.name,n.value).then(function(t){ecount.document.filedownloadcachemap.push({key:n.name,date:new Date,size:t.d2.size});ecount.document.filedownloadcache.setItem("filecachemap",ecount.document.filedownloadcachemap).then(function(){e(t.d2)}).catch(function(){c(n,2)})}).catch(function(){c(n)})}):e(n.value.d2)})})};a={httpMethod:"GET",url:y,responseType:"blob",handler:{onComplete:function(t){var i,u;if(t.target.status==200){i=t.target.getResponseHeader("ETag").replace(/"/g,"");try{ecount.constValue.isIE?e(t.target.response):(u={name:n,value:{d1:i.encryptXor("ecount"),d2:t.target.response}},ecount.document.filedownloadcache.setItem(n,{d1:i.encryptXor("ecount"),d2:t.target.response}).then(function(t){ecount.document.filedownloadcachemap.push({key:n,date:new Date,size:t.d2.size});ecount.document.filedownloadcache.setItem("filecachemap",ecount.document.filedownloadcachemap).then(function(){e(t.d2)}).catch(function(){c(u,2)})}).catch(function(){c(u)}))}catch(f){r()}}},onError:function(){r()}}};try{u=new XMLHttpRequest;u.onreadystatechange=function(t){if(u.readyState==4){if(u.status==200)a.handler.onComplete(t);ecount.document._fileDownloadMap[n]&&setTimeout(function(){delete ecount.document._fileDownloadMap[n]},1e3)}};u.onprogress=function(){};u.open(a.httpMethod,a.url);u.responseType=a.responseType;u.send()}catch(k){r()}}}).catch(function(){r()})}catch(c){r()}})},getDownloadUrl:function(r){n=r.url;t=r.resultCallback;i=r.result;var f=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n),e={Data:n},u=ecmodule.common.fileStorage.getHostPrefix(f.host)+"/ECFDR"+f.path;try{u=decodeURIComponent(u)}catch(o){}finally{u=encodeURIComponent(u)}return $.encryptAjax({url:ecount.common.buildSessionUrl(ecmodule.common.fileStorage.ecfileRequestApiPath),method:"POST",data:{Key:u},async:!1,dataTypeCustom:"json",success:function(n){if(n.Status!="200")ecount.alert("get download url error.");else{var t=n.Data.decryptXor("ecount");e={Data:t}}}}),e}}},cfvr:function(n,t){var r=$.url(n),u={Data:n},i;if(/(https?:)?\/\/[^\.]{2,}\.ecounterp.com\/ViewFile/gi.test(n)){r=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n);i=ecmodule.common.fileStorage.getHostPrefix(r.host)+"/ECFST"+r.path;try{i=decodeURIComponent(i)}catch(f){}finally{i=encodeURIComponent(i)}$.encryptAjax({url:ecount.common.buildSessionUrl(ecmodule.common.fileStorage.ecfileRequestApiPath),method:"POST",data:{Key:i},dataTypeCustom:"json",async:!1,success:function(i){var r=ecount.document._createViewProcedure(n,t,i);r.viewload(r)}})}return u},_createViewProcedure:function(n,t,i){return{url:n,resultCallback:t,result:i,viewload:function(r){n=r.url;t=r.resultCallback;i=r.result;var u=ecmodule.common.fileStorage.getAwsS3StorageUrlObj(n),f={Data:n};i.Status!="200"?ecount.alert("error"):ecount.document._initLocalStorage(function(){var s=i.Data.r1.decryptXor("ecount"),o=i.Data.r2,f=u.path.encryptXor("ecount"),r=null,n=function(){r?t&&$.isFunction(t)&&t(r):ecount.common.api({url:ecount.common.buildSessionUrl("/ECAPI/SVC/Common/Infra/CFDR"),method:"POST",data:{Request:{FileName:u.path}},success:function(t){if(t.Status!="200")ecount.alert("error");else{var i=t.Data.decryptXor("ecount");r={Data:i};n()}}})},e=function(i){if(t&&$.isFunction(t))try{var r=new FileReader;r.addEventListener("loadend",function(){t(r.result)});r.readAsText(i)}catch(u){n()}};try{typeof ecount.document.filedownloadcache!="undefined"&&ecount.document.filedownloadcache.getItem(f).then(function(t){if(t&&t.d1==o){e(t.d2);return}var i=ecmodule.common.fileStorage.getHostPrefix(u.host)+"/ECFDR"+u.path;try{i=decodeURIComponent(i)}catch(s){}finally{i=encodeURIComponent(i)}$.encryptAjax({url:ecount.common.buildSessionUrl(ecmodule.common.fileStorage.ecfileRequestApiPath),method:"POST",data:{Key:i},dataTypeCustom:"json",success:function(t){var o,i,u;if(t.Status!="200")ecount.alert("error");else{o=t.Data.decryptXor("ecount");r={Data:o};i={httpMethod:"GET",url:o,responseType:"blob",handler:{onComplete:function(t){if(t.target.status==200){var i=t.target.getResponseHeader("ETag").replace(/"/g,"");try{ecount.document.filedownloadcache.setItem(f,{d1:i.encryptXor("ecount"),d2:t.target.response}).then(function(n){e(n.d2)})}catch(r){n()}}},onError:function(){n()}}};try{u=new XMLHttpRequest;u.onload=function(n){var t=n.type||"";t.toUpperCase()=="LOAD"&&i.handler.onComplete&&i.handler.onComplete(n)};u.open(i.httpMethod,i.url);u.responseType=i.responseType;u.send()}catch(s){n()}}}})}).catch(function(){n()})}catch(h){n()}})}}},checkConvertPdfForInner:function(n,t){var r=Date.now(),i=function(){var e=(Date.now()-r)/1e3;if(e>=120){ecount.alert("CONVERT_PDF_TIMEOUT",function(){t(!1)});return}if(!n||!n.FileName){ecount.alert("CONVERT_PDF_ERROR:Check",function(){t(!1)});return}var f=n.FileName,o=f.replace(".PDF",".txt"),s=n.JobId,h=encodeURIComponent([ecmodule.common.fileStorage.tempComCode,ecount.company.COM_CODE].join(ecount.delimiter)),u={JobId:s,ComCode:h,FileName:o,SavePath:n.SavePath};ecmodule.common.fileStorage.etcFileStorageHost=n.Host;ecmodule.common.fileStorage.checkFileExistsV2(u,function(n){n==!1?setTimeout(function(){i()},4e3):ecmodule.common.fileStorage.viewFileV2(u,2,function(n){var i=n.replace(/"/gi,"").split(","),r;i.length!=2?ecount.alert("CONVERT_PDF_ERROR:ViewFile",function(){t(!1)}):i[0]!="STATUS_CONVERTED"?ecount.alert(i[0],function(){t(!1)}):(r={Status:i[0],PageCount:i[1],FileName:f,EtcOption:u},t(r))})})};i()},openVideoRecording:function(n,t,i,r){var o=this,u,f,e;t?(u=new UAParser,t.Browser=u.getBrowser().name+u.getBrowser().major,f={DS_USERDATA:JSON.stringify(t)},ecount.common.gmcSessionApi({ecPageID:n.ecPageID,sessionURL:"/Common/Infra/InsertTbMovieBasic",callbackApi:function(u){ecount.common.api({ecPageID:n.ecPageID,url:u,data:f,success:function(u){var f=t.Language,e={width:i*1.1,height:r,EKey:u.Data,Language:f,Host:window.requestUrl.host};ecount.popup.openWindow({url:"/ECERP/SVC/Popup/EcRecorderService",name:"winRecoding",param:e,popupType:!0,popupID:n.pageID,fpopupID:o.ecPageID})}})}})):(e={width:i*1.1,height:r,Language:ecount.user.LAN_TYPE,Host:window.requestUrl.host},ecount.popup.openWindow({url:"/ECERP/SVC/Popup/EcRecorderService",name:"winRecoding",param:e,popupType:!0,popupID:n.pageID}))},viewVideo:function(n,t){var f=null,u=null,e=n.toLowerCase(),i,r;e.startsWith("/media/")?(u="mms://app.ecounterp.com/",f=u+n):e.startsWith("downloadfile/")&&(i=n.split("/"),i.shift(),i.length==5&&i.remove(3),u="mms://"+window.location.host,f=u+ecmodule.common.fileStorage.getViewVideoUrl(i,1));r=$("#ifrmVideo");r.length==0&&(r=$('<iframe name="ifrmVideo" style="width:0px; height:0px;border:0" class="hidden"><\/iframe>'),$("body").append(r));r[0].src=f;t&&t()},adjustPdfHtml:function(n){var r=document.createElement("div"),u,i,t;for(r.innerHTML=n,u=r.getElementsByTagName("script"),t=u.length;t--;)u[t].parentNode.removeChild(u[t]);for(i=r.getElementsByTagName("img"),t=i.length;t--;)i[t].src=i[t].src.replace(/https?:\/\/(login|zeus|apollo|hera|zcn|hcn)\d+(-dev)?\.ecounterp\.(com|cn)/ig,""),i[t].src=i[t].src.replace(/https?:\/\/(login|zeus|apollo|hera|zcn|hcn)\d+(-dev)?\.ecount\.(com|cn)/ig,"");return r.innerHTML.replace(/javascript(:|;)?/gi,"")},adjustPrintTable:function(n){if(n){if(ecount.isIE){var t=n.className;t.indexOf("ie-border-bug-fix")<0&&(n.className=t+" ie-border-bug-fix")}return n}},printPop2:function(n){n.loadHiddenPage?n.loadHiddenPage(n):n.data&&n.isAnotherPrint?printHidden(n.data):printHidden2_Pop(n)},setPrintLog:function(n){var t={H_TYPE:null,H_DATE:null,H_NO:null,H_STATUS:null,GB_TYPE:"Y"};t=$.extend({},t,n||{});ecount.common.api({url:"/Inventory/Common/InsertSaleHistory",data:Object.toJSON(t),success:function(){}})},setHistory:function(n,t,i){var r;if(n==null)return{ERRFLAG:"-1"};r={IO_DATE:n.IO_DATE||"",IO_NO:n.IO_NO||0,LOG_TYPE:n.LOG_TYPE||"00",CS_FLAG:n.CS_FLAG||"None",FORM_GUBUN:n.FORM_GUBUN||"",SlipType:n.SlipType||"",LOG_STATUS:n.LOG_STATUS||"Print",GB_TYPE:n.GB_TYPE||"Confirmed"};r=$.extend({},r,n||{});ecount.common.api({ecPageID:n.ecPageID,url:"/Common/Infra/SaveHistory",data:Object.toJSON(r),success:function(n){n.Status=="200"?t!=null&&t(n):i!=null&&i(n)}})},setImageUploadInfoSave:function(n){if(n.param.usingNewFileStorage===!0){var t=n.param.hasStorageHost;ecmodule.common.fileStorage.saveFileInfoV6([{lifeTime:n.param.temp_file_lifetime,comCode:n.param.comCode,owner_id:n.param.ownerKey,type:1,storage_cd:"O",cd_filemenu:"GWMY",account:"ECOUNT",resize_format_string:String.format("150*120{0}375*300{0}50*40",ecount.delimiter),owner_name:n.param.FileName,PRG_ID:"C001109"}],{uploadFiles:[{id:n.param.FileName,name:n.param.FileName,size:n.param.Size}],removeFiles:[],files:[]},function(i){var r={Request:{Data:{EDIT_MODE:ecenum.editMode.new,LIST_IMAGE_STORAGE:[{TITLE:n.param.FileName,TYPE:n.param.Type,FILE_ID:i[0].fileId,FILE_NAME:n.param.FileName,FS_OWNER_KEY:n.param.ownerKey}]}}};ecount.common.api({ecPageID:n.ecPageID,url:"/SVC/Groupware/File/SaveImageStorage",data:Object.toJSON(r),success:function(i){var r;r=t?i.Data[0].ORG_IMAGE_URL:i.Data[0].ORG_IMAGE_URL_WITHOUT_ZONE||i.Data[0].ORG_IMAGE_URL;n.callback&&n.callback(i.Status=="200",{Data:r})}.bind(this)})}.bind(this))}},iframeSubmit:function(n,t,i){var u=ecount.popup.parent,f=u.$("#"+i+""),r;f.length==0&&u.$("body").append($('<iframe id="'+i+'" name="'+i+'" style="width:1000px; height:2000px;border:10" class="hidden"><\/iframe>'));r=u.$("#__ecSubmitForm");r.length==0?(r=$('<form id="__ecSubmitForm" method="POST"/>'),u.$("body").append(r)):r.empty();r.append($('<input type="hidden" name="jsonp"/>').val(Object.toJSON(t)));r.attr("action",ecount.common.buildSessionUrl(n)+"&xct=jsonp&jscb=((window.name == '__externalEcountIFrame') ? window : parent).ecount.document.exceptionCallback");r.attr("method","post");r.attr("target",i);r.submit()},openPopupCertificate:function(n,t,i,r,u,f){function e(t){var e={Key:[],Request:{Data:{BusinessNo:i,Slips:[],IsCheckConfirmSlip:u.IscheckConfirmSlip,IsCheckDeadLineAttchmentEctaxBySlips:u.IsCheckDeadLineAttchmentEctaxBySlips}}},o;u.IsBatch==!1&&(o=r.select(function(n){return String.format("{0}-{1}",n.IO_DATE,String(n.IO_NO))}),e.Key=o,e.Request.Data.Slips=r);ecount.common.api({ecPageID:n.ecPageID,url:"/Svc/Account/ETaxInvoice/ValidateEctax",data:e,complete:function(){},success:function(r){var u,e,o;r.Data.length==1&&r.Data[0].Data.Error_Flag?(_result=r.Data[0].Data,_result.Error_Flag=="Y"?["CE_NR","CE_IC","CE_ED"].contains(_result.Error_Type)?(_result.Error_Type=="CE_NR"?u="/ECERP/SVC/ECTax/ECTAX104M":_result.Error_Type=="CE_IC"?u="/ECERP/ECTax/ECTAX016M":_result.Error_Type=="CE_ED"&&(u="http://www.tradesign.net/ra/ecount.jsp"),_result.Error_Type=="CE_NR"?(ecount.popup.openWindow({url:ecount.common.buildSessionUrl(u),popupID:"ECTAX104M",additional:!0,param:{width:800,height:500,businessNo:i},notCloseMenuChanged:!0}),f&&f()):_result.Error_Type=="CE_IC"?(e=function(t){t&&n.openWindow({url:ecount.common.buildSessionUrl(u),popupType:!0,width:630,height:700});f&&f()},ecount.confirm(_result.Error_Message,e)):_result.Error_Type=="CE_ED"&&ecount.alert(_result.Error_Message,function(){f&&f()})):(o=_result.Error_Message,ecount.alert(o,function(){f&&f()})):t()):t()}})}typeof u=="boolean"&&(u={IscheckConfirmSlip:u});e(function(){var f={url:"/ECERP/SVC/ECTAX/ECTAX000P",modal:!0,param:{width:"450",height:"510",Request:{Page:t,BusinessNo:i,RearwardFlag:"N"}}};u.IsBatch==!0?_.extend(f.param.Request,{IsBatch:!0,Slips:[],ListApiParameter:r}):(_.extend(f.param.Request,{IsBatch:!1,Slips:r,ListApiParameter:null}),$.isEmpty(r[0].TRX_DATE)||$.isEmpty(r[0].TRX_NO)||(f.param.Request.TrxDataInfos=r.select(function(n){return{IO_DATE:n.IO_DATE,IO_NO:n.IO_NO,TRX_DATE:n.TRX_DATE,TRX_NO:n.TRX_NO}})));n.openWindow(f)})},_isDownloadApp:function(n,t){var i=!1,r,u;return ecount.common.isInApp===!0&&ReactNativeWebView.appVersion&&(r=ecount.common.isIOS?"5.1.5":"5.1.6",u=ReactNativeWebView.appVersion[ecount.common.isIOS?"ios":"android"],u.localeCompare(r,undefined,{numeric:!0,sensitivity:"base"})>=0&&(i=!0,n&&(i=n()),i&&ReactNativeWebView.postMessage(Object.toJSON(t)))),i}}}();ecount.convertor={executeFilter:function(n,t,i){var r=n.message,u,h="",c="",s,e,o,l,y=n.reg||"",f,a,v;switch(n.type){case"maxbyte":u=t.subStringBytes(n.max);r=r||ecount.resource.MSG01396;break;case"maxlength":if(e=n.max||50,o=0,n.isLineBreakLengthPlus){o=p(t,e);function p(n,t){var i,r,u,f;return n=n||"",t=t||50,i=n.replace(/\r\n/g,"aa").replace(/\n/g,"\r\n"),r=i.length>t?i.substring(0,t):i,f=i.length>t&&r.match(/\r$/)?1:0,u=r.match(/\r\n/g),u?u.length+f:f}}u=t.length>e-o?t.substring(0,e-o):t;r=r||String.format(ecount.resource.MSG01136,"50","50");break;case"numberOnlyAndSign":l="[^\\d"+y+"]";u=t.replace(new RegExp(l,"gi"),"");r=r||"";break;case"password":f=i&&_.isFunction(i.passwordValidate)?i.passwordValidate(t,"",n.level,n.options.passWordValidationInfo):ecount.common.fnPwValidationChk(t,"",n.level,n.options.passWordValidationInfo);u=t;r=f.message;a=f.stepResult;v=f.passwordResult;break;case"regexp":u=t.replace(new RegExp(n.regexp,"gim"),"");r=n.message;break;case"required":u=t.length==0?"":t;r="";break;case"numericOnly":f=this.numericOnly(t,n.options,i);u=f.str;s=f.isErr;h=f.orgVal;c=f.viewVal;r=n.options.numericMsg||ecount.resource.MSG01396;break;case"imeMode":u=this.imeMode(t,n.options.mode);s=!1;break;case"max":u=Number(t)>Number(n.max)?n.max:t;r=r||""}return{str:u,orgVal:h,viewVal:c,message:r,isErr:s,stepResult:a,passwordResult:v}},executePrettyFilter:function(n,t){var f=t,u={value:t,isChange:!1},i="",r="";if(!_.isString(t)||!_.isPlainObject(n))return u;if(n.type==="replaceFilter"){switch(n.subType+"_"+(n.nationalCode||_.lowerCase(_.get(ecount,"company.STATE_CODE","")))){case"mobile_kr":t.test(/^\d{10,11}$/)&&(i=/^(\d{3})(\d{3,4})(\d{4})$/g,r="$1-$2-$3");break;case"tel_kr":case"fax_kr":t.test(/^\d{7,11}$/)&&(i=t.substring(0,2)==="02"?/^(\d{2})?(\d{3,4})(\d{4})$/g:/^(\d{3})?(\d{3,4})(\d{4})$/g,r="$1-$2-$3");break;case"tax_kr":case"business_kr":t.test(/^\d{10}$/)&&(i=/^(\d{3})(\d{2})(\d{5})$/g,r="$1-$2-$3");break;case"resident_kr":t.test(/^\d{13}$/)&&(i=/^(\d{6})(\d{7})$/g,r="$1-$2");break;case"post_kr":t.test(/^\d{6}$/)&&(i=/^(\d{3})(\d{3})$/g,r="$1-$2");break;case"mobile_th":t.test(/^\d{10}$/)&&(i=/^(\d{3})(\d{3})(\d{4})$/g,r="$1-$2-$3");break;case"tel_th":case"fax_th":t.test(/^\d{9}$/)&&(i=t.substring(0,2)==="02"?/^(\d{2})(\d{3})(\d{4})$/g:/^(\d{3})(\d{3})(\d{3})$/g,r="$1-$2-$3");break;case"tax_th":t.test(/^\d{13}$/)?(i=/^(\d{1})(\d{4})(\d{5})(\d{2})(\d{1})$/g,r="$1-$2-$3-$4-$5"):t.test(/^\d{10}$/)&&(i=/^(\d{1})(\d{4})(\d{4})(\d{1})$/g,r="$1-$2-$3-$4");break;case"business_th":case"resident_th":t.test(/^\d{13}$/)&&(i=/^(\d{1})(\d{4})(\d{5})(\d{2})(\d{1})$/g,r="$1-$2-$3-$4-$5");break;case"mobile_tw":t.test(/^\d{10}$/)&&(i=/^(\d{4})(\d{3})(\d{3})$/g,r="$1-$2-$3");break;case"tel_tw":case"fax_tw":t.test(/^\d{6,8}$/)?(i=t.length<8?/^(\d{3})(\d{3,4})$/g:/^(\d{4})(\d{4})$/g,r="$1-$2"):t.test(/^\d{9,10}$/)&&(t.substring(0,4)==="0836"?(i=/^(\d{4})(\d{5,6})$/g,r="$1-$2"):~_.indexOf(["037","049","089","082"],t.substring(0,3))?(i=/^(\d{3})(\d{3})(\d{3,4})$/g,r="$1-$2-$3"):!~_.indexOf(["02","03","04","05","06","07","08"],t.substring(0,2))||(i=/^(\d{2})(\d{3,4})(\d{4})$/g,r="$1-$2-$3"));break;case"mobile_id":t.test(/^\d{11,13}$/)&&(i=t.length===11?/^(\d{4})(\d{4})(\d{3})$/g:/^(\d{4})(\d{4,5})(\d{4})$/g,r="$1-$2-$3");break;case"tel_id":case"fax_id":t.test(/^\d{7,8}$/)?(i=/^(\d{3,4})(\d{4})$/g,r="$1-$2"):t.test(/^\d{10,11}$/)&&!!~_.indexOf(["021","022","024","031","061"],t.substring(0,3))?(i=/^(\d{3})(\d{3,4})(\d{4})$/g,r="$1-$2-$3"):t.test(/^\d{11,12}$/)&&!!~_.indexOf(["02","03","04","05","06","07","09"],t.substring(0,2))&&(i=/^(\d{4})(\d{3,4})(\d{4})$/g,r="$1-$2-$3");break;case"mobile_vn":t.test(/^\d{10}$/)&&(i=/^(\d{4})(\d{3})(\d{3})$/g,r="$1-$2-$3");break;case"tel_vn":case"fax_vn":t.test(/^\d{7,8}$/)?(i=/^(\d{3,4})(\d{4})$/g,r="$1-$2"):t.test(/^\d{11}$/)&&(i=!~_.indexOf(["024","028"],t.substring(0,3))?/^(\d{4})(\d{3})(\d{4})$/g:/^(\d{3})(\d{4})(\d{4})$/g,r="$1-$2-$3");break;case"tax_vn":case"business_vn":t.test(/^\d{13}$/)&&(i=/^(\d{10})(\d{3})$/g,r="$1-$2");break;case"tel_cn":case"fax_cn":t.test(/^\d{11,12}$/)&&(i=/^(\d{3,4})(\d{8})$/g,r="$1-$2");break;case"mobile_ph":t.test(/^\d{11}$/)&&(i=/^(\d{4})(\d{3})(\d{4})$/g,r="$1-$2-$3");break;case"tel_ph":case"fax_ph":t.test(/^\d{10}$/)&&(~_.indexOf(["02"],t.substring(0,2))?(i=/^(\d{2})(\d{4})(\d{4})$/g,r="$1-$2-$3"):(i=/^(\d{3})(\d{3})(\d{4})$/g,r="$1-$2-$3"));break;case"tax_ph":t.test(/^\d{12,13}$/)?(i=/^(\d{3})(\d{3})(\d{3})(\d{3,4})$/g,r="$1-$2-$3-$4"):t.test(/^\d{14}$/)&&(i=/^(\d{3})(\d{3})(\d{3})(\d{5})$/g,r="$1-$2-$3-$4");break;case"resident_ph":t.test(/^\d{12}$/)&&(i=/^(\d{4})(\d{7})(\d{1})$/g,r="$1-$2-$3")}i&&(u.value=t.replace(i,r).replace(/^-|-$/g,""),u.isChange=t!==u.value)}return u},getDecimalValueByConvertor:function(n,t){var i=t.isShowIfZero==undefined?!0:t.isShowIfZero,r=t.dataType==undefined?"9"+ecount.common.number.defaultPointLength.toString():t.dataType,u=t.isCheckZero,f=t.amtCalc,e=t.thousandSeparator==null||t.thousandSeparator==undefined?ecount.config.company.THOU_SEPARATOR:t.thousandSeparator,o=t.decimalSeparator==null||t.decimalSeparator==undefined?ecount.config.company.DEC_SEPARATOR:t.decimalSeparator,s=t.isTodayTime===!0;return ecount.convertor.dataTypeConvertor[i?"9":"8"](n,{dataType:r,isCheckZero:u,amtCalc:f,thousandSeparator:e,decimalSeparator:o,isTodayTime:s})},getDateValueByConvertor:function(n,t){t=t||{};var i=t.dataType,r=t.customizeDate;return i?(intUnit=i.substring(0,1),intUnit!="1"&&intUnit!="2")?n:ecount.convertor.dataTypeConvertor[intUnit](n,t):n},getConvertorByFormInfo:function(n){var t="",i;if(n.dataType)i=ecount.convertor.dataTypeConvertor[n.dataType[0]],t=n.dataType;else if(n.dataType1)switch(n.dataType1){case"DATETIME":/^(date)\d{2}$/gi.test(n.dateFormat)?(i=n.dateFormat=="Date20"||["YEARMONTH","YEARMONTH_NO"].contains(n.dataType2)?function(t,i){var r=ecount.convertor.dataTypeConvertor.date20(t);return i&&(i.dataType=n.dateFormat),ecount.convertor.dataTypeConvertor.date(r,i)}:ecount.convertor.dataTypeConvertor.date,t=n.dateFormat):n.dateFormat=="CustomDate"?(i=ecount.convertor.dataTypeConvertor["2"],t="29",n.customizeDate==""&&(n.dateFormat="")):i=ecount.convertor.dataTypeConvertor["5"];break;case"NUM":t=ecount.common.isTrue(n.isDisplayZero)?"9":"8";t+=$.isNumber(n.decCount)?n.decCount:"0";i=ecount.convertor.dataTypeConvertor[t[0]]}return{convertor:i,dataType:t}},convertValueByFormInfo:function(n,t){var i=ecount.convertor.getConvertorByFormInfo(t),r,u;return i.convertor?(r=i.convertor,u=i.dataType,r(n,{dataType:u,amtCalc:t.amtCalc,isCheckZero:t.isCheckZero,thousandSeparator:t.thousandSeparator,decimalSeparator:t.decimalSeparator,isTodayTime:t.isTodayTime,dateFormat:t.dateFormat,customizeDate:t.customizeDate})):n},dataTypeConvertor:{"1":function(n,t){n=n.toString();var r=n,i=/^([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?(0[1-9]|[1-2][\d]|3[0-1])(T)?(\d*)?([:]\d*)?([:]\d*)?([\/\-\.]\d+)?$/g.exec(n);if(t&&i)if(ecount.common.isTrue(t.isTodayTime)&&i[4]&&i[5]&&i[6]&&i[7]&&ecount.convertor.isToday(i[1],i[2],i[3]))n=String.format("{0}/{1}/{2}{3}{4}{5}{6}",i[1],i[2],i[3],i[4],i[5],i[6],i[7]),r=ecount.infra.getECDateFormat("DATE40",!1,n.toDate());else{r=n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]);switch(t.dataType.substring(1)){case"1":n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]);r=n.substring(2);break;case"2":n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]);r=n.substring(5);break;case"9":n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]);r=ecount.convertor.getDateByCustomizingFormat(n,t.customizeDate)}}return r},"2":function(n,t){n=n.toString();var r=n,i=/^([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?(0[1-9]|[1-2][\d]|3[0-1])(T)?(\d*)?([:]\d*)?([:]\d*)?([\/\-\.]\d+)?([\/\-\.]\d+)?$/g.exec(n);if(t&&i){if(ecount.common.isTrue(t.isTodayTime)&&i[4]&&i[5]&&i[6]&&i[7]&&ecount.convertor.isToday(i[1],i[2],i[3]))n=String.format("{0}/{1}/{2}{3}{4}{5}{6}",i[1],i[2],i[3],i[4],i[5],i[6],i[7]),r=ecount.infra.getECDateFormat("DATE40",!1,n.toDate());else{r=n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]);switch(t.dataType.substring(1)){case"1":r=n.substring(2);break;case"2":r=n.substring(5);break;case"9":r=ecount.convertor.getDateByCustomizingFormat(n,t.customizeDate)}}r=r+(i[8]||"")+(i[9]||"")}return r},"3":function(n,t){var i=/(([1|2][0-9]{3})[\/\-\.]?)?((0[1-9]|1[0-2])[\/\-\.]?)?((0[1-9]|[1-2][\d]|3[0-1])?)?(\(T\))?(\d*[:])?(\d*[:])?(\d*)?([\/\-\.]\d+)?([\/\-\.]\d+)?$/g.exec(n);return t&&i?ecount.convertor.getDate(n,t.customizeDate):n},"5":function(n,t){var i=/([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?(0[1-9]|[1-2][\d]|3[0-1])?(\(T\))?(\d*[:])?(\d*[:])?(\d*)?([\/\-\.]\d+)?([\/\-\.]\d+)?$/g.exec(n);return t&&i?ecount.convertor.getDate(n,t.dateFormat):n},"8":function(n,t){n=n.toString();var i=/^(-|)\d+(\.\d+|)/.exec(n);if(i&&i[0]==n)if(n&&n.replace(new RegExp("0|\\.","g"),"")!=""){if(t)return String.fastFormat(n,{fractionFixFormat:t.amtCalc,fractionLimit:t.dataType.substring(1),removeFractionIfZero:ecount.common.isFalse(t.isCheckZero),currencySeparator:t.thousandSeparator==null||t.thousandSeparator==undefined?",":t.thousandSeparator,fractionSeparator:t.decimalSeparator==null||t.decimalSeparator==undefined?".":t.decimalSeparator})}else return"";return n},"9":function(n,t){var u,i,r;if(n=n.toString(),u=/^(-|)\d+(\.\d+|)/,i=u.exec(n),i&&i[0]==n)if(r=t.dataType.substring(1),(n===0||n=="0")&&r==="0")n="0";else if(n!==""&&t)return String.fastFormat(n,{fractionFixFormat:t.amtCalc,fractionLimit:r,removeFractionIfZero:ecount.common.isFalse(t.isCheckZero),currencySeparator:t.thousandSeparator==null||t.thousandSeparator==undefined?",":t.thousandSeparator,fractionSeparator:t.decimalSeparator==null||t.decimalSeparator==undefined?".":t.decimalSeparator});return n},date:function(n,t){var u;n=n.toString();var r=n,i=/^([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?(0[1-9]|[1-2][\d]|3[0-1])(T)?(\d*)?([:]\d*)?([:]\d*)?([\/\-\.]\d+)?([\/\-\.]\d+)?$/g.exec(n);return t&&i&&(u=/^date(\d{2})$/gi.exec(t.dataType),ecount.common.isTrue(t.isTodayTime)&&i[4]&&i[5]&&i[6]&&i[7]&&ecount.convertor.isToday(i[1],i[2],i[3])?(n=String.format("{0}/{1}/{2}{3}{4}{5}{6}",i[1],i[2],i[3],i[4],i[5],i[6],i[7]),r=ecount.infra.getECDateFormat("DATE40",!1,n.toDate())):u.length==2?u[1]=="99"?(n=String.format("{0}/{1}/{2}",i[1],i[2],i[3]),r=ecount.convertor.getDateByCustomizingFormat(n,t.customizeDate)):r=ecount.infra.getECDateFormat("DATE"+u[1],!1,new Date(i[1],parseInt(i[2])-1,i[3])):r=ecount.infra.getECDateFormat("DATE10",!1,new Date(i[1],parseInt(i[2])-1,i[3])),r+=(i[8]||"")+(i[9]||"")),r},date20:function(n){var t=/^([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?([\/\-\.]\d+)?$/g.exec(n);return t&&(n=t[1]+"/"+t[2]+"/01",t[3]&&(n+=t[3])),n}},isToday:function(n,t,i){var r=new Date,u=r.getFullYear(),f=r.getMonth()+1,e=r.getDate();return n==u&&t==f&&i==e},getDateByCustomizingFormat:function(n,t){if(_.isEmpty(n))return"";var i=n.split("/"),r=i[0],u=i[1],f=i[2].slice(0,2),h=i[2].slice(2),e=(parseInt(u,10)-1).toString(),c=new Date(r,e,f),o=c.getDay(),s;return t?(formatReplace=function(n){var t,i,s;return/^erayear_/.test(n)===!0?(t=n.split("_"),i=t[1],ecount.infra.getEraYear({GROUP_CD:i,YEAR:r})):(s={year_yyyy:function(){return r},year_yy:function(){return r.slice(-2)},month_MM:function(){return u},month_M:function(){return parseInt(u,10).toString()},month_MMMM:function(){var n=Date.CultureInfo.monthNames;return n[e]},month_MMM:function(){var n=Date.CultureInfo.abbreviatedMonthNames;return Date.CultureInfo.LANG=="ko-KR"&&(n=Date.CultureInfo.monthNames),n[e]},day_dd:function(){return f},day_d:function(){return parseInt(f,10).toString()},dw_dddd:function(){var n=Date.CultureInfo.dayNames;return n[o]},dw_ddd:function(){var n=Date.CultureInfo.abbreviatedDayNames;return n[o]},"ㆍ":function(){return""}},s[n]())},s=t.replace(/(year\_yyyy|year\_yy|month\_MMMM|month\_MMM|month\_MM|month\_M|day\_dd|day\_d|dw\_dddd|dw\_ddd|erayear\_\d+|\ㆍ)/g,formatReplace),s+h):n},getDate:function(n,t){var i=/([1|2][0-9]{3})[\/\-\.]?(0[1-9]|1[0-2])[\/\-\.]?(0[1-9]|[1-2][\d]|3[0-1])?(\(T\))?(\d*[:])?(\d*[:])?(\d*)?([\/\-\.](\d+))?([\/\-\.](\d+))?$/g.exec(n),r=i[1]||"",u=i[2]||"",f=u?parseInt(u)-1:-1,e=i[3]||"",o=r&&f!=-1&&e?new Date(r,f,e).getDay():-1,s=i[5]&&i[5].replace(/[:]/g,"")||"",h=i[6]&&i[6].replace(/[:]/g,"")||"",c=i[7]&&i[7].replace(/[:]/g,"")||"",l=i[9]||"",a=i[11]||"";return t?(formatReplace=function(n){var t,i,v;return/^erayear_/.test(n)===!0?(t=n.split("_"),i=t[1],ecount.infra.getEraYear({GROUP_CD:i,YEAR:r})):(v={year_yyyy:function(){return r},year_yy:function(){return r.slice(-2)},month_MM:function(){return u},month_M:function(){return parseInt(u,10).toString()},month_MMMM:function(){var n=Date.CultureInfo.monthNames;return n[f]},month_MMM:function(){var n=Date.CultureInfo.abbreviatedMonthNames;return Date.CultureInfo.LANG=="ko-KR"&&(n=Date.CultureInfo.monthNames),n[f]},day_dd:function(){return e},day_d:function(){return parseInt(e,10).toString()},dw_dddd:function(){var n=Date.CultureInfo.dayNames;return n[o]},dw_ddd:function(){var n=Date.CultureInfo.abbreviatedDayNames;return n[o]},hour_hh:function(){return s},minute_mm:function(){return h},seconds_ss:function(){return c},number_no:function(){return l},serial_ser:function(){return a},"ㆍ":function(){return""}},v[n]())},t.replace(/(year\_yyyy|year\_yy|month\_MMMM|month\_MMM|month\_MM|month\_M|day\_dd|day\_d|dw\_dddd|dw\_ddd|erayear\_\d+|hour_hh|minute_mm|seconds_ss|date_separate|time_separate|space_separate|number_no|serial_ser|\ㆍ)/g,formatReplace)):n},imeMode:function(n,t){return n.replace({H:/[^ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/g,E:/[^A-Z|a-z]/g,N:/[^0-9]/g,EN:/[^A-Z|a-z|0-9]/g,ADR:/[^0-9|\-|,]/g}[t],"")},numericOnly:function(n,t,i){function l(){n=n.toString().replace(new RegExp("[^\\"+u+"|-\\d\\+]","g"),"");n=n.replace(new RegExp("["+u+"]","g"),function(n,t,i){return i.indexOf(n)==t?n:""});n.indexOf("-")>-1&&(n=n.replace(/-/g,""),f=!s&&!0?"-":"");n.substring(n.length-1)=="+"&&(n=n.replace(/\+/,"000"));n=n.replace(/\+/g,"");n.length>1&&(n=n.replace(/^0+/g,""));n=n.replace(new RegExp("^\\"+u),"0"+u)}var e=t.numericRange,u=t.DEC_SEPARATOR||ecount.config.company.DEC_SEPARATOR,o=t.THOU_SEPARATOR||ecount.config.company.THOU_SEPARATOR,s=t.isPositiveInteger,h=t.preventNumericRTrim,c=i?i.duringInputEvent:!1,f="",r;return h==!0&&(u=".",o=ecount.separator.thousands||","),l(),r=this.checkMaxLength(n,{intRange:e[0],decRange:e[1],THOU_SEPARATOR:o,DEC_SEPARATOR:u,numericViewType:i?i.numericViewType:"none",numericViewKeepOrigin:i?i.numericViewKeepOrigin:!1,duringInputEvent:c}),{str:f+r.value,orgVal:r.orgVal?f+r.orgVal:r.orgVal,viewVal:r.viewVal?f+r.viewVal:r.viewVal,isErr:r.isErr}},checkMaxLength:function(n,t){function k(n,t,i,r){var u=+[n,t].join(".");switch(i){case"ceil":u=_.ceil(u,r);break;case"floor":u=_.floor(u,r);break;case"round":u=_.round(u,r)}return u.toString()}var r={viewVal:"",orgVal:"",value:n,isErr:!1},p;if(_.isEmpty(n))return r;var h=_.isNil(t.intRange)?null:t.intRange,e=_.isNil(t.decRange)?null:t.decRange,a=t.THOU_SEPARATOR||ecount.config.company.THOU_SEPARATOR,f=t.DEC_SEPARATOR||ecount.config.company.DEC_SEPARATOR,v=t.numericViewType||"none",w=_.isBoolean(t.numericViewKeepOrigin)?t.numericViewKeepOrigin:!1,c=t.duringInputEvent===!0?!0:!1,o=n.replace(new RegExp("[^\\"+f+"|\\d]","g"),""),b=c&&o.indexOf(f)!==-1&&e!==0,s=o.split(f),u=s[0],y=u,i=s[1]||"",l=!1;return o=u+(i.length>0?f+i:""),r.value=o,e!==null&&i.length>e&&(c||v==="none"||(p=k(u,i,v,e),s=p.split("."),y=u=s[0],i=s[1]||"",l=!0),i=i.substr(0,e),r.isErr=!0),h!==null&&u.length>h&&(u=u.substr(0,h)||"0",l=!0,r.isErr=!0),l&&!c&&w&&(r.orgVal=o,r.viewVal=ecount.convertor.formatNumeric(y,a)+(i.length>0?f+i:"")),r.value=ecount.convertor.formatNumeric(u,a)+(i.length>0||b?f+i:""),r},_numericRTrim:function(n,t){var o=t.numericRange,s=t.showZeroInPoint,f=t.showValueZero,u=t.DEC_SEPARATOR||ecount.config.company.DEC_SEPARATOR||".",e=n&&n.toString().split(u)||[],r=e[0],i=e[1];return _.isEmpty(i)&&(i=""),i=s===!0?i.padRight(o[1],"0"):i.replace(/0*$/g,""),f===!0&&n==""?r="0":f===!1&&n=="0"&&(r=""),_.isEmpty(r)&&(i=""),[r,i].join(u).replace(new RegExp("\\"+u+"?$","g"),"")},replacesSeparatorOrigin:function(n,t){var r=t&&t.split_separator,u=t&&t.reg_separator,f=t&&t.replace_separator||",",e=t&&t.join_separator||".",i=n.split(r);return $.isNull(i[0])||(i[0]=i[0].replace(new RegExp("\\"+u,"g"),f)),i.join(e)},formatNumeric:function(n,t){for(var r=($.isNull(n)?"":n).toString().split("."),u=t||ecount.separator.thousands,i=r[0].replace(new RegExp("\\"+u,"g"),"").toString(),f=/(-?\d+)(\d{3})/;f.test(i);)i=i.replace(f,"$1"+u+"$2");return r.length>1?[i,r[1]].join("."):i},verifiedNumeric:function(n,t,i){var n=$.isNull(n)?this.getValue():n,f,r,e,o,u;return(n=typeof n=="string"?n:n.toString(),f=!0,n=="")?{status:!0,value:""}:(n=="."&&(n="0."),n=t?(n+"").replace(/[^0-9\.]/g,""):(n+"").replace(/[^-0-9\.]/g,""),r=Number.removeSeparator(n).split("."),e=r[1]==""||r[1]==undefined?!1:!0,!e&&this._showZeroInPoint&&i&&this.numericRange[1]&&(r[1]="0",r[1]=this._showZeroInPoint?r[1].padRight(this.numericRange[1],"0"):r[1].replace(/0*$/g,"")),r[0].length>=this.numericRange[0]+1?r[0].length==this.numericRange[0]+1?r[0]=r[0].indexOf("-")>=0?r[0].substr(0,this.numericRange[0]+1):r[0].substr(0,this.numericRange[0]):$.isNumeric(r[0])?r[0].indexOf("-")>=0?(r[0]=r[0].substr(0,this.numericRange[0]+1),f=!1):(r[0]=r[0].substr(0,this.numericRange[0]),f=!1):(r[0]="0",r[1]=""):$.isNumeric(r[0])||(r[0]="0",r[1]=""),r[1]&&r[1].length>this.numericRange[1]&&(o=r[1],r[1]=r[1].substr(0,this.numericRange[1]),f=o.replace(r[1],"").replace(/0/g,"").length>0?!1:!0),r[0]!=""&&(r[0]=r[0].replace(/[0]*/,""),r[0]=r[0]||"0",r[0][0]=="-"&&(u=r[0].split("-"),u[1]=u[1].replace(/[0]*/,""),u[1]=u[1]||"0",r[0]="-"+u[1])),n=r.length>1?e&&r[1]==""?r[0]:r.join("."):r[0],n=$.isNumeric(n)?Number.formatNumeric(n):"0",{status:f,value:n})},uniqSumClass:function(){var n=arguments.length===1?[arguments[0]]:Array.apply(null,arguments),t=n.join(" ").split(" "),i=t.reduce(function(n,t){return t!==undefined&&t!==null&&t!==""&&n.indexOf(t)<0&&n.push(t),n},[]);return i.sort().join(" ")},removeClass:function(){var n=arguments.length===1?[arguments[0]]:Array.apply(null,arguments),t,i,r;return arguments.length===1?arguments[0].split(" ").sort().join(" "):(t=n[0].split(" "),i=n.slice(1).join(" ").split(" "),r=t.filter(function(n){return!_.includes(i,n)}),r.sort().join(" "))},calcFormula:function(n,t){var d=[],v="ㆍ",e,o,u,s,f,h,nt,i,k,c,l,a;if(n&&n.codes&&n.codes.length>0&&t&&t.length>0){var y=[],p=n.codes,rt=n.inCodes,tt=n.bracketFunction,w=n.sumIfCallBack;for(e=0;e<t.length;e++){var r=[],it=t[e].type.trim(),b=t[e].CALC_GUBUN,g=t[e].formula;if(r.push({title:it}),o=b.split(v),b&&_.split(g,v).length==o.length){for(i=0;i<b.length;i++){u=g.split(v);switch(o[i]){case"1":case"12":case"14":f=p.find(function(n){return n.value==u[i]}.bind(this));f||(f={value:u[i],label:u[i],type:"1"});r.push({value:f.value,label:f.label,type:"1"});break;case"2":s=p?p.find(function(n){return u[i].indexOf(n.value+" in")>-1}.bind(this)):{value:u[i],label:u[i]};s&&r.push({value:u[i],label:u[i].replace(s.value,s.label),type:"2"});break;case"4":case"5":case"6":case"8":case"9":case"10":r.push({value:u[i],label:u[i],type:o[i]});break;case"7":f=tt.find(function(n){return n.value==u[i]}.bind(this));r.push({value:f.value,label:f.label,type:"7"});break;case"3":r.length>0&&r[r.length-1].type=="3"?(r[r.length-1].label=r[r.length-1].label+u[i],r[r.length-1].value=r[r.length-1].value+u[i]):r.push({value:u[i],label:u[i],type:o[i]});break;case"11":h=u[i];nt=w&&typeof w=="function"?w(h):h;r.push({value:h,label:nt,type:"11"})}}y.push(r)}}for(i=0;i<y.length;i++){for(k=y[i],c=[],l=0;l<k.length;l++)a=k[l],a.title?c.push(a.title):c.push(a.label);d.push(c.join(" "))}}return d.join(", ")},convertToStyle:function(n){if(typeof n=="string")return"style='"+n+"'";if(!$.isPlainObject(n))return"";var t="",r,i;for(r in n)if(i=n[r],n.hasOwnProperty(r)){if($.isEmpty(i))continue;typeof i=="number"&&(i+="px");t!=""&&(t+=" ");t+=r+":"+i+";"}return t!=""&&(t="style='"+t+"'"),t},getTotalPageCount:function(n,t){return this.initSeperateGridRowData(Object.clone(n),t)},initSeperateGridRowData:function(n,t){var r,p,a,g,e,f,o;t=t||{};var i=ecount.grid.constValue,u=1,w=1,s=0,b=t.bodyRowCount,l={},nt=0,k=null,tt=0;for(l[i.keyColumnPropertyName]=i.rowEmptyRowPropertyName,l[i.rowVariableNames.mergeSet]=t.emptyRowMergeInfo||null,r=0;r<n.length;r++){var h=n[r][i.rowVariableNames.renderSet],d=h&&h[i.rowVariableNames.totalMaxPageCount]||d,c=h&&h[i.rowVariableNames.pageCnt]||c,v=n[r+1]&&n[r+1][i.rowVariableNames.renderSet],rt=n[r],y=h&&h[i.rowVariableNames.tableId]||y,it=rt[i.rowVariableNames.rowType];if(n[r][i.rowVariableNames.renderSet]||(n[r][i.rowVariableNames.renderSet]={}),n[r][i.rowVariableNames.renderSet].CURRENTPAGE=u,n[r][i.rowVariableNames.renderSet][i.rowVariableNames.totalMaxPageCount]=c,h&&h[i.rowVariableNames.pageCnt]&&(tt+=c),k===null&&(h&&h[i.rowVariableNames.tableId]?(k=!0,y=h[i.rowVariableNames.tableId]):(k=!1,y=nt)),s==0&&u==1&&(n[r][i.rowVariableNames.renderSet].ISFIRSTTABLE=!0),b>0){if(s++,e=b,t.isAppearTopAreaOnlyFirst&&u!=1&&(e+=t.appearTopAreaOnlyFirstAddBodyRowCount),t.isAppearBottomAreaLast&&(d||c)!=u&&(e+=t.appearBottomAreaLastAddBodyRowCount),h&&h[i.rowVariableNames.newTable]==!0&&(s=1,u=1,n[r][i.rowVariableNames.renderSet].ISFIRSTTABLE=!0,w++,n[r][i.rowVariableNames.renderSet][i.rowVariableNames.tableId]=k===!0?y:nt+=1),w!=1&&s==1&&(n[r][i.rowVariableNames.renderSet].NEWTABLE=!0),s==e||it&&[i.rowType.separate].contains(it)){if(v&&v[i.rowVariableNames.tableId]&&y!=v[i.rowVariableNames.tableId]&&u<c&&t.removeEmptyLine!=!0){for(f=0;f<s;f++)o=Object.clone(l,!0),n.splice(r+1,0,o);r=r+s}if(u==c)n[r][i.rowVariableNames.renderSet].ISLASTTABLE=!0,u=1;else{if(r==n.length-1){for(a=0,g=c-u;a<g;a++)for(u++,e=b,t.isAppearTopAreaOnlyFirst&&u!=1&&(e+=t.appearTopAreaOnlyFirstAddBodyRowCount),t.isAppearBottomAreaLast&&(d||c)!=u&&(e+=t.appearBottomAreaLastAddBodyRowCount),f=0;f<e;f++)o=Object.clone(l,!0),f==0&&(o[i.rowVariableNames.renderSet]||(o[i.rowVariableNames.renderSet]={}),o[i.rowVariableNames.renderSet].NEWTABLE=!0),n.splice(r+f+1,0,o);n[n.length-1][i.rowVariableNames.renderSet]||(n[n.length-1][i.rowVariableNames.renderSet]={});n[n.length-1][i.rowVariableNames.renderSet].ISLASTTABLE=!0;break}u++}s=0;w++}else if(v&&v[i.rowVariableNames.newTable]==!0&&u==c&&e>s){if(t.removeEmptyLine!=!0){for(p=e-s,f=0;f<p;f++)o=Object.clone(l,!0),n.splice(r+1,0,o);r=r+p}n[r][i.rowVariableNames.renderSet]||(n[r][i.rowVariableNames.renderSet]={});n[r][i.rowVariableNames.renderSet].ISLASTTABLE=!0;u=1;s=0;w++}else if(t.removeEmptyLine!=!0&&r==n.length-1&&s<e){for(p=e-s,f=0;f<p;f++)o=Object.clone(l,!0),n.splice(r+1,0,o),r++;if(u<c)for(a=0,g=c-u;a<g;a++)for(u++,e=b,t.isAppearTopAreaOnlyFirst&&u!=1&&(e+=t.appearTopAreaOnlyFirstAddBodyRowCount),t.isAppearBottomAreaLast&&(d||c)!=u&&(e+=t.appearBottomAreaLastAddBodyRowCount),f=0;f<e;f++)o=Object.clone(l,!0),f==0&&(o[i.rowVariableNames.renderSet]||(o[i.rowVariableNames.renderSet]={}),o[i.rowVariableNames.renderSet].NEWTABLE=!0),n.splice(r+f+1,0,o);n[n.length-1][i.rowVariableNames.renderSet]||(n[n.length-1][i.rowVariableNames.renderSet]={});n[n.length-1][i.rowVariableNames.renderSet].ISLASTTABLE=!0;break}r==n.length-1&&(n[n.length-1][i.rowVariableNames.renderSet].ISLASTTABLE=!0)}}return tt},initDivisionGridRowData:function(n){var i=ecount.grid.constValue,u=n.every(function(n){return n[i.rowVariableNames.renderSet]}),r=0,t;if(u)for(t=0;t<n.length;t++)(n[t][i.rowVariableNames.renderSet]._NEWTABLE||n[t][i.rowVariableNames.renderSet].NEWTABLE||n[t][i.rowVariableNames.renderSet].ISFIRSTTABLE||t===0)&&r++,n[t][i.rowVariableNames.renderSet].DIVISIONINDEX=r},convertFontClassName:function(n){var t=n;switch(n){case"Malgun Gothic":t="malgun-gothic";break;case"NanumGothic":t="nanumgothic";break;case"NanumBarunGothic":t="nanumbarungothic";break;case"NanumMyeongjo":t="nanummyeongjo";break;case"Verdana":t="verdana";break;case"Angsana New":t="angsana-new";break;case"Browallia New":t="browallia-new";break;case"RSU":t="rsu";break;case"Cordia New":t="cordia-new";break;case"Leelawadee":t="leelawadee";break;case"FreesiaUPC":t="freesiaupc";break;case"Microsoft JhengHei":t="microsoft-jhengHei";break;case"PMingLiU":t="pmingliu"}return t},convertRGBToHex:function(n){var t=n.match(ecount.constValue.regExpRgb);return t?this.convertHexCode(t[1])+this.convertHexCode(t[2])+this.convertHexCode(t[3]):(t=n.match(ecount.constValue.regExpRgba),t)?this.convertHexCode(t[1])+this.convertHexCode(t[2])+this.convertHexCode(t[3]):n},convertHexCode:function(n){return parseInt(n).toString(16)=="0"?"00":parseInt(n).toString(16)},mmToPixel:function(n){return n*3.7795275590551181},pixelToMM:function(n){return n*.264583333333333},pixelToPt:function(n){return n*96/72},escape:function(n){return typeof n=="string"&&/['"&<>\t]/.test(n)&&(n=_.escape(n),n=n.replace(/&lt;(\/?)(b|strong|br|br\s*\/|font|span|div)(\s*)&gt;/gi,"<$1$2$3>"),n=n.replace(/&lt;(font|span|div) (\?|%|&|$|\/|\.|\s|;|:|-|=|"|'|\#|\w|\&quot;|&#39;|&amp;|[가-힣])*&gt;/gi,this.unescape),/&amp;/.test(n)&&(n=n.replace(/&amp;(lt;|gt;|#39;|quot;|amp;|nbsp;)/g,"&$1"))),n},unescape:function(n){return _.unescape(n)}};window.ecount.grid||(window.ecount.grid=$.noop);window.ecount.grid.helper||(window.ecount.grid.helper=$.noop,window.ecount.grid.helper.getDecimalValueByConvertor=ecount.convertor.getDecimalValueByConvertor),function(){var n=navigator.userAgent.toLowerCase();ecount.constValue={CONTROL_UPDATE_IT_SELF:"UPDATE_IT_SELF",CONTROL_UPDATE_ALL_COMPONENT:"UPDATE_ALL_COMPONENT",rowKeySeparator:"∮",columnRowKeySeparator:"∮∮∮∮∮∮∮∮∮∮",gridDelimiter:"—",eventTypeShortPrefix:"g.",eventTypePrefix:"gridEvent.rowItem.",firstRowCssClass:" grid-input-first-line ",widgetControlCssClass:"widget-control ",rowStatePropertyName:"R-O-W-S-T-A-T-E",rowIndexPropertyName:"R-O-W-I-N-D-E-X",displayRowNumberingPropertyName:"R-O-W-N-U-M-B-E-R",checkBoxPropertyName:"CHK_H",checkBoxPropertyDescription:"GRID_CHECKBOX",rowMoveablePropertyName:"ROW_MOVEABLE",rowMoveablePropertyDescription:"GRID_ROW_MOVEABLE",rowNumberingPropertyName:"ROW_NUMBERING",rowNumberingPropertyDescription:"GRID_ROW_NUMBERING",keyColumnPropertyName:"K-E-Y",printArea:"target-print-area",locationHost:"http://"+window.location.host,detailItemsForPrintContainerAfterfix:"-detailItemsForPrint",newLineDOM:function(){return document.createElement("br")},cellRenderOption:{attrs:{},data:null,controlType:"",event:{}},isDirectBlur:function(){var t=document.createElement("div"),i;return t.innerHTML="<!--[if lt IE 9]><i><\/i><![endif]-->",i=t.getElementsByTagName("i").length==1,/android/g.test(n)||i}(),isChrome:/chrom(e|ium)/gi.test(n),isChrome_MOBILE:/crios/.test(n),isFirefox:/firefox/gi.test(n),isIE:/trident/gi.test(n),isIE_LT9:function(){var n=document.createElement("div");return n.innerHTML="<!--[if lt IE 9]><i><\/i><![endif]-->",n.getElementsByTagName("i").length==1}(),isIE_LT10:function(){var n=document.createElement("div");return n.innerHTML="<!--[if lt IE 10]><i><\/i><![endif]-->",n.getElementsByTagName("i").length==1}(),isIE_MS10:function(){return navigator.userAgent.indexOf("MSIE 10")>-1}(),isIE_LT11:function(){return/msie /gi.test(n)}(),isEdge:function(){return/edge/gi.test(n)}(),isSafari:function(){return/safari/gi.test(n)}(),IE10BorderHack:"<style>.wrapper-print-content .table{border-width:1.01px;} .wrapper-print-content .table > thead > tr > th, .wrapper-print-content .table > tbody > tr > th{border-width:1.01px;} .wrapper-print-content .table > thead > tr > th, .wrapper-print-content .table > tbody > tr > th, .wrapper-print-content .table > tbody > tr > td{border-width:1.01px;}<\/style>",IE10BorderHack2:"<style>.table{border-width:1.01px;} .table > thead > tr > th, .table > tbody > tr > th{border-width:1.01px;} .table > thead > tr > th, .table > tbody > tr > th, .table > tbody > tr > td{border-width:1.01px;}<\/style>",pagingPosition:{topLeft:"top-left",topLeftMost:"top-leftMost",topRight:"top-right",topRightMost:"top-rightMost",topCenter:"top-center",bottomLeft:"bottom-left",bottomLeftMost:"bottom-leftMost",bottomRight:"bottom-right",bottomRightMost:"bottom-rightMost",bottomCenter:"bottom-center"},sectionType:{thead:"THEAD",theadSlip:"THEADSLIP",tbody:"TBODY",tbodySlip:"TBODYSLIP",tfooter:"TFOOTER",tfooterSlip:"TFOOTERSLIP"},gridRenderType:{typeSpecTran:"type1",typeSplitList:"type2",typeStatusList:"type3",typeDetailList:"type4",typeHorizonList:"type5",typeBarcode:"type11",barCode:"barCode",oneFixel:"oneFixel",columnFix:"columnFix",separateSetting:"separateSetting"},ignoreFixedGridRenderType:{typeSpecTran:!0,typeDetailList:!0,typeBarcode:!0},columnStatus:{deleteImpossibility:"deleteImpossibility"},defaultValidateError:{result:!1,isValidate:!1,error:{popover:{isShow:!1,visible:!0,message:"",placement:"auto",width:undefined,maxWidth:300},css:{visible:!0},widget:{needValidate:!1,errorType:null,useValidate:!1}}},numberType:{decimal:"decimal",onlyNumber:"onlyNumber",englishNumber:"englishNumber",none:"none"},dragType:{top:"top",bottom:"bottom"},multiControlId:{checkbox1:"checkbox1",link1:"link1",link2:"link2",link3:"link3",link4:"link4",link5:"link5",link6:"link6",span1:"span1",input:"input",search:"search",connect:"connect",complete:"complete",completeCancel:"completeCancel"},divLayoutMarginTop:29,direction:{right:"right",left:"left",down:"down",up:"up"},buttonType:{lightGray:"lightGray",gray:"gray",warning:"warning",light:"light",inverse:"inverse",primary:"primary"},linkMultiDirection:{vertical:"vertical",horizontal:"horizontal"},styleClassName:{italic:"text-italic ",bold:"text-bold ",strike:"text-line-through ",underline:"text-uline ",strikeUnderline:"grid-text-uline-through ",CONTROL_INLINE_CLASS:"control-set"},gridArea:{edit:"editable-area",list:"list-area",tree:"tree-area",imageList:"imagelist-area",column:"column-area",paging:"paging-area",gridWidgetInitialize:"grid-widget-initialize"},rowCount:{type:{none:"none",minusSubTotal:"minusSubTotal",minusTotal:"minusTotal"}},rowAddType:{addAtDownOfRow:"addAtDownOfRow",addAtUpOfRow:"addAtUpOfRow",addAtLast:"addAtLast"},locationType:{GMC:"GMC",ZONE:"ZONE"},rowState:{none:"none",changed:"changed",create:"create",deleted:"deleted",deletedNew:"deletednew"},formType:{single:"single",multi:"multi"},moveSectionType:{upToDown:"upToDown",downToUp:"downToUp"},listType:{status:"status",search:"search"},multiGridApiCallType:{multi:"multi",single:"single"},searchTabType:{open:"open",closed:"closed",none:"none"},contentsType:{"default":"default",multiGrid:"multiGrid",calendar:"calendar"},dataViewType:{dataFirst:"dataFirst",dataApi:"dataApi",dataManual:"dataManual"},menuType:{"default":"default",inventory:"inventory",account:"account",manage:"manage",tax:"tax",etc:"etc",groupware:"groupware"},codePopupType:{empCode:"EmpCode",custEmpCode:"CustEmpCode",whCode:"WhCode",assetsCode:"AssetsCode",gyeCode:"GyeCode",site:"Site",userId:"UserId",codeNo:"CodeNo",prodCode:"ProdCode",pjtCode:"PjtCode",businessNo:"BusinessNo"},autoCodeType:{F:{trxKey:"EmpCd"},G:{trxKey:"WhcdSingle"},H:{trxKey:"WhcdOut"},I:{trxKey:"WhcdIn"},J:{trxKey:"ProjectCd"},K:{trxKey:"SiteCd"},L:{trxKey:"ProdType"},N:{trxKey:"LocationType"},B:{trxKey:"AccountCategory"},C:{trxKey:"InexDivCode"}},dualInfoSet:{"widget.multiCode.wh":{dualControlInfo:[{dualControlLen:5,dualType:"multiCodeWh",id:"",groupId:"",hasDualIcon:!0,isDefaultShow:!0,warehouseType:["T","F"],dualStep:0},{controlType:"widget.multiCode.whLevelGroup",subTitle:"LBL07309",id:"_Level",name:"_LEVEL",groupId:"",hasDualIcon:!1,isDefaultShow:!0,warehouseType:["T","F"],dualStep:0},{controlType:"widget.multiCode.wh",subTitle:"LBL01333",id:"_From",name:"_FROM",groupId:"fromWh",hasDualIcon:!0,isDefaultShow:!1,warehouseType:["F"],dualStep:1,additionalInitDataType:"F"},{controlType:"widget.multiCode.whLevelGroup",subTitle:"LBL10256",id:"_FromLevel",name:"_FROMLEVEL",groupId:"fromWh",hasDualIcon:!1,isDefaultShow:!1,warehouseType:["F"],dualStep:1},{controlType:"widget.multiCode.wh",subTitle:"LBL01259",id:"_To",name:"_TO",groupId:"toWh",hasDualIcon:!0,isDefaultShow:!1,warehouseType:["T"],dualStep:2,additionalInitDataType:"T"},{controlType:"widget.multiCode.whLevelGroup",subTitle:"LBL10375",id:"_ToLevel",name:"_TOLEVEL",groupId:"toWh",hasDualIcon:!1,isDefaultShow:!1,warehouseType:["T"],dualStep:2}],dualStepInfo:{0:[{groupId:"",isShow:!0},{groupId:"fromWh",isShow:!1},{groupId:"toWh",isShow:!1}],1:[{groupId:"fromWh",isShow:!0},{groupId:"",isShow:!1},{groupId:"toWh",isShow:!1}],2:[{groupId:"toWh",isShow:!0,iconGroupId:"toWh",isIconShow:!0},{groupId:"",isShow:!1},{groupId:"fromWh",isShow:!1}],3:[{groupId:"fromWh",isShow:!0},{groupId:"toWh",isShow:!0,hasDualIconIndividual:!1},{groupId:"",isShow:!1}],maxStep:3},dualStep:0,lastDualStep:0,dualStepButtonInfo:[{id:"IntegratedWh",label:"",dualStep:0,dualControlId:""},{id:"fromWh",label:"LBL01333",dualStep:1,dualControlId:""},{id:"toWh",label:"LBL01259",dualStep:2,dualControlId:""},{id:"IndividualSelectionWh",label:"LBL10694",dualStep:3,dualControlId:""},]},"widget.multiCode.site":{dualControlInfo:[{dualControlLen:5,dualType:"multiCodeSite",id:"",groupId:"",hasDualIcon:!0,isDefaultShow:!0,dualStep:0,serializeDualStep:!0},{controlType:"widget.multiCode.deptLevelGroup",subTitle:"LBL07531",id:"_level",name:"_LEVEL",groupId:"",hasDualIcon:!1,isDefaultShow:!0,dualStep:0,serializeDualStep:!1},{controlType:"widget.multiCode.site",subTitle:"LBL12827",id:"_Prev",name:"_PREV",groupId:"prevSite",hasDualIcon:!0,isDefaultShow:!1,dualStep:1,serializeDualStep:!0},{controlType:"widget.multiCode.deptLevelGroup",subTitle:"LBL12829",id:"_PrevLevel",name:"_PREVLEVEL",groupId:"prevSite",hasDualIcon:!1,isDefaultShow:!1,dualStep:1,serializeDualStep:!0},{controlType:"widget.multiCode.site",subTitle:"LBL12828",id:"_appointment",name:"_APPOINTMENT",groupId:"appointmentSite",hasDualIcon:!0,isDefaultShow:!1,dualStep:2,serializeDualStep:!0},{controlType:"widget.multiCode.deptLevelGroup",subTitle:"LBL12830",id:"_appointmentLevel",name:"_APPOINTMENTLEVEL",groupId:"appointmentSite",hasDualIcon:!1,isDefaultShow:!1,dualStep:2,serializeDualStep:!1}],dualStepInfo:{0:[{groupId:"",isShow:!0},{groupId:"prevSite",isShow:!1},{groupId:"appointmentSite",isShow:!1}],1:[{groupId:"prevSite",isShow:!0},{groupId:"",isShow:!1},{groupId:"appointmentSite",isShow:!1}],2:[{groupId:"appointmentSite",isShow:!0,iconGroupId:"appointmentSite",isIconShow:!0},{groupId:"",isShow:!1},{groupId:"prevSite",isShow:!1}],3:[{groupId:"prevSite",isShow:!0},{groupId:"appointmentSite",isShow:!0,hasDualIconIndividual:!1},{groupId:"",isShow:!1}],maxStep:3},dualStep:0,dualStepButtonInfo:[{id:"IntegratedSite",label:"",dualStep:0,dualControlId:""},{id:"prevSite",label:"LBL12827",dualStep:1,dualControlId:""},{id:"appointmentSite",label:"LBL12828",dualStep:2,dualControlId:""},{id:"IndividualSelectionSite",label:"LBL10694",dualStep:3,dualControlId:""},]},"widget.multiCode.siteGroup":{dualControlInfo:[{id:"",name:"",hasDualIconIndividual:!0},{controlType:"widget.multiCode.siteGroup",subTitle:"LBL13234",id:"_reference",name:"_REFERENCE",hasDualIconIndividual:!1},{controlType:"widget.multiCode.siteGroup",subTitle:"LBL13236",id:"_sharing",name:"_SHARING",hasDualIconIndividual:!1},],dualStepButtonInfo:[{id:"writer",label:"LBL13232",dualStep:0,dualControlId:""},{id:"reference",label:"LBL13234",dualStep:1,dualControlId:""},{id:"sharing",label:"LBL13236",dualStep:2,dualControlId:""},{id:"INDIVISUAL",label:"LBL10694",dualStep:3,dualControlId:""},]},"widget.multiCode.user":{dualControlInfo:[{dualControlLen:4,dualType:"multiCodeUser",id:"",dualStepItem:0,hasDualIconIndividual:!1,hideIndividual:!0},{controlType:"widget.multiCode.user",subTitle:"LBL02354",id:"_writer",name:"_WRITER",dualStepItem:1,hasDualIconIndividual:!0},{controlType:"widget.multiCode.user",subTitle:"LBL08420",id:"_messenger",name:"_MESSENGER",dualStepItem:2,hasDualIconIndividual:!1},{controlType:"widget.multiCode.user",subTitle:"LBL02715",id:"_reference",name:"_REFERENCE",dualStepItem:3,hasDualIconIndividual:!1},{controlType:"widget.multiCode.user",subTitle:"LBL10989",id:"_sharing",name:"_SHARING",dualStepItem:4,hasDualIconIndividual:!1},],dualStepButtonInfo:[{id:"user",label:"",dualStep:0,dualControlId:""},{id:"writer",label:"LBL02354",dualStep:1,dualControlId:""},{id:"messenger",label:"LBL08420",dualStep:2,dualControlId:""},{id:"reference",label:"LBL02715",dualStep:3,dualControlId:""},{id:"sharing",label:"LBL10989",dualStep:4,dualControlId:""},{id:"INDIVISUAL",label:"LBL10694",dualStep:5,dualControlId:""},],dualStep:0},"widget.multiCode.person":{dualControlInfo:[{dualControlLen:4,dualType:"multiCodePerson",id:"",dualStep:0,hasDualIconIndividual:!1,hideIndividual:!0},{controlType:"widget.multiCode.person",subTitle:"LBL02354",id:"_writer",name:"_WRITER",dualStep:1,hasDualIconIndividual:!0,groupId:null},{controlType:"widget.multiCode.person",subTitle:"LBL08420",id:"_messenger",name:"_MESSENGER",dualStep:2,hasDualIconIndividual:!1,groupId:null},{controlType:"widget.multiCode.person",subTitle:"LBL02715",id:"_reference",name:"_REFERENCE",dualStep:3,hasDualIconIndividual:!1,groupId:null},{controlType:"widget.multiCode.person",subTitle:"LBL10989",id:"_sharing",name:"_SHARING",dualStep:4,hasDualIconIndividual:!1,groupId:null},{controlType:"widget.multiCode.person",subTitle:"LBL09977",id:"_cs",name:"_CS",dualStep:5,hasDualIconIndividual:!1,groupId:null},],dualStepButtonInfo:[{id:"person",label:"",dualStep:0,dualControlId:""},{id:"writer",label:"LBL02354",dualStep:1,dualControlId:""},{id:"messenger",label:"LBL08420",dualStep:2,dualControlId:""},{id:"reference",label:"LBL02715",dualStep:3,dualControlId:""},{id:"sharing",label:"LBL10989",dualStep:4,dualControlId:""},{id:"cs",label:"LBL09977",dualStep:5,dualControlId:""},{id:"INDIVISUAL",label:"LBL10694",dualStep:6,dualControlId:""},]},"widget.multiCode.rankCust":{dualControlInfo:[{dualControlLen:2,dualType:"multiCodeRankCust",id:"",dualStepItem:0,hasDualIconIndividual:!1,hideIndividual:!0},{controlType:"widget.multiCode.rankCust",subTitle:"LBL12825",id:"_Prev",name:"_PREV",dualStepItem:1,hasDualIconIndividual:!0},{controlType:"widget.multiCode.rankCust",subTitle:"LBL12826",id:"_appointment",name:"_APPOINTMENT",dualStepItem:2,hasDualIconIndividual:!1}],dualStepButtonInfo:[{id:"IntegratedRankCust",label:"",dualStep:0,dualControlId:""},{id:"prevRankCust",label:"LBL12825",dualStep:1,dualControlId:""},{id:"appointmentRankCust",label:"LBL12826",dualStep:2,dualControlId:""},{id:"INDIVISUAL",label:"LBL10694",dualStep:3,dualControlId:""}]},"widget.input.contactInfo":{dualControlInfo:[{controlType:"widget.input.contactInfo",dualControlLen:3,dualType:"inputContactInfo",containsType:"gen",id:"",dualStepItem:0,hasDualIconIndividual:!1,hideIndividual:!0},{controlType:"widget.input.contactInfo",subTitle:"Phone",containsType:"gen",id:"_phone",name:"_PHONE",dualStepItem:1,hasDualIconIndividual:!0},{controlType:"widget.input.contactInfo",subTitle:"Mobile",containsType:"gen",id:"_mobile",name:"_MOBILE",dualStepItem:2,hasDualIconIndividual:!1},],dualStepButtonInfo:[{id:"contact",label:"Contact",dualStep:0,dualControlId:""},{id:"phone",label:"Phone",dualStep:1,dualControlId:""},{id:"mobile",label:"Mobile",dualStep:2,dualControlId:""},{id:"INDIVISUAL",label:"Each Selection",dualStep:3,dualControlId:""},]}},fix:{gridTop:"grid-fixedtop",gridTopDiv:"grid-fixedtop-div",gridLeft:"grid-fixedleft",gridLeftDiv:"grid-fixedleft-div",gridCorner:"grid-fixedcorner",gridCornerDiv:"grid-fixedcorner-div"},simpleSearchList:{today:"LBL00785",yesterday:"LBL02464",week:"LBL00791",lastWeek:"LBL06643",month:"LBL00784",lastMonth:"LBL06644",monthLastday:"LBL12103",lastMonthLastday:"LBL12104",year:"LBL09273",lastYear:"LBL09272",season:"LBL02121",lastSeason:"LBL02678",endDay:"BTN00212",endMonth:"BTN00232",quarter:"BTN00507",half:"BTN00508"},DEFAULT_SIMPLESEARCH_KEY:"BASE_DATE",resizeEvent:{start:"ecount.grid.handler.resize.start",enable:"ecount.grid.handler.resize.enable",move:"ecount.grid.handler.resize.move",end:"ecount.grid.handler.resize.end"},stateCodeMap:{tabReporting:"Z",tabCS:"C",tabConfirm:"Y",tabUnconfirmed:"N"},stateTabIdMap:{Z:"tabReporting",Y:"tabConfirm",C:"tabCS",N:"tabUnconfirmed"},stateMenuCdMap:{"20":"Z","50":"C","60":"Y","30":"N"},stateParentMenuCdMap:{Z:"20",C:"50",Y:"60",N:"30"},numberKeyList:{"48":0,"49":1,"50":2,"51":3,"52":4,"53":5,"54":6,"55":7,"56":8,"57":9,"96":0,"97":1,"98":2,"99":3,"100":4,"101":5,"102":6,"103":7,"104":8,"105":9},drawingPaper:{mode:{view:"view",edit:"edit"},inputMode:{viewNEdit:"view&edit",editNView:"edit&view"},shapeType:{table:"ecount.report.shape.table",rectangle:"ecount.report.shape.rectangle",textbox:"ecount.report.shape.textbox",verticalline:"ecount.report.shape.verticalline",horizontalline:"ecount.report.shape.horizontalline",image:"ecount.report.shape.image",sign:"ecount.report.shape.sign",imagecheckbox:"ecount.report.shape.imagecheckbox",smartGuide:"ecount.report.shape.smartGuide",smartGuideManager:"ecount.report.shape.smartGuideManager"},commonShape:{"ecount.report.shape.selectableRange":!0,"ecount.report.shape.smartGuide":!0,"ecount.report.shape.smartGuideManager":!0},managedPrefixId:{"ecount.report.baseTable":"basetable-.*","ecount.report.tableRectangle":"tablerectangle-.*","ecount.report.shape.table":"table-.*","ecount.report.shape.tableCell":"tableCell-.*","ecount.report.shape.tableRow":"tableRow-.*","ecount.report.shape.rectangle":"rectangle-.*","ecount.report.shape.textbox":"textbox-.*","ecount.report.shape.imagecheckbox":"imagecheckbox-.*","ecount.report.shape.verticalline":"verticalline-.*","ecount.report.shape.horizontalline":"horizontalline-.*","ecount.report.shape.image":"image-.*","ecount.report.shape.selectableRange":"selectableRange-.*","ecount.report.shape.smartGuide":"smartguide-.*","ecount.report.shape.sign":"sign-.*"},shapeOptionType:{btnOldHtml:"ecount.report.shape.option.btnOldHtml",btnConvertBackgroundImage:"ecount.report.shape.option.btnConvertBackgroundImage"},oldHTMLSelector:'[data-isoldhtmlbox="true"]',oldHTMLAttributeKey:"data-isoldhtmlbox",defaultCanvasConfig:{shapeTypes:["ecount.report.shape.table","ecount.report.tableRectangle","ecount.report.shape.rectangle","ecount.report.shape.textbox","ecount.report.shape.imagecheckbox","ecount.report.shape.verticalline","ecount.report.shape.horizontalline","ecount.report.shape.image","ecount.report.shape.sign"],prefixId:{"ecount.report.baseTable":"basetable-","ecount.report.shape.table":"table-","ecount.report.tableRectangle":"tablerectangle-","ecount.report.shape.tableCell":"tableCell-","ecount.report.shape.tableRow":"tableRow-","ecount.report.shape.rectangle":"rectangle-","ecount.report.shape.textbox":"textbox-","ecount.report.shape.imagecheckbox":"imagecheckbox-","ecount.report.shape.verticalline":"verticalline-","ecount.report.shape.horizontalline":"horizontalline-","ecount.report.shape.image":"image-","ecount.report.shape.selectableRange":"selectableRange-","ecount.report.shape.smartGuide":"smartguide-","ecount.report.shape.sign":"sign-",hyperlinkPrefix:"hyperlink-",oldHTMLTablePrefix:"oldhtmltable-",oldHTMLTableRowPrefix:"oldhtmltablerow-",oldHTMLTableCellPrefix:"oldhtmltablecell-"},style:{"ecount.report.baseTable":{},"ecount.report.shape.table":{},"ecount.report.tableRectangle":{},"ecount.report.shape.tableCell":{},"ecount.report.shape.tableRow":{},"ecount.report.shape.rectangle":{},"ecount.report.shape.textbox":{},"ecount.report.shape.imagecheckbox":{},"ecount.report.shape.verticalline":{"border-left-style":"solid","border-left-width":"1","border-left-color":"000000"},"ecount.report.shape.horizontalline":{"border-top-style":"solid","border-top-width":"1","border-top-color":"000000"},"ecount.report.shape.image":{},"ecount.report.shape.sign":{}}},editControlType:{"ecount.report.shape.rectangle":!0,"ecount.report.shape.textbox":!0,"ecount.report.shape.table":!0},searchCursorType:{range:"range",element:"element"},regExpFragment:/(?:\<fragment\>)|(?:\<\/fragment\>)/gm,defaultZIndex:3e3,defaultBorderColor:"d4d4d4",defaultMoveZIndex:2e4,defaultMovingZIndex:4e4,areaselectContentPaddingTop:10,areaselectContentPaddingLeft:10,areaselectContentPaddingBottom:10,areaselectContentPaddingRight:10,containerLeftPadding:5,containerRightPadding:5,containerTopPadding:5,containerBottomPadding:5,outlineDefaultClass:"wrapper-areaselect outline",selectingDefaultClass:"wrapper-areaselect selecting",contentDefaultClass:"areaselect-content",areaselectOptionDefaultClass:"wrapper-areaselect-option",enableDrawingPaper:"enable-drawingPaper",defaultLineHandlerOpacity:.5,defaultTableCellWidth:50,startSelectionId:"ec-startSelectionId",endSelectionId:"ec-endSelectionId",startHyperlinkBookmarkId:"ec-starthyperlinkbookmarkid",endHyperlinkBookmarkId:"ec-endhyperlinkbookmarkid",smartGuideGapPixel:5,stickyGapPixel:5,resizeWidthGapPercent:.1,resizeHeightGapPercent:.1,resizeMaxWidthPixel:6,resizeMaxHeightPixel:6,resizeMinWidthPixel:3,resizeMinHeightPixel:3,rectangleDefaultClass:"display-table-cell noselection",canvasStatus:{selectable:1,deselect:2,multiSelect:4,drawable:8,mouseDrawing:16,directDrawing:32,moveable:64,moving:128,resizable:256,resizing:512,horizontalResizable:1024,verticalResizable:2048,editable:4096,editing:8192,resizableCellWidth:16384,resizingCellWidth:32768,resizableCellHeight:65536,resizingCellHeight:131072,resizingCell:262144,moveableCell:524288,dragingCell:1048576,selectableRange:2097152,none:null},canvasCursorType:{none:"none",add:"add"},shapeStatus:{selectable:1,deselect:2,drawable:8,mouseDrawing:16,directDrawing:32,moveable:64,moving:128,resizable:256,resizing:512,horizontalResizable:1024,verticalResizable:2048,editable:4096,editing:8192,resizableCellWidth:16384,resizingCellWidth:32768,resizableCellHeight:65536,resizingCellHeight:131072,resizingCell:262144,moveableCell:524288,dragingCell:1048576,none:null},nativeColorname:{transparent:!0},regExpResize:/(w|e|n|s|nw|ne|sw|se)-resize/,regExpResizeCell:/(ns|ew|nsew)-resize/,fontRex:/(\s)font(-[a-z]+)+(?!(\w|-))|^font(-[a-z]+)+(?!(\w|-))/,nativeFontRex:/(\s)*font-family(\s)*:(\s)*\w+(;)?|font-family(\s)*:(\s)*\w+(;)?(\s)*/,fontSizeRex:/(\s)font-\d+px(?!(\w|-))|^font-\d+px(?!(\w|-))/,nativeFontSizeRex:/(\s)*font-size(\s)*:(\s)*\d+px(;)?|font-size(\s)*:(\s)*\d+px(;)?(\s)*/,boldRex:/(\s)text-bold(?!(\w|-))|^text-bold(?!(\w|-))/,italicRex:/(\s)text-italic(?!(\w|-))|^text-italic(?!(\w|-))/,strikeRex:/(\s)text-line-through(?!(\w|-))|^text-line-through(?!(\w|-))/,underlineRex:/(\s)text-uline(?!(\w|-))|^text-uline(?!(\w|-))/,strikeUnderlineRex:/(\s)grid-text-uline-through(?!(\w|-))|^grid-text-uline-through(?!(\w|-))/,colorRex:/color:#\S+; /,rgbRex:/rgb\(\d+, \d+, \d+\)/,alignRex:/(\s)text-(center|left|right)(?!(\w|-))|^text-(center|left|right)(?!(\w|-))/,valignRex:/(\s)valign-(top|middle|bottom)(?!(\w|-))|^valign-(top|middle|bottom)(?!(\w|-))/,flexAlignRex:/(\s)flex-align-(top|middle|bottom)(?!(\w|-))|^flex-align-(top|middle|bottom)(?!(\w|-))/,fontControlIdList:["family","size","bold","italic","underline","through","textBackgroundColor","textColor","backgroundStyle","top","middle","bottom","left","center","right","nowrap"],mappingDataFontSearchTagNames:["B","U","I","STRIKE","FONT"],canvasPrefix:".",canvasSelector:"ec-canvas",drawingPaperPrefix:".",drawingPaperSelector:"ec-drawingpaper",wrapperAttrKey:"data-wrapper",canvasWrapperSelector:"drawingPaperWrapper",dragPrefix:".",dragSelector:"ec-dragable",containerPrefix:".",containerSelector:"ec-container",containerPaddingTop:10,containerPaddingLeft:10,containerPaddingBottom:10,containerPaddingRight:10,containerMaringLeftInGrid:-5,lineHandlerPrefix:".",lineHandlerSelector:"wrapper-areaselect-adjust",moveablePrefix:".",moveableSelector:"ec-moveable",moveableTopPrefix:".",moveableTopSelector:"areaselect-top",moveableBottomPrefix:".",moveableBottomSelector:"areaselect-bottom",moveableLeftPrefix:".",moveableLeftSelector:"areaselect-left",moveableRightPrefix:".",moveableRightSelector:"areaselect-right",resizablePrefix:".",resizableSelector:"ec-resizable",resizerPrefix:".",resizerSelector:"areaselect-handle",resizerSelectPrefix:".",resizerSelectSelector:"selected",resizeWidthCellPrefix:".",resizeWidthCellSelector:"ec-resizableWidthCell",resizeHeightCellPrefix:".",resizeHeightCellSelector:"ec-resizableHeightCell",editablePrefix:".",editableSelector:"ec-editable",editableCellPrefix:".",editableCellSelector:"ec-editableCell",barcodePrefix:".",barcodeSelector:"ec-barcode",textcontainerPrefix:".",textcontainerSelector:"ec-textcontainer",textareaPrefix:".",textareaSelector:"ec-textarea",mappingDataPreviousSpacePrefix:".",mappingDataPreviousSpaceSelector:"",mappingDataPrefix:".",mappingDataSelector:"areaselect-content-mapping-text",beforeMappingDataSelector:"ec-beforemappingdata",afterMappingDataSelector:"ec-aftermappingdata",mappingDataBeforePrefix:".",mappingDataBeforeSelector:"drawingpaper-beforemappingdata",mappingDataAfterPrefix:".",mappingDataAfterSelector:"drawingpaper-aftermappingdata",tableSelectorLineDefaultSelector:"grid-selector-area-line",tableLayoutFixedSelector:"table-layout-fixed",wrapperAreaSelectPrefix:".",wrapperAreaSelectSelector:"wrapper-areaselect",areaselectOptionPrefix:".",areaselectOptionSelector:"wrapper-areaselect-option",drawingPaperClipboardAttrKey:"data-ec-drawingpaper-clipboard",areaselectOptionControlTypeAttrKey:"data-option-controltype",defaultBoxAttrKey:"data-defaultbox",placeholderAttrKey:"data-placeholder",notEditableBoxAttrKey:"data-isnoteditable",blankString:" ",tableWidthType:{percent:"percent",pixel:"pixel"},borderType:{NONELINE:"none",CHANGE_PROPERTY:"change_property",ALLLINE:"allline",TOPLINE:"topline",LEFTLINE:"leftline",BOTTOMLINE:"bottomline",RIGHTLINE:"rightline",OUTERLINE:"outerline",INNERLINE:"innerline"},tableRowDefaultHeight:20,tableCellDefaultWidth:100,defaultPasteTop:10,defaultPasteLeft:10,moveUpDefaultValue:1,moveDownDefaultValue:1,moveLeftDefaultValue:1,moveRightDefaultValue:1,text:{backspaceDelayTime:200,deleteDelayTime:200},areaselectWidth:5,disableSelection:new Function("return false"),enableSelection:new Function("return true"),selectableRangeType:{ANY:"any",CONTAIN:"contain"},restoreBookmarkEventType:{none:null,focusout:"focusout",mouseup:"mouseup"},customAttributeForRelatedReport:function(n){return n==="selector"?"[data-usingreport='true']":n==="attrObject"?{"data-usingreport":!0}:void 0}},reportEvent:{CANVAS_CHANGE_STATUS:"canvas.changeStatus",CANVAS_SELECTABLERANGE:"canvas.selectableRange",SHAPE_CHANGE_ELEMENT_SIZE:"shape.changeElementSize","SHAPE.CHANGE_ELEMENT_POINT":"shape.changeElementPoint"},keyCode:{B:66,C:67,I:73,U:85,V:86,X:88,Y:89,Z:90,BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,END:36,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,DELETE:46},regExpRgb:/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/,regExpRgba:/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/,regExpBorder:/^border(?!(\w|-))|(\s)border(?!(\w|-))/,regExpBorderStyle:/border(-(top|bottom|left|right)-style){1}(?!(\w|-))/,regExpBorderWidth:/border(-(top|bottom|left|right)-width){1}(?!(\w|-))/,regExpBorderThick:/border(-(top|bottom|left|right)-thick){1}(?!(\w|-))/,regExpText:/\t|\n|\r/g};ecount.constValue.fontSizeTable=function(){return ecount.constValue.isIE?[{title:"10px",data:"1"},{title:"11px",data:null},{title:"12px",data:null},{title:"13px",data:"2"},{title:"14px",data:null},{title:"15px",data:null},{title:"16px",data:"3"},{title:"18px",data:"4"},{title:"19px",data:null},{title:"20px",data:null},{title:"22px",data:null},{title:"24px",data:"5"},{title:"26px",data:null},{title:"28px",data:null},{title:"32px",data:"6"},{title:"36px",data:null},{title:"48px",data:"7"},{title:"72px",data:null}]:[{title:"10px",data:"1"},{title:"11px",data:null},{title:"12px",data:null},{title:"13px",data:"2"},{title:"14px",data:null},{title:"15px",data:null},{title:"16px",data:"3"},{title:"18px",data:"4"},{title:"19px",data:null},{title:"20px",data:null},{title:"22px",data:null},{title:"24px",data:"5"},{title:"26px",data:null},{title:"28px",data:null},{title:"32px",data:"6"},{title:"36px",data:null},{title:"48px",data:"7"},{title:"72px",data:null}]}();ecount.constValue.krFontFamily=function(){return{"돋움":"Dotum","굴림":"Gulim","바탕":"Batang","궁서":"Gungsuh","맑은 고딕":"Malgun Gothic","나눔고딕":"NanumGothic","나눔바른고딕":"NanumBarunGothic","나눔명조":"NanumMyeongjo"}}()}(),function(){var n={},t=[];ecount.layer={serviceType:"layer",setLayerTimeout:function(n,t,i){var r=n==="show"?showTimeout:hideTimeout;$.isNull(r[t])&&(r[t]=[]);r[t].push(i)},setTimer:function(t,i){ecount.layer.clearTimer(t);n[t]=i},getTimer:function(t){return n[t]},clearTimer:function(t){n[t]!=undefined&&(clearTimeout(n[t]),delete n[t])},removeLayer:function(n){var i,r;this.clearTimer(n);i=ecount.global.getEcServiceInstance(n,this.serviceType);i&&i._isOnlyFixedDatePicker!==!0&&(r={handler:ECountEvent.Type.LAYER_DESTROY,type:i.type,serviceKey:i.serviceKey,ecPageID:i.ecPageID},i.preventDestroy==!0?i.hide():ecount.constValue.isIE&&i.type=="recommenddropdown"?setTimeout(function(){i.destroy();ecount.global.removeEcServiceInstance(n,this.serviceType);t.indexOf(n)>-1&&t.splice(t.indexOf(n),1);ecount.runtime.notify(ECountEvent.Type.LAYER_DESTROY,null,r)}.bind(this),0):(i.destroy(),ecount.global.removeEcServiceInstance(n,this.serviceType),t.indexOf(n)>-1&&t.splice(t.indexOf(n),1),ecount.runtime.notify(ECountEvent.Type.LAYER_DESTROY,null,r)))},hideLayer:function(n){this.clearTimer(n);var t=ecount.global.getEcServiceInstance(n,this.serviceType);t&&t.hide()},getActivatedLayer:function(n){if(n)return t.map(function(n){return ecount.global.getEcServiceInstance(n,this.serviceType)}.bind(this));var i=t.filter(function(n){var t=ecount.global.getEcServiceInstance(n,this.serviceType);return t&&t.isShow()}.bind(this));return i.length?ecount.global.getEcServiceInstance(i.last(),this.serviceType):null},getLayer:function(n){return ecount.global.getEcServiceInstance(n,this.serviceType)},getLayerShowStatus:function(n){var t=ecount.global.getEcServiceInstance(n,this.serviceType);return t?t.isShow():!1},toggle:function(n){var i=n.serviceKey,t=this.getLayer(i);t&&t.isShow()?this.hide(t.serviceKey):this.show.apply(this,arguments)},_isAbleToRender:function(n){var t=n.items;return _.isBoolean(n.continuePropagation)&&!n.continuePropagation?!1:!$.isEmpty(t)&&$.isArray(t)&&t.every(function(n){return n.hide==!0})?!1:!0},update:function(t){var i=t.serviceKey,u=t.showingUpDelay===undefined?ecount.env.MOUSE_HOVER_IN_TIME:t.showingUpDelay,r=this.getLayer(i);if(r){if(!this._isAbleToRender(t))return;n[i]!=undefined&&this.clearTimer(i);this.setTimer(i,setTimeout(function(){this.clearTimer(i);r.update(t);ecount.runtime.notify(ECountEvent.Type.LAYER_SHOW,null,{handler:ECountEvent.Type.LAYER_SHOW,type:t.type,serviceKey:i,ecPageID:t.ecPageID,containerName:r.containerName})}.bind(this),u))}else this.show.apply(this,arguments)},show:function(i){var r=i.serviceKey,s=i.ecPageID,f=i.type,l=i._onClicked,o=ecount.global.getEcServiceInstance(r,this.serviceType),e=ecount.global.findPageInstance(s),u,h,c;(l||f!=="dropdown"&&f!=="fn"&&f!=="recommenddropdown"||i.showingUpDelay!==undefined||(i.showingUpDelay=ecount.env.REACT_SENTITIVE),h=i.showingUpDelay===undefined?ecount.env.MOUSE_HOVER_IN_TIME:i.showingUpDelay,this._isAbleToRender(i))&&(n[r]!=undefined&&this.clearTimer(r),e&&(c=e.isInclude?e._ecParent:e,c.popupType=="layer"&&(i.zIndex="2002")),this.setTimer(r,setTimeout(function(){var n,e;if(this.clearTimer(r),$.isNull(o)||o.type!=i.type){if(u=new ecount.layer[f](i),u.render(i.$customPnode?i.$customPnode:$(document.body)),i.preventShowWithCreate==!0)return!1}else u=o,u.setBoundary&&u.setBoundary(i.boundary);if(n=ecount.global.getEcInstance(i.ownerKey),n&&n._layerKey=="group"&&n.getContainerBoundary&&(e=n.getContainerBoundary(),e&&e.top!=i.boundary.top))if(i.fromCommand==!0)i.boundary.top=e.top;else{this.hide(r);return}if(i.type==="recommenddropdown"&&u.fixLayerDirection(),!i.isOnlyRender){if(u.show(i),t.push(r),i.afterShow){var h=i.afterShow.action,l=i.afterShow.delay,a=function(n){return $.isFunction(this[n])?this[n].bind(this,r):null},c=$.isFunction(h)?h:a.call(this,h);c&&($.isEmpty(l)?c():this.setTimer(r,setTimeout(function(){c()}.bind(this),l)))}ecount.runtime.notify(ECountEvent.Type.LAYER_SHOW,null,{handler:ECountEvent.Type.LAYER_SHOW,type:f,serviceKey:r,ecPageID:s,containerName:u.containerName})}}.bind(this),h)))},hide:function(t){var i;if(n[t]!=undefined&&this.clearTimer(t),i=ecount.global.getEcServiceInstance(t,this.serviceType),i){var r=ecount.common.isMacOS&&$.browser.safari&&["fn","recommenddropdown"].contains(i.type),u=r===!0?130:i.hideDelay===undefined?ecount.env.MOUSE_HOVER_OUT_TIME:i.hideDelay,f=setTimeout(function(){this.clearTimer(t,"hide");i&&i._onClicked!=!0&&(this.removeLayer(t),ecount.runtime.notify(ECountEvent.Type.LAYER_HIDE,null,{handler:ECountEvent.Type.LAYER_HIDE,type:i.type,serviceKey:t,ecPageID:i.ecPageID,containerName:i.containerName}))}.bind(this),u);this.setTimer(t,f)}},cancelShow:function(t){n[t]!=undefined&&this.clearTimer(t);var i=ecount.global.getEcServiceInstance(t,this.serviceType);i&&i.cancelShow(!0)},setOnClicked:function(n,t){var i=ecount.global.getEcServiceInstance(n,this.serviceType);$.isNull(i)||i.setOnClicked(t)},setPreventDestroy:function(n,t){var i=ecount.global.getEcServiceInstance(n,this.serviceType);$.isNull(i)||i.setPreventDestroy(t)},mousedownHandler:function(n,t,i){var r=ecount.global.getEcServiceInstance(this.serviceKey,this.serviceType);$.isNull(r)||r.mousedownHandler&&r.mousedownHandler(n,t,i)},keydownHandler:function(n,i,r){var u=ecount.global.getEcServiceInstance(t[t-1],this.serviceType);$.isNull(u)||u.keydownHandler&&u.keydownHandler(n,i,r)},clearByPath:function(n){ecount.global.clearAllServiceByPath(n,this.serviceType)},clear:function(t){var i;$.isNull(t)&&(t=[]);$.isArray(t)||(t=[t]);ecount.global.clearAllService(t,this.serviceType);for(i in n)t.contains(i)||this.clearTimer(i)},destroy:function(t){var f=ecount.global.getEcServiceInstance("ALL",this.serviceType),i,r,u=[];for(i in f)r=ec$.parseEcPath(i).ecPageID,t!==r&&u.push(i);for(i in n)r=ec$.parseEcPath(i).ecPageID,t!==r&&u.push(i);this.clear(u)}};ecount.layer.constValue={DATEPICKER:"layer.datepicker",SELECTBOX:"layer.selectbox",SPECTRUM:"layer.spectrum",FN:"layer.fn",DROPDOWN:"layer.dropdown",SELECTITEM:"layer.selectitem",FOLDITEM:"layer.folditem",NOTIFICATIONDROPDOWN:"layer.notificationdropdown",RECOMMENDDROPDOWN:"layer.recommenddropdown",CARETDROPDOWN:"layer.caretdropdown",EMPLOYEEDETAIL:"layer.employeedetail",FOCUSABLE:"layer.focusable",TABLE:"layer.table",FIXED:"layer.fixed",AUTOCOMPLETE:"layer.autocomplete",SELECTOR:"layer.selector",SERVICE:"service.layer",CREATETABLE:"layer.createtable",IMAGEFILE:"layer.imagefile",BOXSIZESETTING:"layer.boxsizesetting",PALETTE:"layer.palette",REPORT:"layer.report",REPORTALIGN:"layer.reportalign",FILEGROUP:"layer.filegroup"}}(),function(){var n=n||{},t=0;ecount.popover={serviceType:"popover",create:function(i,r){var u=r.type||"popover",e=r.directShow,f;f=$.extend({placement:"auto",html:!0,animation:!1,followMouse:!0,trigger:"manual",delay:{show:0,hide:0}},r);u==="tooltip"&&i.attr("data-original-title",f.title||f.content);i[u]("destroy");bootstrapFunc[u].call(i,f);i.attr("data-popoverindex",t);n[t++]={type:u,elem:i,isClearOnBodyClick:r.isClearOnBodyClick};e===!0&&(u==="tooltip"?bootstrapFunc[u].call(i,"show"):i[u]("show"))},updateContents:function(){type=type||"popover";type==="tooltip"?bootstrapFunc[type].call($target,"show"):$target[type]("show")},show:function(n,t){t=t||"popover";t==="tooltip"?bootstrapFunc[t].call(n,"show"):n[t]("show")},hide:function(n,t){t=t||"popover";t==="tooltip"?bootstrapFunc[t].call(n,"hide"):n[t]("hide")},destroy:function(t,i){i=i||"popover";i==="tooltip"?bootstrapFunc[i].call(t,"destroy"):t[i]("destroy");delete n[t.attr("data-popoverindex")];t.removeAttr("data-popoverindex");t.removeData("popoverindex")},clear:function(t,i,r){var f=i&&$(i.target),e,u;if(r){for(u in n)f=n[u].elem,e=n[u].type,this.destroy(f,e);$("div.popover.popover-schedule-more").remove()}else if(f.closest("div.popover").length==0)for(u in n)n[u].isClearOnBodyClick==!0&&(f=n[u].elem,e=n[u].type,f[e]("hide"))}}}();
(function(){"use strict";function l(t){return"function"==typeof t}var r,n,s=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,u=function(t,e){p[i]=t,p[i+1]=e,2===(i+=2)&&(n?n(d):h())};var t="undefined"!=typeof window?window:undefined,e=t||{},o=e.MutationObserver||e.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),a="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){return function(){setTimeout(d,1)}}var h,p=new Array(1e3);function d(){for(var t=0;t<i;t+=2){(0,p[t])(p[t+1]),p[t]=undefined,p[t+1]=undefined}i=0}h=c?function G(){return function(){process.nextTick(d)}}():o?function H(){var t=0,e=new o(d),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():a?function I(){var t=new MessageChannel;return t.port1.onmessage=d,function(){t.port2.postMessage(0)}}():t===undefined&&"function"==typeof require?function J(){try{var t=require("vertx");return r=t.runOnLoop||t.runOnContext,function e(){return function(){r(d)}}()}catch(n){return f()}}():f();var _=function Q(t,e){var n=this,r=new this.constructor(m);r[y]===undefined&&F(r);var i=n._state;if(i){var o=arguments[i-1];u(function(){k(i,r,o,n._result)})}else x(n,r,t,e);return r};var v=function R(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(m);return E(e,t),e},y=Math.random().toString(36).substring(16);function m(){}var b=void 0,w=1,g=2,A=new O;function S(t){try{return t.then}catch(e){return A.error=e,A}}function j(t,e,n){e.constructor===t.constructor&&n===_&&constructor.resolve===v?function r(e,t){t._state===w?M(e,t._result):t._state===g?P(e,t._result):x(t,undefined,function(t){E(e,t)},function(t){P(e,t)})}(t,e):n===A?P(t,A.error):n===undefined?M(t,e):l(n)?function o(t,r,i){u(function(e){var n=!1,t=function o(t,e,n,r){try{t.call(e,n,r)}catch(i){return i}}(i,r,function(t){n||(n=!0,r!==t?E(e,t):M(e,t))},function(t){n||(n=!0,P(e,t))},e._label);!n&&t&&(n=!0,P(e,t))},t)}(t,e,n):M(t,e)}function E(t,e){t===e?P(t,function n(){return new TypeError("You cannot resolve a promise with itself")}()):!function r(t){return"function"==typeof t||"object"==typeof t&&null!==t}(e)?M(t,e):j(t,e,S(e))}function T(t){t._onerror&&t._onerror(t._result),C(t)}function M(t,e){t._state===b&&(t._result=e,t._state=w,0!==t._subscribers.length&&u(C,t))}function P(t,e){t._state===b&&(t._state=g,t._result=e,u(T,t))}function x(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+w]=n,i[o+g]=r,0===o&&t._state&&u(C,t)}function C(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,i,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?k(n,r,i,o):i(o);t._subscribers.length=0}}function O(){this.error=null}var Y=new O;function k(t,e,n,r){var i,o,s,u,c=l(n);if(c){if((i=function a(t,e){try{return t(e)}catch(n){return Y.error=n,Y}}(n,r))===Y?(u=!0,o=i.error,i=null):s=!0,e===i)return void P(e,function f(){return new TypeError("A promises callback cannot return that same promise.")}())}else i=r,s=!0;e._state!==b||(c&&s?E(e,i):u?P(e,o):t===w?M(e,i):t===g&&P(e,i))}var q=0;function F(t){t[y]=q++,t._state=undefined,t._result=undefined,t._subscribers=[]}var D=function V(i){var o=this;return s(i)?new o(function(t,e){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(t,e)}):new o(function(t,e){e(new TypeError("You must pass an array to race."))})};var K=function X(t){var e=new this(m);return P(e,t),e};var L=N;function N(t){this[y]=function e(){return q++}(),this._result=this._state=undefined,this._subscribers=[],m!==t&&("function"!=typeof t&&function n(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof N?function r(e,t){try{t(function(t){E(e,t)},function(t){P(e,t)})}catch(n){P(e,n)}}(this,t):function i(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}N.all=function Z(t){return new U(this,t).promise},N.race=D,N.resolve=v,N.reject=K,N._setScheduler=function $(t){n=t},N._setAsap=function tt(t){u=t},N._asap=u,N.prototype={constructor:N,then:_,"catch":function(t){return this.then(null,t)}};var U=W;function W(t,e){this._instanceConstructor=t,this.promise=new t(m),this.promise[y]||F(this.promise),s(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):P(this.promise,function n(){return new Error("Array Methods must be provided an Array")}())}W.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===b&&n<t;n++)this._eachEntry(e[n],n)},W.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===v){var i=S(e);if(i===_&&e._state!==b)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===L){var o=new n(m);j(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){t(e)}),t)}else this._willSettleAt(r(e),t)},W.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===b&&(this._remaining--,t===g?P(r,n):this._result[e]=n),0===this._remaining&&M(r,this._result)},W.prototype._willSettleAt=function(t,e){var n=this;x(t,undefined,function(t){n._settledAt(w,e,t)},function(t){n._settledAt(g,e,t)})};var z=function et(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=L)},B={Promise:L,polyfill:z};"function"==typeof define&&define.amd?define(function(){return B}):"undefined"!=typeof module&&module.exports?module.exports=B:void 0!==this&&(this.ES6Promise=B),z()}).call(this);
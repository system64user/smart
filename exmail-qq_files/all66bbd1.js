var gsAgent=navigator.userAgent.toLowerCase(),gsAppVer=navigator.appVersion.toLowerCase(),gsAppName=navigator.appName.toLowerCase(),gbIsOpera=-1<gsAgent.indexOf("opera"),gbIsWebKit=-1<gsAgent.indexOf("applewebkit"),gbIsKHTML=-1<gsAgent.indexOf("khtml")||-1<gsAgent.indexOf("konqueror")||gbIsWebKit,gbIsIE=-1<gsAgent.indexOf("compatible")&&!gbIsOpera||-1<gsAgent.indexOf("msie"),gbIsTT=gbIsIE&&-1!=gsAppVer.indexOf("tencenttraveler")?1:0,gbIsQBWebKit=gbIsWebKit&&-1!=gsAppVer.indexOf("qqbrowser")?1:0,gbIsQPlus=-1<gsAgent.indexOf("qplus"),gbIsEdge=-1!=gsAgent.indexOf("edge"),gbIsChrome=gbIsWebKit&&!gbIsQBWebKit&&!gbIsEdge&&-1<gsAgent.indexOf("chrome")&&gsAgent.indexOf("se 2.x metasr 1.0")<0&&!gbIsQPlus,gbIsSafari=gbIsWebKit&&!gbIsChrome&&!gbIsQBWebKit,gbIsQBIE=gbIsIE&&-1!=gsAppVer.indexOf("qqbrowser"),gbIsTrident=-1!=gsAppVer.indexOf("trident"),gbIsFF=-1<gsAgent.indexOf("gecko")&&!gbIsKHTML&&!gbIsIE&&!gbIsEdge&&!gbIsTrident,gbIsNS=!gbIsIE&&!gbIsOpera&&!gbIsKHTML&&0==gsAgent.indexOf("mozilla")&&"netscape"==gsAppName,gbIsAgentErr=!(gbIsOpera||gbIsKHTML||gbIsSafari||gbIsIE||gbIsTT||gbIsFF||gbIsNS),gbIsWin=-1<gsAgent.indexOf("windows")||-1<gsAgent.indexOf("win32"),gbIsVista=gbIsWin&&(-1<gsAgent.indexOf("nt 6.0")||-1<gsAgent.indexOf("windows vista")),gbIsWin7=gbIsWin&&-1<gsAgent.indexOf("nt 6.1"),gbIsMac=-1<gsAgent.indexOf("macintosh")||-1<gsAgent.indexOf("mac os x"),gsMacVer=(/mac os x (\d+)(\.|_)(\d+)/.test(gsAgent)&&parseFloat(RegExp.$1+"."+RegExp.$3)).toString(),gbIsLinux=-1<gsAgent.indexOf("linux"),gbIsAir=-1<gsAgent.indexOf("adobeair"),gnIEVer=/MSIE (\d+.\d+);/i.test(gsAgent)&&parseFloat(RegExp.$1),gnIEDocTypeVer=0,gsFFVer=/firefox\/((\d|\.)+)/i.test(gsAgent)&&RegExp.$1,gsSafariVer=""+(/version\/((\d|\.)+)/i.test(gsAgent)&&RegExp.$1),gsChromeVer=""+(/chrome\/((\d|\.)+)/i.test(gsAgent)&&RegExp.$1),gsQBVer=""+(/qqbrowser\/((\d|\.)+)/i.test(gsAgent)&&RegExp.$1),_gsForEBuiltTag="_For_E_Built";function _callBack(e,t){if("function"!=typeof e)return null;try{return e.apply(this,t||[])}catch(i){}}function callBack(e,t){if(window.Console)return _callBack.call(this,e,t);try{return _callBack.call(this,e,t)}catch(i){debug(i.message)}}function waitFor(t,i,e,n){var a=0,o=e||500,r=(n||5e3)/o;function s(e){try{i(e)}catch(t){debug(t,2)}}!function(){try{if(t())return s(!0)}catch(e){debug(e,2)}if(a++>r)return s(!1);setTimeout(arguments.callee,o)}()}function unikey(e){return[e,now(),Math.random()].join("").split(".").join("")}function genGlobalMapIdx(){return Math.round(1e4*Math.random()).toString()+(new Date).getMilliseconds()}function isLeapYear(e){return e%400==0||e%4==0&&e%100!=0}function calDays(e,t){return[null,31,null,31,30,31,30,31,31,30,31,30,31][t]||(isLeapYear(e)?29:28)}function now(){return+new Date}function trim(e){return(e&&e.replace?e:"").replace(/(^\s*)|(\s*$)/g,"")}function trim2(e){if(e&&e.substring){for(var t=/\s/,i=-1,n=e.length;t.test(e.charAt(--n)););for(;t.test(e.charAt(++i)););return e.substring(i,n+1)}}function strReplace(e,t,i,n){return(e||"").replace(new RegExp(regFilter(t),n),i)}function encodeURI(e){return e&&e.replace?e.replace(/%/gi,"%25").replace(/\+/gi,"%2B").replace(/&/gi,"%26").replace(/#/gi,"%23").replace(/\'/gi,"%27").replace(/\"/gi,"%22"):e}function decodeURI(e){return decodeURIComponent(e||"")}function regFilter(e){return e.replace(/([\^\.\[\$\(\)\|\*\+\?\{\\])/gi,"\\$1")}function isUrl(e){return"url"==(e||"").replace(/http?:\/\/[\w.]+[^ \f\n\r\t\v\"\\\<\>\[\]\u2100-\uFFFF]*/,"url")}function cookQueryString(e,t){for(var i in t){var n=t[i],a=new RegExp(["([?&]",i,"=)[^&#]*"].join(""),"gi");e=a.test(e)?e.replace(a,"$1"+n):[e,"&",i,"=",n].join("")}return e}function formatNum(e,t){var i=(isNaN(e)?0:e).toString(),n=t-i.length;return 0<n?[new Array(1+n).join("0"),i].join(""):i}function numToStr(e,t){for(var i=String(e.toFixed(t)),n=/(-?\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i}function numToTimeStr(e,t){return T(t||"$HH$:$MM$:$SS$").replace({SS:formatNum(parseInt(e)%60,2),MM:formatNum(parseInt(e/60)%60,2),HH:formatNum(parseInt(e/3600)%60,2)})}function formatDate(e,t,i){var n=e||new Date,a=formatNum;return T(t,i).replace({YY:a(n.getFullYear(),4),MM:a(n.getMonth()+1,2),DD:a(n.getDate(),2),hh:a(n.getHours(),2),mm:a(n.getMinutes(),2),ss:a(n.getSeconds(),2)})}function formatDayByLocale(e,t,i){var n=e||new Date,a=formatNum;return T({zh_CN:{"%YY%-%MM%":"% YY% year% MM% month","%YY%-%MM%-%DD%":"% YY% year% mm% month% DD% day","%YY%-%MM%-%DD%-%WW%":"% YY% year% mm% month% DD% Day% WW%","%MM%-%DD%":"% MM% month% DD% day","%YY%-%MM%-%DD%-%HH%-%MMMM%":"% YY% year% mm% month% DD% day% HH%% MMMM% points"},en_US:{"%YY%-%MM%":"%MM% %YY%","%YY%-%MM%-%DD%":"%MM% %DD%,%YY%","%YY%-%MM%-%DD%-%WW%":"%WW%, %MM% %DD%,%YY%","%MM%-%DD%":"%MM% %DD%","%YY%-%MM%-%DD%-%HH%-%MMMM%":"%MM% %DD%,%YY% %HH%:%MMMM%"}}[getLocale()][t],i).replace({YY:a(n.getFullYear(),4),MM:outputMonth(n.getMonth()),DD:a(n.getDate(),2),WW:outputDayOfWeek(n.getDay(),!0),HH:a(n.getHours(),2),MMMM:a(n.getMinutes(),2)})}function formatDateByLocale(e){return formatDayByLocale(new Date(e.year,parseInt(e.month)-1,e.day||"1"),e.pattern,"%")}function outputMonth(e){return"en_US"==getLocale()?["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"][e]:e+1}function outputDayOfWeek(e,t){return("en_US"==getLocale()?t?["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]:["S","M","T","W","T","F","S"]:t?["on Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","on Saturday"]:["day","One","two","three","four","Fives","six"])[e]}function getAsiiStrLen(e){return(e||"").replace(/[^\x00-\xFF]/g,"aa").length}function clearHtmlStr(e){return e?e.replace(/<[^>]*>/g,""):e}function subAsiiStr(e,t,i,n){for(var a,o=function(e){return e},r=n?htmlEncode:o,s=(n?htmlDecode:o)(trim((e||"").toString())),l=i||"",d=Math.max(t-l.length,1),c=s.length,p=0,u=-1,g=0;g<c;g++)if(p+=35==(a=s.charCodeAt(g))||87==a?1.2:255<a?1.5:1,-1==u&&d<p&&(u=g),t<p)return r(s.substr(0,u))+l;return r(s)}function setCookie(e,t,i,n,a,o){return!!e&&(document.cookie=T(["$name$=$value$; ",i?"expires=$expires$; ":"","path=$path$; ","domain=$domain$; ",o?"$secure$":""]).replace({name:e,value:encodeURIComponent(t||""),expires:i&&i.toGMTString(),path:n||"/",domain:a||["mail.",getDomain()].join(""),secure:o?"secure":""}),!0)}function getCookie(e){if(new RegExp(["(^|;|\\s+)",regFilter(e),"=([^;]*);?"].join("")).test(document.cookie))try{return decodeURIComponent(RegExp.$2)}catch(t){return RegExp.$2}}function deleteCookie(e,t,i){setCookie(e,"",new Date(0),t,i)}function setCookieFlag(e,t,i,n){var a=n||getCookieFlag(e),o=new Date;return o.setTime(o.getTime()+2592e6),a[t]=i,setCookie(e,a.join(""),o),a}function getCookieFlag(e){for(var t=(getCookie(e)||"").split(""),i=t.length;i<6;i++)t[i]="0";return t}function isArr(e){return"[object Array]"==Object.prototype.toString.call(e)}function E(e,t,i,n){if(e)if(null!=e.length){var a,o=e.length;a=n<0?o+n:n<o?n:o;for(var r=i||0;r<a;r++)try{if(!1===t(e[r],r,o))break}catch(s){debug([s.message,"<br>line:",s.lineNumber,"<br>file:",s.fileName,"<br>",t])}}else for(var r in e)try{if(!1===t(e[r],r))break}catch(s){debug([s.message,"<br>",t])}}function extend(){for(var e=arguments,t=e[0],i=1,n=e.length;i<n;i++){var a=e[i];for(var o in a)t[o]=a[o]}return t}function delAtt(e,t){try{delete e[t]}catch(i){}return e}function saveAtt(e,t){if(e){var i=e.hasOwnProperty(t),n=e[t];return function(){return i?e[t]=n:delAtt(e,t),e}}return function(){}}function globalEval(e,t){var i=getTop().globalEval||arguments.callee;if(!i._bTest&&"boolean"!=typeof i._bScriptEval){var n="testScriptEval"+now();i._bTest=!0,i(T("window.$id$=1;").replace({id:n})),i._bTest=!1,i._bScriptEval=!!getTop()[n]}var a=trim(e);if(!a)return!1;var o=(t||window).document,r=GelTags("head",o)[0]||o.documentElement,s=o.createElement("script");if(s.type="text/javascript",i._bScriptEval||arguments.callee._bTest)try{s.appendChild(o.createTextNode(a))}catch(l){}else s.text=a;return r.insertBefore(s,r.firstChild),r.removeChild(s),!0}function evalValue(e,t){var i=unikey("_u"),n=t||window;return globalEval(["(function(){try{window.",i,"=",e,";}catch(_oError){}})();"].join(""),n),n[i]}function evalCss(e,t,i){if(e){var n=t?t.document||t:document,a="cssfrom",o=n.getElementsByTagName("style")[0];if(i&&o)if(-1!=(o.getAttribute(a)||"").indexOf(i))return;if(n.createStyleSheet)(o=o||n.createStyleSheet().owningElement).styleSheet.cssText+=getRes(e);else{if(!o){var r=n.getElementsByTagName("head")[0];(o=n.createElement("style")).type="text/css",r.insertBefore(o,r.firstChild)}o.textContent+=getRes(e)}i&&o.setAttribute(a,[o.getAttribute(a)||"",i].join(","))}}function evalCssNew(e,t,i){if(e){var n=t?t.document||t:document,a="cssfrom",o="style",r=(n.getElementsByTagName(o)[0],n.getElementsByTagName("head")[0].getElementsByTagName(o)),s=r[r.length-1];if(i&&s)if(-1!=(s.getAttribute(a)||"").indexOf(i))return;if(n.createStyleSheet)(s=s||n.createStyleSheet().owningElement).styleSheet.cssText+=getRes(e);else{if(!s){var l=n.getElementsByTagName("head")[0];(s=n.createElement(o)).type="text/css",l.insertAdjacentElement?l.insertAdjacentElement("beforeEnd",s):l.insertBefore(s,l.lastChild||l.firstChild)}s.textContent+=getRes(e)}i&&s.setAttribute(a,[s.getAttribute(a)||"",i].join(","))}}function S(e,t){try{return(t&&(t.document||t)||document).getElementById(e)}catch(i){return null}}function SN(e,t){try{var i=(t&&(t.document||t)||document).getElementsByName(e);return i&&(i[_gsForEBuiltTag]=!0),i}catch(n){return null}}function attr(e,t,i){return e&&e.nodeType&&3!==e.nodeType&&8!==e.nodeType?i===undefined?e.getAttribute(t):(e.setAttribute(t,i),e):undefined}function GelTags(e,t){var i=(t||document).getElementsByTagName(e);return i&&(i[_gsForEBuiltTag]=!0),i}function CN(e,t,i){if((t=t||document).getElementsByClassName)return t.getElementsByClassName(e);var n=[],a="*"==(i=i||"*")&&t.all?t.all:t.getElementsByTagName(i),o=a.length;e=e.replace(/\-/g,"\\-");for(var r=new RegExp("(^|\\s)"+e+"(\\s|$)");0<=--o;)r.test(a[o].className)&&n.push(a[o]);return n}function F(e,t){var i=S(e,t);return i&&(i.contentWindow||(t||window).frames[e])}function appendToUrl(e,t){var i=e.split("#");return[i[0],t,1<i.length?"#"+i[1]:""].join("")}function insertHTML(e,t,i){if(!e)return!1;try{if(e.insertAdjacentHTML)e.insertAdjacentHTML(t,i);else{var n=e.ownerDocument.createRange(),a=0==t.indexOf("before"),o=-1!=t.indexOf("Begin");if(a==o)n[a?"setStartBefore":"setStartAfter"](e),e.parentNode.insertBefore(n.createContextualFragment(i),o?e:e.nextSibling);else{var r=e[a?"lastChild":"firstChild"];r?(n[a?"setStartAfter":"setStartBefore"](r),e[a?"appendChild":"insertBefore"](n.createContextualFragment(i),r)):e.innerHTML=i}}return!0}catch(s){return!1}}function setHTML(e,t){var i="string"==typeof e?S(e):e,n=i.cloneNode(!1);return n.innerHTML=t,i.parentNode.replaceChild(n,i),n}function replaceHTML(e,t){var i=!1;return(i=e.previousSibling?insertHTML(e.previousSibling,"afterEnd",t):insertHTML(e.parentNode,"afterBegin",t))&&removeSelf(e),i}function createIframe(i,e,t){var n="_creAteifRAmeoNlQAd_",a=t||{},o=t.id||unikey(),r=S(o,i);return"function"!=typeof i[n]&&(i[n]=function(e,t){callBack.call(t,arguments.callee[e],[i])}),i[n][o]=t.onload,r?"true"==r.getAttribute("loaded")&&i[n](o,r):(insertHTML(a.obj||i.document.body,a.where||"afterBegin",TE(['<iframe frameborder="0" scrolling="$scrolling$" id="$id$" name="$id$" ','$@$if($transparent$)$@$allowTransparent$@$endif$@$ class="$className$" ',"onload=\"this.setAttribute('loaded','true');$cb$('$id$',this);\" ",'src="$src$" style="$style$" $attrs$>',"</iframe>"]).replace(extend({id:o,cb:n,style:"display:none;",scrolling:"no",src:e},t))),(r=S(o,i))._onload=t.onload),r}function removeSelf(e){try{e.parentNode.removeChild(e)}catch(t){}return e}function isObjContainTarget(e,t){try{if(!e||!t)return!1;if(e.contains)return e.contains(t);if(e.compareDocumentPosition){var i=e.compareDocumentPosition(t);return 20==i||0==i}}catch(n){}return!1}function isDisableCtl(e,t){for(var i=SN(e,t),n=i.length-1;0<=n;n--)if(i[n].disabled)return!0;return!1}function disableCtl(e,t,i){E(SN(e,i),function(e){e.disabled=t})}function isShow(e,t){return"none"!=(getStyle("string"==typeof e?S(e,t):e,"display")||"none")}function show(e,t,i){var n="string"==typeof e?S(e,i):e;return n&&(n.style.display=t?"":"none"),n}-1!=window.location.hostname.indexOf("exmail.qq.com")&&(document.domain="exmail.qq.com"),window.getTop||(window.getTop=function(){var e=arguments.callee;if(!e._moTop)try{window!=parent?e._moTop=parent.getTop?parent.getTop():parent.parent.getTop():e._moTop=window}catch(t){e._moTop=window}return e._moTop}),function(e){var n=/\[([\w\-_]+)(=[\'\"]?([\w\-_~@]+)[\'\"]?)?\]/,a=/\[[\w\-_]+(=[\'\"]?[\w\-_~@]+[\'\"]?)?\]/g,i=/.*?\.([\w\-_]+)/,m=/(?:[\w\-~@\\.#\[\]=\'\"]+)+|\*|>/gi,h=/#([\w\-_]+)/,_=/^([\w\*\-_]+)/,v=[void 0,void 0];function b(e){for(var t=0,i=[],n=e.length;t<n;t++)i[t]=e[t];return i}function y(e,t,i,n){for(var a,o,r=!t||t.test(e.className),s=0;r&&s<n;)a=e.getAttribute((o=i[s++])[1]),r=o[2]?a===o[3]:!!a;return r}function T(e){var t=e.match(a);if(t)for(var i=t.length-1;0<=i;i--)t[i]=t[i].match(n);return t}function $(e){var t=(e.match(i)||v)[1];return t&&RegExp("(^|\\s)"+t+"(\\s|$)")}function x(e,t,i){var n=e.pop();if(">"===n)return x(e,t,!0);var a,o,r,s=(n.match(h)||v)[1],l=$(n),d=(n.match(_)||v)[1],c=T(n),p=c?c.length:0,u=[],g=-1,f=-1;for(d&&(d="*"==d?"":d.toUpperCase());a=t[++f];){o=a.parentNode;do{if(r=(!s||o.id===s)&&(!d||o.nodeName==d)&&y(o,l,c,p),i||r)break}while((o=o.parentNode)&&o.getAttribute);r&&(u[++g]=a)}return e[0]&&u[0]?x(e,u):u}window.finds=function w(e,t){if(!t)return[];if(t.querySelectorAll)return b(t.querySelectorAll(e));var i,n=e.match(m),a=n.pop(),o=(a.match(h)||v)[1],r=$(a),s=T(a),l=s?s.length:0,d=(a.match(_)||v)[1];if(o){var c=((t||window).document||t).getElementById(o);if(!c||d&&c.nodeName!=d.toUpperCase()||!y(c,r,s,l))return[];i=[c]}else{var p=(t.getElementsByTagName?t:t.document).getElementsByTagName(d||"*");if(r||l){var u,g=-1,f=-1;if(i=[],l)for(;u=p[++g];)y(u,r,s,l)&&(i[++f]=u);else for(;u=p[++g];)r.test(u.className)&&(i[++f]=u)}else i=b(p)}return n[0]&&i[0]?x(n,i):i},window.parents=function f(e,t){if(!t)return[];for(var i,n=e.match(m),a=n.pop(),o=(a.match(h)||v)[1],r=$(a),s=T(a),l=s?s.length:0,d=(a.match(_)||v)[1],c=[],p=[],u=-1,g=-1;(t=t.parentNode)&&9!==t.nodeType;)c.push(t);for(d&&(d="*"==d?"":d.toUpperCase());i=c[++u];)(!o||i.id===o)&&(!d||i.nodeName==d)&&y(i,r,s,l)&&(p[++g]=i);return n[0]&&p[0]?x(n,p):p}}();var Show=show;function toggle(e,t){return show(e,!isShow(e,t),t)}function setClass(e,t){return e&&void 0!==t&&e.className!=t&&(e.className=t),e}function addClass(e,t){e&&((" "+e.className+" ").indexOf(" "+t+" ")<0&&(e.className+=e.className?" "+t:t));return e}function rmClass(e,t){if(e)if(t){var i=" "+e.className+" ";i=i.replace(" "+t+" "," "),e.className=trim(i)}else e.className="";return e}function hasClass(e,t){return e&&-1<(" "+e.className+" ").indexOf(" "+t+" ")}function getStyle(e,t){var i;try{i=e&&(e.currentStyle&&"font-size"!=t?e.currentStyle:e.ownerDocument.defaultView.getComputedStyle(e,null))}catch(n){}return i&&i[t]||""}function setOpacity(e,t){if(e&&e.tagName){var i=e.style,n=t||0;"undefined"==typeof i.opacity?i.filter=1==n?"":["alpha(opacity=",100*n,")"].join(""):i.opacity=n}return e}function getOpacity(e,t){if(e&&e.tagName){var i=e.style,n=1;n="undefined"==typeof i.opacity?parseFloat(i.filter.split("=").pop())/100:parseFloat(i.opacity),isNaN(n)&&(n=1)}return n}function getStrDispLen(e){var t="__QMStrCalcer__",i=S(t,getTop());if(!i){var n=getTop().document.body;insertHTML(n,"afterBegin",T(['<div id="$id$" ','style="filter:alpha(opacity=0);opacity:0;width:1px;height:1px;overflow:auto;*overflow:hidden;white-space:nowrap;','position:absolute;left:0;top:0;">',"</div>"]).replace({id:t})),i=n.firstChild}return i.innerHTML=htmlEncode(e),i.scrollWidth}function calcPos(e,t,i,n){var a=0,o=0,r=0,s=0,l=arguments.callee,d=function(e){return e};if(!i&&(i=d),!n&&(n=d),e&&e.tagName){var c,p=e,u=e.parentNode,g=e.ownerDocument,f=g.documentElement,m=g.body;try{c=e.offsetParent}catch(h){return}for(o+=n(e.offsetLeft),a+=i(e.offsetTop),r=e.offsetWidth,s=e.offsetHeight;c&&u&&u!=f&&u!=m&&(!l._isSupportsFixedPosition()||!p.style||"fixed"!==getStyle(p,"position"));)c==u&&(o+=n(u.offsetLeft),a+=i(u.offsetTop),c=u.offsetParent),o-=u.scrollLeft,a-=u.scrollTop,u=(p=u).parentNode;l._isSupportsFixedPosition()&&p.style&&"fixed"===getStyle(p,"position")&&(o+=bodyScroll(g,"scrollLeft"),a+=bodyScroll(g,"scrollTop"))}return"json"==t?{top:a,bottom:a+s,left:o,right:o+r,width:r,height:s}:[a,o+r,a+s,o,r,s]}function calcPosFrame(e,t){for(var i=calcPos(e),n=t||window,a=getTop();n.frameElement&&n!=a;){var o=calcPos(n.frameElement);i[0]+=o[0]-bodyScroll(n,"scrollTop"),i[2]+=o[0]-bodyScroll(n,"scrollTop"),i[1]+=o[3]-bodyScroll(n,"scrollLeft"),i[3]+=o[3]-bodyScroll(n,"scrollLeft"),n=n.parent}return i}function calcAdjPos(e,t,i,n,a){var o=bodyScroll(n,"clientHeight"),r=bodyScroll(n,"clientWidth"),s=bodyScroll(n,"scrollTop"),l=bodyScroll(n,"scrollLeft"),d=s+o,c=l+r,p=[0,0,0,0];if(a<2){e[1];0==a&&e[3]<t||1==a&&c-e[1]>t?p[1]=(p[3]=e[1])+t:p[3]=(p[1]=e[3])-t,e[0]+i>d?p[0]=(p[2]=e[2]-i<s?d:e[2])-i:p[2]=(p[0]=e[0])+i}else 2==a&&e[0]-s<i||3==a&&d>e[2]+i?p[2]=(p[0]=e[2])+i:p[0]=(p[2]=e[0])-i,p[1]=e[1],p[3]=e[3];return p}function bodyScroll(e,t,i){var n=(e||window).document||e,a=n.body,o=n.documentElement;if("number"!=typeof i)return"scrollTop"==t&&"undefined"!=typeof e.pageYOffset?e.pageYOffset:o[t]||a[t];a[t]=o[t]=i}function htmlDecode(e){return e&&e.replace?e.replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'"):e}function htmlEncode(e){return e&&e.replace?e.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;"):e}function htmlEscape(e){return String(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\`/g,"&#96;").replace(/\r/g,"").replace(/\t/g,"").replace(/\n/g,"")}function filteScript(e,t){return e&&e.replace(/<script ?.*>(.*?)<\/script>/gi,"<script>$1\n<\/script>").replace(/<script ?.*>([\s\S]*?)<\/script>/gi,t||"")}function textToHtml(e){return["<DIV>",e.replace(0<=e.indexOf("<BR>")?/<BR>/gi:/\n/g,"</DIV><DIV>"),"</DIV>"].join("").replace(new RegExp("\r","g"),"").replace(new RegExp(" ","g"),"&nbsp;").replace(new RegExp("(<DIV></DIV>)*$","g"),"").replace(/<DIV><\/DIV>/g,"<DIV>&nbsp;</DIV>")}function textToHtmlForNoIE(e){return e.replace(/\n/g,"<br>")}function htmlToText(e){return e.replace(/\n/gi,"").replace(/(<\/div>)|(<\/p>)|(<br\/?>)|(<\/li>)/gi,"\n")}function fixNonBreakSpace(e){return(e||"").replace(/\xA0/gi," ")}function pasteHTML(e,t,i,n){n=n||getMainWin(),e=filteScript(e);var a="string"==typeof t?S(t,n):t;return!(!a||!e)&&(i?a.innerHTML=e:insertHTML(a,"afterBegin",e),!0)}function limitString(e,t){var i=e||"",n=t||20,a=i.length;if(n<a){var o=Math.floor((n-3)/2);i=i.substring(0,o)+"..."+i.slice(-o,a)}return i}function T(e,t){return new T._QMTemplate(e,t)}function TE(e,t){var i=getTop();if(i.QMTmplChecker){var n=new i.QMTmplChecker(e.join?e:[e],t).getErrors();n.length&&debug(n.join("\n"),"code")}return new T._QMTemplate(e,t,"exp")}calcPos._isSupportsFixedPosition=function(){if(null==this._bIsSupportsFixedPosition){var e=document.createElement("div");e.style.cssText="'position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;",e.innerHTML="<div style='position:fixed;top:20px;'></div>",document.body.appendChild(e),this._bIsSupportsFixedPosition=!!{20:1,15:1}[e.firstChild.offsetTop]}return this._bIsSupportsFixedPosition},T._QMTemplate=function(e,t,i){this._msTmplStr=e.join?e.join(""):e.toString(),this._msTmplReplaceVar=t||"$",this._replace="exp"==i?this._replaceWithExp:this._replaceWithParse},T._QMTemplate.prototype={toString:function(){return this._msTmplStr},replace:function(e,t){return this._replace(e,t)},_replaceWithParse:function(e,t){var i=this,n=i._msTmplReplaceVar,a=i._moTmplData,o=i._moLinkData,r=!a;r&&(a=i._moTmplData=i._msTmplStr.split(i._msTmplReplaceVar),o=i._moLinkData=i._moTmplData.concat());for(var s=1,l=a.length;s<l;s+=2)o[s]=i._get(r?a[s]=a[s].split("."):a[s],e,t,n);return o.join("")},_replaceWithExp:function(e,t,i){var n,a=this;if(a._mfReplace||a._compile(),"string"==typeof t){var o=a._moSecDatas[t];o&&(n="function"!=typeof o?a._moSecDatas[t]=a._genHandleFunc(o):o)}else n=a._mfReplace;try{return n&&n(e,a._moTmplDatas,a._get,a._msTmplReplaceVar,htmlEncode,i||t)||""}catch(r){return r.message}},_compile:function(){for(var e,t=this,i=0,n=[],a=[],o=[],r=t._moSecDatas=[],s=t._msTmplReplaceVar,l=new RegExp(["","(.*?)",""].join(regFilter(s)),"g"),d="_afG('$1'.split('.'),_oD,_aoD,_aoR)",c=t._moTmplDatas=t._msTmplStr.split(["","@",""].join(s)),p=0,u=c.length;p<u;p++)if(e=c[p],p%2==0)n.push("_oR.push(_aoT[",p,"].replace(_oD,_aoD));"),c[p]=T(e,s);else if("else"==e)n.push("}else{");else if("endsec"==e){if(o.length){var g=o.pop();r[g[0]]=n.slice(g[1])}}else"endfor"==e?a.length&&n.push("try{delete _oD._parent_;delete _oD._idx_;}catch(e){}}_oD=_oS",a.pop(),";"):"endif"==e?n.push("}"):0==e.indexOf("else if(")?n.push("}",e.replace(l,d),"{"):0==e.indexOf("if(")?n.push(e.replace(l,d),"{"):0==e.indexOf("for(")?(a.push(++i),n.push("var _sI",i,",_oD",i,",_oS",i,"=_oD;",e.replace(l,["_sI",i," in (_oD",i,"=",d,")"].join("")),"{","_oD=_oD",i,"[_sI",i,"];","if(!_oD){continue;}","try{_oD._parent_=_oS",i,";","_oD._idx_=_sI",i,";}catch(e){}")):0==e.indexOf("sec ")?o.push([e.split(" ").pop(),n.length]):0==e.indexOf("eval ")?n.push("_oR.push(",e.substr(5).replace(l,d),");"):0==e.indexOf("html(")&&n.push("_oR.push(_afE(",e.substr(5).replace(l,d),");");return t._mfReplace=t._genHandleFunc(n),n},_genHandleFunc:function(_aoCompileDatas){try{return eval(["([function(_aoD,_aoT,_afG,_aoR, _afE, A){var _oR=[],_oD=_aoD;",_aoCompileDatas.join(""),'return _oR.join("");}])'].join(""))[0]}catch(_oErr){return function(){return"compile err!"}}},_get:function(e,t,i,n){var a,o,r=e.length;if(1<r)try{o=t;for(var s=0;s<r;s++)o="_root_"==(a=e[s])?i:o[a]}catch(l){o=""}else o={_var_:n,_this_:t}[a=e[0]]||t[a];return o}};var addEvent=function(){function a(e,t,i,n){return e&&i&&(e.addEventListener?e[n?"removeEventListener":"addEventListener"](t,i,!1):e.attachEvent?e[n?"detachEvent":"attachEvent"]("on"+t,i):e["on"+t]=n?null:i),e}return function(e,t,i,n){return e&&(e.join||e[_gsForEBuiltTag])?E(e,function(e){a(e,t,i,n)}):a(e,t,i,n),e}}();function addEvents(i,e,n){return E(e,function(e,t){addEvent(i,t,e,n)}),i}function removeEvent(e,t,i){return addEvent(e,t,i,!0)}function removeEvents(e,t){return addEvents(e,t,!0)}function preventDefault(e){return e&&(e.preventDefault?e.preventDefault():e.returnValue=!1),e}function stopPropagation(e){return e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0),e}function getEventTarget(e){return e&&(e.srcElement||e.target)}function getDomWin(e){if(e){var t=e.ownerDocument;return t.defaultView||t.parentWindow}}function getUserTarget(e,t,i){for(var n=getEventTarget(t);n&&isObjContainTarget(e,n);){if(attr(n,i))return n;n=n.parentNode}}function fireMouseEvent(e,t){if(e)if(e.dispatchEvent){var i=e.ownerDocument,n=i.defaultView,a=i.createEvent("MouseEvents");a.initMouseEvent(t,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}else"INPUT"==e.tagName&&"submit"==e.getAttribute("type")&&"click"==t?e.click():e.fireEvent("on"+t);return e}var liveEvent=function(){var d={click:"ck",dblclick:"dbl",mousedown:"md",mouseup:"mu",mouseover:"mor",mousemove:"mm",mouseout:"mot",keydown:"kd",keypress:"kp",keyup:"ku"};function a(e,t){var i=e.type,n=d[i],a=t.rule()[i],o=t.events(),r=getEventTarget(e);if(n)do{var s=r.getAttribute(n),l=a[s];if(s&&l&&o[s]&&(_vRe=o[s].call(t,e,r),!l.bPropagable))break}while((r=r.parentNode)&&r.getAttribute)}return function(e,t){var i=t.rule();for(var n in i)addEvent(e,n,function(e){a(e,t)})}}();function loadJsFile(e,t,i,n,a,o){var r,s=i||document,l="function"==typeof n,d=getTop().loadJsFile,c=getRes(e),p=d._oDatas||(d._oDatas={});if(t)for(var u=GelTags("script",s),g=u.length-1;0<=g;g--)if(-1!=u[g].src.indexOf(c)){if(l){var f=u[g].getAttribute("_key_");!0===p[f]?callBack.call(u[g],n):p[f].push(n)}return u[g]}r=s.createElement("script"),E(a,function(e,t){r.setAttribute(t,e)});f=unikey();function m(){var e=this.getAttribute("_key_");callBack.call(this,n),E(p[e],function(e){e()}),p[e]=!0,o&&removeSelf(r),this.onreadystatechange=this.onload=null}return r.setAttribute("_key_",f),p[f]=[],(GelTags("head",s)[0]||s.documentElement).appendChild(extend(r,{onload:m,onreadystatechange:function(){({loaded:!0,complete:!0})[this.readyState]&&m.call(this)}},{type:"text/javascript",charset:a&&a.charset||"gb2312",src:c})),r}function loadJsFileToTop(){if(2==arguments.length)var t=arguments[0],e=arguments[1];else t="",e=arguments[0];var i=window.loadJsFile;E(e,function n(e){e&&i(t+e,!0,getTop().document)})}function loadCssFile(e,t,i){var n=i||document,a=getRes(e);if(t)for(var o=GelTags("link",n),r=o.length-1;0<=r;r--)if(-1!=o[r].href.indexOf(a))return;var s=n.createElement("link"),l=GelTags("link",n);if(s.type="text/css",s.rel="stylesheet",s.href=a,0<l.length){var d=l[l.length-1];d.parentNode.insertBefore(s,d.nextSibling)}else(GelTags("head",n)[0]||n.documentElement).appendChild(s);return s}function replaceCssFile(t,e,i){return t&&E(GelTags("link",i||document),function(e){e&&-1!=e.href.indexOf(t)&&removeSelf(e)}),loadCssFile(e,!1,i)}function QMAjax(e,t,i,n){var r,s=this,l=getTop(),d=n;function c(e){return!!r&&(clearTimeout(r),r=null,"ok"!=e&&function t(e){s.onError(d,e)}(e),!0)}if(this.method=t||"POST",this.url=e,this.async=!0,this.content="",this.timeout=i,this.onComplete=function(){},this.onError=function(){},this.getXhr=function(){return d},this.setXhr=function(e){d=e},!d)try{d=new XMLHttpRequest}catch(p){try{d=new ActiveXObject("MSXML2.XMLHTTP")}catch(p){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(p){}}}if(!d)return!1;this.abort=function(){c("abort"),d&&d.abort()},this.abortCustom=function(){c("abortCustom"),d&&d.abort()},this.send=function(e){if(!this.method||!this.url||!this.async)return!1;"object"==typeof this.url&&(this.url=this.url.replace({}));var t=this.method.toUpperCase(),i=getTop().getSid&&getTop().getSid();this.abort();var n=QMDistributeDomain(this.url,d);d=n.oXhr;var a=n.sUrl;d.open(t,a+(i&&"POST"==t&&-1==((this.url.split("?")[1]||"")+"&").indexOf("&sid=")?(-1==this.url.indexOf("?")?"?sid=":"&sid=")+i:""),this.async),"POST"==t&&(d.setRequestHeader("Content-Type",document.charset),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),l.E(this.headers,function(e,t){d.setRequestHeader(t,e)}),d.onreadystatechange=function(){try{4==d.readyState&&(200==d.status?c("ok")&&function e(){s.onComplete(d)}():c(d.status))}catch(t){c(t.message)}},function o(e){r||(r=setTimeout(function(){s.abort()},e))}(this.timeout||15e3);try{"POST"==t?d.send(e||this.content):d.send(null)}catch(p){c(p.message)}return!0}}function includeAjax(e){var t=[];t.push(QMAjax.toString()),t.push(["var QMAjaxSend =",QMAjax.send.toString()].join("")),globalEval(t.join(""),e)}QMAjax.newXhr=function(e){var t=e||window;if(t.ActiveXObject)try{return new t.ActiveXObject("MSXML2.XMLHTTP")}catch(i){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}if(t.XMLHttpRequest)return new t.XMLHttpRequest;Log("gen xhr fail")},QMAjax.send=function(e,i,t){var n,a,o=getTop(),r=i||{};"function"==typeof QMDistributeDomain?(a=t?((n=QMDistributeDomain(e,t.getXhr())).bNewXhr&&t.setXhr(n.oXhr),t):new QMAjax("","",0,(n=QMDistributeDomain(e,r.xhr)).oXhr),e=n.sUrl,a.url=e):(a=t||new QMAjax).url=e;o.E("method,timeout,content,headers".split(","),function(e){r[e]&&(a[e]=r[e])}),a.onComplete=function(e){o.callBack.call(e,i.onload,[!0,o.trim2(e.responseText||""),e])},a.onError=function(e,t){o.callBack.call(e,i.onload,[!1,t,e])},a.send()};var QMAjaxRequest=QMAjax;function getErrMsg(e,t){var i="_AjaxErrorHTML_",n=S(i);n||((n=document.createElement("div")).id=i,n.style.display="none",document.body.appendChild(n)),n.innerHTML=filteScript(200==e.status?e.responseText:"");var a=S(t);return a&&(a.innerText||a.textContent)||""}function getHttpProcesser(){var e=getTop(),t=e.gCurHttpProcesserId||0;e.gCurHttpProcesserId=(t+1)%30;try{null!=e.gHttpProcesserContainer[t]&&delete e.gHttpProcesserContainer[t]}catch(n){e.gHttpProcesserContainer={}}var i=e.gHttpProcesserContainer[t]=new e.Image;return i.onload=function(){return!1},i}function goUrl(e,t,i){t=trim(addDistributeDomainPrefix(t,e));try{var n=(e.contentWindow||e).location,a=n.href.split("#"),o=t.split("#"),r=o[0]==a[0]?o[0]:t;i?n.href=r:n.replace(r)}catch(s){e.src=t}}function generateFlashCode(e,t,i,n){var a=[],o=[],r=[],s=n||{},l=T(" $name$=$value$ "),d=T('<param name="$name$" value="$value$" />'),c=T(gbIsIE?['<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ',"$codebase$ ","$attr$ $id$ >","$param$",'<embed $embed$ type="application/x-shockwave-flash" ',"$pluginspage$ "," $name$ ></embed>","</object>"]:['<embed $embed$ type="application/x-shockwave-flash" ',"$pluginspage$ "," $name$ $id$ ></embed>"]);function p(e,t){return{name:e,value:t}}for(var u in s.allowScriptAccess="always",s.quality="high",s){var g=p(u,s[u]);o.push(d.replace(g)),r.push(l.replace(g))}for(var u in i){g=p(u,i[u]);a.push(l.replace(g)),r.push(l.replace(g))}return t&&(o.push(d.replace(p("movie",t))),r.push(l.replace(p("src",t)))),c.replace({id:e&&[' id="',e,'"'].join(""),name:e&&[' name="',e,'"'].join(""),attr:a.join(""),param:o.join(""),embed:r.join(""),codebase:"https:"==location.protocol?"":'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" ',pluginspage:"https:"==location.protocol?"":'pluginspage="http://www.adobe.com/cn/products/flashplayer" '})}function getFlash(e,t){var i=t||window,n=i[e]||i.document[e];return n&&(n.length?n[n.length-1]:n)}function zoomFuncCreater(g){return function(e,t,i,n){var a=i||g.limitWidth||1,o=n||g.limitHeight||1,r=e/a||1,s=t/o||1,l=[r<1?"w":"W",s<1?"h":"H"].join(""),d=g[l]||g.all,c={};switch(d){case"stretch":c.width=a,c.height=o;break;case"zoomMaxMin":case"zoomMinMax":var p=t<e?0:1;d=["zoomMax","zoomMin"]["zoomMinMax"==d?1-p:p];case"zoomMax":case"zoomMin":var u=Math["zoomMax"==d?"min":"max"](s,r);c.width=Math.round(e/u),c.height=Math.round(t/u);break;case"none":default:c.width=e,c.height=t}return c.left=Math.round((a-c.width)/2),c.top=Math.round((o-c.height)/2),c}}function scrollIntoMidView(e,t,i,n,a){if(!e||!t)return!1;var o="BODY"==t.tagName.toUpperCase(),r=t.ownerDocument,s=r.documentElement;o&&s.clientHeight&&(t=s);var l=calcPos(e)[0]-calcPos(t)[0]-(o?t.scrollTop:0),d=l,c=e.offsetHeight,p=t.clientHeight,u=n||0;if(i||d<0||p<d+c){var g,f=0;c+u<p&&(f=a?d<0?0:p-c-u:(p-c-u)/2),g=t.scrollTop=t.scrollTop+l-f,t==s&&(r.body.scrollTop=g)}return!0}function Gel(e,t){return(t||document).getElementById(e)}function objectActive(e){}function inherit(e,t,i,n,a){var o=callBack(i,[t.prototype]),r=o.$_constructor_,s=function(){if("__inherit__"!=arguments[0]){var e=callBack.call(this,a,arguments)||{};if(e.bReturn)return e.vData;this._mbIsBuildConstructor||(this.constructor=arguments.callee,this._mbIsBuildConstructor=!0),t.apply(this,arguments),callBack.call(this,r,arguments)}};return extend(s.prototype=new t("__inherit__"),o,{toString:function(){return""}}),extend(s,n,{name:e,superclass:t})}function inheritEx(e,t,i,n){var a={},o=inherit(e,t,i,n,function(){var e=typeof arguments[0];return{bReturn:"string"==e||"undefined"==e,vData:o.$_call.apply(o,arguments)}});return extend(o,{$_call:function(e,t,i){if(0==arguments.length)return a;var n=a[e];return 1<arguments.length&&n?callBack.call(n,n[t],i):n},$_add:function(e,t){return a[e]=t},get:function(e){return a[e]},$_del:function(e){delete a[e]}})}function cacheByIframe(e,t){for(var i=t||{},n=i.win||getTop(),a=i.id||unikey("_"),o=[i.attrs],r=[],s=0,l=e&&e.length||0;s<l;s++)for(var d=e[s],c=2,p=d.length;c<p;c++)r.push(d[0],":",d[1],d[c],"|");o.push(' _file="',encodeURIComponent(r.join("")),'"'),o.push(' _header="',encodeURIComponent(i.header||""),'"'),o.push(' _body="',encodeURIComponent(i.body||""),'"'),createIframe(n,getBlankUrl(n,i),extend({},i,{id:a,attrs:o.join(""),onload:function(e){var t=this;callBack.call(t,i.onload,[e]),(0!=i.destroy||"true"==t.getAttribute("destroy"))&&n.setTimeout(function(){removeSelf(t)},100)}}))}function getBlankUrl(e,t){t=t||{};var i=(e||getTop()).location,n="/zh_CN/";-1<i.hostname.indexOf("en.exmail.qq.com")&&(n="/en_US/");var a=n+"htmledition/"+getFullResSuffix("domain2.html");return[a,"?",document.domain!=i.host?encodeURIComponent(document.domain):"",-1!=i.href.indexOf(a)||!1===t.useCache?"&r="+Math.random():""].join("")}function clearCache(){0<arguments.length&&getTop().cacheByIframe(arguments,{destroy:!1,onload:function(){this.getAttribute("destroy")||(this.setAttribute("destroy","true"),this.contentWindow.location.reload(!0))}})}function preLoad(e,t,i,n){if(window!=getTop())getTop().preLoad.apply(this,arguments);else{var a=arguments.callee,o=a._moWaitqueue=a._moWaitqueue||[];if(e&&i)for(var r=0,s=i.length;r<s;r++)o.push([[e,t,i[r]]]);if(!a._mbIsRun&&0<o.length){a._mbIsRun=!0,cacheByIframe(o[0],{onload:function l(){a._mbIsRun=!1,callBack(n,[o.shift()[0][2]]),setTimeout(function(){a("","","",n)},100)}})}}}function setDblClickNoSel(i){if(i){var n="__MoUSeDoWnnoSEL__";function a(){return(i.getAttribute(n)||"").toString().split(",")}function o(e,t){i.setAttribute(n,[e,t])}1==a().length&&(o(0,"up"),addEvents(i,{mousedown:function(e){var t=now(),i=parseInt(a()[0]);o(t,"down"),t-i<500&&preventDefault(e)},mouseup:function(){o(a()[0],"up")},selectstart:function(e){"up"==a().pop()&&preventDefault(e)}}))}return i}var dddIndex=0;function waitForShowTip(t,i,n){var a=getTop();dddIndex++;a.loadJsFile("$js_path$"+getFullResSuffix("qmtip.js"),!0),a.waitFor(function(){return a.QMTip},function(e){e&&(t.domid?window.fuck_domid=1:fuck_domid&&(window.fuck_domid=0),a.callBack(n,[a.QMTip[i||"markunshow"](t)]))})}function addDistributeDomainPrefix(e,t){var i=QMDistributeDomain.removeHost(e);if(0===i.indexOf("/cgi-bin/")&&(i==e||e.indexOf(getTop().location.host)<5)){try{if(!t||t&&t.parent!=t)return QMDistributeDomain.getHost()+i}catch(n){}if(i==e)return getTopHost()+i}return e}function getTopHost(){var e=getTop().location;return[e.protocol,"//",e.host].join("")}function OprATagForDistributeDomain(e){var t=getEventTarget(e),i=t.tagName,n=QMDistributeDomain.removeHost(t.href||"");n=QMDistributeDomain.removeDefaultHost(n);"A"!==i||0!==n.indexOf("/cgi-bin/")&&0!==n.indexOf("/")||("_blank"===t.target||"_top"===t.target||e.ctrlKey||"_parent"===t.target&&window.parent==window||"true"===attr(t,"unset")||"actionFrame"===t.target?t.href=[OprATagForDistributeDomain._sBlank,getTopHost(),n].join(""):2!==e.button&&(t.href=[OprATagForDistributeDomain._sBlank,QMDistributeDomain.getHost(),n].join("")))}function preventDefault2(e){var t=getEventTarget(e),i=t.tagName,n=t.href;"A"!==i||!n||"javascript:;"!==n&&"javascript:void(0);"!==n||preventDefault(e)}function isHttp(){return"http:"==window.location.protocol}function supportWPS(){var e=!0,t=navigator.userAgent,i=/msie ([\d.]+)/i.exec(t),n=i?parseFloat(i[1]):100,a=-1<t.indexOf("presto");return(n<=10||a)&&(e=!1),e&&getTop().gray_preview_wps}OprATagForDistributeDomain._sBlank=gbIsIE?" ":"";var QMDistributeDomain=function(){var o,r=getTop();function s(){return r.getTopHost()}function t(){return r.gsDistributeDomain||s()}function l(e){if(0===e.indexOf("/cgi-bin/"))return!0;var t=e.indexOf("//");return-1==t||0!==t&&(5!=t&&6!=t||!/^http(s)?:\/\//i.test(e))}function i(e){return!l(e)&&(0===(e=e.toLowerCase()).indexOf("//")&&(e=document.location.protocol+e),0===e.indexOf(t()))}function d(e){return i(e)?e:l(e)?t()+e:a(e)}function n(e){return"/"+e.split("/").slice(3).join("/")}function c(e){return l(e)?e:n(e)}function a(e){return t()+c(e)}function e(e,t){var i=!1,n=l(e);if(!t||n){i=!0;try{t=o.contentWindow.xmlHttp(),"dev.exmail.qq.com"==location.host||(e=d(e))}catch(a){r.debug({title:"set proxy error",url:e},2),e=s()+(n?e:c(e)),t=QMAjax.newXhr(r)}}return{bNewXhr:i,sUrl:e,oXhr:t}}return-1!=window.location.hostname.indexOf("exmail.qq.com")&&waitFor(function(){return r.document.body},function(e){e&&r.createIframe(r,getBlankUrl(r),{id:"iframe_distributeDomain_proxy_",onload:function(){o=this}})}),e.getTopHost=s,e.getHost=t,e.isRelativeUrl=l,e.isHasDistributeHost=i,e.addHost=d,e.replaceHost=a,e.getRelativeUrl=c,e.removeHost=function p(e){return i(e)?n(e):e},e.removeDefaultHost=function u(e){return 0===e.indexOf(s())?n(e):e},e}();function getDomain(e){return[["foxmail.com","qq.com","biz"],["Foxmail.com","QQ","Tencent"]][e?1:0][/,7$/.test(getSid())?2:-1<location.href.indexOf("foxmail.com")?0:1]}var GetDomain=getDomain;function getSid(){return getTop().g_sid||(S("sid")?S("sid").value:location.getParams(getTop().location.href).sid)}var GetSid=getSid;function getScode(){return 1==getTop().gIsPublicEmail?location.getParams(getTop().location.href).scode:""}function trimLeftLetter(e,t){return e&&e.length?t?e.length>t?e.slice(0,t)+"...":e.slice(0,t):e:""}function getUin(){return getTop().g_uin}function getPaths(){var e={images_path:getTop().images_path||"/zh_CN/htmledition/images/",js_path:getTop().js_path||"/zh_CN/htmledition/js/",css_path:getTop().css_path||"/zh_CN/htmledition/css/",style_path:getTop().style_path||"/cgi-bin/getcss?sid="+getSid()+"ft=",swf_path:getTop().swf_path||"/zh_CN/htmledition/swf/",stationery_path:"http://rescdn.qqmail.com/zh_CN/",card_path:"http://rescdn.qqmail.com/zh_CN/",mo_path:"http://rescdn.qqmail.com/zh_CN/",editor_path:getTop().editor_path||"/zh_CN/htmledition/qqmaileditor/",neweditor_path:getTop().neweditor_path||"/zh_CN/htmledition/js/qqmaileditor/",base_path:"/",skin_path:"0",swf_cdn_path:"//res.mail.qq.com/bizmail/zh_CN/htmledition/swf/"};for(var t in e)e[t]=trim(getTop()[t])||e[t];return e}function getPath(e,t){"image"==e&&(e+="s");var i=getPaths()[e+"_path"]||"";return i&&t&&"skin"!=e&&0!=i.indexOf("http")&&(i=[location.protocol,"//",location.host,i].join("")),i}function getRes(e){return T(e).replace(getPaths(),!0)}function getFullResSuffix(e){if(!getTop().gLn)return e;var t,i;return 0<e.indexOf(".js")?(t=e.substr(0,e.indexOf(".js")),i=".js"):0<e.indexOf(".css")?(t=e.substr(0,e.indexOf(".css")),i=".css"):0<e.indexOf(".html")&&(t=e.substr(0,e.indexOf(".html")),i=".html"),0<t.length&&getTop().gLn[t]?t+getTop().gLn[t]+i:e}function outputJsReferece(n,e,t){var a=n||outputJsReferece._msPath,i=e||outputJsReferece._moFileList,o=t||window,r=T(['<script language="JavaScript" src="$file$',-1==a.indexOf("?")?"":"&r="+Math.random(),'"></',"script>"]),s=[];return outputJsReferece._msPath=a,E(outputJsReferece._moFileList=i,function l(e){var t=trim(e||""),i=/[0-9a-fA-F]{6}\.js$/.test(t)?e.substr(0,e.length-9):e.split(".")[0];!i||!n&&o[i+"_js"]||s.push(r.replace({file:a+e}))}),s.join("")}function runUrlWithSid(e){try{getTop().getHttpProcesser().src=T("$url$&sid=$sid$&r=$rand$").replace({url:e,sid:getSid(),rand:Math.random()})}catch(t){}}function createBlankIframe(e,t){cacheByIframe(t&&0==t.defcss?[]:[["css","",getRes("$css_path$comm.css")],["css",getPath("style"),"skin"]],extend({className:"menu_base_if",transparent:!1,destroy:!1,attrs:"tabindex=-1"},t,{win:e,header:["<script>",getTop.toString().replace(/[\r\n]/g,""),"<\/script>",t&&t.header||""].join(""),onload:function(e){"true"!=this.getAttribute("cbi_inited")&&(t&&t.transparent&&(this.contentWindow.document.body.style.background="transparent"),this.setAttribute("cbi_inited","true")),callBack.call(this,t&&t.onload,[e])}}))}function createActionFrame(e){return createBlankIframe(e,{id:"actionFrame",defcss:!1,onload:actionFinishCheck})}function getFileTypeByExt(e){var t={eml:"eml",pdf:"pdf",txt:"txt,h,m,js,as,java,c,cpp,plist,ini,stp,csv,xml",html:"html,htm,xhtml,mht",rar:"zip,7z,rar,bz2,gz,tar,tbz,tgz,cab,gzip,bzip2,deb",mov:"mp3,m4a,wma,wav,aac,ac3,mp2,ape,flac,f4a,mkv,rmvb,wmv,mp4,f4v,flv,avi,mov,qt,m4v,asf,rm,mpeg,mpg,vob,ts,3gp,3gpp,3gp2,ogg,ogv,mp4,webm,f4m,avi",jpg:"jpg,png,bmp,gif,jpeg,tiff",fl:"fla,swf",psd:"psd",exl:"xls,xlsx,et,ett",ppt:"ppt,pptx,dps,dpt",doc:"doc,docx,rtf,dot,docm,wps,wpt",blank:""};return(t=function(e){var t={};for(var i in e)for(var n=e[i].split(","),a=0,o=n.length;a<o;a++)t[n[a]]=i;return t}(t))[e.toLowerCase()]||"blank"}function getFileExt(e){var t=e.split(".");return 1<t.length?t.pop().toLowerCase():""}function isSupportImportWord(e){return"doc"==getTop().getViewTypeByFileName(e)}function getViewTypeByFileName(e){return getViewTypeByExt(getFileExt(e))}function getViewTypeByExt(e,t){var i={doc:"c,doc,xls,ppt,docx,xlsx,pptx,rtf,pdf,txt,js,as,htm,html,mht,xhtml,eml,h,m,java,cpp,plist,ini,xml,pps,stp,csv,dot,docm,et,ett,dps,dpt,wps,wpt",music:"mp3,f4a,oga,wma,wav,m4a,aiff,aifc",video:"mp4,wmv,swf,mov,flv,f4v,m4v,ogg,ogv,webm,avi,m4v,rm,rmvb,mpeg,mpg,3gp",compress:"zip,7z,rar,bz2,gz,tar,tbz,tgz,cab,gzip,bzip2,deb",img:"jpg,jpeg,bmp,gif,png"};for(var n in t&&(i={wpsdoc:"doc,dot,wps,wpt,docx,dotx,docm,dotm,rtf,xls,xlt,et,xlsx,xltx,xlsm,xltm,ppt,pptx,pptm,ppsx,ppsm,pps,potx,potm,dpt,dps,pdf",doc:"c,doc,xls,ppt,docx,xlsx,pptx,rtf,pdf,txt,js,as,htm,html,mht,xhtml,eml,h,m,java,cpp,plist,ini,xml,pps,stp,csv,dot,docm,et,ett,dps,dpt,wps,wpt",music:"mp3,f4a,oga,wma,wav,m4a,aiff,aifc",video:"mp4,wmv,swf,mov,flv,f4v,m4v,ogg,ogv,webm,avi,m4v,rm,rmvb,mpeg,mpg,3gp",compress:"zip,7z,rar,bz2,gz,tar,tbz,tgz,cab,gzip,bzip2,deb",img:"jpg,jpeg,bmp,gif,png"}),i)if(-1<[",",i[n],","].join("").indexOf([",",e.toLowerCase(),","].join("")))return n;return"other"}var getPreviewView=function(){var l=getTop();return function(e,t){var i=e.get("sName"),n=l.getFileExt(i),a=l.getFileTypeByExt(n||""),o=l.getViewTypeByExt(n),r=e.get("mailid")?[e.get("mailid"),e.get("attachid"),e.get("attachname")].join("|"):"";return l.T(["/cgi-bin/$appname$?sid=$sid$&upfilelistitem=$upfileid$&mailattach=$mailattach$","&filename=$filename$&filetype=$filetype$&t=$t$&readprev=$compose$&filepath=$filepath$","&action=$action$$viewdocparam$&viewtype=$viewtype$&r=$rand$&sc=false"]).replace({sid:l.getSid(),rand:Math.random(),appname:{txt:"readtemplate",html:"readtemplate",eml:"viewdocument"}[a]||{compress:"viewcompress",video:"viewfile",music:"viewfile",img:"viewfile"}[o]||"viewdocument",action:"compress"==o?"list":function s(e){return-1<"txt,html".indexOf(l.getFileTypeByExt(e||""))}(n)?"view":"",compose:"normal",t:t||"attachments_simple",upfileid:e.get("sFileId"),filename:l.encodeURI(i),filetype:a,filepath:e.get("sFilePath")||"",mailattach:r,viewdocparam:"doc"==o?"&s=yozo&fromattach=1&from=attachfolder":"",viewtype:"eml"==n?"eml":""})}}();function getIconByExt(e,t){return["/zh_CN/htmledition/images/xdisk/ico_",/^(min|mid|max)$/g.test(t)?t:"min","/fu_",getFileTypeByExt(e.toLowerCase()),".gif"].join("")}function calcMainFrameDomInGlobalPos(e,t){var i=calcPos(e),n=calcPos(S("mainFrame",getTop())),a=getMainWin().document,o=a.documentElement,r=a.body,s=i[3]+n[3]-(o.scrollLeft||r.scrollLeft||0),l=i[0]+n[0]-(o.scrollTop||r.scrollTop||0),d=i[4],c=i[5];return"json"==t?{top:l,bottom:l+c,left:s,right:s+d,width:d,height:c}:[l,s+d,l+c,s,d,c]}var gsMsgNoSubject="Please fill in the email subject",gsMsgNoMail="No messages selected",gsMsgSend="The mail is being sent.",gsMsgSave="&nbsp;&nbsp;&nbsp; mail is being saved to the draft box.",gsMsgSaveOk="Email successfully saved to draft box",gsMsgAutoSave="&nbsp;&nbsp;&nbsp; mail is being saved to the draft box.",gsMsgAutoSaveOk="Mail is automatically saved to the draft box",gsMsgSendErrorSaveOK="The letter has been saved to the draft box",gsMsgSaveErr="The message could not be saved in the draft box",gsMsgNoSender="Please fill in the recipient before sending",gsMsgNoCardSender="Please fill in the recipient before sending",gsMsgNoCard="Please select the greeting card before sending",gsMsgSettingOk="Settings saved successfully",gsMsgLinkErr="Network response failed",gsMsgCheatAlert="The system will move this message to  spam  and submit the message content to the mailbox administrator.\n\nAre you sure you want to report this message?",gsMsgSendTimeErr="The sending time you set does not exist",gsMsgMoveMailSameFldErr="Cannot be moved to the same directory";function doPageError(e,t,i){var n=arguments.callee.caller,a=n&&n.caller,o=a&&a.caller,r=(n||"null").toString(),s=(a||"").toString(),l=(o||"").toString();try{if(-1!=e.indexOf(" Script "))return;if(-1!=e.indexOf("flashUploader")){var d=qmFlash.getFlashVer();for(var c in d)e+="|"+d[c]}if((!t||-1==t.indexOf("/cgi-bin/mail_list?")||2!=i)&&location.getParams){var p=location.getParams(t);_oCgiPart=t.split("?")[0].split("/"),_sErrFunc=encodeURIComponent(r.replace(/[\r\n\t ]/gi,"").substr(0,50)),0<_oCgiPart.length?(p.cgi=_oCgiPart.pop(),getTop().ossLog("delay","sample",["stat=js_run_err&msg=",e,"&line=",i,"&url=",T("$cgi$?t=$t$&s=$s$").replace(p),"&func=",_sErrFunc,gbIsIE?"":"_NIE"].join(""))):_sErrFunc}getTop().debug(["error:",e,"<br><b>line</b>:",i,"<br><b>url</b>:",t,"<br><b>function</b>:",r.substr(0,100),s?"<br><b>parent function</b>:"+s.substr(0,100):"",l?"<br><b>parent parent function</b>:"+l.substr(0,100):""].join(""),"error")}catch(u){u.message}return 0!=location.host.indexOf("dev.")}var QMFileType={data:{doc:"doc",docx:"doc",xls:"exl",xlsx:"exl",ppt:"ppt",pptx:"ppt",pdf:"pdf",txt:"txt",log:"txt",xml:"txt",js:"txt",css:"txt",php:"txt",asp:"txt",aspx:"txt",jsp:"txt",vbs:"txt",h:"txt",cpp:"txt",eml:"eml",rar:"rar",zip:"rar","7z":"rar",arj:"rar",wav:"mov",mp3:"mov",wma:"mov",mid:"mov",rmi:"mov",ra:"mov",ram:"mov",mp1:"mov",mp2:"mov",mp4:"mov",rm:"mov",rmvb:"mov",avi:"mov",mov:"mov",qt:"mov",mpg:"mov",mpeg:"mov",mpeg4:"mov",dat:"mov",asf:"mov",wmv:"mov","3gp":"mov",ac3:"mov",asf:"mov",divx:"mov",mkv:"mov",ogg:"mov",pmp:"mov",ts:"mov",vob:"mov",xvid:"mov",htm:"html",html:"html",mht:"html",swf:"swf",flv:"swf",bmp:"bmp",gif:"gif",jpg:"jpg",jpeg:"jpg",jpe:"jpg",psd:"psd",pdd:"psd",eps:"psd",tif:"tu",tiff:"tu",ico:"tu",png:"tu",pic:"tu",ai:"tu"},getFileType:function(e){return this.data[trim(e||"").toLowerCase()]||"qita"},getFileTypeForFile:function(e){return this.getFileType((e||"").split(".").pop())}},QMHistory={_moParam:{},_moCaches:{}};function QMCache(e){var t=this._mnTimeStamp=e.timeStamp||1,i=this._msAppName=e.appName;if(!t||!i)throw{message:"QMCache construct : config error!"};var n=getTop().QMCache._moCacheSet;n||(n=getTop().QMCache._moCacheSet={});var a=n[i];a||(a=n[i]={_curTimeStamp:"0",_data:{}}),1==this._compareTimeStamp(a._curTimeStamp,t)&&(a._curTimeStamp=t)}QMHistory.getId=function(e){return e},QMHistory.getUrl=function(e){var t=getTop().QMHistory._moCaches[QMHistory.getId(e)];return t&&t._sUrl},QMHistory.getLastRecordId=function(){return getTop().QMHistory._moParam._sLastUrlRecordId},QMHistory.tryBackTo=function(e){try{var t=getTop().QMHistory._moParam,i=QMHistory.getId(e),n=getTop().QMHistory._moCaches[i],a=n&&n._sUrl,o=n&&n._nHistoryLen>=getTop().history.length,r=n&&t._sPreMainWinUrl==a,s=n&&!t._bIsActionFrameUrlChange;if(gbIsIE&&(o||r)&&s||!gbIsWebKit&&o&&r&&s)return function l(){var e=a.split("#")[0];return getTop().location.getParams&&4==getTop().location.getParams(e).folderid?goUrlMainFrm(e):gbIsIE&&6==gnIEVer?getTop().history.go(e):void getTop().history.back()}(),!0}catch(d){}return!1},QMHistory.recordCurrentUrl=function(e){var t,i,n=e.location.href,a=getTop().QMHistory._moCaches,o=getTop().QMHistory._moParam,r=o._sPreMainWinUrl=o._sCurMainWinUrl,s=o._sCurMainWinUrl=n;for(var l in a)a[l]._sUrl==r&&(t=l),a[l]._sUrl==s&&(i=l);t&&i&&delete a[t],-1!=n.indexOf("/mail_list")&&this._recordInfo("mail_list",n),-1!=n.indexOf("t=readmail")&&this._recordInfo("readmail",n),-1!=n.indexOf("/today")&&this._recordInfo("today",n)},QMHistory.recordActionFrameChange=function(e){getTop().QMHistory._moParam._bIsActionFrameUrlChange="clear"!=e},QMHistory._recordInfo=function(e,t){var i=getTop(),n=QMHistory.getId(e),a=i.QMHistory._moCaches,o=a[n];o||(o=a[n]=new i.Object),o._nHistoryLen=history.length+1,o._sUrl=t,i.QMHistory._moParam._sLastUrlRecordId=e},QMCache.prototype.isHistoryTimeStamp=function(){return 0!=this._compareTimeStamp(getTop().QMCache._moCacheSet[this._msAppName]._curTimeStamp,this._mnTimeStamp)},QMCache.prototype.setData=function(e,t){getTop().QMCache._moCacheSet[this._msAppName][e]=t},QMCache.prototype.getAll=function(e){return getTop().QMCache._moCacheSet[this._msAppName]},QMCache.prototype.getData=function(e){return getTop().QMCache._moCacheSet[this._msAppName][e]},QMCache.prototype.delData=function(e){delete getTop().QMCache._moCacheSet[this._msAppName][e]},QMCache.prototype._compareTimeStamp=function(e,t){return e==t?0:t<e?-1:1};var QMMailCache={_mId:now()};function rdVer(e,t,i){var n,a,o,r,s=new QMCache({appName:"readmail"});if(-1==t)return s.delData(e);if(n=s.getData("on"),"on"==e)return 0==t?n||0:s.setData("on",t);if(!n||!e)return 0;if(r="BaseVer"==e,(!(o=s.getData("BaseVer"))||r&&1==t)&&(o=o||rdVer("on",0)+Math.random().toFixed(2),o+=10,s.setData("BaseVer",o)),r)return o;var l=!(a=s.getData(e)||0)||1==t;return(l||i)&&(l&&(a+=1e4),i&&(a=1e4*Math.floor(a/1e4)+parseInt(i,10)%1e4),s.setData(e,a)),a}function setGlobalVarValue(e,t,i){var n=getTop();return n.goDataBase||(n.goDataBase=new n.Object),e&&!i&&(n.goDataBase[e]=t,getTop().getSignatureData()[e]=t),t}function getGlobalVarValue(e){return getTop().goDataBase&&getTop().goDataBase[e]||getTop().getSignatureData()[e]}function hideWindowsElement(t,e){if(e=e||getMainWin(),gbIsIE&&!(6<gnIEVer)&&(e.gbIsHasHideElements||!1)==(t||!1)){getTop().setGlobalVarValue("WINDOWS_ELEMENT_NOT_DISPLAY",t?"":"true"),e.gbIsHasHideElements=!t;var i=e.document.body;E(e.QMReadMail?["select","object","embed"]:["select"],function(e){E(GelTags(e,i),function(e){t?e.style.visibility=e.getAttribute("savevisibility"):(e.setAttribute("savevisibility",getStyle(e,"visibility")),e.style.visibility="hidden")})})}}function controlWindowsElement(){"true"==getTop().getGlobalVarValue("WINDOWS_ELEMENT_NOT_DISPLAY")&&hideWindowsElement(!1)}function setKeepAlive(e){null==getTop().gKeepAliveNum&&(getTop().gKeepAliveNum=0),null!=e&&1!=e.gbIsSetKeepAlive&&(e.gbIsSetKeepAlive=!0,getTop().gKeepAliveNum++,null==getTop().gKeepAliveTimer&&(getTop().gKeepAliveTimer=getTop().setInterval(function(){getTop().runUrlWithSid("/cgi-bin/readtemplate?t=keep_alive")},9e5)),addEvent(e,"unload",function(){e.gbIsSetKeepAlive=!1,getTop().gKeepAliveNum--,0==getTop().gKeepAliveNum&&(getTop().clearInterval(getTop().gKeepAliveTimer),getTop().gKeepAliveTimer=null)}))}function encodeNick(e){return e&&e.replace(/\\/g,"\\\\").replace(/\"/gi,'\\"').replace(/\'/gi,"\\'")||""}function decodeNick(e){return e&&e.replace(/\\\"/gi,'"').replace(/\\\\/gi,"\\")||""}QMMailCache.newCache=function(e,t){var i=!1,n=getTop();return!n.gMailListStamp||n.gMailListStamp<t?(n.gMailListStamp=t,n.goMailListMap||(n.goMailListMap=new n.Object),i=!0):n.gnExpireTimeStamp>=t&&reloadFrm(e),e["isNewQMMailCache"+this._mId]=i},QMMailCache.setExpire=function(){getTop().gnExpireTimeStamp=getTop().gMailListStamp},QMMailCache.addData=function(e,t){if(e&&getTop().goMailListMap&&(this.hasData(e)||(getTop().goMailListMap[e]={oTagIds:{},star:null,reply:null}),t)){var i=getTop().goMailListMap[e];for(var n in t)switch(n){case"removeTagId":i.oTagIds[t[n]]=0;break;case"addTagId":i.oTagIds[t[n]]=1;break;default:"undefined"!=typeof t[n]&&(i[n]=t[n])}}},QMMailCache.delData=function(e){getTop().goMailListMap&&delete getTop().goMailListMap[e]},QMMailCache.hasData=function(e){return getTop().goMailListMap&&null!=getTop().goMailListMap[e]},QMMailCache.getData=function(e){return getTop().goMailListMap&&getTop().goMailListMap[e]},QMMailCache.addVar=function(e,t){return getMainWin()[e]=this.getVar(e,0)+t},QMMailCache.getVar=function(e,t){return getMainWin()[e]||t},QMMailCache.isRefresh=function(e){return e["isNewQMMailCache"+this._mId]},rdVer.batch=function(e){var t=new QMCache({appName:"readmail"}),i=new RegExp("^"+e);E(t.getAll(),function(e,t){i.test(t)&&rdVer(t,1)})},rdVer.check=function(e,t,i){if(e){var n=e.location,a=(t=t||n.getParams().mailid,i=i||n.getParams().ver||0,rdVer(t,0));return i<a&&(goUrl(e,cookQueryString(n.href,{ver:a}),!0),!0)}},rdVer.log=function(e,t){var i=new QMCache({appName:"preload"}),n=(new Date).getTime(),a=i.getData(e),o=a&&n-a<1e3*rdVer.maxage(e);switch(t){case"pre":o||(i.setData(e,n),ossLog("delay","all","stat=rdcache&type=281&locval=,rdcache,preload,1"));break;case"hit":o&&ossLog("delay","all","stat=rdcache&type=291&locval=,rdcache,hit,1"),a&&i.delData(e)}return o},rdVer.isPre=function(e){return!(2<e&&e<7||9==e)},rdVer.preRD=function(e,t){var i=function(){preLoad("html","/cgi-bin/readmail?",e,function(e){rdVer.log(location.getParams(e).mailid,"pre")})};e&&0<e.length&&(t=t||40,0<(e=e.slice(0,1<rdVer("on",0)?2:1)).length&&(t?setTimeout(i,t):i()))},rdVer.maxage=function(e){return e?60*("@"==e[0]||"C"==e[0]?10:60):0},rdVer.url=function(e,t,i,n,a,o,r,s,l){var d,c,p,u,g=T("/cgi-bin/$cgi$?folderid=$folderid$$s$&t=$t$&mailid=$mailid$$cache$&sid=$sid$"),f="readmail",m=parseInt(t);if(r)c="readmail&s=draft";else if(0===n)c=100==s?"compose_card&s=draft":"compose&s=draft";else if(3===n)c="compose_meeting&s=draft";else if("9"==t)c="sms_list_v2",f="readtemplate";else if("11"==t)f="bottle_panel",c="bottle";else if(200900<m&&m<205012)c=f="archive_readmail";else{switch(e.charAt(0)){case"C":c="readmail_conversation";break;case"@":c="readmail_group";break;default:c="readmail"}d=!0}p=a?["&newwin=true","&compose_new=compose"][n?0:1]:["","&s=from_unread_list","&s=from_star_list"][1!=o&&2!=o?0:o];var h=d?rdVer(e,0,i):0;return!h&&l?"":(u=g.replace({cgi:f,mailid:e,folderid:t,t:c,s:p,sid:getSid(),cache:h?T("&mode=pre&maxage=$maxage$&base=$base$&ver=$ver$").replace({maxage:rdVer.maxage(e),base:rdVer("BaseVer",0),ver:h}):""}),l?u.split("?")[1]:u)};var QMPageInit={_debugCreater:function(a){return function(){var e=getTop(),t=arguments.length;if(e.Console)if(0==t)location.host;else try{e.console&&e.console.log&&e.console.log(arguments[0]);var i=e.Console[a];i.add.apply(i,arguments)}catch(n){}}},_traceCreater:function(o){return function(e,t,i,n,a){!getTop().QMTimeTracer||a&&a!=getTop().g_uin||getTop().QMTimeTracer.getTracer().trace(e,t,o,i,n)}},_initLocation:function(e){var t=e.location;t._bIsAnalyse=!1,t.params={},t.getParams=function(e){if(!e&&this._bIsAnalyse)return this.params;var i={},t=e?e.substr(e.indexOf("?")+1).split("#")[0]:this.search.substr(1);return t&&E(t.split("&"),function(e){var t=e.split("=");i[t.shift()]=unescape(t.join("="))}),e||(this.params=i,this._bIsAnalyse=!0),i};var i=t.href,n=getTop();e==n&&getSid()&&-1<i.indexOf("/cgi-bin/")&&-1==i.indexOf("/frame_html?")&&-1==i.indexOf("/log")&&(-1==i.indexOf("/ftnExs_")||-1<i.indexOf("/ftnExs_files"))&&!e.gbIsNoCheck&&"true"!=t.getParams().nocheckframe?-1==top.location.href.indexOf("/cgi-bin/bizmail?")&&goNewWin(t,!0,!e.gbSupportNW):e!=n&&n.bnewwin&&e==getMainWin()&&(e.gbSupportNW?"true"!=t.getParams().newwin&&e.location.replace(i+"&newwin=true"):goNewWin(t,!0,!0))},_initPageKeyDown:function(e,t){var i=e.srcElement||e.target,n=e.ctrlKey,a=(e.altKey,e.shiftKey),o=e.keyCode,r="text"==i.type||"TEXTAREA"==i.tagName,s=t&&"INPUT"==i.tagName&&"button"!=i.type,l="BUTTON"==i.tagName||"button"==i.type;switch(o){case 8:!r&&goBackHistory()&&preventDefault(e);break;case 13:!l&&(!r&&QMReadedItem.read(i)||s)&&preventDefault(e);break;case 37:case 39:n&&(goPrevOrNextMail(39==o),preventDefault(e));break;case 38:case 40:case 188:case 190:if(!r){var d=38==o||188==o;QMReadedItem.move(!d)&&preventDefault(e)}break;case 46:if(!r){var c=S(a?"quick_completelydel":"quick_del",getMainWin()),p=a?S("quick_del",getMainWin()):null,u=S("del",getMainWin());(isShow(c)||isShow(p)||isShow(u))&&(preventDefault(e),fireMouseEvent(c||p||u,"click"))}break;case 88:!r&&QMReadedItem.check(a)&&preventDefault(e)}},_initDebug:function(e){e.Debug=e.debug=this._debugCreater("debug"),e.Log=e.log=this._debugCreater("log"),e.Watch=e.watch=this._debugCreater("watch"),e.Trace=e.trace=this._traceCreater(e),e.onerror=doPageError},_initMainWinEvent:function(e){if(e!=getTop()&&e==getMainWin()){getTop().QMHistory.recordCurrentUrl(e),getTop().QMHistory.recordActionFrameChange("clear");var t=e.location.href,i=0<t.indexOf("t=sms_list_v2"),n=0<t.indexOf("t=bottle");addEvent(e,"unload",function(){showProcess(0),isshowMsg()&&getTop().gMsgDispTime&&2e3<now()-getTop().gMsgDispTime&&hiddenMsg(),i&&startWebpush(2)}),i&&closeWebpush(2),n&&closeWebpush(4),getTop().QMWebpushTip&&getTop().QMWebpushTip.hideAll(3e3),e.setTimeout(function(){},200)}},_initTopWinEvent:function(f){if(f==getTop()&&-1!=f.location.href.indexOf("/frame_html")){var e=function(){var e;if(getMainWin()!=f&&"noreload"!=getUserCookie("reloadurl")&&!getMainWin().gbIsNoCheck)try{var t=getMainWin().location;e=t.getParams().sid&&t.pathname+_trimUrlSearchParam(t.search)}catch(i){}setUserCookie("reloadurl",e||"",new Date(now()+5e3))};addEvents(f,{load:function(e){var t=getTop().document.body;function i(e){for(var t=e.srcElement||e.target,i=0;t&&i<3&&"A"!=t.tagName;t=t.parentNode,i++);return t||{}}function n(e){var u=i(e);if("A"==u.tagName){if("nocheck"==u.getAttribute("initlized"))return!0;if("true"!=u.getAttribute("initlized")){u.setAttribute("initlized","true");var g=u.onclick;u.onclick=function(e){var i=e||getTop().event,t=parseInt(u.getAttribute("md"));if(!isNaN(t)&&0<t){getTop().clearTimeout(t),u.setAttribute("md","0");var n=i.shiftKey,a=i.ctrlKey,o=i.metaKey,r=n||a||o||"_blank"==u.target,s=u.getAttribute("nocheck"),l=trim(u.href),d=!(""==l||0==l.indexOf("javascript:")),c=0==trim(u.href).indexOf("http");function p(){if(g&&(g.call(u),preventDefault(i)),c)if(n&&0!=u.href.indexOf("java"))open(u.href),preventDefault(i);else switch(u.target){case"mainFrame":var e=u.href;goUrlMainFrm(e+(-1!=e.indexOf("?")?"#stattime="+now():""),!1),preventDefault(i);break;case"_parent":case"_self":try{f.location.href=u.href}catch(t){}preventDefault(i)}}"false"==s||!r&&"true"!=s&&d&&"_blank"!=u.target?(preventDefault(i),QMPageInit._runFuncAfterCheckMainFrame(p)):p()}}}u.setAttribute("md",getTop().setTimeout(function(){u.setAttribute("md","0")},1e3))}}addEvents(t,{mousewheel:function a(e){(e.target||e.srcElement)==t&&preventDefault(e)},mousedown:n,keydown:n,click:function o(e){var t=i(e);"A"==t.tagName&&"true"!=t.getAttribute("initlized")&&preventDefault(e)}})},beforeunload:e,unload:e})}},_detectMouseT:function(e,t){var i,n=["u","1","2","3"],a=getEventTarget(t),o=function(e){if(e&&e.getAttribute){var t=e.getAttribute("t");for(var i in n)if(n[i]==t)return t}};i=o(a);try{for(;a&&a!=e.document.body&&i;){if("u"!=i)return a;i=o(a=a.parentNode)||i}}catch(r){}return null},_initPageMouse:function(t,i,e){var n=this._detectMouseT(i,e);if(n)switch(n.getAttribute("t")){case"1":case"2":case"3":waitFor(function(){return getTop().QMProfileTips},function(e){e&&getTop().QMProfileTips.doMouseEvent(t,i,n)})}},_initPageEventDelay:function(i){var n=this;i.setTimeout(function(){var t=0==(i.location.getParams&&i.location.getParams().t||"").indexOf("compose");addEvents(i.document,{mousedown:OprMouseDown,touchend:getTop().iPadCloseMenu||function(){},keydown:function(e){n._initPageKeyDown(e,t)},click:function(e){getTop().QMWebpushTip&&getTop().QMWebpushTip.hideAll(3e3),preventDefault2(e)},mouseover:function(e){n._initPageMouse("over",i,e)},mouseout:function(e){n._initPageMouse("out",i,e)}})},100)},_initlize:function(e){if(!(e=e||window).gIsInitPageEventProcess){e.gIsInitPageEventProcess=!0;var t=0;try{t=1,this._initDebug(e),t=2,this._initLocation(e),t=3,this._initMainWinEvent(e),t=4,this._initTopWinEvent(e),t=5,this._initPageEventDelay(e),getTop().gbIsMac&&e.document.documentElement&&(e.document.documentElement.className+=" MacOS")}catch(i){doPageError(i.message,e.location.href,"initPageEvent_processid:"+t)}try{e.document.execCommand("BackgroundImageCache",!1,!0)}catch(i){}}},_runFuncAfterCheckMainFrame:function(e){try{if(getMainWin().exitConfirm)return getMainWin().exitConfirm(e)}catch(t){debug(t.message)}e()}};function initPageEvent(e){QMPageInit._initlize(e)}function getTopWin(){return getTop()}function getMainWin(){return F("mainFrame",getTop())||getTop()}function getActionWin(){return F("actionFrame",getTopWin())}function getLeftWin(){return getTop()}initPageEvent(window);var GetLeftWin=getLeftWin;function getLeftDateWin(){return F("leftFrame",getTop())}function getSignatureWin(){return F("signatureFrame",getTop())}function getSignatureData(){return getTop().goUserInfo._oData}function reloadFrm(e){if(e)try{if(e.location.search){var t=e.location.href.split("#")[0].split("?"),i="r="+now();return t[1]=t[1]?(("&"+t[1]+"&").replace(/&r=.*?&/,"&")+i).slice(1):i,e.location.replace(t.join("?")),!0}}catch(n){}return!1}function reloadLeftWin(){var e;!reloadFrm(getLeftDateWin())&&(e=S("leftFrame",getTop()))&&(e.src=T("/cgi-bin/folderlist?sid=$sid$&r=$rand$").replace({sid:getSid(),rand:Math.random()}))}function reloadAllFrm(e,t,i,n){function a(e){var t=arguments.callee;getTop().setTimeout(e,t._time),t._time+=200}a._time=0,(null==n||n)&&a(function(){reloadFrm(getMainWin())}),(null==i||i)&&a(function(){reloadFrm(reloadLeftWin())})}function reloadFrmLeftMain(e,t){reloadAllFrm(!1,!1,e,t)}function _unReloadUrl(){setUserCookie("reloadurl","noreload",new Date(now()+5e3))}function goUrlTopWin(e,t){_unReloadUrl(),goUrl(getTop(),e,!t)}function goUrlMainFrm(e,t,i){0!=t?(reloadLeftWin(),setTimeout(function(){goUrl(S("mainFrame",getTop())||getTop(),e,!i)},300)):goUrl(S("mainFrame",getTop())||getTop(),e,!i)}function _trimUrlSearchParam(e){return e&&e.substr&&"?"+["&",e.substr(1),"&"].join("").replace(/&sid=.*?&/gi,"&").replace(/&loc=.*?&/gi,"&").replace(/&newwin=true/gi,"&").slice(1,-1)}function goNewWin(e,t,i,n){var a="",o="",r="";if("object"==typeof e)a=e.pathname,o=e.search;else{var s=e.indexOf("?");a=e.substring(0,s),o=e.substr(s)}r=n?n.frametmpl:i?"frame_html":"newwin_frame";var l="";-1<a.indexOf("reader_")&&(l=getTop().location.protocol+"//mail.qq.com"),getTop().gsDistributeDomain&&(l=getTop().location.protocol+"//exmail.qq.com");var d=T(l+"/cgi-bin/frame_html?t=$t$&sid=$sid$&url=$url$").replace({t:r,sid:getSid(),url:encodeURIComponent(a+_trimUrlSearchParam(o))});n&&(d+=n.frametmplparam),t?goUrlTopWin(d,!0):(_unReloadUrl(),window.open(d))}function isMaximizeMainFrame(){return getTop().maximizeMainFrame._bIsMaximizeMainFrame}function maximizeMainFrame(e){var t=S("mainFrame",getTop()),i=S("leftPanel",getTop()),n=S("imgLine",getTop());if(!t||!n||!i||2!=e&&0==e==!isMaximizeMainFrame())return!1;var a=getTop().maximizeMainFrame,o=a._bIsMaximizeMainFrame=2==e?!isMaximizeMainFrame():!!e;o&&(a._sBackupMarginLeft=i.style.width,a._sImgParentCssText=n.parentNode.style.cssText),t.parentNode.style.marginLeft=o?"5px":a._sBackupMarginLeft,i.parentNode.style.cssText=o?"border-left:none;":"",n.parentNode.style.cssText=(o?"border-left:none;margin-left:0;padding:0;":"")+a._sImgParentCssText,show(i,!o),show(n,!o),show(S("folder",getTop()),!o)}function filteSignatureTag(e,t){var i="string"==typeof e?e:"";return"2LOWCASE"==t?i.replace(/<sign(.*?)\/>/gi,"<sign$1>").replace(/<qzone(.*?)\/>/gi,"<qzone$1>").replace(/<taotao(.*?)\/>/gi,"<taotao$1>").replace(/<\/sign>/gi,"</sign>").replace(/<\/qzone>/gi,"</qzone>").replace(/<\/taotao>/gi,"</taotao>").replace(/<(\/?)includetail>/gi,"<$1tincludetail>"):"FILTE<:"==t?i.replace(/<:sign.*?>/gi,"").replace(/<:qzone.*?>/gi,"").replace(/<:taotao.*?>/gi,"").replace(/<:includetail.*?>/gi,""):i.replace(/<\/?sign.*?>/gi,"").replace(/<\/?qzone.*?>/gi,"").replace(/<\/?taotao.*?>/gi,"").replace(/<\/?includetail.*?>/gi,"")}function getSignatureHeader(){var e=!(!arguments[0]||1!=arguments[0]),t=getTop().getGlobalVarValue("DEF_FONT_FAMILY"),i=getTop().getGlobalVarValue("DEF_FONT_SIZE"),n=getTop().getGlobalVarValue("DEF_FONT_COLOR"),a="<FONT ";if(t&&(a=a+"face='"+t+"' "),i){a=a+"size='"+({"xx-small":1,"x-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6}[i]||i)+"' "}return n&&(a=a+"color='"+n+"' "),T(["<div>",a+="><br /></FONT>",a,a,a,'<div style="color:#909090;font-family:Arial Narrow;font-size:12px">',e?"":"------------------","</div>","</div>"])}function checkSignatureFrame(){if(getTop().gLoadSignTimeout&&(getTop().clearTimeout(getTop().gLoadSignTimeout),getTop().gLoadSignTimeout=null),getSignatureData()){getTop().gSignStatus="finish";var e=!0;try{getSignatureData().RealUserSignature||(e=!1)}catch(t){e=!1}e||null!=getTop().reloadSignTimeout?e&&directChangeSkin():getTop().gReloadSignTimeout=getTop().setTimeout("getTop().reloadSignature( true );",5e3)}}function loadSignature(){try{"ready"!=getTop().goUserInfo._sStatus&&getTop().goUserInfo.reset()}catch(e){return}}function reloadSignature(e){getTop().goUserInfo.reset()}function getSignature(e,t){try{return getSignatureData().getRealUserSignature(e,t)}catch(i){return loadSignature(),""}}function getDetaultStationery(e){return"ready"==getTop().goUserInfo._sStatus?"Header"==e?getSignatureData().RealUserDefaultStationeryHeader:getSignatureData().RealUserDefaultStationeryBottom:(loadSignature(),"")}function getDefaultEditor(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealDefaultEditor:(loadSignature(),undefined)}function getUserNick(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealUserNick:(loadSignature(),0)}function getDefaultSaveSendbox(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealDefaultSaveSendbox:(loadSignature(),0)}function getUserAlias(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealUserAlias:(loadSignature(),"")}function getDefalutAllMail(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealDefaultAllMail:(loadSignature(),[])}function getOpenSpellCheck(){return!0}function getDefaultSender(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealDefaulSender:(loadSignature(),"")}function setDefaultSender(e){var t=getTop().getGlobalVarValue("DEF_MAIL_FROM"),i=getTop().getGlobalVarValue("DOMAIN_MAIL_LOGO_URL");i&&i[t]&&(i[e]=i[t]),getTop().setGlobalVarValue("DEF_MAIL_FROM",e)}function getAllSignature(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealAllSignature:(loadSignature(),{})}function getUserSignatureId(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealUserSignatureId:(loadSignature(),"")}function getIsQQClub(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealIsQQClub:(loadSignature(),!1)}function getBindAccount(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealBindAccount:(loadSignature(),!1)}function getRecognizeNickName(){return"ready"==getTop().goUserInfo._sStatus?getSignatureData().RealRecognizeNickName:(loadSignature(),!1)}function closeRecognizeNickName(){ossLog("realtime","all","stat=tips&type=know&tipid=66"),setGlobalVarValue("DEF_RECOGNIZENICKNAME",!1)}function getUserInfoText(e){var t=S("user"+e,getTopWin())||{};return fixNonBreakSpace(t.innerText||t.textContent)}function getUserInfo(e){return(S("user"+e,getTopWin())||{}).innerHTML||""}function setUserInfo(e,t){try{return S("user"+e,getTopWin()).innerHTML=htmlEncode(t),!0}catch(i){return!1}}function msgBox(e,t,i,n,a,o){if(window!=getTop())return getTop().msgBox(e,t,i,n,a,o);var r=e;if(!r){var s=S("msg_txt",o||window)||S("msg_txt",getActionWin());s&&(s.innerText||s.textContent)&&"true"!=s.getAttribute("ok")&&(r=filteScript(s.innerHTML),s.setAttribute("ok","true"))}if(r&&(r=trim(r.replace(/[\r\n]/gi,""))))if(hiddenMsg(),"dialog"==t)alertBox({msg:r,title:a||"confirm"});else if("antiSpamRelease"==t){var l=g_useralias;if(!l)try{l=getTop().S("sendmailemail_val",getTop().getMainWin()).innerHTML}catch(d){l=""}/\.onwork\.com$/.test(l)||/\.onexmail\.com$/.test(l)?(alertBox({msg:"Today, you have reached the upper limit for sending out trial domain names. Please contact your administrator.",title:"prompt"}),(new Image).src="/qy_mng_logic/reportKV?type=AdminDomain&itemName=secondlevel|block|send"):((new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=antiSpamWx&item=dialogShow&sid="+getSid()+"&r="+Math.random(),confirmBox({msg:r,title:a||"system hint",confirmBtnTxt:"verification",onload:function(){var e=this.S("confirm"),t=this.S("cancel");addEvent(e,"click",function(e){getTop().showAntiSpamWxCheck(),(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=antiSpamWx&item=verifyCK&sid="+getSid()+"&r="+Math.random()}),addEvent(t,"click",function(e){(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=antiSpamWx&item=cancelCK&sid="+getSid()+"&r="+Math.random()})}}))}else setClass(arguments.callee.createMessageBox().firstChild,"success"==t?"msg":"errmsg").innerHTML=r,showMsg(),i&&(getTop().gMsgBoxTimer=getTop().setInterval(getTop().hiddenMsg,n||5e3)),getTop().gMsgDispTime=now()}function showAntiSpamWxCheck(){var n=arguments.callee;QMAjax.send("/cgi-bin/setting_wxbind?action=send_check&t=data_mgr&ef=js&sid="+getSid(),{method:"GET",onload:function(e,t){var i=evalValue(t);e&&i&&"0"==i.retcode?i.data&&n.qrcodeHandle(n,i.data.wx_ticket,i.data.binded,i.data.scan_code):showError("System failed, please try again later")}})}function isshowMsg(){return getTop().isShow("msgBoxDIV")}function hiddenMsg(){getTop().gMsgBoxTimer&&(getTop().clearInterval(getTop().gMsgBoxTimer),getTop().gMsgBoxTimer=null),getTop().show("msgBoxDIV",!1),getTop().showProcess(0)}function showMsg(){getTop().show("msgBoxDIV",!0)}function showError(e,t){msgBox(e,"",-1!=t,t||5e3)}function showInfo(e,t){msgBox(e,"success",-1!=t,t||5e3)}function showProcess(e,t,i,n,a){var o="load_process",r=arguments.callee._create(o);if(0==e)return show(r,!1);hiddenMsg(),show(r,!0);var s=2==e;if(s){n&&(S(o+"_plan_info",getTop()).innerHTML=n+":");var l=parseInt(i);l=isNaN(l)?0:Math.max(0,Math.min(100,l)),S(o+"_plan_rate",getTop()).innerHTML=S(o+"_plan_bar",getTop()).style.width=[l,"%"].join("")}else i&&(S(o+"_info",getTop()).innerHTML=i);show(S(o+"_plan",getTop()),s),show(S(o+"_img",getTop()),!s&&t),show(S(o+"_plan_info",getTop()),s),show(S(o+"_plan_rate",getTop()),s),show(S(o+"_info",getTop()),!s),show(S(o+"_cancel",getTop()),0!=a)}function getProcessInfo(){var e="load_process",t=getTop();if(isShow(S(e,t))){var i=S(e+"_plan_rate",t),n=S(e+"_info",t);if(n&&isShow(n))return n.innerHTML;if(i&&isShow(S(e+"_plan",t)))return parseInt(i.innerHTML)}return""}function replaceCss(e,t){replaceCssFile("skin",[getPath("style"),getFullResSuffix(["skin",void 0===t?getPath("skin"):t,".css"].join(""))].join(""),(e||window).document)}function _getLogoSrc(e,t){var i=getTop();return!t&&i.gLogoUrl?i.gLogoUrl.replace(/(.*)_[^_]+_([^_]+)/,"$1_"+e+"_$2"):TE(["$images_path$logo","$@$if($bFoxmail$)$@$","_foxmail/logo_biz_$nSkinId$_","$@$else$@$","$sSubfolder$logo_biz/logo_biz_$nSkinId$_","$@$endif$@$","$@$if($bFoxmail$)$@$","0","$@$else$@$","$sLogoid$","$@$endif$@$.png"]).replace({images_path:getPath("image"),bFoxmail:t,sSubfolder:i.gsLogoFolder,nSkinId:e,sLogoid:(i.gsLogoFolder||0==e)&&i.gLogoId||0})}function doRealChangeStyle(e,t,i,n,a){var o=getTop(),r=o.gTempSkinId=t,s=getMainWin(),l=[o,s],d=a||!1,c=S("imglogo",o);c&&(void 0===n||""==n?t<1e7&&(c.src=_getLogoSrc(r,i)):c.src=n,c.className=d?"domainmaillogo":""),E(o.goDialogList,function(e,t){l.push(F(t,getTop()))}),E(GelTags("iframe",s.document),function(e){l.push(e.contentWindow)}),E(l,function(e){replaceCss(e,r)}),removeSelf(e),setTimeout(resizeFolderList),rdVer("BaseVer",1)}function changeStyle(e,t){var i=!1,n=getTop().getGlobalVarValue("DOMAIN_MAIL_LOGO_URL")||{},a=getGlobalVarValue("DEF_MAIL_FROM")||"";t?(i=0<=t.indexOf("/cgi-bin/viewfile"))&&(n[a]=t,a&&setGlobalVarValue("DOMAIN_MAIL_LOGO_URL",n)):a&&n[a]&&(t=n[a],i=t&&0<=t.indexOf("/cgi-bin/viewfile")),getGlobalVarValue("IS_DEF_LOGO")!=undefined&&(i=!getGlobalVarValue("IS_DEF_LOGO")),getGlobalVarValue("LOGO_URL")==undefined||t||(t=getGlobalVarValue("LOGO_URL"));var o=void 0===e||""==e?getTop().skin_path:e,r=(getTop().gsLogoFolder||0==o)&&getTop().gLogoId||0,s="",l=getTop().changeStyle,d=l._sProcessId;(l._sProcessId=["skinCssCache",o,s,t||r].join("_"))!=d&&cacheByIframe([["css",getPath("style"),"skin"+o+".css"],t?["img","",t]:["img",_getLogoSrc(o,!1)]],{onload:function(){doRealChangeStyle(this,o,!1,t,i)}})}function osslogCompose(e,t,i,n,a){getTop().ossLog("delay","all",T(["stat=compose_send","&t=$time$&actionId=$actionId$&mailid=$mailid$","&isActivex=$isActivex$&failCode=$failCode$","&$other$"]).replace({time:e,actionId:t,mailId:i,failCode:n,other:["&cgitm=",getTop().g_cgiTimeStamp||-1,"&clitm=",getTop().g_clientTimeStamp||-1,"&comtm=",a&&a.valueOf?a.valueOf():-1].join("")}))}function recodeComposeStatus(e,t,i,n){var a=0,o=getTop().gSendTimeStart;if(o&&o.valueOf)a=now()-o.valueOf(),getTop().gSendTimeStart=null;else if(!n)return;osslogCompose(a,e,t,i,o),getTop().isUseActiveXCompose=!1}function errorProcess(e){"function"==typeof getMainWin().ErrorCallBack?getMainWin().ErrorCallBack(e):"function"==typeof getTop().ErrorCallBack&&getTop().ErrorCallBack(e)}function doPostFinishCheck(e,t,i){if(e){var n="",a=!1,o=S(e,t),r=F(e,t);try{if(!o||"true"==o.getAttribute("deleted"))return;var s=r.document.body;if(a=!s.className&&!s.style.cssText){var l=r.document.documentElement;n=(l.textContent||l.innerText||"").substr(0,30)}}catch(d){debug("doPostFinishCheck exception"),debug(d,2),a=d.message||"exception"}QMHistory.recordActionFrameChange(),a&&(callBack.call(o,i,[n]),1!=a&&(removeSelf(o),createBlankIframe(t,{id:e,onload:o._onload})),errorProcess())}}function actionFinishCheck(){doPostFinishCheck("actionFrame",getTop(),function(e){showError(gsMsgLinkErr)})}function doSendFinishCheck(){doPostFinishCheck("sendmailFrame",getTop(),function(e){recodeComposeStatus(2,null,e||0),msgBox(T(["Due to network reasons, mail delivery failed!",'[<a href="/cgi-bin/switch2service?sid=$sid$&errcode=-1&time=$time$&cginame=sendmail&t=error_report">Send error report</a>]']).replace({time:formatDate(new Date,"$YY$$MM$$DD$$hh$$mm$$ss$")}),"dialog",!0,0,"Failure information")})}function submitToActionFrm(e){try{return e.submit(),!0}catch(t){return showError(e.message),!1}}function afterAutoSave(e,t,i,n){var a,o,r=0;try{var s=getTop().getMainWin();function l(){disableAll&&disableAll(!1)}if(r=1,""==t||!t)return l();if(r=2,!s||!S("fmailid",s))return l();r=3,(o=S("fmailid",s).value)!=t&&(S("fmailid",s).value=t,getTop().setTimeout(function(){reloadLeftWin()},0)),r=4;for(var d=e.split(" |"),c=[],p=s.QMAttach.getExistList(),u=0,g=p.length;u<g;u++){var f=S("Uploader"+p[u],s);f&&!f.disabled&&""!=f.value&&c.push(f)}r=5;var m=c.length;for(u=0,g=d.length-1;u<g;u++){for(var h=!1,_=0;_<=u&&_<m;_++)if(!c[_].disabled&&-1!=c[_].value.indexOf(d[u])){h=c[_].disabled=!0;try{(gbIsIE||gbIsWebKit)&&(c[_].parentNode.childNodes[1].innerText=d[u])}catch(x){}}if(!h){var v=d[u]+" |",b=e.indexOf(v);-1!=b&&(e=e.substr(0,b)+e.substr(b+v.length,e.length-b-v.length))}}r=6,s.loadValue(),r=7,e&&S("fattachlist",s)&&(S("fattachlist",s).value+=e),r=8,r=9,showInfo(i||formatDate(new Date,"$hh$:$mm$")+" "+getTop().gsMsgSendErrorSaveOK),r=10;var y=getTop().QMDialog("composeExitAlert");r=10.1;var $=y&&y.S("btn_exit_notsave");if(r=10.2,$&&(r=10.3,$.isShow&&$.isShow()||$.disabled))return r=10.4,fireMouseEvent($,"click");r=11,n||l(),r=12,s.enableAutoSave()}catch(x){a=x.message,debug(["afterAutoSave:",x.message,"eid:",r])}ossLog("realtime","all",T(["stat=custom&type=AFTER_AUTO_SAVE&info=","$processid$,$errmsg$,$oldmailid$,$mailid$,$attachlist$"]).replace({processid:r,errmsg:encodeURIComponent(a||"ok"),oldmailid:encodeURIComponent(o),mailid:encodeURIComponent(t),attachlist:encodeURIComponent(e)}))}function cancelDoSend(){var e=getMainWin().QMAttach;if(e&&e.onfinish)e.onprogress=null,e.onfinish=null;else{var t=S("sendmailFrame",getTop());t&&(t.setAttribute("deleted","true"),removeSelf(t))}recodeComposeStatus(3,null,0),showProcess(0),errorProcess()}function quickDoSend(i,n,e){var a=!1;"nomsg"!=e&&showProcess(1,0,["<img src='",getPath("image"),"newicon/a_send.gif' width='14px' height='14px' align='absmiddle'>&nbsp;",e||gsMsgSend].join(""),null,!0),disableSendBtn(!0),disableSource(!0),createBlankIframe(getTop(),{id:"sendmailFrame",onload:function(e){if(a)doSendFinishCheck(this);else{a=!0;try{i.content.value=n,i.target="sendmailFrame",i.submit()}catch(t){showError("Failed to send:"+t.message),disableSendBtn(!1),disableSource(!1)}}}})}function disableSendBtn(e,t){disableCtl("sendbtn",e,t||getMainWin())}function disableSaveBtn(e,t){disableCtl("savebtn",e,t||getMainWin())}function disableTimeSendBtn(e,t){disableCtl("timeSendbtn",e,t||getMainWin())}function disableSource(e){disableCtl("source",e,getMainWin())}function disableAll(e,t){var i=t||getMainWin();if(i.disableAll&&i.disableAll!=arguments.callee)return i.disableAll(e);disableSendBtn(e,t),disableSaveBtn(e,t),disableTimeSendBtn(e,t);var n=getTop().QMDialog("composeExitAlert"),a=n&&n.S("btn_exit_save");a&&(a.disabled=e)}function verifyCode(e,t,i){if(window!=getTop())return getTop().verifyCode(_asSubTmpl);var n=arguments.callee._onok||i;setVerifyCallBack(),loadingBox({model:"Captcha",js:[getTop().getPath("js")+getTop().getFullResSuffix("qmverify.js")],oncheck:function(){return window.QMVerifyBox},onload:function(){QMVerifyBox.open({sType:e,sVerifyKey:t,onok:n})}})}function feedbackVfSubmit(){getTop().S("verifycode_cn",getMainWin()).value=arguments[0].verifycode||arguments[0].verifycode_cn,getTop().S("verifykey",getMainWin()).value=arguments[0].verifykey,getTop().SN("sendbtn",getMainWin())[0].disabled=!1,getTop().fireMouseEvent(getTop().SN("sendbtn",getMainWin())[0],"click"),getTop().SN("sendbtn",getMainWin())[0].disabled=!0}function openComposeDlg(e,t,i){getTop().QMAddress&&QMAddress.isInit()||loadJsFile(getPath("js")+getFullResSuffix("qmaddress.js"),!0,document,function(){QMAddress.initAddress()}),loadJsFileToTop(getPath("js"),[getFullResSuffix("qqmaileditor/editor.js")]),loadingBox({model:"Send a letter",js:[getTop().getPath("js")+getTop().getFullResSuffix("libcompose.js"),getTop().getPath("js")+getTop().getFullResSuffix("qmaddrinput.js")],oncheck:function(){return window.ComposeLib&&window.QMAddrInput&&window.QMEditor&&(!i||i())},onload:function(){ComposeLib.openDlg(e,t)}})}function setVerifyCallBack(e){getTop().verifyCode._onok=e}function emptyFolder(e){return confirm(e?"Are you sure you want to empty this folder?\n(Mail cannot be recovered after emptying)":"Are you sure you want to delete all messages in this folder?\n(Mail cannot be recovered after emptying)")}function renameFolder(i,n,a,e){return promptFolder({defaultValue:e||"",type:"rename"+(n||"folder"),onreturn:function(e){var t=S("frm",a);"tag"==n?(t.fun.value="renametag",t.tagname.value=e,t.tagid.value=i):(t.fun.value="rename",t.name.value=e,t.folderid.value=i),submitToActionFrm(t)}}),!1}function promptFolder(c){var p={shortcutgroup:{title:"New Contact Group",msg:"Please fill in the contact group name",name:"Contact grouping",maxascii:32,description:"When writing a letter, you only need to enter this group name (pinyin is required for Chinese characters), and you can send it in groups quickly."},folder:{title:"new folder",msg:"Please enter a folder name",name:"folder",height:200,maxascii:30},folderselect:{title:"new folder",msg:"Please enter a folder name",msgselect:"Choose the location of the new folder",name:"folder",height:420,maxascii:30,isSelect:1,selectedId:c.selectedId},tag:{title:"New label",msg:"Please enter the label name",name:"label",maxascii:50},renamefolder:{title:"Rename folder",msg:"Please enter a new name for the folder",name:"folder",maxascii:80,isRenameFolder:1},renametag:{title:"Rename label",msg:"Please enter a new label name",name:"label",maxascii:50}}[c.type];p.defaultValue=c.defaultValue,p.onreturn=function(e,t,i,n){if(e){var a=getAsiiStrLen(trim(t));if(0==a||a>p.maxascii)return n?(n.S("folder_needValid").innerHTML=TE(a?"The $name$ name is too long, please use less than $maxascii$ characters ($@$eval $maxascii$/2$@$The name of a Chinese character)":"$name$ name cannot be empty").replace(p),!1):showError(TE(a?"The $name$ name is too long, please use less than $maxascii$ characters ($@$eval $maxascii$/2$@$The name of a Chinese character)":"$name$ name cannot be empty").replace(p));if(/[~!#\$%\^&\*\(\)=\+|\\\[\]\{\};\':\",\?\/<>]/.test(t))return n?(n.S("folder_needValid").innerHTML=p.name+"The name cannot contain ~!#$%^&*()=+|[]{};':\",?/<>Equal character",!1):showError(p.name+"The name cannot contain ~!#$%^&*()=+|[]{};':\",?/<>Equal character");if(n){var o=new RegExp("folder_(\\d+)");try{for(var r=getTop().getMainWin().document.getElementsByTagName("tr"),s=0;s<r.length;s++)if(o.test(r[s].id)&&r[s].getAttribute("alias")==t)return!(n.S("folder_needValid").innerHTML="A folder with the same name already exists")}catch(d){}try{var l=n.getPanelDom().getElementsByTagName("li");for(s=0;s<l.length;s++)if(o.test(l[s].id)&&l[s].getAttribute("alias")==t)return!(n.S("folder_needValid").innerHTML="A folder with the same name already exists")}catch(d){}}return c.onreturn(t,i),!0}},promptBox(p)}function _setFolderCss(e,t,i,n){if(e){var a=S(e+"_td",t);if(a)return setClass(a,i),a;var o=S(e,t);if(o){var r="over"==n;return r&&showFolders(o.name,!0),setClass(S(e,t).parentNode,r?"fn_list":""),o}}}function switchFolderComm(e,i,t,n,a,o,r){var s=S(t,i),l=e;if(l?r._sCurFolderId=l:l=r._sCurFolderId,s){var d,c="SwiTchFoLdErComM_gLoBaldATa",p=i[c];if(p!=l&&_setFolderCss(p,i,o,"none"),d=_setFolderCss(i[c]=l,i,a,"over"))if(E("new|personal|pop|tag".split("|"),function(e){var t=S(e+"folders",i);t&&isObjContainTarget(t,d)&&showFolders(e,!0)}),"hidden"!=getStyle(s,"overflow"))scrollIntoMidView(d,s);else{var u=S("ScrollFolder",i);u&&isObjContainTarget(u,d)&&scrollIntoMidView(d,u)}}}function switchFolder(e,t,i){getTop().switchFolderComm(e,t||getLeftWin(),"folder","li","fn","fs",getTop().switchFolder),"mail_list"!==i&&("folder_1"==e?getTop().logKV("CommFunc","webmail|folderlist|inbox|click"):"folder_starred"==e?getTop().logKV("CommFunc","webmail|folderlist|starmail|click"):"folder_4"==e?getTop().logKV("CommFunc","webmail|folderlist|draft|click"):"folder_3"==e?getTop().logKV("CommFunc","webmail|folderlist|sent|click"):"folder_5"==e?getTop().logKV("CommFunc","webmail|folderlist|delete|click"):"folder_6"==e?getTop().logKV("CommFunc","webmail|folderlist|spam|click"):"folder_personal"==e||128<parseInt(e)?getTop().logKV("CommFunc","webmail|folderlist|personal|click"):"folder_pop"==e?getTop().logKV("CommFunc","webmail|folderlist|othermail|click"):"folder_note"==e?getTop().logKV("CommFunc","webmail|folderlist|note|click"):"folder_todo"==e?getTop().logKV("CommFunc","webmail|folderlist|todo|click"):"folder_reminder"==e?getTop().logKV("CommFunc","webmail|folderlist|calendar|click"):"folder_entdisk"==e?getTop().logKV("CommFunc","webmail|folderlist|entdisk|click"):"folder_ftn"==e&&getTop().logKV("CommFunc","webmail|folderlist|ftn|click"))}function switchRightFolder(e,t,i){getTop().switchFolderComm(e,t||F("rightFolderList",getMainWin()),i||"folder_new","div","toolbg","",getTop().switchRightFolder)}function isShowFolders(e,t){var i=S("icon_"+e,t||getTop());return!(!i||"fd_off"!=i.className)}function getFolderNodeById(e){for(var t=getTop().originUserFolders,i={},n=0;n<t.length;n++)if(t[n].id==e){i=t[n];break}return i}function showFolderTrace(e){var t=getTop(),i=t.getFolderNodeById(e),n=S("folder_"+e+"_td");if(n){t.switchFolder("folder_"+e);var a=n.getAttribute("level");if(null!=a){var o=[];for(a=+a;1!=a&&1<a;)o.push(i.fatherid),i=t.getFolderNodeById(i.fatherid),a--;for(var r=o.length-1;0<=r;r--)t.showFolders(o[r],!0)}}}function showFolders(n,e,t){var i=t||getTop(),a=S(n+"folders",i),o=S("icon_"+n,i);if(!a){var r=!isShowFolders(n,i);"boolean"==typeof e&&r!=e||setClass(o,r?"fd_off":"fd_on")}if(a&&o){r=!isShowFolders(n,i);if(isShowFolders(n,i)&&show(a,!0),"boolean"!=typeof e||r==e){if(setClass(o,r?"fd_off":"fd_on"),t)show(a,r);else{var s=getTop(),l="fOlDErsaNimaTion"+n,d=s[l];d||(d=s[l]=new s.qmAnimation({from:1,to:100})),d.stop(),r?(a.style.height="1px",show(a,!0)):a.style.height="auto";var c=a.scrollHeight;d.play({speed:c,onaction:function(e,t){S(n+"folders",s).style.height=(Math.floor((r?t:1-t)*c)||1)+"px"},oncomplete:function(e,t){var i=S(n+"folders",s);r?i.style.height="auto":show(i,!1)}})}callBack(getTop().iPadResizeFolder)}}}function decreaseFolderUnread(e,t,i){for(var n,a=e.split(";"),o=a.length-1;0<=o;o--)(n=_optFolderUnread(0,a[o]))&&_optFolderUnread(1,a[o],n-1,t,i)}function getFolderUnread(e){return _optFolderUnread(0,e)}function setFolderUnread(e,t,i,n){return _optFolderUnread(1,e,t||0,i,n)}function getGroupUnread(e){return _optFolderUnread(0,e,null,null,getMainWin())}function setGroupUnread(e,t,i){return _optFolderUnread(1,e,t||0,i,getMainWin())}function setTagUnread(e,t,i,n){return _optFolderUnread(1,e,t||0,i,n,!0)}function _optFolderUnread(e,t,i,n,a,o){var r=S(["folder_",new String(t).toString().split("folder_").pop()].join(""),a||getLeftWin());if(!r)return 0;if(-1!=t.indexOf("tag")||-1!=t.indexOf("starred")||-1!=t.indexOf("bsm"))return 0;var s=r.getAttribute("etitle"),l=GelTags("div",r),d=r.name;l.length&&(r=l[0]);var c="number"==typeof i&&0<i?i:0,p=r.innerText||r.textContent||"",u=p.lastIndexOf("("),g=-1==u?0:parseInt(p.substring(u+1,p.lastIndexOf(")")));if(0==e)return g;if(g==c)return 1;var f=0==c,m={info:htmlEncode(-1!=u?p.substring(0,u):p),title:s,unread:c};if(r.title=T("$title$"+(n||f?"":" $unread$ unread email(s)")).replace(m),(r=setHTML(r,T(f?"$info$":n?"$info$($unread$)":"<b>$info$</b><b>($unread$)</b>").replace(m)+("Star Mail"==m.info?'<input type="button" class="ico_input icon_folderlist_star"/>':"")+("drifting bottle"==m.info?'<input class="ico_input drifticon" type="button" hidefocus />':""))).setAttribute("initlized",""),d&&!o){var h=S("folder_"+d,getTop());if(h){try{_optFolderUnread(e,t,c,n,getMainWin())}catch(_){doPageError(_.message,"all.js","_optFolderUnread")}return setFolderUnread(h.id,getFolderUnread(h.id)-g+c)}}return 1}function doFolderEmpty(e,t,i){t.folderid.value=e,t.rk.value=Math.random(),t.loc&&(t.loc.value=i),submitToActionFrm(t)}function selectAll(t,e){E(GelTags("input",S("list",e||getTop().getMainWin().document)),function(e){e.checked=t})}function selectReadMail(t,e){E(GelTags("input",S("list",e)),function(e){"Select/Unselect"!=e.title&&(e.checked=e.getAttribute("unread")!=t)})}function checkAddrSelected(e){for(var t,i=GelTags("input",S("list",e||getTop().getMainWin())),n=i.length,a=0;a<n;a++)if("checkbox"==(t=i[a]).type&&t.checked)return!0;return!1}function checkBoxCount(t){var i=0;return E(GelTags("INPUT"),function(e){"checkbox"==e.type&&e.name==t&&e.checked&&i++}),i}function PGV(){}function checkCheckBoxs(e,t){for(var i,n=GelTags("input",t||S("frm",getMainWin())),a=0,o=n.length;a<o;a++)if("checkbox"==(i=n[a]).type&&i.name==e&&i.checked)return!0;return!1}function setListCheck(e,t){if("checkbox"==e.type){null==t?t=e.checked:e.checked=t;var i=e.parentNode.parentNode;if("TR"==i.tagName&&(i=i.parentNode.parentNode),i!=S("frm",getMainWin())){var n=i.className;setClass(i,n="B"==n?t?"B":"":strReplace(n," B","")+(t?" B":"")),t&&listMouseOut.call(i)}}}function doCheck(e,t,i,n){var a=e||window.event,o=t||a.srcElement||a.target,r=n||getMainWin();if(o&&r){if("one"!=o.className&&"all"!=o.className||CA(o),setListCheck(o),(a&&a.shiftKey||i)&&r.gCurSelObj&&r.gCurSelObj!=o&&o.checked==r.gCurSelObj.checked)for(var s,l=getTop().GelTags("input",r.document),d=0,c=l.length,p=0;p<c;p++)if("checkbox"==(s=l[p]).type){if((s==r.gCurSelObj||s==o)&&1==d++)break;1==d&&setListCheck(s,o.checked)}r.gCurSelObj=o}}function checkAll(t,e){E(GelTags("input",e||getTop().getMainWin().document),function(e){e.name==t&&setListCheck(e)})}function fakeReadmail(o){QMAjax.send(T("/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&t=readsubmail&mode=fake&base=$base$&pf=$pf$&xx=kk").replace({sid:getSid(),mailid:o.sMailId,pf:rdVer.isPre(o.sFolderId)?1:0,base:rdVer("BaseVer",0)}),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t){var i=trim2(t);if(e&&0==i.indexOf("(")){var n=evalValue(i);n&&(folderOpt(extend(o,n)),callBack(getMainWin().updatePreAndNext,[o]))}else{var a=getActionWin().document;a.open(),a.write(_aoXml.responseText)}}})}function folderOpt(e){if(e){var t=getTop();if(t.recordCompareReadedMailId(e.sMailId),e.bNewMail){var i=e.sFolderId;if(0<i)try{t.setFolderUnread(i,t.getFolderUnread(i)-1),e.bStar&&t.setFolderUnread("starred",t.getFolderUnread("starred")-1),e.bBsm&&t.setFolderUnread("bsm",t.getFolderUnread("bsm")-1);var n=e.oMatchTag||[],a=n.length-1;for(0<=a&&setTagUnread("tag",getFolderUnread("tag")-1);0<=a;a--){var o="tag_"+n[a];debug(["getFolderUnread",o,getFolderUnread(o)]),setTagUnread(o,getFolderUnread(o)-1)}}catch(r){}}}}function recordReadedMailId(e){getTop().gsReadedMailId=e}function recordCompareReadedMailId(e){e&&getTop().gsReadedMailId!=e&&(getTop().gsReadedMailId=e),QMMailCache.addData(e)}function SG(e,t){var i=e.className,n=!/\bsts\b/i.test(i),a=GelTags("input",e.parentNode)[0],o=a&&a.className,r=(t?e.parentNode.parentNode.parentNode:e.parentNode).nextSibling;if("one"!=o&&"all"!=o||setClass(a,n?"one":"all"),setClass(e,n?i.replace(/\bhts\b/i,"sts"):i.replace(/\bsts\b/i,"hts")),"toarea"!=r.className&&(r=r.nextSibling),"toarea"==r.className)return show(r,n)}function CA(e){if(e){var t=("all"==e.className?e.parentNode.parentNode.parentNode.parentNode:e.parentNode).nextSibling;if("toarea"!=t.className&&(t=t.nextSibling),"toarea"==t.className){var i=e.checked;E(GelTags("input",t),function(e){setListCheck(e,i)})}}}function RD(e,t,i,n,a,o,r,s,l,d){var c=getTop();if(c.S("qmdialog_container")&&""!=c.S("qmdialog_container").innerHTML&&c.S("qqmail_mask")&&"none"!=c.S("qqmail_mask").style.display&&(c.S("qmdialog_container").innerHTML="",c.S("qqmail_mask").style.display="none"),recordReadedMailId(t),e){preventDefault(e);var p=e.srcElement||e.target,u=p&&p.getAttribute("fid");if(u)return goUrlMainFrm(T("/cgi-bin/$cgi$?sid=$sid$&folderid=$fid$&page=0&t=$t$").replace({cgi:"9"==u?"readtemplate":"mail_list",fid:u,sid:getSid(),t:"9"==u?"sms_list_v2":""}),!1),stopPropagation(e)}var g=rdVer.url(t,a,l,n,getTop().bnewwin||e&&e.shiftKey,o,r,s);if("0"==d?g+="&show_ww_icon=false":"1"==d&&(g+="&show_ww_icon=true"),rdVer.log(t,"hit"),e&&(e.shiftKey||e.ctrlKey)){for(var f=e.target||e.srcElement;f&&"i M"!=f.className&&"i F"!=f.className;)f=f.parentNode;f&&QMReadedItem.disp(f),e.shiftKey&&goNewWin(g),e.ctrlKey&&window.open(g)}else goUrlMainFrm([g,"#stattime=",now()].join(""),!1)}function checkPerDelML(e,t,i){return delMailML(e,t,"PerDel",i)}function delMailML(e,t,i,n){var a=9==n.nodeType?n.defaultView||n.parentWindow:n,o=QMMailList.getCBInfo(a);configPreRmMail(o,"rmMail"),rmMail("PerDel"==i?1:0,o),"PerDel"!=i&&maillistCheckGrpSendSkipSelf(o)}function maillistCheckGrpSendSkipSelf(e){if("1"==e.sFid&&1==e.oMail.length){var t=e.oMail[0],i=t.oChk.getAttribute("fa"),n=t.oChk.getAttribute("sh").split(",");checkGrpSendSkipSelf(i,n)}}function reportSpamML(e,t){var i=9==t.nodeType?t.defaultView||t.parentWindow:t,n=QMMailList.getCBInfo(i);return configPreRmMail(n,"spammail"),(e?reportSpamJson:reportNoSpamJson)({bBlackList:!0},n),!1}window.g_sBaseImageUrl=getTop().getPath("stationery"),getTop().goUserInfo||(getTop().goUserInfo={_sStatus:"init",_fCallbacks:{},_oData:{},_doCallback:function(){for(var e in getTop().goUserInfo._fCallbacks)for(var t=0,i=getTop().goUserInfo._fCallbacks[e].length;t<i;t++)try{getTop().goUserInfo._fCallbacks[e][t](getTop().goUserInfo.get(e))}catch(n){}getTop().goUserInfo._fCallbacks={}},get:function(e){return"init"==getTop().goUserInfo._sStatus?(getTop().goUserInfo.reset(),""):"undefined"==typeof getTop().goUserInfo._oData[e]?"":getTop().goUserInfo._oData[e]},deferget:function(e,t){"init"==getTop().goUserInfo._sStatus?("undefined"==typeof getTop().goUserInfo._fCallbacks[e]&&(getTop().goUserInfo._fCallbacks[e]=[]),getTop().goUserInfo._fCallbacks[e].push(t),getTop().goUserInfo.reset()):t(getTop().goUserInfo._oData[e])},set:function(e){extend(getTop().goUserInfo._oData,e)},reset:function(){if("loading"!=getTop().goUserInfo._sStatus){getTop().goUserInfo._sStatus="loading";var e=T(["/cgi-bin/getcomposedata?t=signature&fun=compose&sid=$sid$&qzonesign=$qzonesign$&r=$rand$"]).replace({sid:getSid(),qzonesign:"",rand:now()});QMAjax.send(e,{method:"GET",timeout:1e4,headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t){var i=trim2(t);e&&0==i.indexOf("(")?(getTop().goUserInfo._sStatus="ready",getTop().goUserInfo.set(new Function("return "+i)()),directChangeSkin()):getTop().goUserInfo._sStatus="init",getTop().goUserInfo._doCallback()}})}}}),msgBox.createMessageBox=function(e){var t=S("msgBoxDIV",getTop());if(!t){var i=void 0===e?getTop().bnewwin?0:43:e;insertHTML(getTop().document.body,"afterBegin",T(['<div id="msgBoxDIV" style="position:absolute;width:100%;display:none;','padding-top:2px;height:24px;*height:24px;_height:20px;top:$top$px;text-align:center;">',"<span></span>","</div>"]).replace({top:i})),t=S("msgBoxDIV",getTop())}return t},showAntiSpamWxCheck.getWxticket=function(n,a){QMAjax.send("/cgi-bin/setting_wxbind?action=send_check&t=data_mgr&ef=js&sid="+getSid(),{method:"GET",onload:function(e,t){var i=evalValue(t);e&&i&&"0"==i.retcode&&i.data&&(n.S("wx_qrcode").src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i.data.wx_ticket,n.S("scan_code").value=i.data.scan_code,"function"==typeof a&&a())}})},showAntiSpamWxCheck.qrcodeHandle=function(o,e,t,r){var s=!0,l=0,d=!1,c=new QMDialog({sid:"antiSpamWxCheckDlg",sTitle:"WeChat verification",sBodyHtml:T(['<div style="padding: 30px 20px;font-size: 14px;">','<div style="font-size:15px;margin-bottom: 20px;">',"Please use WeChat scan code verification to complete this sending","</div>",'<input type="hidden" value id="scan_code">','<div id="qr_con" width="260" height="260" style="padding-bottom: 20px;">','<img id="wx_qrcode" style="box-shadow: 0 1px 6px #333;" width="200" height="200" src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=$wxticket$">',"</div>","<div>Please use WeChat  scan  to scan the QR code","</div>","</div>"].join("")).replace({wxticket:e}),nHeight:"auto",nWidth:500,onload:function(){var n=this;setTimeout(function a(){s&&(d=150<=++l,getTop(),QMAjax.send("/cgi-bin/setting_wxbind?action=poll_send&is_bind="+t+"&ef=js&t=data_mgr&sid="+getSid()+("1"==t?"&scan_code="+r:"")+"&r="+Math.random(),{method:"GET",onload:function(e,t){var i=evalValue(t);e&&"1"==i.data.send_check?(s=!1,c.close(),(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=antiSpamWx&item=wxScan&sid="+getSid()+"&r="+Math.random(),o.showWxCheckResult()):e&&"0"==i.data.send_check?(showError("Please use the WeChat scan code bound to the email account"),o.getWxticket(n,function(){l=0,r=n.S("scan_code").value,setTimeout(a,2e3)})):d?o.getWxticket(n,function(){l=0,r=n.S("scan_code").value,setTimeout(a,2e3)}):setTimeout(a,2e3)}}))},2e3)},onclose:function(){s=!1,c=null}})},showAntiSpamWxCheck.showWxCheckResult=function(){alertBox({msg:"WeChat verification is successful, please click  OK  to continue to send this letter",title:"OK",icon:"icon_finish_b",onload:function(){addEvent(this.S("confirm"),"click",function(e){getMainWin().doVerifySubmit()})}})},showProcess.createProcessBox=function(e){var t="load_process",i=S(t,getTop());return i?isNaN(e)||(i.style.top=e+"px"):(insertHTML(Scale.getContainer(),"afterBegin",T(['<table id="$id$" cellspacing=0 cellpadding=0 border=0 ','style="position:absolute;top:$top$px;left:0;width:100%;display:none;z-index:9999;">','<tr><td align="center">','<table id="$id$_pos" cellspacing=0 cellpadding=0 border=0 class="autosave autosave_txt" style="height:20px;"><tr>','<td style="width:2px;"></td>','<td id="$id$_img" style="padding:0 0 0 5px;">','<img src="$image_path$ico_loading.gif" style="width:16px;height:16px;vertical-align:middle;">',"</td>",'<td id="$id$_plan" valign=center style="padding:0 0 0 5px;">','<div style="font:1px;border:1px solid white;width:104px;text-align:left;">','<div id="$id$_plan_bar" style="font:1px;background:#fff;height:8px;margin:1px 0;width:50%;"></div>',"</div>","</td>",'<td id="$id$_plan_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_plan_rate" style="width:40px;text-align:right;padding:0;"></td>','<td id="$id$_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_cancel" style="padding:0 0 0 5px;">','[<a onclick="getTop().cancelDoSend();" nocheck="true" style="color:white;">cancel</a>]',"</td>",'<td style="padding:0 0 0 5px;"></td>','<td style="width:2px;"></td>',"</tr></table>","</td></tr>","</table>"]).replace({id:t,top:isNaN(e)?getTop().bnewwin?0:45:e,image_path:getPath("image",!0)})),i=S(t,getTop())),i},showProcess._create=function(e){var t=S(e,getTop());return t||(insertHTML(getTop().document.body,"afterBegin",T(['<table id="$id$" cellspacing=0 cellpadding=0 border=0 ','style="position:absolute;top:$top$px;left:0;width:100%;display:none;z-index:9999;">','<tr><td align="center">','<table cellspacing=0 cellpadding=0 border=0 class="autosave autosave_txt" style="height:20px;"><tr>','<td style="width:2px;"></td>','<td id="$id$_img" style="padding:0 0 0 5px;">','<img src="$image_path$ico_loading.gif" style="width:16px;height:16px;vertical-align:middle;">',"</td>",'<td id="$id$_plan" valign=center style="padding:0 0 0 5px;">','<div style="font:1px;border:1px solid white;width:104px;text-align:left;">','<div id="$id$_plan_bar" style="font:1px;background:#fff;height:8px;margin:1px 0;width:50%;"></div>',"</div>","</td>",'<td id="$id$_plan_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_plan_rate" style="width:40px;text-align:right;padding:0;"></td>','<td id="$id$_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_cancel" style="padding:0 0 0 5px;">','[<a onclick="getTop().cancelDoSend();" nocheck="true" style="color:white;">cancel</a>]',"</td>",'<td style="padding:0 0 0 5px;"></td>','<td style="width:2px;"></td>',"</tr></table>","</td></tr>","</table>"]).replace({id:e,top:getTop().bnewwin?0:45,image_path:getPath("image",!0)})),t=S(e,getTop())),t};var QMReadedItem={};function listMouseOver(e){var t=this;if(-1==t.className.indexOf(" B")&&"#f3f3f3"!=getStyle(t,"backgroundColor")&&"none"!=t.getAttribute("colorchange")&&(t.style.backgroundColor="#f3f3f3"),e){for(var i=getEventTarget(e);i&&i!=t&&"tagbgSpan"!=i.className;)i=i.parentNode;i&&i!=t&&QMTag.showTagClose(i,1)}}function listMouseOut(e){var t=this;if(e&&isObjContainTarget(t,e.relatedTarget||e.toElement)||!t.style.backgroundColor||"none"==t.getAttribute("colorchange")||(t.style.backgroundColor=""),e){for(var i=getEventTarget(e);i&&i!=t&&"tagbgSpan"!=i.className;)i=i.parentNode;i&&i!=t&&QMTag.showTagClose(i,0)}}function listMouseEvent(t){addEvents(t,{contextmenu:function(e){listContextMenu.call(t,e)},mouseover:function(e){listMouseOver.call(t,e)},mouseout:function(e){listMouseOut.call(t,e)}})}function listContextMenu(e){mailRightMenu(this,e),preventDefault(e)}function GetListMouseClick(t,i){return function(e){ListMouseClick(e,t||window,i)}}function ListMouseClick(_aoEvent,_aoWin,_asFolderId){var _oTargetObj,_oEvent=_aoEvent||_aoWin.event;if(_oTargetObj=getEventTarget(_oEvent)){var _nFoldId=parseInt(_asFolderId);if("mailid"==_oTargetObj.name||201012<_nFoldId&&_nFoldId<205012)return getGlobalVarValue("TIP_46")||requestShowTip("gotnomail",46,_aoWin,function(e,t){return setGlobalVarValue("TIP_46",1),!0}),doCheck(_oEvent);if(0==_oTargetObj.className.indexOf("cir")){var _sFuncCode=GelTags("table",_oTargetObj.parentNode.parentNode)[0].parentNode.onclick.toString().split("{")[1].split("}")[0].replace(/event/gi,"{shiftKey:true}");return/\WRD/.test(_sFuncCode)||(_sFuncCode=GelTags("table",_oTargetObj.parentNode.parentNode)[0].parentNode.onclick.toString().replace(/.*{/g,"").replace(/}.*/g,"").replace(/event/gi,"{shiftKey:true}")),eval(_sFuncCode)}}}function listInitForComm(e,t){var i,n,a,o=GelTags("div"),r=doCheck;i=e||"M";for(var s=o.length-1;0<=s;s--)(n=o[s]).className==i&&("ft"==e&&(n=GelTags("table",n)[0]),(a=GelTags("input",n)[0])&&"checkbox"==a.type&&(a.title="Hold down shift and click on different check boxes to make multiple selections convenient and quick.",addEvent(a,"click",r),t||listMouseEvent(n)))}function modifyFolder(e,t){return getMainWin().location.href=T(["/cgi-bin/foldermgr?sid=$sid$&fun=detailpop&t=pop_detail","&folderid=$folderid$&acctid=$acctid$"]).replace({sid:getSid(),folderid:e,acctid:t}),!1}function recvPopHidden(n){getMainWin().setTimeout(function(){if(n){var e="iframeRecvPopHidden";createBlankIframe(getMainWin(),{id:e});var t=["/cgi-bin/mail_list?sid=",getSid(),"&folderid=",n,"&t=recv_pop_hidden"].join("");try{F(e,getMainWin()).location.replace(t)}catch(i){S(e,getMainWin()).src=t}}else getTop().reloadFrmLeftMain(!1,!0)},1e4)}function recvPop(e,t,i){recvPopCreat(e,t),S("tips",i)&&(S("tips",i).innerHTML=T(['<img src="$images_path$ico_loading3.gif" align=absmiddle>',"Collecting. &nbsp; System will automatically collect it in the background. You can leave this page and come back later to check the result."]).replace({images_path:getPath("image",!0)})),recvPopHidden(t)}function recvPopCreat(e){getActionWin().location=["/cgi-bin/foldermgr?sid=",getSid(),"&fun=recvpop&acctid=",e].join("")}function recvPopAll(){getActionWin().location=["/cgi-bin/foldermgr?sid=",getSid(),"&fun=recvpopall"].join("");try{setTimeout(function(){reloadFrmLeftMain(!1,!0)},3e3)}catch(e){}return!1}function setPopFlag(e,t,i){"recent"==t&&setPopRecentFlag(e,i)}function setPopRecentFlag(e,t){runUrlWithSid(["/cgi-bin/foldermgr?sid=",getSid(),"&fun=pop_setting&acctid=",e,"&recentflag=",t].join(""))}function checkPopMailShow(e){for(var t=["@yahoo.com.cn","@sina.com","@tom.com","@gmail.com"],i=e.toLowerCase(),n=0;n<t.length;n++)if(0<=i.indexOf(t[n]))return!0;return!1}function setBeforeUnloadCheck(l,d,e,t,c){var p=["input","select","textarea"];l=l||window,c=c?"string"==typeof c?S(c,l):c:l.document,l.gbIsBeforeUnloadCheck=!0,E(p,function(e){var i=l[e+"_save"]=[];E(GelTags(e,c),function(e,t){i.push(e.value+e.checked),e.setAttribute("saveid",t)})}),l.onsetbeforeunloadcheck||(l.onsetbeforeunloadcheck=function(){if(l.gbIsBeforeUnloadCheck)for(var e=0,t=p.length;e<t;e++)for(var i=p[e],n=i+"_save",a=GelTags(i,c),o=0,r=a.length;o<r;o++){var s=a[o].getAttribute("saveid");if(null!=s&&"true"!=a[o].getAttribute("nocheck")&&l[n][s]!=a[o].value+a[o].checked)return d||"The settings you modified have not been saved. Are you sure you want to leave?"}},gbIsIE?l.document.body.onbeforeunload=l.onsetbeforeunloadcheck:l.document.body.setAttribute("onbeforeunload","return onsetbeforeunloadcheck();")),E(t||["cancel"],function(e){addEvent("string"==typeof e?S(e,l):e,"mousedown",function(){l.gbIsBeforeUnloadCheck=!1})}),E(GelTags("form",l.document),function(e){addEvent(e,"submit",function(){l.gbIsBeforeUnloadCheck=!1}),e._submit||(e._submit=e.submit,e.submit=function(){l.gbIsBeforeUnloadCheck=!1,this._submit()})})}function popErrProcess(e,t,i,n,a,o){null!=e&&msgBox(e,t,i,n),null!=o&&getMainWin().ShowPopErr(o,a),showSubmitBtn()}function showSubmitBtn(){var e=S("submitbtn",getMainWin());e&&(e.disabled=!1)}function showPopSvr(){show(S("popsvrTR",getMainWin()),!0)}function setTaskId(e){try{getMainWin().document.checkFrom.taskid.value=e}catch(t){}}function showQuickReply(e){show(S("quickreply",getMainWin()),e),show(S("upreply",getMainWin()),!e),runUrlWithSid("/cgi-bin/getcomposedata?Fun=setshowquickreply&isShowQuickReply="+(e?0:1))}function hiddenReceipt(e){show(S("receiptDiv",e),!1)}function switchOption(e){var t=[["<input type='button' class='qm_ico_quickup' title='hide' />",!0],["<input type='button' class='qm_ico_quickdown' title='Show more actions' />",!1]]["none"==S("trOption",e).style.display?0:1];S("aSwitchOption",e).innerHTML=t[0],show(S("trOption",e),t[1])}function checkPerDel(e){delMail("PerDel",e)}function delMail(e,t){rmMail("PerDel"==e?1:0,t.QMReadMail.getCBInfo(t))}function setMailType(e,t,i,n){var a=S("mail_frm",n);a.s.value=["readmail_",t?i?"group":e:"not"+e,getMainWin().newwinflag?"_newwin":""].join(""),a.action="/cgi-bin/mail_mgr?sid="+getSid(),a.mailaction.value="mail_spam",a.isspam.value=t,a.reporttype.value="cheat"==e?"1":"",submitToActionFrm(a)}function getAddrSub(e){var t=e.indexOf("@");if(-1<t){var i=e.substr(0,t),n=e.substr(t);return subAsiiStr(i,18,"...")+subAsiiStr(n,18,"...")}return debug("name+dom"+e),subAsiiStr(e,36,"...")}function getRefuseText(e){var t,i=T(['<input type="checkbox" name="$TNAME$" id="$TID$" $TCHECK$>will<label for="$TID$">$TVALUE$</label>add to blacklist']),n="",a="";for(t in e){var o,r="refuse";0<t&&(r="refuse"+t,a="<br>"),o="Sender"!=e[t]?"&lt;"+getAddrSub(e[t])+"&gt;":e[t];debug("ITEM: "+e[t]),n+=a+i.replace({TNAME:r,TID:r,TVALUE:o,TCHECK:""})}return debug("RET Text"+n),n}function reportSpam(e,t,i,n,a){var o=i||(window==getTopWin()?getMainWin():window);if(!S("mail_frm",o)){var r,s=QMMailList.getCBInfo(o),l=0,d=s.oMail.length,c={};if(0==d)return showError(gsMsgNoMail),!1;for(var p=0;p<d;p++)(r=s.oMail[p]).bSys,l+=r.bDft?1:0,-1!=r.sSEmail.indexOf("@groupmail.qq.com")?e=!0:-1!=r.sSEmail.indexOf("10000@qq.com")&&(e=!0),"undefined"==typeof c.sender?(c.sender=r.sSEmail,c.nickname=r.sSName):c.sender!=r.sSEmail&&(c.sender="");if(l==d)n=1;else{for(p=0;p<d;p++)r=s.oMail[p];s=QMMailList.getCBInfo(o),QMMailList.selectedUI(s)}}c?debug("Has nick and sender "+c.sender):debug("No nick and sender");var u=new Array;u[0]="Sender",c&&c.sender&&c.sender.indexOf(",")<0&&(u[0]=c.sender);var g=0;a&&(0<a[0].length&&(u[g++]=a[0]),a[1]&&(u[g++]=a[1]));var f=T(["<div>",'<input type="radio" name="reporttype" id="r$value$" value="$value$" $checked$>','<label for="r$value$">$content$</label>',"</div>"]),m=(1!==n?["<div style='padding:10px 10px 0 25px;text-align:left;'>","<form id='frm_spamtype'>","<div style='margin:3px 0 3px 3px'><b>Please select the type of garbage to report:</b></div>",f.replace({value:t?11:8,checked:"checked",content:"Other mail"}),f.replace({value:t?10:4,checked:"",content:"advertisement mail"}),f.replace({value:t?9:1,checked:"",content:"Fraud email"}),'<div style="padding:5px 0 2px 0;">',e?"&nbsp;":getRefuseText(u),"</div><div style='margin:10px 3px 0px 3px' class='addrtitle' >Tips: We will give priority to the use of accurate classified report emails.</div>","</form>","</div><div style='padding:3px 15px 12px 10px;text-align:right;'>","</div>"]:["<div class='cnfx_content'>","<img style='float:left; margin:5px 10px 0;' src='",getPath("image"),"ico_question.gif' />","<div class='b_size' style='padding:10px 10px 0 0;margin-left:65px;line-height:1.5;height:80px;text-align:left;'>","<form id='frm_spamtype'>","<strong>Do you want to report this drift bottle?</strong><br>",'<div style="display:none">',f.replace({value:8,checked:"checked",content:""}),"</div>","After reporting, you will no longer receive a response from this drift bottle.","</form>","</div></div><div class='cnfx_btn'>","</div>"]).join(""),h=['<a class="btn_blue" id="btn_ok" href="javascript:;">OK</a>','<a class="btn_gray" id="btn_cancel" href="javascript:;">cancel</a>'].join("");return new(getTop().QMDialog)({sId:"reportSpam",sTitle:1===n?"Smash this bottle":"Report and reject selected messages",sBodyHtml:m,sFootHtml:h,nWidth:450,nHeight:1===n?150:220,onload:function(){var s=this;addEvent(s.S("btn_ok"),"click",function(){var e=S("mail_frm",getMainWin())||S("frm",getMainWin());if(e){e.s.value="readmail_spam",e.isspam.value="true",e.mailaction.value="mail_spam",e.action="/cgi-bin/mail_mgr?sid="+getTop().getSid();for(var t=s.S("frm_spamtype").reporttype,i=s.S("frm_spamtype").refuse,n=s.S("frm_spamtype").refuse1,a=0,o=t.length;a<o;a++)if(t[a].checked){e.reporttype.value=t[a].value;break}var r=new Array;r[0]="0",r[1]="0",(i&&i.checked||n&&n.checked)&&(e.s.value="readmail_reject"),n?(debug("Pro refuse OK* "+i.checked+" - "+n.checked),i&&i.checked?(debug("what1? ---- "),r[0]="1",debug("SRe"+r[0])):(debug("what2? "),r[0]="0"),debug("sreject1 "+r[0]+r[1]),n.checked?r[1]="1":r[1]="0",debug("sreject2 "+r[0]+r[1])):(r[0]="1",r[1]="1"),e.s_reject_what&&(e.s_reject_what.value=r[0]+r[1],debug("Reject method "+e.s_reject_what.value)),submitToActionFrm(e),s.close()}}),addEvent(s.S("btn_cancel"),"click",function(){s.close()})},onshow:function(){this.S("btn_cancel").focus()}}),!1}function setSpamMail(e,t,i){var n=i||(window==getTopWin()?getMainWin():window);if(e&&!t)return reportSpam(null,null,n);setMailType("spam",e,t,n)}function setCheatMail(e,t){setMailType("cheat",e,t)}function doReject(e,t,i,n){var a="This email address";n&&(a="<"+n+">");var o=S("mail_frm",i);o.s_reject_what&&(o.s_reject_what.value="10"),confirm("The system will"+a+"Put in the  blacklist , you will no longer receive mail from this address.\n\nAre you sure you want to reject messages from this sender?")&&setMailType("reject",e,t,i)}function setFolderReaded(i,n,e){if((n?getGroupUnread(n):getFolderUnread(i))<1)return showError("There are no unread messages in the folder");var a=getSid(),o=unikey("allread");(getMainWin()[o]=1)!=i?QMAjax.send("/cgi-bin/mail_mgr?mailaction=read_all&t=unreadmail_reg_data&loc=setFolderUnread,,,32",{method:"POST",content:T("sid=$sid$&folderid=$folderid$&groupid=$groupid$").replace({sid:a,folderid:i,groupid:n}),onload:function(e,t){e&&-1<t.indexOf("mark_allmail_ok")?(reloadFrmLeftMain(!0,!!getMainWin()[o]),showInfo("Folder marked as read successfully")):showError("Folder marked as failed to read, please try again")}}):confirmBox({title:"Message marking tips",msg:"Are you sure you want to mark unread messages in this folder as read?",onreturn:function(e,t){e&&QMAjax.send("/cgi-bin/mail_mgr?mailaction=read_all&t=unreadmail_reg_data&loc=setFolderUnread,,,32",{method:"POST",content:T("sid=$sid$&folderid=$folderid$&groupid=$groupid$").replace({sid:a,folderid:i,groupid:n}),onload:function(e,t){e&&(reloadLeftWin(),reloadFrm(getTop().getMainWin()),getTop().showInfo("Folder marked as read successfully"))}})}})}function addContentMouseEvent(e,c){if(e){var p=getTop().getDomWin(e);addEvents(e,{mouseover:function(e){var t,i=getEventTarget(e);if("5"==attr(i,"t")?(p.QMReadMail.addCalEvent(i,e,c),t=!0):attr(i,"t"),t)try{var n=getTop(),a=n.calcPos(i),o=n.S("showcalpanel",n.getMainWin()),r=n.calcPos(o),s=n.S("contentDiv",n.getMainWin())||n.parents("div.qm_converstaion_body",i)[0],l=n.calcPos(s);s&&r[2]>l[2]&&(o.style.top=a[2]-r[2]+"px")}catch(d){}},mouseout:function(e){var t=getEventTarget(e);"5"==attr(t,"t")?p.QMReadMail.hideCalEvent(t,e):attr(t,"t")},mousedown:function(e){attr(getEventTarget(e),"t")}})}}function linkMaker(d,c){var e=["(","(?:https?:\\/\\/|wwwd{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)","(?:","(?:&amp;amp;)","|","(?:&amp;)","|","[^\\s`!()\uff08\uff09\\[\\]{};'\"<>\u201c\u201d\u2018\u2019\u3002\uff0c\uff1b]","|","(?:[(\uff08][^\\s()\uff08\uff09<>]+[)\uff09])","|","(?:[(\uff08][^\\s()\uff08\uff09<>]*?[(\uff08][^\\s()\uff08\uff09<>]*?[)\uff09][)\uff09])",")+","(?:","(?:[(\uff08][^\\s()\uff08\uff09<>]+[)\uff09])","|","(?:[(\uff08][^\\s()\uff08\uff09<>]*?[(\uff08][^\\s()\uff08\uff09<>]*?[)\uff09][)\uff09])","|","[^\\s`!()\uff08\uff09\\[\\]{};:'\".,<>?\u201c\u201d\u2018\u2019\u3002\uff0c\uff1b]",")",")"].join(""),t=["(","[=\\u2248]?","(?:","(?:\uff08\\+?\\d{1,5}\\-?\uff09|\uff08\\+?\\d{1,5}\\-?|\\(\\+?\\d{1,5}\\-?\\)|\\(\\+?\\d{1,5}\\-?|\\+?\\d{1,5}\\-?)?","(?:","1\\d{3}(?:\\-?\\d{3,4}){2}","|","(?:[(\uff08]?\\d{2,4}[)\uff09]?)?\\d{3,5}\\-?\\d{3,5}(?:\\-?(?:\\d{1,8}|\uff08\\d{1,8}\uff09|\\(\\d{1,8}\\)))?",")",")","(?:(?![\\d\\-\\+\\*\\/=\\u2248]))",")"].join(""),i=/((?!0000)[0-9]{4}(?:[-/.]{1})?(?:(?:0?[1-9]|1[0-2])(?:[-/.]{1})?(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])(?:[-/.]{1})?(?:29|30)|(?:0?[13578]|1[02])(?:[-/.]{1})?31)|(?!0000)[0-9]{4}(?:[-/year]{1})(?:(?:0?[1-9]|1[0-2])month(?:0?[1-9]|1[0-9]|2[0-8])day|(?:0?[13-9]|1[0-2])month(?:29|30)day|(?:0?[13578]|1[02])month31day)|(?!year)(?:(?:0?[1-9]|1[0-2])month(?:0?[1-9]|1[0-9]|2[0-8])day|(?:0?[13-9]|1[0-2])month(?:29|30)day|(?:0?[13578]|1[02])month31day)|(?![/-])(?:(?:0?[1-9]|1[0-2])(?:[-/.]{1})?(?:0?[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])(?:[-/.]{1})?(?:29|30)|(?:0[13578]|1[02])(?:[-/.]{1})?31))\b/g.source;function p(e){for(var t=e||"",i=[],n=t.length/12,a=0;a<n;a++)i[a]=t.substr(12*a,12);return i.join("<wbr>")}return d.replace(new RegExp([e,"([a-z0-9.!#$%&'+/=?^_`{|}~-]{3,}@(?:[A-Z0-9-]+\\.)+[A-Z]{2,4})",i,t].join("|"),"ig"),function(e,t,i,n,a){var o;if(t)return['<a href="',0!=e.indexOf("http")?"http://"+e:e,'">',p(htmlDecode(e)).replace("&","&amp;"),"</a>"].join("");if(i)return['<a href="mailto:',e,'">',p(e),"</a>"].join("");if(n)if(c){var r=c.parentNode.firstChild,s=r.innerText||r.textContent||r.nodeValue||"";if(":"!=s.charAt(s.length-1)&&/((?!0000)[0-9]{4}([-/]{1})(?:(?:0?[1-9]|1[0-2])(?:[-/]{1})(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])(?:[-/]{1})(?:29|30)|(?:0?[13578]|1[02])(?:[-/]{1})31)|(?!0000)[0-9]{4}(?:[-/year]{1})(?:(?:0?[1-9]|1[0-2])month(?:0?[1-9]|1[0-9]|2[0-8])day|(?:0?[13-9]|1[0-2])month(?:29|30)day|(?:0?[13578]|1[02])month31day)|(?!year)(?:(?:0?[1-9]|1[0-2])month(?:0?[1-9]|1[0-9]|2[0-8])day|(?:0?[13-9]|1[0-2])month(?:29|30)day|(?:0?[13578]|1[02])month31day)|(?![/-])(?:(?:0?[1-9]|1[0-2])(?:[-/]{1})(?:0?[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])(?:[-/]{1})(?:29|30)|(?:0[13578]|1[02])(?:[-/]{1})31))/g.test(e)){var l=d.substring(arguments[arguments.length-2]+e.length,arguments[arguments.length-2]+e.length+6);!l.match(/\s?\d\d:\d\d/g)&&(l=""),o="<span style='border-bottom:1px dashed #ccc;' t='5' times='"+l+"' >"+e+"</span>"}else o=e}else o=e;else a&&(o=e);return o})}function linkIdentify(e){if(e&&"A"!=e.tagName&&"SCRIPT"!=e.tagName&&"STYLE"!=e.tagName&&"qqmailbgattach"!=e.className&&"PRE"!=e.tagName&&"CODE"!=e.tagName){for(var t,i=e.firstChild;i;i=t)t=i.nextSibling,linkIdentify(i);if(3==e.nodeType){var n=e.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),a=linkMaker(n,e);if(n!=a){var o=document.createElement("div");o.innerHTML=a;try{o.childNodes.forEach(function(e){3!=e.nodeType&&(e.removeAttribute("onanimationstart"),e.removeAttribute("onmousemove"))})}catch(r){o.innerHTML=a}a=o.innerHTML,(e.previousSibling?insertHTML(e.previousSibling,"afterEnd",a):insertHTML(e.parentNode,"afterBegin",a))&&removeSelf(e)}}}}function _isLinkNeedSwap(e){var t=e.href||"",i=e.ownerDocument,n=(i.parentWindow||i.defaultView).location;return t.split("#")[0]!==n.href.split("#")[0]&&(!e.onclick&&t&&0!=t.indexOf("javascript:")&&0!=t.indexOf("#"))}function swapLink(e,t,i,n){var a=e.ownerDocument?e:S(e,i);if(a){function o(e){_isLinkNeedSwap(e)&&(e.target="_blank",e.onclick=function(){return openExtLink.call(this,t)})}linkIdentify(a),addContentMouseEvent(a,n),E(GelTags("a",a),o),E(GelTags("area",a),o),E(GelTags("form",a),function(e){e.onsubmit=function(){var e=i.location;return"true"==e.getParams().filterflag||this.action?(this.target="_blank",!0):(showError(T(['The operation has been blocked for security reasons [<a onclick="',"setTimeout( function() {","goUrlMainFrm('$url$&filterflag=true');","showInfo('Unblock successful');","});",'" style="color:white;" >Unblock</a>]']).replace({url:e.pathname+e.search})),!1)}})}}function preSwapLink(e,t){var i=getEventTarget(e);if(i&&{A:1,AREA:1}[i.tagName]&&_isLinkNeedSwap(i)&&(openExtLink.call(i,t)&&window.open(i.href),preventDefault(e)),"mail_fold_toggle"==i.id&&_oTop.parents(".mail_fold_toggle_wrap",i)[0]){var n=_oTop.parents(".mail_fold_toggle_wrap",i)[0].nextSibling;n&&"mailFoldWrap"==n.id&&(i.innerHTML="none"==n.style.display?"Hide references<span>\u2191</span>":"Show references<span>\u2193</span>",n.style.display="none"==n.style.display?"":"none")}}function swapImg(e,t,i,n){}function openSpam(e){(e=e||window).location.replace(appendToUrl(e.location.href,"&disptype=html&dispimg=1&clickshowimage=1"))}function openHttpsMail(e){e.location.replace(appendToUrl(e.location.href,"&dispimg=1"))}function copyToClipboard(e){try{if(gbIsFF)netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),Components.classes["@mozilla.org/widget/clipboardhelper;1"].getService(Components.interfaces.nsIClipboardHelper).copyString(e);else{var t=S("copyinputcontainer");t||(insertHTML(document.body,"beforeEnd",'<input id="copyinputcontainer" style="position:absolute;top:-1000px;left:-1000px;"/>'),t=S("copyinputcontainer")),t.value=e,t.select(),document.execCommand("Copy")}}catch(i){return alert(T("Your browser security settings do not allow the editor to copy automatically, please use the keyboard shortcut ($cmd$+C) to do so.").replace({cmd:gbIsMac?"Command":"Ctrl"})),!1}return!0}function newCopyToClipboard(e){if(window.clipboardData)return window.clipboardData.clearData(),clipboardData.setData("Text",e),!0;if(-1!=navigator.userAgent.indexOf("Opera"))return window.location=e,!0;if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(d){return!1}var t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return!1;var i=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!i)return!1;i.addDataFlavor("text/unicode");var n=new Object;new Object;(n=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString)).data=e,i.setTransferData("text/unicode",n,2*e.length);var a=Components.interfaces.nsIClipboard;return!!t&&(t.setData(i,null,a.kGlobalClipboard),!0)}var o=S("qmdialog_container").children[0].id+"_authorCode";if(S(o)||S("authorCode")&&(o="authorCode"),S(o)){if(S(o).select){S(o).select();var r=document.execCommand("Copy");return S(o).blur(),r}var s=window.getSelection();s.removeAllRanges();var l=document.createRange();l.selectNode(S(o)),s.addRange(l);r=document.execCommand("Copy");return s.removeAllRanges(),r}return!1}function _doOpenSignLink(_oLinkObj,_card_data){var _oLinkObj=_oLinkObj,_card_data=_card_data,TE=_oTop.TE,T=_oTop.T,calcPos=_oTop.calcPos,QMMenu=_oTop.QMMenu,_oMenuItems=[{bDisSelect:!0,sStyle:"padding:0;",nHeight:"auto",sItemValue:TE(['<div class="card_inner">','<div class="card_box_main">','<table cellspacing="0" cellpadding="0" style="height: 247px;">',"<tr>",'<td style="height: 74px;vertical-align: top;">',"$@$if($card._detail.detail_logo$ && $card.logo$)$@$",'<img class="card_logo" src="$card.logo$" style="max-height: 54px;max-width: 80px;">',"$@$endif$@$","</td>","</tr>","<tr>",'<td style="vertical-align: middle;">','<div class="card_name" title="$card.name$">$card.name$</div>',"$@$if($card._detail.detail_duty$ && $card.duty$)$@$",'<div class="card_duty">$card.duty$</div>',"$@$endif$@$","</td>","</tr>","<tr>",'<td class="card_box_detail" style="vertical-align: bottom;">','<div class="card_corp" style="display: inline-block;">$card.corpname$</div>','<div style="position: relative;display: inline;">',"$@$if($card.auth$ == 0)$@$",'<span class="corp_state corp_uncertified" style="margin-left: 2px;" title="The enterprise is not certified"></span>',"$@$else if($card.auth$ == 1 && $corp_card.name$)$@$",'<span class="corp_state corp_certified bizcard_cert_icon" id="js_corp_certified" style="margin-left: 2px;"></span>','<div id="bizcard_cert_hover"  style="display:none;background: #fff;position: absolute; left:0;top:15px; padding: 20px;width: 380px;box-sizing: border-box;box-shadow: 0 2px 4px 0 rgb(0 0 0 / 10%);border: 1px solid #CACDD2;z-index: 1;" >','<span class="corp_card_cert_icon"></span>','<span style="width: 100px;height:60px;float: left;margin-right: 10px;background-image: url($corp_card.logo$);"></span>','<div style="font-size: 14px;line-height:20px;color: #000000;margin-bottom: 6px;font-weight: bold;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">$corp_card.name$</div>','<div style="font-size: 12px;line-height:17px;max-height:36px;color: #000000;overflow: hidden;text-overflow: ellipsis;white-space: pre-line;">',"<span>Address:</span>","<span>$corp_card.addr$</span>","</div>",'<div style="font-size: 12px;line-height:17px;color: #787878;padding: 20px 0;border-top: 1px solid #E8E8E8;margin: 20px 0;max-height:54px;margin-top: 37px;">$corp_card.remark$</div>','<div style="text-align: right;">','<a style="color:#186FD5;font-size: 12px;line-height:17px;text-decoration: none;" href="//service.exmail.qq.com/cgi-bin/help?subtype=1&no=1001001&id=23" target="_blank">Tencent Exmail authentication</a>',"</div>","</div>","$@$else if($card.auth$ == 1)$@$",'<span class="corp_state corp_certified" style="margin-left: 2px;" title="Enterprise has been certified"></span>',"$@$endif$@$","</div>","<div>","$@$if($card._detail.detail_party$ && $card.party$)$@$",'<div class="card_party" style="display: inline-block;">$card.party$</div>',"$@$endif$@$","$@$if($card._detail.detail_landline$ && $card.landline$)$@$",'<div class="card_landline">$card.landline$</div>',"$@$endif$@$","$@$if($card._detail.detail_phone$ && $card.phone$)$@$",'<div class="card_phone">$card.phone$</div>',"$@$endif$@$","$@$if($card._detail.detail_email$ && $card.email$)$@$",'<div class="card_email">$card.email$</div>',"$@$endif$@$","</div>","</td>","</tr>","</table>",'<div class="example_avatar_div ">',"$@$if($card._detail.detail_avatar$ && $card.avatar$)$@$",'<img src="$card.avatar$" width="70px" height="70px" ></img>',"$@$endif$@$","</div>",'<div class="add_to_contact_div" id="js_add_to_contact">','<span class="add_to_contact"></span>',"</div>","</div>","$@$if($card._detail.detail_text$ && $card.text$)$@$",'<div class="sep_line_dot"></div>','<div class="card_box_btm">','<span class="quotation"></span>','<div class="card_text" style="color: #787878;font-size: 12px;line-height: 17px;overflow-wrap: break-word;max-height: 102px;overflow-y: auto;word-break: break-word;white-space:pre-line;" >$card.text$</div>',"</div>","$@$endif$@$","</div>"]).replace(_card_data)}],isCompose=!!_oTop.getMainWin().getPageEditor,oContainer=_oLinkObj.children[0],_mainWinPos=calcPos(_oTop.getMainWin().frameElement);if(isCompose)var _editorWin=_oTop.getMainWin().getPageEditor().getEditWin(),_editorPos=calcPos(_editorWin.frameElement);var _oPos=calcPos(oContainer),_totalHeight=_mainWinPos[0]-_oTop.getMainWin().scrollY+(isCompose?_editorPos[0]-_editorWin.scrollY:0)+_oPos[2];new QMMenu({sId:"bizCardPopDetail",oEmbedWin:_oTop,nWidth:"443",nZIndex:96,sWidthDetect:"float",sClassName:"bizCardPopDetail",nX:_mainWinPos[3]+_oPos[1]+4+(isCompose?_editorPos[3]:0),oItems:_oMenuItems,bAnimation:!1,bAutoClose:!1,bProxyScroll:!1,onshow:function(){var e=_oTop.calcPos(this._moPanelDom);this._moPanelDom.style.top=_totalHeight-e[5]+"px",this.S("_menuall_").style.overflow="visible",_oTop.addClass(_oTop.getMainWin().document.body,"stopBodyScorll")},onload:function(){var self=this,selectMenu=null,select=self.S("js_add_to_contact"),ico_cert=self.S("js_corp_certified"),selectClick=function(){var _oPopMenuItems=[];_oPopMenuItems=[{bDisSelect:!0,sStyle:"padding:0;",nHeight:"auto",sItemValue:T(['<div class="pop_add_to_contact" id="js_add_to_contact_pop">','<div id="js_add_to_mailbox">','<span class="add_to_contact_icon add_to_mailbox_icon"></span>','<span class="add_to_contact_txt">To the mailbox address book</span>',"</div>",'<div id="js_add_to_phone">','<span class="add_to_contact_icon add_to_phone_icon"></span>','<span class="add_to_contact_txt">To the mobile phone address book</span>',"</div>",'<div id="js_add_to_we">','<span class="add_to_contact_icon add_to_we_icon"></span>','<span class="add_to_contact_txt">To Wechat / WeChat Work</span>',"</div>","</div>"])}];var _parentPos=calcPos(self._moPanelDom),_pos=calcPos(select);selectMenu=new _oTop.QMMenu({oEmbedWin:_oTop,oEmbedToDom:self._moPanelDom,sId:"bizCardPopDetail_contact",sClassName:"qmpanel_shadow bizCardPopDetail_contact",nX:0,nY:_pos[0]-_parentPos[0]-112-20,nArrowPos:73,bAutoClose:!1,nHeight:110,nZIndex:97,sWidthDetect:"float",nWidth:"en.exmail.qq.com"==location.host?270:156,oItems:_oPopMenuItems,bArrowPosNoClose:!0,bAnimation:!1,onshow:function(){_oTop.QMAddress.initAddress()},onload:function(){var _self=this,_add_to_mailbox=_self.S("js_add_to_mailbox"),_add_to_phone=_self.S("js_add_to_phone"),_add_to_we=_self.S("js_add_to_we");_add_to_mailbox.onclick=function(){new _oTop.QMDialog({sId:"newAddr",sTitle:"New Contact",sClassName:"addMailContactDlg",nWidth:600,bAutoClose:!1,sBodyHtml:_oTop.T(['<div id="con" class="panel_edit panel_edit_sendMsg" style="height: 464px;overflow: auto;">','<div class="panel_edit_inner bd">',"<ul>",'<li ui-type="column">','<input ui-type="input" tabindex="1" type="hidden" name="sId" value="" placeholder="" _has_placeholder="1">','<span class="caption tf">',"<span>name</span>","</span>",'<div class="column_value">','<span class="name_combined">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oName" value="$card.name$" class="txt_name txt" placeholder="" _has_placeholder="1">',"</span>",'<input ui-type="input" ku="enable_save" type="hidden" name="oFamilyName" value="" placeholder="" _has_placeholder="1">','<input ui-type="input" ku="enable_save" type="hidden" name="oGivenName" value="" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" class="avatar_item"><input ui-type="input" tabindex="1" type="hidden" name="sId" value="" placeholder="" _has_placeholder="1">','<span class="caption tf">',"<span>Profile photo</span>","</span>",'<div class="column_value">','<span class="face_wrap tf">','<img ui-type="avator" data-id="" data-empty="1" class="avator pointer" width="60" height="60" src="$card.avatar$" ck="addr_faceUpload">',"</span>","</div>","</li>",'<li class="sp_item"></li>','<li ui-type="column">','<label class="caption tf" _has_editlabel="1">',"<span>Personal email</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oEmail_person" value="" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column">','<label class="caption tf" _has_editlabel="1">',"<span>Work mailbox</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oEmail_work" value="$card.email$" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column">','<label class="caption tf" _has_editlabel="1">',"<span>Mobile Phone</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oTel_mobile" value="$card.phone$" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column">','<label class="caption tf" _has_editlabel="1">',"<span>Landline</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oTel_landline" value="$card.landline$" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" token="oIM" >','<label class="caption tf" _has_editlabel="1">',"<span>WeChat</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oIM_wx" value="" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" token="oIM" >','<label class="caption tf" _has_editlabel="1">',"<span>QQ</span>","</label>",'<div class="column_value">','<input ui-type="input" ku="enable_save" tabindex="1" type="text" name="oIM_QQ" value="" class="txt_name txt" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" class="column_job">','<label class="caption tf" _has_editlabel="1">',"<span>Company Address</span>","</label>",'<div class="column_value">','<input type="text" class="txt_name txt" ui-type="input" ku="enable_save" tabindex="1" name="oAdr" value="" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" token="oOrg" class="column_job">','<label class="caption tf" _has_editlabel="1">',"<span>Company Name</span>","</label>",'<div class="column_value">','<input type="text" class="txt_name txt" ui-type="input" ku="enable_save" tabindex="1" name="oOrg" value="$card.corpname$" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" token="oOrg" class="column_job">','<label class="caption tf" _has_editlabel="1">',"<span>Department</span>","</label>",'<div class="column_value">','<input type="text" class="txt_name txt" ui-type="input" ku="enable_save" tabindex="1" name="sOrg2" value="$card.party$" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" token="oOrg" class="column_job">','<label class="caption tf" _has_editlabel="1">',"<span>Position</span>","</label>",'<div class="column_value">','<input type="text" class="txt_name txt" ui-type="input" ku="enable_save" tabindex="1" name="sTitle" value="$card.duty$" placeholder="" _has_placeholder="1">',"</div>","</li>",'<li ui-type="column" ui-subtype="group" class="column_groups">','<label class="caption tf" style="cursor:default;" _has_editlabel="1">Group</label>','<div id="groupInfo" class="column_value" style="line-height: 26px;">','<a id="addr_group_add" data-view="normal" class="group_add" href="javascript:;" title="Select Contact Group" style="color: #32384E;font-size: 12px;">Add to </a>','<div id="menu_container" style="position: relative;z-index: 1;">',"</div>","</div>","</li>",'<li ui-type="column">','<label ck="addr_editlabel" class="caption tf" ui-type="edit" has_editlabel="1">',"<span>Remarks</span>","</label>",'<div class="column_value">','<textarea class="txt_more" ui-type="input" ku="enable_save" tabindex="1" name="oNote" default="Remarks" placeholder="Remarks" _has_placeholder="1"></textarea>',"</div>","</li>","</ul>","</div>","</div>",'<div class="nav_edit" style="padding:8px 0 8px 0;border-top:1px solid #ccc;background-color:#eaeaea;text-align: right;">','<a href="javascript:;" id="confirm" class="button_blue button_spaceRight">Save</a>','<a href="javascript:;" id="cancel" class="button_gray" style="margin-right:20px;">cancel</a>',"</div>"]).replace(_card_data),onload:function(){var _oSelfObj=this,_groups=_oTop.QMAddress.getPersonalGroupsOnly(),_oGroupMenuItems=[];if(_groups&&0!=_groups.length){if(_groups)for(var i=0;i<_groups.length;i++)_oGroupMenuItems.push({sId:_groups[i].id,sItemValue:_groups[i].name})}else _oGroupMenuItems.push({bDisSelect:!0,sItemValue:"No contact group"});function getDlgValue(e){var t=_oTop.finds(e,_oSelfObj._moPanelDom);return 0<t.length?t[0].value.trim():""}function submitData(){var paramArr=[];paramArr.push("id="),paramArr.push("name="+getDlgValue('input[name="oName"]')),paramArr.push("familyname="),paramArr.push("givenname="),paramArr.push("email=Personal Mailbox/5:"+getDlgValue('input[name="oEmail_person"]')),paramArr.push("email=work email/6:"+getDlgValue('input[name="oEmail_work"]')),paramArr.push("tel=Cell phone/4097:"+getDlgValue('input[name="oTel_mobile"]')),paramArr.push("tel=Landline/4097:"+getDlgValue('input[name="oTel_landline"]')),paramArr.push("IM=WeChat:"+getDlgValue('input[name="oIM_wx"]')),paramArr.push("IM=QQ:"+getDlgValue('input[name="oIM_QQ"]')),paramArr.push("adr=company address/1:"+getDlgValue('input[name="oAdr"]')),paramArr.push("org=company name:"+getDlgValue('input[name="oOrg"]')),paramArr.push("org2="+getDlgValue('input[name="sOrg2"]')),paramArr.push("title="+getDlgValue('input[name="sTitle"]')),paramArr.push("note=remarks:"+getDlgValue('textarea[name="oNote"]')),paramArr.push("sGroupId="),paramArr.push("sType="),paramArr.push("sViewType=normal");var _choosed_groups=_oTop.finds(".group_delete",_oSelfObj._moPanelDom);if(0<_choosed_groups.length)for(var i=0;i<_choosed_groups.length;i++){var _group_id=_choosed_groups[i].getAttribute("data_id");paramArr.push("group="+getDlgValue('input[name="oEmail_person"]')+":"+_group_id)}var _avatar_dom=_oTop.finds('img[ui-type="avator"]',_oSelfObj._moPanelDom);_avatar_dom.length&&""!=_avatar_dom[0].getAttribute("src")&&paramArr.push("photo_url="+encodeURIComponent(_avatar_dom[0].getAttribute("src"))),_oTop.QMAjax.send("/cgi-bin/laddr_addedit?sid="+_oTop.getSid()+"&operate=save&t=contact.json&ef=js&resp_charset=UTF8&view=normal",{method:"POST",content:paramArr.join("&"),onload:function(_abIsOk,_asData){if(_abIsOk){var res_data=eval("("+_asData+")")||{},errcode=res_data.errcode;errcode==undefined?(_oTop.showInfo("saved successfully"),_oSelfObj.close()):-112==errcode?_oTop.showError("Contact already exists"):-113==errcode?_oTop.showError("Your address this contact has exceeded the limit"):-2==errcode?_oTop.showError("Login status has expired"):res_data.errmsg&&_oTop.showError(res_data.errmsg)}},error:function(e,t){_oTop.showError("System anomaly")}})}_oTop.addEvent(_oSelfObj.S("confirm"),"click",function(){submitData()}),_oTop.addEvent(_oSelfObj.S("cancel"),"click",function(){_oSelfObj.close()}),_oTop.addEvent(_oSelfObj.S("addr_group_add"),"click",function(e){var a=_oTop.getEventTarget(e);new _oTop.QMMenu({oEmbedWin:_oTop,oEmbedToDom:_oSelfObj.S("menu_container"),sId:"group_menu",nX:0,nY:0,nWidth:"auto",oItems:_oGroupMenuItems,onitemclick:function(e,t){var i=_oTop.parents('li[ui-type="column"]',a)[0];if(!_oTop.finds('[data_id="'+e+'"]',i).length){var n=_oTop.TE(['<span class="group_item">',"$name$",'<a href="javascript:;" data_id="$id$" class="group_delete" id="js_delete_group_item_$id$">','<span class="ico_concact_delete"></span>',"</a>","</span>"]).replace({id:e,name:t.sItemValue});_oTop.insertHTML(a,"beforeBegin",n),_oTop.addEvent(_oTop.finds("#js_delete_group_item_"+e,i)[0],"click",function(e){var t=_oTop.getEventTarget(e);_oTop.removeSelf(_oTop.parents(".group_item",t)[0])})}}})})},onshow:function(){this.S("confirm").focus()}}),_self.close(),self.close()},_add_to_phone.onclick=function(){_self.close(),self.close(),new _oTop.QMDialog({sId:"addToPhoneDlg",sTitle:"",sClassName:"bizCardDlg",nWidth:326,bAutoClose:!1,sBodyHtml:_oTop.TE(['<div class="dialog_tip warning">','<div class="">','<div class="tip_text_title">',"Add to mobile phone address book","</div>",'<div class="tip_text_desc">',"Please use Wechat to scan the code","</div>",'<div class="tip_qr_image">','<image width="160" height="160" src="$qr_url$"></image>',"</div>","</div>","</div>"]).replace({qr_url:_card_data.card.phoneQrcode})})},_add_to_we.onclick=function(){_self.close(),self.close();var e="https://work.weixin.qq.com/wework_admin/common_genqrcode?use_new_style=&qr_margin=0&qr_size=6&url=https%3A%2F%2Fwork.weixin.qq.com%2Fu%2F"+_card_data.card.weCode+"%3Fsrc%3D128";new _oTop.QMDialog({sId:"addToPhoneDlg",sTitle:"",sClassName:"bizCardDlg",nWidth:326,bAutoClose:!1,sBodyHtml:_oTop.TE(['<div class="dialog_tip warning">','<div class="">','<div class="tip_text_title">',"Add as WeChat Work contact","</div>",'<div class="tip_text_desc">',"Please use Wechat or WeChat Work to scan the code.","</div>",'<div class="tip_qr_image">','<image width="160" height="160" src="$qr_url$"></image>','<div class="biz_card_ww_qr_logo"></div>',"</div>","</div>","</div>"]).replace({qr_url:e})})}},onitemclick:function(e){}})};ico_cert&&(ico_cert.onmouseover=function(){self.S("bizcard_cert_hover").style.display="table"},ico_cert.onmouseout=function(){self.S("bizcard_cert_hover").style.display="none"}),self._moPanelDom.onclick=function(e){var t=_oTop.getEventTarget(e);"add_to_contact_div"==t.className||0<_oTop.parents(".add_to_contact_div",t).length?selectClick():0==_oTop.parents(".bizCardPopDetail_contact",t).length&&selectMenu&&selectMenu.close()}},onbeforeclose:function(){_oTop.rmClass(_oTop.getMainWin().document.body,"stopBodyScorll")}})}QMReadedItem.addItem=function(e){getMainWin().gMailItems||(getMainWin().gMailItems=[]),getMainWin().gMailItems.push(e)},QMReadedItem.getItems=function(){return getMainWin().gMailItems||[]},QMReadedItem.save=function(e){getMainWin().goReadedItemImg=e},QMReadedItem.load=function(){return getMainWin().goReadedItemImg},QMReadedItem.disp=function(e){if(e){var t="checkbox"==e.type?e.parentNode:GelTags("input",e)[0].parentNode,i=t.firstChild;"IMG"!=i.tagName&&(insertHTML(t,"afterBegin",T(['<img src="$path$ico_grouplight.gif" class="showarrow"',' title="This is a recent email you read" />']).replace({path:getPath("image")})),i=t.firstChild),show(this.load(),!1),show(i,!0),this.save(i)}},QMReadedItem.read=function(e){if(e&&"U"===e.tagName)fireMouseEvent(e,"click");else{if(!this.load())return!1;fireMouseEvent(GelTags("table",this.load().parentNode.parentNode)[0].parentNode,"click")}return!0},QMReadedItem.check=function(e){if(!this.load())return!1;var t=this.load().nextSibling;return t.checked=!t.checked,doCheck(null,t,e),!0},QMReadedItem.move=function(e){var t=this.getItems(),i=t.length,n=-1;if(0==i)return!1;if(null!=this.load())for(var a=QMReadedItem.load().nextSibling,o=i-1;0<=o;o--)if(a==t[o]){n=o;break}return-1<(n+=e?1:-1)&&n<i&&(this.disp(t[n]),scrollIntoMidView(t[n],getMainWin().document.body,!1),!0)};var fieldMap={NAME:1,CORPNAME:2,POSITION:4,PARTY:8,CORPLOGO:16,AVATAR:32,PHONE:64,TEL:128,EMAIL:256,TEXT:512,DETAIL:1024,ADDTOBIZADDR:2048,ADDTOPHONEADDR:4096,ADDTOWXADDR:8192};function parsePhoneQrcode(e){if(!e)return"";var t=htmlDecode(e),i=t.indexOf("src=")+5,n=t.indexOf('"',i);return t.slice(i,n)}function decodeFlag(e){var t=e.detail;return e._detail={},e._detail.detail_logo=!!(t&fieldMap.CORPLOGO),e._detail.detail_avatar=!!(t&fieldMap.AVATAR),e._detail.detail_party=!!(t&fieldMap.PARTY),e._detail.detail_duty=!!(t&fieldMap.POSITION),e._detail.detail_phone=!!(t&fieldMap.PHONE),e._detail.detail_landline=!!(t&fieldMap.TEL),e._detail.detail_email=!!(t&fieldMap.EMAIL),e._detail.detail_text=!!(t&fieldMap.TEXT),e._detail.save_to_mailbox=!!(t&fieldMap.ADDTOBIZADDR),e._detail.save_to_phone=!!(t&fieldMap.ADDTOPHONEADDR),e._detail.save_to_we=!!(t&fieldMap.ADDTOWXADDR),e}function safeGetXmlData(e,t,i){return i?e&&e[t]&&e[t][0]&&e[t][0][i]&&e[t][0][i][0]?e[t][0][i][0].DATA:"":e&&e[t]&&e[t][0]?e[t][0].DATA:""}function convertData(e){var t={},i={},n={};return i.detail=safeGetXmlData(e,"card","detail"),i.name=safeGetXmlData(e,"card","name"),i.corpname=safeGetXmlData(e,"card","corpname"),i.duty=safeGetXmlData(e,"card","position"),i.party=safeGetXmlData(e,"card","party"),i.avatar=safeGetXmlData(e,"card","avatar"),i.phone=safeGetXmlData(e,"card","phone"),i.landline=safeGetXmlData(e,"card","tel"),i.email=safeGetXmlData(e,"card","email"),i.text=safeGetXmlData(e,"card","text"),i.text=safeGetXmlData(e,"card","text"),i.logo=safeGetXmlData(e,"card","logo"),i.phoneQrcode=parsePhoneQrcode(safeGetXmlData(e,"phonebook","content")),i.weCode=safeGetXmlData(e,"card","vcode"),i.weQrcode="https://work.weixin.qq.com/wework_admin/common_genqrcode?use_new_style=&qr_margin=0&qr_size=6&url=https%3A%2F%2Fwork.weixin.qq.com%2Fu%2F"+i.weCode+"%3Fsrc%3D128",i.auth=safeGetXmlData(e,"corp_auth"),i=decodeFlag(i),n.name=safeGetXmlData(e,"corp_card","name"),n.addr=safeGetXmlData(e,"corp_card","corpaddr"),n.remark=safeGetXmlData(e,"corp_card","corpremark"),n.homepage=safeGetXmlData(e,"corp_card","homepage"),n.logo=safeGetXmlData(e,"corp_card","authlogourl"),t.card=i,t.corp_card=n,t}function _openSignLink(){var _oLinkObj=this;if("unifiedSignature_link"==_oLinkObj.className){var _oTop=getTop(),_card_id=_oLinkObj.getAttribute("card_id"),_vode=_oLinkObj.getAttribute("vcode");return QMAjax.send("/cgi-bin/getmembercard?vcode="+_vode+"&id="+_card_id+"&f=json",{method:"POST",onload:function(_abIsOk,_asData){if(_abIsOk){var _oData=eval("("+_asData+")");if(_oData&&0==_oData.RetCode){var data=convertData(_oData);console.log(data),_doOpenSignLink(_oLinkObj,data)}else _oData&&0!=_oData.RetCode?_oTop.showError("The business card information is invalid."):_oTop.showError("System anomaly")}else _oTop.showError("System anomaly")}}),!1}}function openExtLink(e){var t=this;if(0==t.href.indexOf("mailto:")&&-1!=t.href.indexOf("@")){var i=["/cgi-bin/readtemplate?sid=",getSid(),"&t=compose&s=cliwrite&newwin=true&email=",t.href.split("mailto:")[1].split("?")[0]].join("");try{var n=[];if(1<t.href.split("mailto:")[1].split("?").length)for(var a=(n=t.href.split("mailto:")[1].split("?")[1].split("&")).length-1;0<=a;a--)"subject"==n[a].split("=")[0].toLowerCase()?i+="&pre_subject="+n[a].split("=")[1]:"body"==n[a].split("=")[0].toLowerCase()&&(i+="&pre_body="+n[a].split("=")[1])}catch(v){}return window.open(i),!1}if("qqmail_card_reply"==t.className||"qqmail_card_reply_btn"==t.className){var o=t.name,r=t.className,s=!!o,l=-1!=r.indexOf("birthcard");return getMainWin().location=T("/cgi-bin/cardlist?sid=$sid$&t=$t$&s=$s$&today_tips=$tips$&loc=readmail,readmail,sendnewcard,1&ListType=$listtype$&email=$email$$newwin$").replace({sid:getSid(),t:s?"compose_card":"card",s:l?"replybirthcard":"",tips:-1!=r.indexOf("btn")?"112":"111",listtype:s?"No":"Cards&Cate1Idx=listall",email:o,newwin:getTop().bnewwin?"&newwin=true":""}),!1}if("qqmail_postcard_reply_mobile"==t.className)return(c=getMainWin().QMReadMail)&&(getMainWin().location=T("/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&t=compose&s=reply&disptype=html").replace({sid:getSid(),mailid:c.getMailId()})),!1;if("qqmail_postcard_sendhelp_mobile"==t.className)return window.open("http://service.exmail.qq.com/cgi-bin/help?subtype=1&&id=36&&no=1000696"),!1;if(/qqmail_shareCalendar_joinBtn/i.test(t.className)&&/\/cgi-bin\/calendar\?/i.test(t.href)){var d=t.href;return d=trim2(d),QMAjax.send(d,{method:"POST",content:"sid="+getSid(),onload:function(e,t){if(e){if(/<!--cgi exception-->/gi.test(t)){var i=/<!--cgierrorcode:-([\d]+)-->/gi.test(t)&&RegExp.$1;if("821"==i)showError("The other party has stopped sharing the calendar");else if("810"==i){showError("Please login account"+(/<!--email:([\W\w]+?)-->/gi.test(t)&&RegExp.$1)+"Rejoin calendar")}else if("823"==i)showError("Invitation email has expired");else if("2"==i){var n=getTop();n.goUrl(n,[n.location.protocol,"//",n.location.hostname,"/cgi-bin/loginpage"].join(""))}else showError("Join failed");return}showInfo("Join successfully")}else showError("Join failed")}}),!1}if("qqmail_card_reply_thanksbtn"==t.className||"qqmail_card_reply_thanks"==t.className||"qqmail_birthcard_reply_thanksbtn"==t.className)return openComposeDlg("card",{sTitle:"Thank you friends",sDefAddrs:o=t.name,bAddrEdit:!0,sDefContent:"Thank you for the card! We should keep in touch with each other in the future.",bContentEdit:!0,sDefSubject:"Thank you for the card!",bRichEditor:!1,nWidth:488,oncomplete:function(){},bShowResult:!0}),!1;if("qqmail_postcard_reply"==t.className)return goUrlMainFrm(T("/cgi-bin/readtemplate?sid=$sid$&t=compose_postcard&email=$email$").replace({sid:getSid(),email:t.name}),!1),!1;if("qqmail_postcard_reply2"==t.className){var c,p="",u="";if(c=getMainWin().QMReadMail)try{var g=(c.getSubMailWithDom?c.getSubMailWithDom(t):c.getMailInfo()).from;p=g&&g.name||"",u=g&&g.addr||""}catch(v){}return goUrlMainFrm(T("/cgi-bin/readtemplate?sid=$sid$&t=compose_postcard&email=$email$&reply=1&frname=$name$&fraddr=$addr$").replace({name:escape(p),addr:escape(u),sid:getSid(),email:t.name}),!1),!1}if("qqmail_postcard_print"==t.className)return(c=getMainWin().QMReadMail)&&window.open(T("/cgi-bin/readmail?sid=$sid$&t=print_haagendazs&s=print&filterflag=true&mailid=$mailid$").replace({sid:getSid(),mailid:c.getMailId()})),!1;if("qqmail_postcard_getmoreinfo"==t.className)return(c=getMainWin().QMReadMail)&&window.open(T("/cgi-bin/today?t=haagendazs2010&sid=$sid$").replace({sid:getSid(),mailid:c.getMailId()})),!1;if(t.hostname==getTop().location.hostname&&("/cgi-bin/readtemplate"==t.pathname||"cgi-bin/readtemplate"==t.pathname)&&-1!=t.search.indexOf("t=calendar"))return(c=getMainWin().QMReadMail)&&goUrlMainFrm(t.href,!0),!1;if("weworkSignature_link"==t.className&&t.href&&/^https?:\/\/work\.weixin\.qq\.com\/wework_admin\/user\/h5\/qqmail_user_card\//.test(t.href)){var f=getTop(),m=t.href;m+=-1==m.indexOf("?")?"?":"&";var h=[];h.push("sid="+f.getSid()),h.push("uin="+f.getUin()),h.push("email="+encodeURIComponent(f.getUserInfo("addr")||f.getCookie("qqmail_alias")||"")),m+=h.join("&"),window.open(m);try{(new Image).src="/qy_mng_logic/reportKV?type=Sign&itemName=wwSignCardClick&uin="+f.getUin()}catch(v){}return!1}if("unifiedSignature_link"==t.className&&t.href&&/^https?:\/\/exmail\.qq\.com\/qy_mng_logic\/user_card\/h5\//.test(t.href))return _openSignLink.call(this);if(t.hostname==getTop().location.hostname&&t.href&&-1<t.href.indexOf("/cgi-bin/mail_spam")&&window.open("/cgi-bin/readtemplate?t=safety&check=false&gourl="+encodeURIComponent(t.href),"_blank"),t.hostname==getTop().location.hostname)return!0;if(0<=t.href.indexOf("javascript:void(0)"))return!1;if("preview"!=e&&getMainWin().location.href.indexOf("/cgi-bin/readmail?")<0)return!0;for(var _=t.parentNode;_;){if(1==_.nodeType&&("QQmailNormalAtt"==_.id||"attachment"==_.id))return!0;_=_.parentNode}return window.open(T("$host$/cgi-bin/mail_spam?action=check_link&url=$url$&mailid=$mid$&spam=$spam$&r=$rand$").replace({mid:getMainWin().location.getParams().mailid,spam:"spam"==e?1:0,rand:Math.random(),url:encodeURIComponent(t.href),host:-1==window.location.host.indexOf("exmail.qq.com")?"":"//exmail.qq.com"}),"_blank"),!1}function goPrevOrNextMail(e){var t,i=getMainWin();(t=S(["prevmail","nextmail"][e?1:0],i))&&!t.getAttribute("disabled")||(t=S(["prevpage","nextpage"][e?1:0],i))&&!t.getAttribute("disabled")&&(i.location=t.href)}function goBackHistory(){var e=SN("readmailBack",getMainWin());return!!(0<e.length&&isShow(e[0]))&&(fireMouseEvent(e[0],"click"),!0)}function MLIUIEvent(e,t,i){for(var n=e.value,a=QMMailCache,o=a.isRefresh(t),r=e.parentNode;"TABLE"!=r.tagName.toUpperCase();)r=r.parentNode;var s=GelTags("table",r)[0],l=GelTags("td",GelTags("tr",s)[0]),d=(l[1],getTop().CN("fg",r).length&&getTop().CN("fg",r)[0]);e.setAttribute("init","true"),QMReadedItem.addItem(e),d&&"new_g"==d.className&&(d=l[6]);for(var c,p=GelTags("div",s),u=p.length-1;0<=u;u--)if("TagDiv"==p[u].className){c=p[u];break}if(a.hasData(n))if(o)a.delData(n);else{var g=a.getData(n);if("true"==e.getAttribute("unread")&&a.addVar("unread",-1),_setMailListFlag(e,r,!1,g.reply),_hideGroupNewReply(e,r),d&&null!=g.star&&(setClass(d,g.star?"fg fs1":"fg"),a.addVar("star",g.star?1:-1)),g.oTagIds){var f,m=GelTags("table",s),h=g.oTagIds,_={};if(c){for(u=m.length-1;0<=u;u--)(f=m[u].getAttribute("tagid"))&&(_[f]=1);for(var v in h)0===h[v]?QMTag.rmTagUI(c,v):_[v]||QMTag.addTagUI(c,v,i,n,!1)}}}listMouseEvent(r),d&&(d.title="fg"==d.className?"Mark star":"Cancel star",addEvent(d,"click",function(e){return starMail(null,QMMailList.getCBInfo(t,n),"maillist"),stopPropagation(e)})),addEvent(r,"click",GetListMouseClick(t,i)),addEvent(r,"selectstart",preventDefault);var b=s.rows[0].cells[1];-1<b.className.indexOf("fr")&&(loadJsFile(getPath("js")+getFullResSuffix("qmtip.js"),!0),addEvent(b,"mouseover",MLI._remarkTip),addEvent(b,"mouseout",MLI._remarkTip)),addEvent(c,"click",function(e){if(QMTag.readclose(e,QMMailList.getCBInfo(t,n)))return stopPropagation(e)}),dragML(r,e)}function MLI(e,t,i,n){for(var a=SN("mailid",t),o=a[a.length-1],r=o.value,s=o.parentNode,l=QMMailCache.isRefresh(t);"TABLE"!=s.tagName.toUpperCase();)s=s.parentNode;MLIUIEvent(o,t,i);var d="1"==o.getAttribute("uw")?t.oPreUWMails:t.oPreMails,c=d.length,p=l?2:1;if(new Date-new Date(parseInt(o.getAttribute("totime")))<2592e6&&"true"==o.getAttribute("unread")&&"false"!=o.getAttribute("preload")&&c<p&&!rdVer.log(r)&&rdVer.isPre(i)){var u;o.getAttribute("gid");(u=rdVer.url(r,i,n,"",!1,"",!1,"",!0))&&d.push(u)}getTop().gsReadedMailId==r&&(QMReadedItem.disp(s),recordReadedMailId(null))}function MLJump(e,t,a,o){var i=SN("maillistjump",o.document),r="_MlJuMp_",s=parseInt(e)||0,l=parseInt(t)||0;function d(e){var t,i=getTop().QMMenu(e).S("txt"),n=parseInt(i.value);return isNaN(n)?(i.select(),showError("Please enter the number of pages to jump")):(t=Math.max(0,Math.min(n-1,l)),l<n&&t==s?(i.select(),showError("The number of pages entered exceeds the range, please enter the correct number of pages")):s==t?(i.select(),showError("You have entered the current number of pages")):(getTop().QMMenu(e).close(),void goUrlMainFrm([a,"&page=",t,"&loc=mail_list,,jump,0"].join(""))))}E(i,function(n){n.getAttribute(r)||(n.setAttribute(r,"1"),addEvents(n,{click:function(e){var i=unikey("mljump"),t=calcPos(n);new(getTop().QMMenu)({sId:i,oEmbedWin:o,nWidth:185,nX:t[1]-185,nY:bodyScroll(o,"scrollHeight")-t[2]<40?t[0]-40-13:t[2],bAutoClose:!1,oItems:[{nHeight:40,sItemValue:MLJump._oTemplate.replace({id:i})}],onshow:function(){this.S("txt").focus()}}),addEvent(getTop().QMMenu(i).S("txt"),"keypress",function(e){var t=e.keyCode||e.which;13===t?d(i):(t<48||57<t)&&8!=t&&9!=t&&preventDefault(e)}),addEvent(getTop().QMMenu(i).S("btn"),"click",function(e){d(i)}),preventDefault(e)}}))})}function initDropML(){function c(e){var t=calcPos(e),i=S("dragtitle"),n=i.offsetLeft,a=i.offsetTop;return t[1]>n&&t[3]<n&&t[2]>a&&t[0]<a?e:null}function a(e,t){if(e&&0<=e.id.indexOf("folder_")){var i=e.className,n=-1<i.indexOf("toolbg");t&&n?setClass(e,i.replace(/\btoolbg\b/g,"")):n||t||setClass(e,i+" toolbg")}}var o=S("dragtitle"),e=S("OutFolder"),t="inidrop",n=BaseMailOper.getInstance(getMainWin()),i=QMDragDrop,r="mail_list";if("true"==e.getAttribute(t))return!1;e.getAttribute(t,"true"),i.delGroup(r);var s=!1,p=null,u=null,l=null,d=/^([489]|personal|pop|tag)$/,g=new i.DropTarget(S("OutFolder"),{ondragover:function(e){if(p!=u){p&&p.id,u&&u.id;var t=p&&p.getAttribute("dp"),i=u&&u.getAttribute("dp"),n=u&&u.getAttribute("dr");i&&showFolders(i,!0,getTop()),t&&t!=i&&showFolders(t,!1,getTop()),a(p,1),a(u),l&&clearTimeout(l),s=n&&!d.test(n),l=setTimeout(function(){setClass(o,s?"drag_over":"drag_out"),l=null},50),p=u}},ondrop:function(e){if(u&&s){var t=n.getMailInfo().sFid,i=u.getAttribute("dr")||"";if(ossLog("delay","all","stat=drag&opr="+i),"6"==i)return a(p,1),p=null,n.apply("spammail"),void(dragML._mbHasChecked=!0);if(d.test(i))return a(p,1),void(p=null);if(0<=i.indexOf("tag_"))i=i.replace("tag","tid");else if("starred"==i)i="star";else if(5!=t&&6!=t||5!=i){if(!parseInt(i))return;i={5:"delmail"}[i]||"fid_"+i}else i="predelmail",dragML._mbHasChecked=!0;n.apply(i),o.setAttribute("na","true"),new qmAnimation({from:100,to:1}).play({speed:"slow",onaction:function(e,t){setOpacity(o,e/100)},oncomplete:function(e,t){show(o,0),setClass(o,"drag_out"),setOpacity(o,100),a(p,1),p=null}})}}},function(e,t,i){if(gbIsIE){for(var n=getEventTarget(i.event),a=/(folder_\w+_td|(personal|pop|tag)foldersDiv)/;n&&!a.test(n.id);)n=n.parentNode;u=n}else if(u=c(S("OutFolder"))){var o,r,s=["personal","pop","tag"],l=null,d=null;for(r=s.length-1;0<=r&&!(l=c(S(s[r]+"foldersDiv")));r--);if(l=l||c(S("SysFolderList")))for(r=(o=GelTags("li",l)).length-1;0<=r&&!(d=c(o[r]));r--);u=d||l}return!(!p&&!u)});i.addGroup(r,g)}function dragML(e,a){if(S("OutFolder")&&QMDragDrop){var o=dragML,t="dragtitle",r=S(t);r||(insertHTML(getTop().document.body,"afterBegin",'<div id="dragtitle" class="drag_out" style="display:none;"></div>'),r=S(t));var s,i=new QMDragDrop.Draggable(e,{threshold:5,oTitle:r},{ondragstart:function(e){o._mbHasChecked=1==a.checked,a.checked=!0;var t=getMainWin(),i=BaseMailOper.getInstance(t),n=QMMailList.getCBInfo(t);QMMailList.selectedUI(n),i.setMailInfo(n),r.innerHTML=["Select ",n.oMail.length," email(s)"].join(""),ossLog("delay","all","stat=drag&c="+n.oMail.length),s=gbIsIE?[0,0,0,0]:calcPos(t.frameElement),r.style.left=s[3]+e.clientX+"px",r.style.top=s[0]+e.clientY+"px",r.setAttribute("na",""),show(r,1),initDropML()},ondrag:function(e){r.style.left=s[3]+e.clientX+"px",r.style.top=s[0]+e.clientY+"px"},ondragend:function(e){if(r.getAttribute("na")||(show(r,0),setClass(r,"drag_out")),!o._mbHasChecked){a.checked=!1;var t=QMMailList.getCBInfo(getMainWin());QMMailList.selectedUI(t)}}});QMDragDrop.addGroup("mail_list",i);var n=e.ownerDocument,l=n.parentWindow||n.defaultView,d=dragML._sMarkMainWin=dragML._sMarkMainWin||unikey("drag");l[d]||(addEvent(l,"unload",function(){r.releaseCapture&&r.releaseCapture(),show(r,0)}),l[d]=1)}}function MLI_A(e){var t=GelTags("table",e),i=t[t.length-1],n=i.getAttribute("mailid");QMMailCache.hasData(n)&&(QMMailCache.isRefresh(window)?QMMailCache.delData(n):setClass(i,"i M")),listMouseEvent(i),addEvent(i,"selectstart",preventDefault)}function _optMailListFlag(e,t,i,n){if(!e||"checkbox"!=e.type)return!1;if(null==i)return"true"==e.getAttribute("unread");if(t||(t=e.parentNode.parentNode.parentNode.parentNode),"true"==e.getAttribute("unread")==!!i&&!n)return i;var a=e.getAttribute("gid");a&&(setGroupUnread(a,getGroupUnread(a)-1),setGroupUnread("gall",getGroupUnread("gall")-1)),e.setAttribute("unread",i?"true":"false"),setClass(t,[i?"i F":"i M",e.checked?" B":""].join("")),setClass(GelTags("table",t)[0],i?"i bold":"i");var o=GelTags("div",t)[1];if(!/(s[016789]bg)|(Rw)/.test(o.className)){var r=n?"r":e.getAttribute("rf"),s=e.getAttribute("isendtime"),l="Rr";s?l="0"==s?"Rc":"Ti":i?l="Ru":r&&(l="r"==r?"Rh":"Rz"),setClass(o,"cir "+l)}return i}function _getMailListFlag(e){return _optMailListFlag(e)}function _setMailListFlag(e,t,i,n){return _optMailListFlag(e,t,i,n)}function _hideGroupNewReply(e,t){if(!e||!e.getAttribute("gid"))return!1;var i=GelTags("b",t)[0],n=i&&i.parentNode;return!(!n||"new_g"!=n.className)&&(n.style.visibility="hidden",!0)}function getMailListInfo(){var e=getMainWin(),t=S("_ut_c",e),i=S("_ur_c",e),n=S("_ui_c",e);return{totle:t&&parseInt(t.innerHTML)||0,unread:i&&parseInt(i.innerHTML)||0,star:n&&parseInt(n.innerHTML)||0}}function setMailListInfo(e,t,i){var n,a=getMainWin(),o=!0,r=S("_ur",a),s=S("_ui",a),l=S("_ut",a);if(!isNaN(e=parseInt(e))){(n=S("_ur_c",a))?(n.innerHTML=Math.max(0,e),show(r,0<e)):o=!1;var d=S("tip_unread",a);d&&(d.innerHTML=e<0?parseInt(d.innerHTML)+e:e,show(d,e))}return isNaN(t=parseInt(t))||(t=Math.max(0,t),(n=S("_ui_c",a))?show(s,0!=(n.innerHTML=t)):o=!1),isNaN(i=parseInt(i))||(t=Math.max(0,i),(n=S("_ut_c",a))?show(l,0!=(n.innerHTML=t)):o=!1),show(S("_uc",a),isShow(r)),show(S("_ua",a),isShow(r)),o}function readMailFinish(e,t,i,n){var a,o,r=getMainWin(),s=S("load_"+e,r);if(QMMailCache.addData(e),s)show(s,!1),o=GelTags("input",a=s.parentNode.previousSibling)[0];else{for(var l=GelTags("input",r.document),d=0,c=l.length;d<c;d++)if("checkbox"==l[d].type&&l[d].value==e){o=l[d];break}for(a=o;"TABLE"!=a.tagName.toUpperCase();)a=a.parentNode}for(var p=GelTags("table",a),u=!1,g=p.length-1;0<=g;g--)if(p[g].getAttribute("tagid")){u=!0;break}_hideGroupNewReply(o,a),o&&_getMailListFlag(o)&&(_setMailListFlag(o,a,!1),setMailListInfo(getMailListInfo().unread-1),"1"==o.getAttribute("star")&&setFolderUnread("starred",getFolderUnread("starred")-1),i&&0<parseInt(i)&&!u?setFolderUnread(i,n?getGroupUnread("gall"):getMailListInfo().unread):reloadLeftWin())}function checkMail(e){return""==e?(showError("The added content cannot be empty"),!1):!!e.match(/^[\.a-zA-Z0-9_=-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)||(showError("The email address you entered is incorrect, please re-enter"),!1)}function checkAndSubmit(e){var t=S(e);if(!checkMail(trim(t.value)))return t.focus(),!1;submitToActionFrm(t.form)}function pushToDialogList(e){var t=getTop();t.goDialogList||(t.goDialogList=new t.Object),e&&(t.goDialogList[e]=!0)}function reportClickWeworkOfLeftBar(){var e=0;try{getTop().S("ww_new")&&"none"!=getTop().S("ww_new").style.display&&(e=1),getTop().S("ww_new").style.display="none"}catch(t){}QMAjax.send("/cgi-bin/readtemplate",{method:"POST",content:["sid=",getSid(),"&action=click_qywx_tab&first_click=",e].join(""),onload:function(e,t){}})}function showDialogNewReadMail(e,t,i,n){new(getTop().QMDialog)({sId:"addnewremind_qqmail",sTitle:"New reminder",sUrl:T("/cgi-bin/read_reminder?linkid=%linkid%&linktitle=%linktitle%&sid=%sid%&t=remind_edit&from=%from%","%").replace({sid:getSid(),linkid:e,linktitle:t,from:i}),nWidth:450,nHeight:477}),n&&rdVer(n,1)}function setRemindSpan(e,t){getTop().S("remind_edit_"+e,t).innerHTML=(getTop().reminddetail["mailid:"+e]||"").replace(/linktitle=.*&sid=/g,function(e){return e.replace(/\'/g,"&#039;")})}function showSimpleRuleFilter(_asAddr,_asClickFrom){if(_asAddr)var _oDialog=new(getTop().QMDialog)({sId:"addnewfilter_qqmail",sTitle:"Quickly create receipt rules",sUrl:T("/cgi-bin/setting2?sid=$sid$&Fun=GetFolderList&CurFilterID=0&t=readmail_filter&fromaddr=$fromaddr$").replace({sid:getSid(),fromaddr:_asAddr}),nWidth:420,nHeight:240,onshow:function(){var _oDialogWin=this.getDialogWin();waitFor(function(){try{return S("jump",_oDialogWin)}catch(e){}},function(_abIsOk){if(_abIsOk){function _fInitFolderItem(e){return e.length&&e.push({bDisSelect:!0,nHeight:10,sItemValue:"<hr/>"}),e.push({bDisSelect:!1,nHeight:22,sId:"new",sItemValue:"New Folder..."}),e}function _fGetItemValue(){var e=_oQMSelect.get(2);return"new"==e?"-1":e}function _fRestet(){_oQMSelect.set(_oUserFolder[0].sId,2)}function _fAddOption(e,t){var i={bDisSelect:!1,nHeight:22,sId:t,sItemValue:e};_oUserFolder=1==_oUserFolder.length?_fAddItem(_oUserFolder=_fAddItem(_oUserFolder,{bDisSelect:!0,nHeight:10,sItemValue:"<hr/>"},0),i,0):_fAddItem(_oUserFolder,i,_oUserFolder.length-2),_oQMSelect.update({oMenu:{oItems:_oUserFolder}}),_oQMSelect.set(t,2)}function _fAddItem(e,t,i){return"[object Array]"!={}.toString.call([])&&(t=[t]),e.slice(0,i).concat(t).concat(e.slice(i,e.length))}function _fCreateFolder(){promptFolder({type:"folder",bAlignCenter:!0,width:410,height:237,style:"createNewFolder",onreturn:function(_asName){QMAjax.send("/cgi-bin/foldermgr",{method:"POST",content:["sid=",getSid(),"&fun=new&from=simple&ef=js&resp_charset=UTF8&name=",_asName].join(""),onload:function(_abIsOk,_asResp){try{if(_abIsOk){var _oData=eval("("+_asResp+")");return void("0"==_oData.errcode?(_fAddOption(_asName,_oData.folderid),reloadLeftWin(),showInfo("Successfully created a new folder")):showError(_oData.errmsg))}}catch(e){}showError("Network anomalies, please try again later.")}})}})}var _oUserFolder=_fInitFolderItem(_oDialogWin.oUserFolder);_oQMSelect=new QMSelect({oContainer:S("selectfolder",_oDialogWin),oMenu:{nWidth:"auto",nMaxWidth:180,nMaxItemView:4,oItems:_oUserFolder},onselect:function(e){if("new"==e.sId)return _fCreateFolder(),!0}}),addEvent(S("jump",_oDialogWin),"click",function(){_oDialog.close();var e=_fGetItemValue();"-1"==e&&(e=""),getMainWin().location.replace(_oDialogWin.location.href.replace("&Fun=GetFolderList","&Fun=Create").replace("&t=readmail_filter","&loc=filter,simple,0,0&folderid="+e+"&type=0&OptionCode=0&FilterType=0"))}),addEvent(S("confirm",_oDialogWin),"click",function(){(new Image).src="/qy_mng_logic/reportKV?type=FilterCondition&itemName=mail_list|quick_filter|click&r="+Math.random();var _sFolderId=_fGetItemValue(),_nOldMail=S("oldmail",_oDialogWin).checked?1:0;"-1"==_sFolderId?(showError("You need to create a new folder"),_fRestet()):_sFolderId?QMAjax.send("/cgi-bin/foldermgr",{method:"POST",content:["sid=",getSid(),"&fun=addfilter&from=simple&ef=js&action=move&oldmail=",_nOldMail,"&sender=",_asAddr,"&folderid=",_sFolderId].join(""),onload:function(_abIsOk,_asResp){try{if(_abIsOk){var _oData=eval("("+_asResp+")");return void("0"==_oData.errcode?(_nOldMail&&0<_oData.affected?(showInfo(TE(["Successful operation,","$@$if($num$>0)$@$","Moved $num$ messages.","$@$else$@$",", You have no messages to move or tag.","$@$endif$@$",'<a href="/cgi-bin/mail_list?sid=$sid$&folderid=$fid$&page=0"','style="color:white" onclick="getTop().hiddenMsg();" target="mainFrame">',"[view]","</a>"]).replace({sid:getSid(),fid:_oData.folderid,num:_oData.affected}),3e4),"mail_list"==_asClickFrom&&reloadFrm(getMainWin())):showInfo("New rule successfully created"),ossLog("realtime","all","loc=filter,simple,0,1"),_oDialog.close()):showError(_oData.errmsg))}}catch(e){}showError("Network anomalies, please try again later.")}}):(showError("Please select a folder"),_fRestet())}),addEvent(S("cancel",_oDialogWin),"click",function(){_oDialog.close()})}else showError("The network is abnormal. Please refresh and try again.")})}});else showError("cannot get sender address, cannot create rule")}function submitSwitchForm(){var e=getTop().S("frmSwitch");e&&e.submit()}function beforeFrameHtmlUnload(){var e=QMDialog();for(var t in e)if("min"==e[t].option("status"))return setTimeout(function(){e[t].max()},10),"You still have the program running, sure to close?"}MLJump._oTemplate=T(['<div style="position:absolute;">','<div class="addrtitle jumpmenusdjust" style="float:left;">Jump to th<input id="txt" type="text" class="txt" style="width:30px;" />Page</div>','<a id="btn" href="javascript:;" class="left button_gray_s" style="width:40px; margin:7px 0 0 5px; _display:inline;">&nbsp; confirm &nbsp;</a>',"</div>"]),MLI._remarkTip=function(e){for(var n=getTop(),a=arguments.callee,o=e.clientX,r=e.clientY,s=getEventTarget(e);s&&"TD"!=s.tagName.toUpperCase();)s=s.parentNode;a._mnTimeout&&(clearTimeout(a._mnTimeout),a._mnTimeout=0),"mouseout"!=e.type?a._mnTimeout=setTimeout(function(){var e=n.GelTags("b",s.parentNode.cells[2]),t=e[e.length-1];if(n.QMTip&&t&&(a._nClientX!=o||a._nClientY!=r)){a._nClientX=o,a._nClientY=r;var i=t.innerHTML.replace(/^\&nbsp;-\&nbsp;/,"").replace(/\&nbsp;/gi,"&nbsp; ").replace(/&lt;br\/?&gt;/g,"<br/>");n.QMTip.showMailList(1,s.ownerDocument,i,o,r)}},250):n.QMTip&&n.QMTip.showMailList(0,s.ownerDocument)};var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function mybase64encode(e){var t,i,n,a,o,r;for(n=e.length,i=0,t="";i<n;){if(a=255&e.charCodeAt(i++),i==n){t+=base64EncodeChars.charAt(a>>2),t+=base64EncodeChars.charAt((3&a)<<4),t+="==";break}if(o=e.charCodeAt(i++),i==n){t+=base64EncodeChars.charAt(a>>2),t+=base64EncodeChars.charAt((3&a)<<4|(240&o)>>4),t+=base64EncodeChars.charAt((15&o)<<2),t+="=";break}r=e.charCodeAt(i++),t+=base64EncodeChars.charAt(a>>2),t+=base64EncodeChars.charAt((3&a)<<4|(240&o)>>4),t+=base64EncodeChars.charAt((15&o)<<2|(192&r)>>6),t+=base64EncodeChars.charAt(63&r)}return t}function showArchiveActive(){new QMDialog({sId:"archiveactive",sTitle:"Please activate first",sBodyHtml:getTop().TE(['<div class="cnfx_content" style="line-height:1.6;">','<div style="border-bottom:1px solid #E4E4E4; margin:0 0 15px; padding:0 0 15px;">Please check the activation email and follow the instructions to activate the archiving function.</div>',"</div>"]).replace({}),sFootHtml:['<a href="/cgi-bin/mail_list?sid='+getSid()+'&folderid=1&page=0&s=inbox&loc=folderlist,,,1" id="open_folder" class="btn_blue" target="mainFrame" initlized="true" md="0" href="javascript:;" nocheck="true">Check activation email</a><a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">confirm</a>'],nHeight:"auto",nWidth:400,onload:function(){var e=this;this.$;e.S("ok").onclick=function(){e.close()},e.S("open_folder").onclick=function(){e.close()}}})}function showArchiveClose(){new QMDialog({sId:"archiveactive",sTitle:"Archive function has been stopped",sBodyHtml:getTop().TE(['<div class="cnfx_content" style="line-height:1.6;">','<div style="border-bottom:1px solid #E4E4E4; margin:0 0 15px; padding:0 0 15px;">The archiving function has been stopped. If you need to open it again, please contact the mailbox administrator.</div>',"</div>"]).replace({}),sFootHtml:['<a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">confirm</a>'],nHeight:"auto",nWidth:400,onload:function(){var e=this;this.$;e.S("ok").onclick=function(){e.close()}}})}function DoArchiveLogin(i){QMAjax.send("/cgi-bin/archive_frame?auth=1&sid="+getSid()+"&lkey="+mybase64encode(i.S("pw1").value),{method:"POST",content:["r=",Math.random(),""].join(""),onload:function(e,t){0<=t.indexOf("archive_loginsucc")?(i.close(),location.replace("/cgi-bin/archive_frame?nocheckframe=true&sid="+getSid())):(alert("Wrong password! please enter again!"),i.S("pw1").focus())}})}function showArchiveLogin(){new QMDialog({sId:"archivelogin",sTitle:"Log in to the archive system",sBodyHtml:getTop().TE(['<div class="cnfx_content" style="line-height:1.6;">','<div style="border-bottom:1px solid #E4E4E4; margin:0 0 15px; padding:0 0 15px;">Please enter the password to log in to the mail filing system</div>','<div style="margin-top:12px;"><label>Enter the password:<input class="dialog_input" type="password" id="pw1" value="" style="width:220px;margin:0;"/></label></div>',"</div>"]).replace({}),sFootHtml:['<a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">confirm</a>','<a id="cancel" md="0" nocheck="true" initlized="true" class="btn_gray" href="javascript:;">cancel</a>'].join(""),nHeight:"auto",nWidth:400,onclose:function(){},onshow:function(){this.S("pw1").focus()},onload:function(){var t=this;t.S("cancel").onclick=function(){t.close()},t.S("ok").onclick=function(){DoArchiveLogin(t)},t.S("pw1").onkeydown=function(e){13==e.keyCode&&DoArchiveLogin(t)}}})}function showDelArchive(){new QMDialog({sId:"delarchive",sTitle:"Disable and delete archive",sBodyHtml:getTop().TE(['<div id="dialog_body" class="cnfx_content" style="line-height:1.6;">',"\t<div>Deactivate and delete currently archived messages. This operation will not affect the messages in member mailboxes.</div>","\t<div>Are you sure you want to disable and delete the archive?</div>",'\t<div style="margin-top:12px;">',"\t\t<label>Verification code:</label>",'\t\t<input class="dialog_input" id="captchInput" value="" style="width: 170px;margin:0;" />','\t\t<a id="captchaSendBtn" class="button_gray button_spaceRight captchaSendBtn" onclick="" style="float: right;">Send the verification code</a>',"\t</div>",'\t<div style="margin-top: 12px;"><label id="del_notice" class="txt_red del_notice"></label></div>',"</div>"]).replace({}),sFootHtml:['<a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">confirm</a>','<a id="cancel" md="0" nocheck="true" initlized="true" class="btn_gray" href="javascript:;">cancel</a>'].join(""),nHeight:"auto",nWidth:400,onclose:function(){},onshow:function(){this.S("captchInput").focus()},onload:function(){var i=this;i.S("captchaSendBtn").onclick=SendVerifyCode,i.S("cancel").onclick=function(){i.close(),clearInterval(window.SendVerifyCodeTimerId)},i.S("ok").onclick=function(){var e=i.S("captchInput").value;if(""==e)return i.S("del_notice").innerText="please enter verification code!",void this.S("captchInput").focus();QMAjax.send("/cgi-bin/archive_delete?step=deleteachive&sid="+getSid()+"&verifycode="+e,{method:"GET",onload:function(e,t){0<=t.indexOf("deletearchive_success")?(i.S("dialog_body").innerHTML="<div>Archived mail has been deactivated and deleted. Please contact the mailbox administrator for re-enabling.</div>",i.S("ok").outerHTML='<a id="delarchive__fresh>" class="btn_blue" initlized="true" href="/cgi-bin/today?sid='+getSid()+'" nocheck="true">confirm</a>',i.S("cancel").outerHTML=""):0<=t.indexOf("checkverifycode_fail")?(i.S("del_notice").innerText="The verification code is incorrect, please re-enter!",this.S("captchInput").focus()):i.S("del_notice").innerText="The system is abnormal, please try again later."}})}}})}function postProcessSendVerifyCode(e){var t=getTop();showSendVerifyCodeTips(t,e);var i=10;window.SendVerifyCodeTimerId=setInterval(function(){i--,console.log(i),0<i?t.CN("signBtnEdit")[0].innerText="Captcha"+i+"Valid within minutes":(clearInterval(window.SendVerifyCodeTimerId),closeSendVerifyCodeTips(t,e))},6e4),window.onhashchange=function(){clearInterval(window.SendVerifyCodeTimerId)}}function showSendVerifyCodeTips(e,t){e.CN("captchaSendBtn")[0].outerHTML='<a style="float: right;cursor: default;" class="button_gray button_gray_disabled signBtnEdit" id="delarchive__signBtnEdit">The verification code is valid for 10 minutes.</a>',e.CN("del_notice")[0].innerText="Verification code has been sent to"+t+"\u3002"}function closeSendVerifyCodeTips(e,t){e.CN("signBtnEdit")[0].outerHTML='<a id="delarchive__oNewClass_captchaSendBtn" class="button_gray button_spaceRight captchaSendBtn" onclick="" style="float: right;">Resend Code</a>',e.CN("del_notice")[0].innerText="",setEventForSendVerifyCode()}function setEventForSendVerifyCode(){getTop().CN("captchaSendBtn").onclick=SendVerifyCode}function SendVerifyCode(){QMAjax.send("/cgi-bin/archive_delete?step=sendverifycode&t=archive_delete&sid="+getSid(),{method:"GET",onload:function(e,t){var i=getTop();0<=t.indexOf("sendverifywx_success")?postProcessSendVerifyCode("Your bundled WeChat"):0<=t.indexOf("sendverifymobile_success")?postProcessSendVerifyCode("Your bundled phone"):0<=t.indexOf("sendverifymail_success")?postProcessSendVerifyCode("Administrator secret mailbox"):0<=t.indexOf("sendverifycode_fast")?i.CN("del_notice")[0].innerText="Verification codes are sent too frequently, please try again later.":0<=t.indexOf("sendverifymail_success")?i.CN("del_notice")[0].innerText="Failed to send verification code":i.CN("del_notice")[0].innerText="The system is abnormal, please try again later."}})}function showAdvanceSearchMenu(){var e=Scale.fixBodyWidth(document.body.clientWidth)-284;new(getTop().QMMenu)({oEmbedWin:window,nX:e,nY:62,nWidth:281,oItems:[{sId:"0",sItemValue:'<div class="ss_drop_item"><a href="javascript:;"><span class="ss_icon ss_icon_mail"></span>View all messages</a></div>'},{sId:"4",sItemValue:'<div class="ss_drop_item"><a href="javascript:;"><span class="ss_icon ss_icon_note"></span>View all notes</a></div>'},{sId:"2",sItemValue:'<div class="ss_drop_item ss_drop_split"><a href="javascript:;">Advanced search.</a></div>'}],sClassName:"ss_drop_wrap",onitemclick:function(e){var t={sid:getTop().getSid()};if("1"==e){changeStatus(1);var i=T("/cgi-bin/mail_list?topmails=0&sid=$sid$&s=search&folderid=all&page=0&subject=&sender=&receiver=&searchmode=attach&advancesearch=0").replace(t);getTop().getMainWin().location.href=i}else if("0"==e){changeStatus(1);i=T("/cgi-bin/mail_list?topmails=0&sid=$sid$&s=search&folderid=all&page=0&subject=&sender=&receiver=&searchmode=&advancesearch=0").replace(t);getTop().getMainWin().location.href=i,getTop().logKV("CommFunc","webmail|mailsearch|allmail|click")}else if("3"==e){changeStatus(1);i=T("/cgi-bin/mail_list?sid=$sid$&folderid=8&page=0&t=mail_list_group").replace(t);getTop().getMainWin().location.href=i}else if("4"==e){changeStatus(1);i=T("/cgi-bin/note_list?catid=0&sid=$sid$").replace(t);getTop().getMainWin().location.href=i,getTop().logKV("CommFunc","webmail|mailsearch|allnote|click")}else showAdvanceSearchDialog("all"),getTop().logKV("CommFunc","webmail|mailsearch|advance|click")}})}function manageMailBox(_url){if(_url&&""!=_url){var _bindState,_phoneNum,url="/cgi-bin/setting_wxbind?action=check_bind_info&sid="+getTop().getSid()+"&ef=js&t=data_mgr";g_IsWwBizmail&&(url="/cgi-bin/setting_wxbind?action=wwbizmail_check_bind_info&sid="+getTop().getSid()+"&ef=js&t=data_mgr");var adminType=getTop().S("manageMail").getAttribute("data-admin-type");QMAjax.send(url,{method:"POST",content:["r=",Math.random()].join(""),onload:function(_abIsOk,_avParam){if(_abIsOk)try{var _oData=eval(_avParam);function showWxBindResult(e,t){new QMDialog({sId:"LoAdINgBOx",sTitle:"System reminder",nWidth:540,nHeight:"auto",sBodyHtml:T('<div style="width: 350px;margin:0 auto;padding:30px 0;text-align: left;font-size: 14px;">    <div class="blocktip" style="margin-bottom: 20px;"><span class="blocktip_icon icon_finish_b" style="float: left;margin-right: 10px;"></span>        <div class="blocktip_content">            <div class="blocktip_title green" style="font-size: 16px;font-weight: bolder;color: #6b9f40;">$sWXName$</span></div>            <div class="graytext" style="color: #9E9B9B;padding-top:4px; font-size:12px;">You have enabled secure login, please login through WeChat scan.</div>        </div>    </div>    <div style="font-size:12px;"><span style="color: #B13131; float: left; overflow: hidden; font-weight: bolder;">Note:</span>        <div>Users of a client (Foxmail, Outlook, or mobile clients, etc) need to add a client-specific password. You can also add a</div>    </div>    <div style="font-size:12px;">        <p style="padding: 10px 0;"><a id="add_auth_pwd" href="javascript:;" class="btn_blue" style="height: 27px;line-height: 25px;">New password</a>\t\t\t\t\t\t\t\t\t<a id="goAdmin" href="javascript:;" class="button_gray" style="height: 27px;line-height: 25px;margin-left: 20px;">Enter management side</a></p>        <div id="auth_pwd_container" style="display: none; border-top: 1px solid #E6E3E3;padding-top: 15px;">        </div>    </div></div>').replace({sWXName:"1"==t?"Successfully turned on secure login":"WeChat account has been successfully bound:"+e}),onclose:function(){null,-1==_url.indexOf("location")&&QMAjax.send("/cgi-bin/bizmail?sid="+getSid()+"&r="+Math.random()+"&action=adminfirstlogin"+(getTop().getUrlParam("slt")?"&slt=1":"")),"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url},onload:function(){var t=this;QMAjax.send("/cgi-bin/setting4?sid="+getSid(),{method:"POST",content:"action=open_force_wx_scan_login&t=biz_rf_portal_mgr&ef=jsnew&resp_charset=UTF8",onload:function(e,t){var i=evalValue(t);e&&"0"==i.data.errcode||getTop().showError("Failed to enable secure login, please reset it in  WeChat Binding  later.")}}),getTop().addEvent(t.S("add_auth_pwd"),"click",function(){!function e(a){QMAjax.send("/cgi-bin/wx_token?act=add_spwd&ef=js&resp_charset=UTF8&sid="+getSid(),{method:"POST",onload:function(e,t){var i=evalValue(t);if(e&&"0"==i.errcode){var n=T('<span style="color: #9E9B9B;">Client-specific password:</span><input id="authorCode" readonly style="width:215px;background-color:#fff;border:0px;color:#6b9f40;font-weight:bold;font-size:16px;letter-spacing:1px;" value=%pwd%>&nbsp;<a href="javascript:;" onclick="ret=getTop().newCopyToClipboard(\'%pwd%\');if(ret){getTop().showInfo(\'Copy successfully. Now you can paste (Ctrl + V) into the client.\');}else{getTop().showError(\'Copy failed, please use keyboard shortcut (Ctrl+C) to complete.\');}" title="Copy to clipboard" initlized="true" md="0">copy</a><p style="color: #9E9B9B;">Please enter this password on the client.</p>',"%").replace({pwd:i.data.passwd});a.S("auth_pwd_container").innerHTML=n,a.S("auth_pwd_container").style.display="block"}else getTop().showError("Failed to obtain the password, please re-obtain it in  WeChat Bind  later.")}})}(t)}),getTop().addEvent(t.S("goAdmin"),"click",function(){"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url})}})}if("0"==_oData.data.iswxbind&&"0"==_oData.data.isphonebind?_bindState="0":"1"==_oData.data.iswxbind&&"0"==_oData.data.token&&"0"==_oData.data.force_wx_scan_login?_bindState="1":"0"==_oData.data.iswxbind&&"1"==_oData.data.isphonebind&&"0"==_oData.data.isphonevf&&(_bindState="2",_phoneNum=_oData.data.phone),"0"==_bindState||"2"==_bindState){var _bDlgState=!0,_nCount=0,_bRefreshQrcode=!1,_sCheckUrl="/cgi-bin/setting_wxbind?action=get&refresh_ticket="+_bRefreshQrcode+"&ef=js&t=data_mgr&sid="+getTop().getSid(),adminName="Rating administrator";"super"==adminType&&(adminName="Super Administrator");var _oDlg=new QMDialog({sId:"LoAdINgBOx",sTitle:"System reminder",sClassName:"dlg_sys_bind_mobile",nWidth:540,nHeight:"auto",sBodyHtml:T('<div id="bindWxBlock" style="padding: 30px 20px;font-size: 14px;display:$wxState$;"><div style="font-weight: bolder; margin-bottom: 20px;">You have been set to'+adminName+', The administrator needs WeChat login, please bind</div><div id="qr_con" width="260" height="260" style="padding-bottom: 20px;"><img id="wx_qrcode" style="box-shadow: 0 1px 6px #333;" width="200" height="200" src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=$wxticket$"></div><div style="color: #707070;">Please scan the QR code with WeChat, and log in with WeChat after binding</div><div style="margin-top: 10px;display:$showBindPhone$;">No WeChat, but<a id="bindPhone" style="cursor: pointer;">Bind phone</a></div><div style="margin-top: 25px;display:$backPhone$;"><a id="goBackPhone" style="cursor: pointer;text-align: left;"><Back to phone verification</a></div></div><div id="bindPhoneBlock" style="padding: 30px 20px;font-size: 14px;display:none;"><div class="blocktip_content" style="width: 300px;margin: auto;margin-bottom: 20px;"><div id="blocktip_title" style="font-weight: bolder; margin-bottom: 20px;text-align: left;font-size: 14px;">Please bind your mobile phone and log in with your mobile phone dynamic password</div><div class="items" style="text-align: left;"><div class="item dlf_sys_bind_line"><div class="singup_item_countryCode"><div class="qy_telInput_zipCode js_countryCode_dropdown"><div class="qy_telInput_zipCode_input"><input type="text" class="qui_inputText qy_inputText qy_inputText_Big" style="height: 26px;"><a href="javascript:;" class="qy_telInput_zipCode_input_arrowWrap"><span class="qy_telInput_zipCode_input_arrowWrap_icon"></span></a></div><div class="qui_dropdownMenu qy_dropdownMenu"><ul></ul></div></div></div><label class="input_tip" id="f_phone_tips" style="display:none;height: 36px;width: 274px;line-height: 36px;">phone number</label><input class="input_normal with_area" name="phone"  id="phone" un="bind" placeholder="phone number"><label id="phoneErr" class="err" style="display:none;"></label></div><div class="item image_verify dlg_sys_bind_line" id="image_verify" style="display:none;border: 1px solid #C7C7C7;border-radius: 2px;"><input class="input_normal input_l" name="verify_vc" id="verify"  un="bind" placeholder="Picture verification code" style="border:none;width:195px;"><div class="dlg_sys_bind_captcha"><img class="bind_f_img_vc" id="vfcode" src=""><a href="javascript:;" id="refresh_captch_btn" class="change_captcha_btn">Change one</a></div><label id="verifyErr" class="err"></label></div><div class="item dlg_sys_bind_line"><label class="input_tip" id="f_pwd_tips" style="display:none;height: 36px;line-height: 36px;width: 145px;">Captcha</label><input class="input_normal input_l" name="phone_vc" id="pwd"  un="bind" placeholder="Captcha"><a class="get_sms_code_btn" un="bind" id="requestSmsCode">get verification code</a> <label  id="smsErr" class="err"></label></div><div class="item"><a class="btn_blue" un="bind" id="btn_phone_bind">Confirm binding</a></div></div><div style="text-align: left;margin-top: 40px;"><a id="bindWx" style="cursor: pointer;text-align: left;"><Return to WeChat</a></div></div></div><div id="vfPhone" style="display:$phoneState$;padding:14px 0 35px 0;width: 415px;margin: auto;"><div class="block_line">You have been set to'+adminName+', The administrator needs WeChat or mobile phone login</div><div class="block_line">Please confirm that a valid mobile phone has been bound, or you can replace the bound mobile phone.</div><div class="blocktip_content" style="width: 340px;margin: auto;text-align:left;"><div class="items"><div style="margin-top: 25px;margin-bottom: 15px;position: relative;"><input type="radio" value="0" name="toSelect" id="toCheck" checked="checked" style="margin-right: 5px;"><label for="toCheck" style="font-size: 13px;">Verify that the phone is bound: $phoneNum$</label><a class="btn_gray" id="btn_vf_phone_vc" un="check" style="margin-top:-5px;height:30px;line-height:30px;margin-left:5px;font-size:12px;width: 90px;">get verification code</a></div><div id="vfPhoneBlock" style="display:none;width: 187px;margin-left: 22px;"><div class="item" style="margin-bottom: 12px;"><label class="input_tip" id="vfcode_tips" style="display:none;height: 36px;line-height: 36px;width: 145px;">Captcha</label><input style="width: 170px;" id="phone_vc" name="phone_vc" un="check" placeholder="Captcha"> <label  id="smsErr_vf" class="err" style="font-size: 12px;position: relative;top: -27px;left: 200px;float: left;margin-bottom: -17px;"></label></div><div class="item"><a class="btn_blue" un="check" id="btn_phone_check" style="width: 91%;">confirm</a></div></div><div><input type="radio" value="0" name="toSelect" id="toChange" style="margin-right: 5px;"><label for="toChange" style="font-size: 13px;">Replace bound phone</label></div><div id="changePhoneBlock" class="changePhoneBlock" style="display:none;width: 223px;margin-left: 22px;"><div class="item" style="margin: 14px auto;"><label class="input_tip" name="phone_tips" id="f_phone_change_tips" style="display:none;height: 36px;width: 274px;line-height: 36px;">phone number</label><input name="phone"  id="phone_change" un="change" style="width: 202px;" placeholder="phone number"><label id="phoneErr_change" class="err" style="display:none;margin-bottom: -4px;font-size:12px;position: relative;top: -27px;left: 228px;  float: left;"></label></div><div class="item" style="display:inline-block;margin-top: -2px;"><label class="input_tip" id="vfcode_tips_change" style="display:none;height: 36px;line-height: 36px;width: 145px;">Captcha</label><input name="phone_vc" id="phone_vc_change" un="change" placeholder="Captcha" style="width:81px;"><a class="btn_gray" style="margin-left: 8px;width: 88px;position: absolute;" id="btn_change_phone_vc" un="change" >get verification code</a> <label id="smsErr_change" class="err" style="font-size: 12px;position: relative;top: 14px;left: 232px;float: left;margin-bottom: -17px;"></label></div><div class="item" style="margin-top: -18px;margin-bottom:12px;"><a class="btn_blue" un="change" id="btn_phone_bind_change" style="width: 90%;">Confirm binding</a></div></div></div><div style="text-align: left;margin-top: 40px;"><span class="wxicon" style="background-size:contain;vertical-align:middle;"></span>You too<a id="goBindWx" style="cursor: pointer;">Bind WeChat</a>, Scan code login is more convenient</div></div></div>').replace({wxticket:_oData.data.wxticket,showBindPhone:"0"==_oData.data.isphonebind?"":"none",showCheckPhone:"1"==_oData.data.isphonebind?"":"none",phoneNum:_phoneNum,phoneState:"2"==_bindState?"":"none",wxState:"0"==_bindState?"":"none",backPhone:"2"==_bindState?"":"none"}),onload:function(){var r=this,s=!1,t=getTop();function a(e,t){if("bind"==t)if(0<e){next_sec=e-1;var i=next_sec+"Reacquire in seconds";r.S("requestSmsCode").className="btn_gray disable",r.S("requestSmsCode").innerText=i,r.S("requestSmsCode").value=next_sec+"Reacquired in seconds",setTimeout(function(){a(next_sec,"bind")},1e3)}else r.S("requestSmsCode").className="btn_gray",r.S("requestSmsCode").innerText="get verification code",r.S("requestSmsCode").value="get verification code";else if("check"==t)if(0<e){next_sec=e-1;i=next_sec+"Reacquire in seconds";r.S("btn_vf_phone_vc").className="btn_gray disable",r.S("btn_vf_phone_vc").innerText=i,r.S("btn_vf_phone_vc").value=next_sec+"Reacquired in seconds",setTimeout(function(){a(next_sec,"check")},1e3)}else r.S("btn_vf_phone_vc").className="btn_gray",r.S("btn_vf_phone_vc").innerText="get verification code",r.S("btn_vf_phone_vc").value="get verification code";else if("change"==t)if(0<e){next_sec=e-1;i=next_sec+"Reacquire in seconds";r.S("btn_change_phone_vc").className="btn_gray disable",r.S("btn_change_phone_vc").innerText=i,r.S("btn_change_phone_vc").value=next_sec+"Reacquired in seconds",setTimeout(function(){a(next_sec,"change")},1e3)}else r.S("btn_change_phone_vc").className="btn_gray",r.S("btn_change_phone_vc").innerText="get verification code",r.S("btn_change_phone_vc").value="get verification code"}function o(){r.S("vfcode").src="/cgi-bin/getverifyimage?aid=23000101&r="+Math.random()}function i(e){var t,i,n=!!e&&e.currentTarget;if("bind"!=n.getAttribute("un"))return"check"==n.getAttribute("un")?""==(i=r.S("phone_vc").value)?n.getAttribute("id")!=r.S("phone_vc").getAttribute("id")?(r.S("smsErr_vf").innerText="Please fill in the verification code",r.S("smsErr_vf").style.display="",!1):void 0:n.getAttribute("id")!=r.S("phone_vc").getAttribute("id")||!(r.S("smsErr1").style.display="none"):"change"==n.getAttribute("un")?(t=r.S("phone_change").value,i=r.S("phone_vc_change").value,""==t?n.getAttribute("id")!=r.S("phone_change").getAttribute("id")?(r.S("phoneErr_change").innerText="please fill in cell phone number",r.S("phoneErr_change").style.display="",!1):void 0:/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(t)?n.getAttribute("id")==r.S("phone_change").getAttribute("id")?!(r.S("phoneErr_change").style.display="none"):""==i?n.getAttribute("id")!=r.S("phone_vc_change").getAttribute("id")?(r.S("smsErr_change").innerText="Please fill in the verification code",r.S("smsErr_change").style.display="",!1):void 0:n.getAttribute("id")!=r.S("phone_vc_change").getAttribute("id")||!(r.S("smsErr_change").style.display="none"):(r.S("phoneErr_change").innerText="Please fill in the correct mobile phone number",r.S("phoneErr_change").style.display="",!1)):void 0;t=r.S("phone").value,i=r.S("pwd").value,$verify=r.S("verify").value;var a=r.countryCode;if(""==t){if(n.getAttribute("id")!=r.S("phone").getAttribute("id")&&n.getAttribute("id")!=r.S("pwd").getAttribute("id"))return r.S("phoneErr").innerText="please fill in cell phone number",r.S("phoneErr").style.display="",!1;if(n.getAttribute("id")==r.S("pwd").getAttribute("id"))return;if(n.getAttribute("id")==r.S("phone").getAttribute("id"))return void(r.S("phoneErr").style.display="none")}else{if(86==a&&!/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(t))return r.S("phoneErr").innerText="Please fill in the correct mobile phone number",r.S("phoneErr").style.display="",!1;if(86!=a&&!/^[0-9]+$/.test(t))return r.S("phoneErr").innerText="Please fill in the correct mobile phone number",r.S("phoneErr").style.display="",!1;if(n.getAttribute("id")==r.S("phone").getAttribute("id"))return!(r.S("phoneErr").style.display="none")}return""==i?n.getAttribute("id")!=r.S("pwd").getAttribute("id")?(r.S("smsErr").innerText="Please fill in the verification code",r.S("smsErr").style.display="",!1):void 0:n.getAttribute("id")==r.S("pwd").getAttribute("id")?!(r.S("smsErr").style.display="none"):s&&!$verify?(r.S("verifyErr").innerText="Please fill in the verification code",r.S("verifyErr").style.display="",!1):(r.S("verifyErr").style.display="none",!0)}t.addEvent(r.S("bindPhone"),"click",function(){r.S("bindWxBlock").style.display="none",r.S("vfPhone").style.display="none",r.S("bindPhoneBlock").style.display="",r.countryCode=86,jQuery||t.loadJsFileToTop(t.getPath("js"),[t.getFullResSuffix("home/lib/jquery-1.11.0.min.js")]),t.waitFor(function(){return t.jQuery},function(e){e&&(t.jQuery.noConflict(),t.loadJsFileToTop(t.getPath("js"),[t.getFullResSuffix("biz/admin/lib/dropdown/pkg.js")]),t.waitFor(function(){return t.jQuery.fn.countryCodeDropdown},function(e){if(e){var t=jQuery.fn.countryCodeDropdown,i={container:".js_countryCode_dropdown",dropDownClass:"qy_telInput_zipCode_input ",dropdownInputClass:"qy_inputText_Big",onChange:function(e){r.countryCodeDropdown.setText(e.value),r.countryCode=+e.value},onHide:function(){r.countryCodeDropdown.isValidCode(r.countryCodeDropdown.getText())?r.countryCode!=r.countryCodeDropdown.getText()&&r.countryCodeDropdown.setText(r.countryCode):r.countryCodeDropdown.setText(r.countryCode)}};t.initialize?r.countryCodeDropdown=t.initialize(i):r.countryCodeDropdown=new t(i),r.countryCodeDropdown.selectByValue(r.countryCode),r.countryCodeDropdown.scrollToSelectedItem()}}))})}),getTop().addEvent(r.S("bindWx"),"click",function(){r.S("bindWxBlock").style.display="",r.S("bindPhoneBlock").style.display="none",r.S("vfPhone").style.display="none"}),getTop().addEvent(r.S("goBackPhone"),"click",function(){r.S("bindWxBlock").style.display="none",r.S("bindPhoneBlock").style.display="none",r.S("vfPhone").style.display=""}),getTop().addEvent(r.S("goBindWx"),"click",function(){r.S("bindWxBlock").style.display="",r.S("bindPhoneBlock").style.display="none",r.S("vfPhone").style.display="none"}),getTop().addEvent(r.S("toCheck"),"click",function(){r.S("changePhoneBlock").style.display="none",-1==r.S("btn_vf_phone_vc").innerText.indexOf("second")?r.S("btn_vf_phone_vc").className="btn_gray":r.S("vfPhoneBlock").style.display=""}),getTop().addEvent(r.S("toChange"),"click",function(){r.S("btn_vf_phone_vc").className="btn_gray disable",r.S("changePhoneBlock").style.display="",r.S("vfPhoneBlock").style.display="none"}),getTop().addEvent(r.S("change_verify_code"),"click",function(){r.S("vfcode").src=r.S("vfcode").src+"0"}),getTop().addEvent(r.S("refresh_captch_btn"),"click",function(e){o()}),getTop().addEvent(r.S("btn_phone_bind"),"click",function(e){var n,t,i="";n=r.S("phone").value,t=r.S("pwd").value;var a=r.S("verify").value,o=r.countryCode;if(i="Please bind a new phone"==r.S("blocktip_title").innerText?"&change=1":"&change=2",86==o){if(!/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(n))return r.S("phoneErr").innerText="Enter an 11-digit mobile number",r.S("phoneErr").style.display="",!1}else if(!/^[0-9]+$/.test(n))return r.S("phoneErr").innerText="Please enter the correct phone number",r.S("phoneErr").style.display="",!1;return""==t?(r.S("smsErr").innerText="Please fill in the verification code",r.S("smsErr").style.display="",!1):s&&!a?(r.S("verifyErr").innerText="Please fill in the verification code",r.S("verifyErr").style.display="",!1):void QMAjax.send("/cgi-bin/setting_remind?action=authsms&t=biz_rf_mgr&sid="+getSid()+"&mobile="+n+"&smscode="+t+i+"&ef=js"+(o?"&area="+o:"")+"&img_vc="+a,{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"0"==i.retcode?showPhoneBindResult(n,o):"100"==i.retcode?getTop().showError("Invalid request, please check the parameters"):"-104"==i.retcode?(r.S("phoneErr").innerText="The number of accounts bound to the phone has exceeded the limit",r.S("phoneErr").style.display=""):"2"==i.retcode?(r.S("phoneErr").innerText="The administrator has bound the phone, please do not bind again",r.S("phoneErr").style.display=""):"102"==i.retcode?getTop().showError("The request is too busy, please try again later"):"104"==i.retcode?getTop().showError("The account is bound to another mobile phone number"):"-202"==i.retcode?(r.S("verifyErr").innerText="Verification code error",r.S("vfcode").src=r.S("vfcode").src+"0",r.S("verifyErr").style.display=""):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}})}),getTop().addEvent(r.S("btn_phone_bind_change"),"click",function(e){var n,t;return n=r.S("phone_change").value,t=r.S("phone_vc_change").value,"&change=1",/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(n)?""==t?(r.S("smsErr_change").innerText="Please fill in the verification code",r.S("smsErr_change").style.display="",!1):void QMAjax.send("/cgi-bin/setting_remind?action=authsms&t=biz_rf_mgr&sid="+getSid()+"&mobile="+n+"&smscode="+t+"&img_vc=&change=1&ef=js&r="+Math.random(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"0"==i.retcode?showPhoneBindResult(n):"100"==i.retcode?getTop().showError("Invalid request, please check the parameters"):"-104"==i.retcode?(r.S("phoneErr_change").innerText="The number of accounts bound to the phone has exceeded the limit",r.S("phoneErr_change").style.display=""):"2"==i.retcode?(r.S("phoneErr_change").innerText="The administrator has bound the phone, please do not bind again",r.S("phoneErr_change").style.display=""):"102"==i.retcode?getTop().showError("The request is too busy, please try again later"):"104"==i.retcode?getTop().showError("The account is bound to another mobile phone number"):"202"==i.retcode?(r.S("smsErr_change").innerText="Verification code error",r.S("smsErr_change").style.display=""):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}}):(r.S("phoneErr_change").innerText="Enter an 11-digit mobile number",r.S("phoneErr_change").style.display="",!1)}),getTop().addEvent(r.S("verify"),"keydown",function(){r.S("verifyErr").innerText=""}),getTop().addEvent(r.S("requestSmsCode"),"click",function(e){if(-1==e.target.className.indexOf("disable")){var i=r.S("phone").value,n=r.countryCode,t=r.S("verify").value;if(86==n){if(!/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(i))return r.S("phoneErr").innerText="Enter an 11-digit mobile number",r.S("phoneErr").style.display="",!1}else if(!/^[0-9]+$/.test(i))return r.S("phoneErr").innerText="Please enter the correct phone number",r.S("phoneErr").style.display="",!1;if(s&&!t)return r.S("verifyErr").innerText="Please enter the picture verification code",r.S("verifyErr").style.display="",!1;new TencentCaptcha("2016770177",function(e){0==e.ret?function t(e){getTop().addClass(r.S("requestSmsCode"),"disable"),QMAjax.send("/cgi-bin/setting_remind?action=sendsms&t=biz_rf_mgr&sid="+getSid()+"&mobile="+i+"&ef=js"+(n?"&area="+n:"")+"&ticket="+encodeURIComponent(e.ticket)+"&randstr="+encodeURIComponent(e.randstr),{method:"POST",onload:function(e,t){getTop().rmClass(r.S("requestSmsCode"),"disable");var i=evalValue(t);e&&"0"==i.retcode?(getTop().showInfo("Sent successfully"),a(60,"bind")):"102"==i.retcode?getTop().showError("The request is too busy, please try again later"):"-104"==i.retcode?getTop().showError("The number of accounts bound to the phone has exceeded the limit"):"-201"==i.retcode?(s=!0,o(),r.S("image_verify").style.display="",r.S("verifyErr").innerText="Please enter the picture verification code"):"-202"==i.retcode?(s=!0,r.S("verifyErr").innerHTML="Graphic verification code error",o()):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}})}(e):e.ret}).show()}}),getTop().addEvent(r.S("btn_change_phone_vc"),"click",function(e){if(-1==e.target.className.indexOf("disable")){var t=r.S("phone_change").value;if(!/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(t))return r.S("phoneErr_change").innerText="Enter an 11-digit mobile number",r.S("phoneErr_change").style.display="",!1;QMAjax.send("/cgi-bin/setting_remind?action=sendsms&t=biz_rf_mgr&sid="+getSid()+"&mobile="+t+"&ef=js&r="+Math.random(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"0"==i.retcode?(getTop().showInfo("Sent successfully"),a(60,"change")):"102"==i.retcode?getTop().showError("The request is too busy, please try again later"):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}})}}),getTop().addEvent(r.S("btn_vf_phone_vc"),"click",function(e){if(-1==e.target.className.indexOf("disable")){r.S("vfPhoneBlock").style.display="";QMAjax.send("/cgi-bin/setting_remind?action=sendsms&t=biz_rf_mgr&sid="+getSid()+"&type=8&ef=js&r="+Math.random(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"0"==i.retcode?(getTop().showInfo("Sent successfully"),a(60,"check")):"102"==i.retcode?getTop().showError("The request is too busy, please try again later"):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}})}}),getTop().addEvent(r.S("btn_phone_check"),"click",function(e){var t=r.S("phone_vc").value;if(""==t)return r.S("smsErr_vf").innerText="Please enter SMS verification code",r.S("smsErr_vf").style.display="",!1;QMAjax.send("/cgi-bin/setting_remind?action=checksms&t=biz_rf_mgr&sid="+getSid()+"&phone_vc="+t+"&ef=js&r="+Math.random(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"0"==i.retcode?(getTop().showInfo("Successful verification"),_oDlg=null,-1==_url.indexOf("location")&&QMAjax.send("/cgi-bin/bizmail?sid="+getSid()+"&r="+Math.random()+"&action=adminfirstlogin"+(getTop().getUrlParam("slt")?"&slt=1":"")),"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url):"-201"==_aoData.retcode?(s=!0,r.S("image_verify").style.display=""):"-202"==_aoData.retcode?(s=!0,r.S("verifyErr").innerHTML="Graphic verification code error",r.S("vfcode").src=r.S("vfcode").src+"0"):"-99"==i.retcode?getTop().showError("SMS verification code error"):i.retcode?getTop().showError("System is busy, error code:"+i.retcode):getTop().showError("The system is busy, please try again later")}})}),"placeholder"in document.createElement("input")?(addEvent(r.S("phone"),"blur",i),addEvent(r.S("pwd"),"blur",i),addEvent(r.S("phone_change"),"blur",i),addEvent(r.S("phone_vc_change"),"blur",i),addEvent(r.S("phone_vc"),"blur",i),addEvent(r.S("verify_vc"),"blur",i)):(""==r.S("phone").value&&(r.S("f_phone_tips").style.display="inline"),""==r.S("pwd").value&&(r.S("f_pwd_tips").style.display="inline"),""==r.S("phone_vc").value&&(r.S("vfcode_tips").style.display="inline"),""==r.S("phone_change").value&&(r.S("f_phone_change_tips").style.display="inline"),""==r.S("phone_vc_change").value&&(r.S("vfcode_tips_change").style.display="inline"),addEvent(r.S("f_phone_tips"),"click",function(e){r.S("phone").focus(),r.S("f_phone_tips").style.display="none"}),addEvent(r.S("f_pwd_tips"),"click",function(e){r.S("pwd").focus(),r.S("f_pwd_tips").style.display="none"}),addEvent(r.S("vfcode_tips"),"click",function(e){r.S("phone_vc").focus(),r.S("vfcode_tips").style.display="none"}),addEvent(r.S("f_phone_change_tips"),"click",function(e){r.S("phone_change").focus(),r.S("f_phone_change_tips").style.display="none"}),addEvent(r.S("vfcode_tips_change"),"click",function(e){r.S("phone_vc_change").focus(),r.S("vfcode_tips_change").style.display="none"}),addEvent(r.S("phone"),"focus",function(e){r.S("f_phone_tips").style.display="none"}),addEvent(r.S("pwd"),"focus",function(e){r.S("f_pwd_tips").style.display="none"}),addEvent(r.S("phone_vc"),"focus",function(e){r.S("vfcode_tips").style.display="none"}),addEvent(r.S("phone_change"),"focus",function(e){r.S("f_phone_change_tips").style.display="none"}),addEvent(r.S("phone_vc_change"),"focus",function(e){r.S("vfcode_tips_change").style.display="none"}),addEvent(r.S("phone"),"blur",function(e){""==r.S("phone").value?r.S("f_phone_tips").style.display="inline":i()}),addEvent(r.S("pwd"),"blur",function(e){""==r.S("pwd").value?r.S("f_pwd_tips").style.display="inline":i()}),addEvent(r.S("phone_vc"),"blur",function(e){""==r.S("phone_vc").value?r.S("vfcode_tips").style.display="inline":i()}),addEvent(r.S("phone_change"),"blur",function(e){""==r.S("phone_change").value?r.S("f_phone_change_tips").style.display="inline":i()}),addEvent(r.S("phone_vc_change"),"blur",function(e){""==r.S("phone_vc_change").value?r.S("vfcode_tips_change").style.display="inline":i()})),setTimeout(function n(){_bDlgState&&(_bRefreshQrcode=60<=++_nCount,getTop(),QMAjax.send("/cgi-bin/setting_wxbind?action=get&refresh_ticket="+_bRefreshQrcode+"&ef=js&t=data_mgr&sid="+getSid(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"1"==i.data.isbinded?(_bDlgState=!1,showWxBindResult(i.data.account)):(_bRefreshQrcode&&(r.S("wx_qrcode").src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i.data.wxticket,_nCount=0),setTimeout(n,2e3))}}))},2e3)},onclose:function(){_bDlgState=!1,_oDlg=null}});function showPhoneBindResult(e,t){new QMDialog({sId:"LoAdINgBOx",sTitle:"System reminder",nWidth:540,nHeight:"auto",sBodyHtml:['<div style="width: 410px;margin: auto;text-align: left;"><div style="background:url(/zh_CN/htmledition/images/newicon/prompt.png) no-repeat 0 3px; width:32px; height:34.5px;float: left;margin-top: 20px;"></div>','<div style="padding: 20px 0; font-size: 16px;width:400px;">\t','<div style="padding-left: 40px;color: #37AF20;">',"Mobile phone number has been successfully bound:",'<span id="wxbind">'+(t?"+"+t:"")+e+"</span></div>",'<div style="font-size: 13px;margin-left: 40px;margin-top: 8px;color: #837B7B;">',"You are bound to your mobile phone<br></div>",'<a class="btn_blue" id="submit" style="margin: 40px 0 0 40px;width: 80px;height: 30px;line-height: 30px;font-size: 15px;">OK</a>',"</div></div>"].join(""),onclose:function(){null,-1==_url.indexOf("location")&&QMAjax.send("/cgi-bin/bizmail?sid="+getSid()+"&r="+Math.random()+"&action=adminfirstlogin"+(getTop().getUrlParam("slt")?"&slt=1":"")),"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url},onload:function(){var e=this;getTop().addEvent(e.S("submit"),"click",function(){e.S("_closebtn_").click(),-1==_url.indexOf("location")&&QMAjax.send("/cgi-bin/bizmail?sid="+getSid()+"&r="+Math.random()+"&action=adminfirstlogin"+(getTop().getUrlParam("slt")?"&slt=1":"")),"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url})}})}}else if("1"==_bindState){var adminName="Rating administrator";"super"==adminType&&(adminName="Super Administrator");var _oDlg=new QMDialog({sId:"LoAdINgBOx",sTitle:"System reminder",nWidth:540,nHeight:"auto",sBodyHtml:T('<div style="padding: 30px 0;margin: 0 35px;overflow: hidden;zoom: 1;font-size: 14px;text-align: left;line-height: 25px;">You have been set to'+adminName+', You need to start the secure login and click the  OK  button to confirm the activation.</div><div class="bd attbg" style="padding: 0px 40px;border-width: 1px 0 0;text-align: right;"><a class="btn_blue" id="openWxToken" style="line-height: 20px;font-size: 14px;margin: 8px;">OK</a><a id="cancel" style="font-size: 14px;margin-left: 10px;">cancel</a></div>').replace({}),onload:function(){var e=this;getTop().addEvent(e.S("cancel"),"click",function(){_oDlg=null,e.S("_closebtn_").click()}),getTop().addEvent(e.S("openWxToken"),"click",function(){showWxBindResult("","1")})},onclose:function(){_oDlg=null}})}else-1==_url.indexOf("location")&&QMAjax.send("/cgi-bin/bizmail?sid="+getSid()+"&r="+Math.random()+"&action=adminfirstlogin"+(getTop().getUrlParam("slt")?"&slt=1":"")),"mail.exmail.qq.com"==location.hostname?location.href=_url+(-1==_url.indexOf("?")?"?":"&")+"domain_bak=1":location.href=_url}catch(e){}}})}}function enterManageMail(e){"mail.exmail.qq.com"==location.hostname?location.href=e+(-1==e.indexOf("?")?"?":"&")+"domain_bak=1":location.href=e}function safeJumpQQ(qmUn,qmSid,ls,msk){var ckst="",newWin=window.open("");QMAjax.send("/cgi-bin/getuserdata?sid="+getSid()+"&infotype=ckst&t=biz_rf_mgr&ef=js",{method:"POST",content:["r=",Math.random()].join(""),onload:function(_abIsOk,_avParam){if(null==newWin||void 0===newWin)getTop().showError("Failed to open the jump window, please refresh and try again");else if(_abIsOk)try{var _oData=eval(_avParam);ckst=_oData.data.ckst,newWin.location.href="https://wx.mail.qq.com/login/login?auth_type=3&qq_target=bizmail&fun=bizmail&dmtype=bizmail&qm_username="+qmUn+"&qm_sid="+qmSid+"&ls="+ls+"&msk="+msk+"&ckst="+ckst+"&noptlogin=1"}catch(e){newWin.close(),getTop().showError("Jump failed, please refresh and try again")}else newWin.close(),getTop().showError("Jump failed, please refresh and try again")}})}function checkWxBindStatus(url,callback){if(!url)return!1;QMAjax.send(url,{method:"POST",content:["r=",Math.random()].join(""),onload:function(_abIsOk,_avParam){if(_abIsOk)try{var _oData=eval(_avParam);"function"==typeof callback&&callback(_oData)}catch(e){}}})}function doWxBind(e,t){t=t||{};var i=getTop();new i.QMDialog({sId:"LoAdINgBOx_doBindWx",sTitle:"Bind WeChat",nWidth:540,nHeight:"auto",sBodyHtml:getBindQrTemplate(t).replace({wxticket:e.wxticket}),onload:function(){var e=this;setTimeout(function(){pollDoWxBind(0,e,t)},2e3)},onclose:function(){!0!==i.wx_just_scaned&&closeAutoForward(),i.fwd_checking_wx=-1,null}})}function pollDoWxBind(e,n,a){var o=(e||0)+1,r=60<=o,s=getTop();QMAjax.send("/cgi-bin/setting_wxbind?action=get&refresh_ticket="+r+"&ef=js&t=data_mgr&sid="+getSid(),{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"1"==i.data.isbinded?(s.wx_just_scaned=!0,n.S("_closebtn_").click(),a&&"function"==typeof a.success?a.success(!0):s.showInfo("Bind to WeChat successfully")):r?(n.S("wx_qrcode").src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i.data.wxticket,setTimeout(function(){pollDoWxBind(0,n,a)},2e3)):n.S("_closebtn_")&&setTimeout(function(){pollDoWxBind(o,n,a)},2e3)}})}function authWxBind(e){var o=getTop();QMAjax.send("/cgi-bin/setting_wxbind?action=pollcheckauthorize&refresh_ticket=true&ef=js&t=data_mgr&sid="+getSid(),{method:"POST",onload:function(e,t){var i=evalValue(t);if(e&&i.data.wx_ticket&&i.data.scan_code&&i.data.valid_time){var n=i.data.wx_ticket,a=i.data.scan_code;new o.QMDialog({sId:"LoAdINgBOx_authBindWx",sTitle:"Verify WeChat",nWidth:540,nHeight:"auto",sBodyHtml:getAuthQrTemplate().replace({wxticket:i.data.wx_ticket}),onload:function(){var e=this;setTimeout(function(){pollAuthWxBind(0,e,n,a)},2e3)},onclose:function(){!0!==o.wx_just_scaned&&closeAutoForward(),o.fwd_checking_wx=-1,null}})}}})}function pollAuthWxBind(e,o,n,a){var r=(e||0)+1,s=getTop(),t=900<r;QMAjax.send("/cgi-bin/setting_wxbind?action=pollcheckauthorize&refresh_ticket="+t+"&ef=js&t=data_mgr&sid="+getSid()+"&scan_code="+a,{method:"POST",onload:function(e,t){var i=evalValue(t);e&&"1"==i.data.check_res?(s.wx_just_scaned=!0,o.S("_closebtn_").click(),s.showInfo("Verify WeChat success")):e&&"0"==i.data.check_res?(s.showError("Failed to verify WeChat, please use the bound WeChat scan code"),QMAjax.send("/cgi-bin/setting_wxbind?action=pollcheckauthorize&refresh_ticket=true&ef=js&t=data_mgr&sid="+getSid(),{method:"POST",onload:function(e,t){var i=evalValue(t);if(e&&i.data.wx_ticket&&i.data.scan_code&&i.data.valid_time){var n=i.data.wx_ticket,a=i.data.scan_code;o.S("wx_qrcode").src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+n,setTimeout(function(){pollAuthWxBind(r,o,n,a)},2e3)}}})):o.S("_closebtn_")&&setTimeout(function(){pollAuthWxBind(r,o,n,a)},2e3)}})}function createVirtualWeworkCorp(a){QMAjax.send("/cgi-bin/today?sid="+getSid()+"&action=get_code_for_wework&ef=js&t=biz_rf_mgr&newCreateProcess=1",{method:"POST",onload:function(e,t){var i;try{i=evalValue(t),e&&i.data&&i.data.wework_code?a(!0,i.data.wework_code):"-101"==i.retcode?a(!1,"-101"):a(!1)}catch(n){a(!1)}}})}function closeAutoForward(){var e=S("autofwd0"),t=S("OptionCode2");e&&e.click(),t&&(t.checked=!1,S("fwdTip").style.display="none")}function getBindQrTemplate(e){return T('<div id="bindWxBlock" style="padding: 30px 20px;font-size: 14px;"><div style="font-weight: bolder; margin-bottom: 20px;">'+(e.header||"In order to avoid the possible leakage of important information caused by automatic forwarding, you need to enable it after binding WeChat")+'</div><div id="qr_con" width="260" height="260" style="padding-bottom: 20px;"><img id="wx_qrcode" style="box-shadow: 0 1px 6px #333;" width="200" height="200" src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=$wxticket$"></div><div style="color: #707070;">'+(e.footer||'Please use WeChat"scan it"To bind')+"</div></div>")}function getAuthQrTemplate(){return T('<div id="bindWxBlock" style="padding: 30px 20px;font-size: 14px;"><div style="font-weight: bolder; margin-bottom: 20px;">In order to avoid the possible leakage of important information caused by automatic forwarding, you need to verify and activate WeChat</div><div id="qr_con" width="260" height="260" style="padding-bottom: 20px;"><img id="wx_qrcode" style="box-shadow: 0 1px 6px #333;" width="200" height="200" src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=$wxticket$"></div><div style="color: #707070;">Please use WeChat"scan it"for validation</div></div>')}function doReadMailStatistics(e,t){try{var i=document.getElementById("mainFrame").contentWindow.document.getElementById("tbOtherOptions");QMAjax.send("/cgi-bin/getinvestigate",{method:"POST",content:"statistics=1&st_mailid="+e+"&"+t+"="+(+new Date-getTop().currentReadMailStartTime)+"&st_originaltime="+i.getAttribute("data-origintime")})}catch(n){}}function attachSetFlag(_avParam,_abIsSetStarred,_afCallback){_avParam="&mailattach="+("string"==typeof _avParam?_avParam.split(","):_avParam).join("&mailattach=");var _sUrl=[_avParam,"&action=",_abIsSetStarred?"setflag":"cancelflag"].join(""),_sValidTxt=_abIsSetStarred?"Collect":"Uncollect";QMAjax.send("/cgi-bin/attachfolder?t=attachfolder.json",{method:"POST",content:["r=",Math.random(),_sUrl].join(""),onload:function(_abIsOk,_avParam){if(_abIsOk)try{var _oData=eval(_avParam);getTop().showInfo("Attachment"+_sValidTxt),_afCallback&&_afCallback.call(null,_oData)}catch(e){}else getTop().showError(_sValidTxt+"failure")}})}function showAdvanceSearchDialog(e){var t={sid:getTop().getSid(),keyword:"all"!=e?encodeURI(trim(S("subject").value)):""},i=T("/cgi-bin/folderlist?sid=$sid$&t=searchoption"+(getTop().formatDayByLocale?"_v2":"")+"&advancesearch=2&loc=frame_html,,9&advkeyword=$keyword$").replace(t);new QMDialog({sId:"advsearch",sTitle:"Advanced mail search",sUrl:i,nWidth:461,nHeight:426,nFootHeight:48})}function getAttachList(_avParam,_afCallback,_aoOption){_aoOption=_aoOption||{};var _fSelf=arguments.callee,_oArgs=arguments,_oList="object"==typeof _avParam&&_avParam.length?_avParam:[],_ATT_LIST_URL=T("/cgi-bin/readmail?sid=$sid$&t=$t$&s=forward&from=attachfolder&disptype=html&ef=js$param$"),_sParam=TE(["$@$for($oAttach$)$@$","&mailattach=$mailid$|$attachid$|$attachname$|$fileextenal$|$filebyte$","$@$if($editname$)$@$","|$editname$","$@$endif$@$","$@$endfor$@$"]).replace({oAttach:_oList});QMAjax.send(_ATT_LIST_URL.replace({sid:getSid(),t:"compose.json",param:_sParam}),{method:"GET",onload:function(_abIsOk,_avData){var _bFlag=!0;if(_abIsOk)try{var _oData=eval(_avData),_oAttachs=_oData.attach;if(_oAttachs&&_oAttachs.length){for(var i=0;i<_oAttachs.length;i++)if(0==+_oAttachs[i]["byte"]){_bFlag=!1;break}}else _bFlag=!1}catch(e){_bFlag=!1}_afCallback(!(!_bFlag||!_abIsOk),_oData)}},_aoOption.ajax)}function isEn(){return"en_US"==getLocale()}function isCh(){return"zh_CN"==getLocale()}function getLocale(){return"undefined"==typeof gsLocale?"zh_CN":gsLocale||"zh_CN"}function mailRecall(_anType,_aoParam,_aoCallbacks){var _oCallbacks=_aoCallbacks||{},_oPostData=extend({r:Math.random(),sid:getSid()},_aoParam);_oCallbacks.onbeforesend&&!1===_oCallbacks.onbeforesend()||QMAjax.send("/cgi-bin/send_status",{method:"POST",content:_anType?T("t=send_status.json&s=mailrecall_queryv2&taskid=$taskid$&messageid=$msgid$&sid=$sid$&r=$r$&ef=js").replace(_oPostData):T("t=send_status.json&s=mailrecallv2&messageid=$msgid$&time=$time$&sid=$sid$&r=$r$&ef=js").replace(_oPostData),onload:function(_abIsOk,_avParam){if(_abIsOk){try{var _oData=eval(["(",_avParam,")"].join(""));if(-1<+_oData.errcode)return void(_oCallbacks.onsuccess&&_oCallbacks.onsuccess(_oData));showError(_oData.errmsg||(1==_anType?"Failed to check the withdrawal status of the email, the withdrawal result will be notified to you later":"Operation failed, please try again later"))}catch(e){showError(_oData.errmsg||(1==_anType?"Failed to check the withdrawal status of the email, the withdrawal result will be notified to you later":"Operation failed, please try again later"))}_oCallbacks.onerror&&_oCallbacks.onerror(_avParam)}else"abort"!=_avParam&&showError(_oData.errmsg||(1==_anType?"Failed to check the withdrawal status of the email, the withdrawal result will be notified to you later":"Operation failed, please try again later")),_oCallbacks.onerror&&_oCallbacks.onerror(_avParam);_oCallbacks.oncomplete&&_oCallbacks.oncomplete(_abIsOk,_avParam)}})}function backHome(e){getMainWin().location.href=T("/cgi-bin/today?sid=$sid$&loc=backhome,,,$locid$").replace({sid:getSid(),locid:e||140})}function resizeFolderList(){var e=S("SysFolderList"),t=S("ScrollFolder"),i=S("folder");if(e&&t&&i){var n=["auto","hidden"],a=i.clientHeight,o=e.offsetHeight,r=a-o<50?0:1;i.style.overflow=n[r],i.style.overflowX=n[1],t.style.overflow=n[1-r],t.style.height=r?a-o+"px":"auto"}}function setTopSender(e){var t=getGlobalVarValue("DEF_MAIL_FROM")||"";switch(e&&e.action){case"setting4":t!=e.email&&(setUserInfo("addr",e.email),setDefaultSender(e.email),changeStyle(e.skin,e.logo),getTop().skin_path=e.skin,clearCache(["css",getPath("style"),"skin"])),reloadSignature()}}function directChangeSkin(){if(window!=getTop())return getTop().directChangeSkin();function _errorHandle(e,t){"abort"!=t&&showError("Failed to switch accounts, please try again.")}var _oUserAddrObj=S("useraddr"),_oUserAddrArrowObj=S("useraddrArrow");if(!_oUserAddrObj)return null;setUserInfo("addr",getDefaultSender());for(var _nWidth=195,_oAllMail=getDefalutAllMail(),_nAllMailLen=0,_oTypeMails=[[],[],[]],_i=0,_nLen=_oAllMail.length;_i<_nLen;_i++){var _nType=_oAllMail[_i].type;(0<=_nType||_nType<3)&&_oAllMail[_i].email&&(_oTypeMails[_nType].push(_i),_nAllMailLen++)}for(var _oItemTmpl=T(['<div style="width:18px;height:16px;float:left;padding-top:3px;">','<img id="img_$id$" src="$images_path$ico_ft_upload_success.gif" width="16px" height="16px" style="display:$display$"/>',"</div>",'<div title="$email$">$email$</div>']),_oItems=[{sItemValue:['<div style="padding:0 5px;">','<span style="float:right;">','<a id="userIdMgr" href="javascript:;">Manage</a>',"</span>","<span>Choose account</span>","</div>"].join("")}],_nCurrentId=0,j=0;j<3;j++){var _oTypeMail=_oTypeMails[j],_nLen=_oTypeMail.length;j&&_nLen&&_oItems.push({nHeight:10,sItemValue:"<hr/>"});for(var i=0,_nLen=_oTypeMail.length;i<_nLen;i++){var _oMail=_oAllMail[_oTypeMail[i]];_oMail.email==getDefaultSender()&&(_nCurrentId=_oTypeMail[i]),_oItems.push({sId:_oTypeMail[i],sItemValue:_oItemTmpl.replace({images_path:getPath("image"),display:"none",email:limitString(_oMail.email,38),id:_oTypeMail[i]})});var _nEmailDispLen=getStrDispLen(_oMail.email)+72;_nWidth<_nEmailDispLen&&(_nWidth=_nEmailDispLen)}}var _oAjaxObj=new QMAjax,_fDoItemClick=function(_asId){getUserInfoText("addr")!=_oAllMail[_asId].email?(_oAjaxObj.abort(),_oAjaxObj.method="GET",_oAjaxObj.url=T("/cgi-bin/setting4?sid=$sid$&nosetnick=1&Fun=submit&showdefaultemailfrom=$email$&t=setting4_userinfo&r=$r$").replace({sid:getSid(),email:encodeURI(_oAllMail[_asId].email),r:Math.random()}),_oAjaxObj.onComplete=function(_aoXmlObj){try{eval(_aoXmlObj.responseText)}catch(_oError){return void _errorHandle()}if(!setting4_userinfo||!setting4_userinfo.email||setting4_userinfo.skin<0)_errorHandle();else{showInfo("The default sending account has been switched");var _nSkinId=setting4_userinfo.skin,_sEmail=setting4_userinfo.email,_sLogoUrl=setting4_userinfo.logo,_sHref=getMainWin().location.href;if(setUserInfo("addr",_sEmail),setDefaultSender(_sEmail),changeStyle(_nSkinId,_sLogoUrl),clearCache(["css",getPath("style"),"skin"]),getTop().goUserInfo.reset(),0<=_sHref.indexOf("/cgi-bin/setting4")||0<=_sHref.indexOf("/cgi-bin/setting5"))setTimeout(function(){reloadFrm(getMainWin())},500);else if(0<=_sHref.indexOf("/cgi-bin/today")&&!getUserInfoText("alias")){var _oAlias=S("today_alias",getMainWin());_oAlias&&(_oAlias.innerHTML=_sEmail)}else if(_sHref.indexOf("cgi-bin/readmail")<0&&_sHref.indexOf("cgi-bin/mail_list")<0){var _oTmpComposeGlobal=getMainWin().goCompose;_oTmpComposeGlobal&&_oTmpComposeGlobal.oQmSender&&_oTmpComposeGlobal.oQmSender.setSenderSelected(_sEmail)}_nCurrentId=_asId;var _oSendMailNameInput=S("sendmailname",getMainWin());_oSendMailNameInput&&(_oSendMailNameInput.value=_sEmail)}},_oAjaxObj.onError=_errorHandle,_oAjaxObj.send()):showInfo("The default sending account has been switched")};1<_nAllMailLen&&(_oUserAddrArrowObj.style.display="",_oUserAddrArrowObj.parentNode.onclick=function(){var e=calcPos(_oUserAddrObj.parentNode);show(new(getTop().QMMenu)({sId:"changeskinmenu",oEmbedWin:getTop(),nX:e[3],nY:e[2],nWidth:_nWidth,nItemHeight:21,oItems:_oItems,onitemclick:_fDoItemClick,onload:function(){var e=this;this.S("userIdMgr").onclick=function(){goUrlMainFrm(T("/cgi-bin/setting4?fun=list&acc=1&sid=$sid$").replace({sid:getSid()})),e.close()}}}).S("img_"+_nCurrentId),1)})}function detectMeetingAssistDlg(){getTop().meetingAssistantDetectId&&clearInterval(getTop().meetingAssistantDetectId);var e=Math.random();getTop().getMainWin().meetingAssistantId=e,getTop().meetingAssistantDetectId=setInterval(function(){getTop().getMainWin().meetingAssistantId!=e&&(getTop().CN("meeting_assistant_dlg")&&getTop().CN("meeting_assistant_dlg")[0]&&(getTop().CN("meeting_assistant_dlg")[0].remove(),getTop().S("qqmail_mask").style.display="none"),clearInterval(getTop().meetingAssistantDetectId))},1e3)}function getPhotoCGI(e){var t=e||{};return t.uploadcgi?[location.protocol,"//",location.host,"/cgi-bin/",t.uploadcgi,"?uin=",getTop().getCookie("biz_username"),"&sid=",getTop().getSid(),"&t=upload"].join(""):-1!=window.location.hostname.indexOf("exmail.qq.com")?[getTop().QMDistributeDomain.getHost(),"/cgi-bin/upload?uin=",getTop().getCookie("biz_username"),"&sid=",getTop().getSid()].join(""):[location.protocol,"//",location.host,"/cgi-bin/upload?uin=",getTop().getCookie("biz_username"),"&sid=",getTop().getSid()].join("")}function getCookieMutiName(){var e=arguments.callee;return e._oCookieMutiName||(e._oCookieMutiName={sid:1,username:1,foxacc:1,reloadurl:1,reloadurl:1,m3gmsid:1,mcookie:1,msid:1,defaultf:1,qm_flag:1,QFRIENDUNREADCNT:1,RSSUNREADCNT:1,rss_domain:1,qqmail_activated:1,qqmail_alias_default:1,qqmail_from:1,wimrefreshrun:1,"new":1,qm_sk:1,qm_ssum:1,qq2self_sid:1,exstype:1,lockurl:1,new_mail_num:1})}function setUserCookie(e,t,i,n,a,o){if(1!=getCookieMutiName()[e])return setCookie(e,t,i,n,a,o);for(var r=getCookie(e),s=r?r.split("|"):[],l=getUin(),d=l+"&"+t,c=!0,p=0;p<s.length;p++)s[p].match(l)&&(s[p]=d,c=!1);return r=s.join("|"),c&&(r+=(""==r?"":"|")+d),setCookie(e,r,i,n,a,o)}function getUserCookie(e){var t=getCookie(e);if(1!=getCookieMutiName()[e])return t;for(var i=t?t.split("|"):[],n=getUin(),a=0;a<i.length;a++)if(i[a].match(n))return i[a].split("&")[1]||i[a];return t}function deleteUserCookie(e,t,i){deleteCookie(e,t,i)}function setUserCookieFlag(e,t,i,n){return setCookieFlag(e,t,i,n)}function getUserCookieFlag(e){return getCookieFlag(e)}function getReaderData(e){if(window!=getTop())getTop().getReaderData(e);else{var t=arguments.callee;removeSelf(t.jsObj),t.jsObj=loadJsFile(e+"&r="+Math.random(),!1,document)}}function getReaderDataInterval(e,t){if(window!=getTop())return getTop().getReaderDataInterval(e,t);var i=arguments.callee,n=(window.gsRssDomain||"")+"/cgi-bin/reader_data2?sid="+getSid()+"&t=rss_data.js";function a(){getReaderData(n)}i.nTimer&&clearInterval(i.nTimer),i.nTimer=setInterval(a,t||1e3*window.gnRssInterval||6e5),a()}Scale=function(){var l=1,d=l,i="normal",n="",a=!0,c=null,p=null,o=function(e,t){1<t?1.1==t?(addClass(e,"scale1_10"),rmClass(e,"scale1_25")):(addClass(e,"scale1_25"),rmClass(e,"scale1_10")):(rmClass(e,"scale1_25"),rmClass(e,"scale1_10"))},u=function(e,t){gbIsIE?e.style.zoom=t:gbIsFF||(e.style.WebkitTransformOrigin=e.style.MozTransformOrigin=e.style.OTransformOrigin=e.style.TransformOrigin="0 0",e.style.WebkitTransform=e.style.MozTransform=e.style.OTransform=e.style.Transform="scale("+t+")"),o(p,t),o(getMainWin().document.body,t)},r=function(){var e=c.clientHeight,t=c.clientWidth,i=S("qqbrowser_pop",getTop())?S("qqbrowser_pop",getTop()).offsetHeight:0;if(d=l,t<1060&&1<d?d=1:t<1250&&1.1<d&&(d=1.1),e<595&&1<d?d=1:e<640&&1.1<d&&(d=1.1),u(p,d),S("resize").style.width=c.clientWidth/d+"px",S("resize").style.height=c.clientHeight/d-i+"px",gnIEDocTypeVer&&gnIEDocTypeVer<8&&gnIEVer<9){debug("ie6 resize");var n=S("mainFrame"),a=S("folder"),o=S("leftPanel"),r=finds(".bodybgbt",window)[0],s=getTop().document.body.offsetHeight;n&&(-1<document.location.href.indexOf("t=newwin_frame")?n.style.height=s+"px":n.style.height=s-77-i+"px",o&&(o.style.height=s-77-i+"px"),r&&(r.style.height=s-77-i+"px"),a&&(a.style.height=s-197-i+"px"),resizeFolderList())}},t=function(){var e=getMainWin(),t=c.clientWidth;a&&t<=650?(d=t/650,"normal"==i&&(i="scale",n=p.style.cssText,S("resize").style.width="100%",S("resize").style.height="100%"),8==gnIEDocTypeVer?(p.style.width=t/d/d+"px",p.style.height=c.clientHeight/d/d+"px"):(p.style.width=t/d+"px",p.style.height=c.clientHeight/d+"px"),u(p,d)):("scale"==i&&(i="normal",p.style.cssText=n),r()),1==e.bSettingDisplay&&(d==l||d<1?e.NormalViewText&&e.NormalViewText():e.StressViewText&&e.StressViewText(1==d?0:1.1==d?1:2))},s=function(e){return 8!=gnIEDocTypeVer?e:e/d},g=calcPos;return window.calcPos=function(e,t){return g(e,t,s,s)},{useMini:function(e){a=!!e},getScale:function(){return d},getSizeMode:function(){switch(d){case 1:return 0;case 1.1:return 1;case 1.25:return 2}},fixFrameCursorPos:function(e){return gbIsIE?e/d:e},fixCursorPos:function(e,t){return e/d},fixOffsetLeft:function(e){return gbIsIE?e/d:e},fixOffsetTop:function(e){return gbIsIE?e/d:e},fixBodyWidth:function(e){return 8==gnIEDocTypeVer?e/d:7==gnIEDocTypeVer?e:e/d},fixBodyHeight:function(e){return e/d},resize:function(e){l=e?1==e?1.1:1.25:1,t()},initResizeScale:function(){p=document.body,c=document.documentElement,gbIsIE?(p.style.position="relative",6==gnIEVer&&(this.getContainer().style.overflow="hidden")):p.style.height="auto",c.style.overflow="hidden",addEvent(window,"resize",function(){t()})},getContainer:function(){return getTop().S("resize")||getTop().document.body},setBodyClass:function(e){o(e.document.body,d)}}}();var QMFullTextSearch={};function changeStatus(e){var t=S("searchIcon");t&&setClass(t,e?"ss_icon ss_fronticon ss_icon_loading":"ss_icon ss_fronticon ss_icon_search")}function doSearch(){return QMPageInit._runFuncAfterCheckMainFrame(function(){var e=S("frmSearch");e.sender.value=e.subject.value,e.receiver.value=e.subject.value,e.keyword.value=e.subject.value,e.combinetype.value="or",submitToActionFrm(e)}),!1}function audioPlay(t){var i=getTop();t.container||(t.container=S("mp3player_container",i.getMainWin())),t.global&&!t.globalcontainer&&(t.globalcontainer=S("gplayer_container",i)),i.QMPlayer||loadJsFileToTop(getPath("js"),[getFullResSuffix("qmplayer.js")]),waitFor(function(){return!!i.QMPlayer},function(e){e?i.QMPlayer.createInstance(t):t.container&&(t.container.innerHTML="Player failed to load")})}function audioStop(){var e=getTop().QMPlayer;e&&e.stop()}function setPlayer(e){var n=getTop();return n.QMPlayer||loadJsFile(getPath("js")+getFullResSuffix("qmplayer.js"),!0,n.document),function a(e){if(!n.QMPlayer)return setTimeout(function(){a(e)},200),!1;var t="qqmailMediaPlayer"+(e.id||""),i=e.win||window;return!(!i||i[t])&&!(!e.container&&!(e.container=S("mp3player_container",i)))&&(i[t]=new n.QMPlayer).setup(e)}(e)}function playUrl(e){var t=(e.win||window)["qqmailMediaPlayer"+(e.id||"")];t?t.openUrl(e.url,e.dispInfo):setPlayer(e)}function stopUrl(e){e||(e={});try{(e.win||window)["qqmailMediaPlayer"+(e.id||"")].stop()}catch(t){}}function searchMusic(e,t,d){if(window!=getTop())return getTop().searchMusic(e,t,d);e=e||"",t=t||"";var c=arguments.callee,p=[e,t].join("@");return c.fCallBack=function(e){var t,i=[];if(!e.contentWindow.gMusicInfo||!(t=e.contentWindow.gMusicInfo.list))return d(i);for(var n=0,a=t.length;n<a;n++)for(var o={song:t[n].songname.replace(/<\/?strong>/gi,""),singer:t[n].singername.replace(/<\/?strong>/gi,"")},r=htmlDecode(t[n].songurl).replace(/\|/g,"").split(";"),s=0,l=r.length;s<l;s+=2)if(r[s]&&-1==r[s].indexOf("qqmusic.qq.com")){o.url=r[s].replace(/^(FI|SI|AN|QQ)/,""),i.push(o);break}c._oDataMap[p]=i,d(i)},e||t?(c._oDataMap||(c._oDataMap={}),c._oDataMap[p]?d(c._oDataMap[p]):void(c._oDataDomObj=createBlankIframe(getTop(),{id:"getMusicUrlFromSoSo",style:"display:none;",header:T(["<script>","function searchJsonCallback(a)","{","window.gMusicInfo = a;","}","<\/script>",'<script src="$domain$/fcgi-bin/fcg_search_xmldata.q?w=$song$%20$singer$&source=3&r=$rand$"><\/script>']).replace({domain:"https:"==location.protocol?"https://ptlogin2.mail.qq.com":"http://cgi.music.soso.com",song:encodeURI(e),singer:encodeURI(t),rand:Math.random()}),destroy:!0,onload:function(e){searchMusic.fCallBack(this)}}))):d([])}function getMusicUrl(a,o,r){searchMusic(a,o,function(e){if(0<e.length){for(var t=0,i=/\.mp3$/i,n=0;(gbIsMac||gbIsLinux)&&n<e.length;n++)if(i.test(e[n].url)){t=n;break}debug(e[t].url),r(e[t].song,e[t].singer,e[t].url,e)}else r(a,o,"",e)},1)}function startWebpush(t){var i=getTop();i.QMWebpushTip&&i.QMWebpush||(i.loadCssFile(getPath("css")+i.getFullResSuffix("webpushtip.css"),!0),i.loadJsFileToTop(getPath("js"),[i.getFullResSuffix("qmwebpush.js"),i.getFullResSuffix("qmwebpushtip.js")])),waitFor(function(){return i.QMWebpushTip},function(e){e&&i.QMWebpushTip.open(t)},1e3,3e4)}function closeWebpush(e){getTop().QMWebpushTip&&getTop().QMWebpushTip.close(e,!0)}function ftSendStatic(e,t){e&&ossLog("realtime","all",T("stat=exskick&sid=$sid$&uin=$uin$&log=$code$").replace({uin:t||getTop().g_uin,sid:getSid(),code:e}))}!function(){if(window==getTop()){function a(){var e=S("subject"),t=T('<div unselectable="on" class="ss_drop_item"><a href="javascript:;" unselectable="on"><span unselectable="on" class="ss_icon ss_icon_mail"></span>contain<b unselectable="on">$keyword$</b>s mail </a></div>'),i=T('<div unselectable="on" class="ss_drop_item"><a href="javascript:;"\t\t\t\tunselectable="on"><span class="ss_icon ss_icon_note" unselectable="on"></span>contain<b unselectable="on">$keyword$</b>\'S note</a></div>'),n='<div class="ss_drop_item ss_drop_split" unselectable="on"><a unselectable="on" href="javascript:;">Advanced search.</a></div>',a=trim(e.value);if(""==a)return"";return a=13<a.length?a.substring(0,13)+"...":a,"1"!=attr(e,"fullsearch")?"999"==attr(e,"fullsearch")?[{sId:"searchInMail",sItemValue:t.replace({keyword:htmlEncode(a)})}]:[{sId:"searchInMail",sItemValue:t.replace({keyword:htmlEncode(a)})},{sId:"advanceSearch",sItemValue:n}]:[{sId:"searchInMail",sItemValue:t.replace({keyword:htmlEncode(a)})},{sId:"searchInNotes",sItemValue:i.replace({keyword:htmlEncode(a)})},{sId:"advanceSearch",sItemValue:n}]}QMFullTextSearch._TIP_FULL_TEXT="Full-text email search.",QMFullTextSearch._TIP_NORMAL_TEXT="Email search.",QMFullTextSearch.search=function(e){var t=S("subject"),i=function(e,t,i){if(t.document.getElementsByClassName)return t.document.getElementsByClassName(e);t=t.document;var n=[],a="*"==(i=i||"*")&&t.all?t.all:t.getElementsByTagName(i),o=a.length;e=e.replace(/\-/g,"\\-");for(var r=new RegExp("(^|\\s)"+e+"(\\s|$)");0<=--o;)r.test(a[o].className)&&n.push(a[o]);return n}("fn",getTop(),"li")[0],n="all";i&&(n=i.getAttribute("dr"));var a={sid:getSid(),searchmode:e||"",folderid:"gmnormal"==e?"8":"all",stat:"attach"==e?"8":"6"},o={};changeStatus(1),a.subject=a.sender=a.receiver="true"==t.getAttribute("focus")&&htmlEncode(encodeURI(trim(t.value))),o="note"==e?T(["/cgi-bin/note_list?sid=$sid$&s=search&keyword=$subject$"]):"1"==attr(t,"fullsearch")?T(["/cgi-bin/mail_list?sid=$sid$&s=search&folderid=$folderid$&page=0&subject=$subject$&sender=$sender$","&receiver=$receiver$&searchmode=$searchmode$&topmails=0&advancesearch=0&loc=frame_html,,,$stat$"]):"999"==attr(t,"fullsearch")?T(["/cgi-bin/archive_maillist?sid=$sid$&s=search&folderid="+n+"&page=0&keyword=$subject$&sender=$sender$","&receiver=$receiver$&topmails=0&advancesearch=3&combinetype=or&loc=frame_html,,,7"]):T(["/cgi-bin/mail_list?sid=$sid$&s=search&folderid=$folderid$&page=0&keyword=$subject$&sender=$sender$","&receiver=$receiver$&topmails=0&advancesearch=3&combinetype=or&loc=frame_html,,,7"]),QMPageInit._runFuncAfterCheckMainFrame(function(){goUrlMainFrm(o.replace(a),!1)})},QMFullTextSearch._onevent=function(n){return function(){var e=S("subject"),t="1"==attr(e,"fullsearch")?QMFullTextSearch._TIP_FULL_TEXT:QMFullTextSearch._TIP_NORMAL_TEXT;"999"==attr(e,"fullsearch")&&(t="Search by subject or recipient/sender...");var i=S("subjectsearchLogo");_oValue={focus:["true"!=e.getAttribute("focus"),"","","true"],blur:[""==e.value,t,"#a0a0a0","false"]}[n],_oValue[0]&&(e.value=_oValue[1],e.style.color=_oValue[2],e.setAttribute("focus",_oValue[3])),"focus"==n&&""!=e.value&&QMFullTextSearch.QMAuto.show(a()),i&&setClass(i,"focus"==n?"ss_icon ss_endicon ss_icon_return":"ss_icon ss_endicon ss_icon_arrowdown")}},QMFullTextSearch.onkeydown=function(e){e.keyCode},waitFor(function(){return getTop().QMAutoComplete},function(e){e&&!function t(){var e=S("subject");e&&(QMFullTextSearch.QMAuto=new QMAutoComplete({oInput:e,oPosObj:S("smartSearch"),nWidth:280,oClass:{classnormal:"ss_drop_item_wrap",classhigh:"ss_drop_item_wrap_hover"},ongetdata:function(e,t,i){var n=a();return i&&i(n),n},onselect:function(e){"searchInMail"==e.sId?QMFullTextSearch.search():"searchInAttach"==e.sId?QMFullTextSearch.search("attach"):"searchInGroupMail"==e.sId?QMFullTextSearch.search("gmnormal"):"searchInNotes"==e.sId?QMFullTextSearch.search("note"):showAdvanceSearchDialog()}}))}()},1e3,3e4),QMFullTextSearch.onfocus=QMFullTextSearch._onevent("focus"),QMFullTextSearch.onblur=QMFullTextSearch._onevent("blur")}}();var QMXfDownload=function(){this._mnXfStatus=0,this._mnVer=""};QMXfDownload.prototype.init=function(){var e,t=null;try{t=new ActiveXObject("QQIEHelper.QQRightClick.2")}catch(i){return debug("x:"+i.message),void(this._mnXfStatus=1)}this._mnVer=e=parseInt(t.GetVersion().split(".").pop()),this._mnXfStatus=65<e?3:2,delete t},QMXfDownload.prototype.getStatus=function(){return this._mnXfStatus},QMXfDownload.prototype.dl=function(e,t){if(t=t||"",2<this._mnXfStatus){var i=new ActiveXObject("QQIEHelper.QQRightClick.2"),n=this._mnVer;127<=n?i.SendUrl2(e,location.href,t,document.cookie,0,10500):65<n&&i.SendUrl(e,location.href,t,document.cookie),delete i}};var QMdlRespXml=function(e){var t=e&&e.responseText,i=t?t.split("|"):["error","DEF_ERR"];this._msErrorCode=null,this._msKey=null,this._msDownLoadUrl=null,"error"!=i[0]&&0==i[0].indexOf("http://")?(this._msDownLoadUrl=i[0].replace(/#/g,"_"),this._msKey=i[1]):this._msErrorCode=QMdlRespXml._TEMPLATE[i[1]]?i[1]:"DEF_ERR"};QMdlRespXml._TEMPLATE={"-102":"The file has been deleted by the file owner.","-1":"unknown mistake","-201":"File download limit reached, unable to download",DEF_ERR:"Failed to obtain download address"},QMdlRespXml.prototype.getError=function(){return this._msErrorCode},QMdlRespXml.prototype.getErrorMsg=function(){return QMdlRespXml._TEMPLATE[this._msErrorCode]},QMdlRespXml.prototype.getKey=function(){return this._msKey},QMdlRespXml.prototype.getUrl=function(){return setCookie("qm_ftn_key",this._msKey,new Date((new Date).valueOf()+36e5),"/","qq.com"),this._msDownLoadUrl};var QMFtnRen=function(){this._moConfig=null};function twoDCodeImgUrl(e){var t=location.getParams(e);return TE(["/cgi-bin/generate_twodimcode?out=250&sid=$@$eval getSid()$@$","$@$if($mailid$)$@$","&filename=$@$eval escape($filename$)$@$&mailid=$mailid$","$@$else if($att$)$@$","&att=$att$&action=groupattach","$@$else if($k$)$@$","&k=$k$&code=$code$&action=bigattach","$@$endif$@$"]).replace(t)}function showTwoDCodeImgMenu(e,t,i,n){var a,o=e.document,r=calcPos(t),s=r[2]-40;0<(a=s+320-bodyScroll(o,"scrollTop")-bodyScroll(o,"clientHeight"))&&(s-=10+a),new QMMenu({oEmbedWin:e,sId:"scanImg",nArrowPos:r[0]-s-5,bAutoClose:!1,sWidthDetect:"float",nArrowDirection:"Left",nWidth:"auto",nX:r[3]+25,nY:s,onshow:function(){6==gnIEVer&&(this.S("twodcode").src=this.S("twodcode").src)},oItems:[{bDisSelect:!0,sStyle:"padding:0;",nHeight:"auto",sItemValue:T(['<div style="width:300px;height:310px;padding-top:10px;">','<div style="text-align:center;">','<img id="twodcode" style="width:250px;height:250px;" src="$src$"/>',"</div>",'<div style="margin-top:-5px;">','<p style="margin:0;text-align:center;padding:5px 0;">Scan the QR code to download the attachment to the phone.</p>','<p style="margin:0;text-align:center;padding:5px 0;">(the QR code is valid for 5 minutes)</p>',"</div>","</div>"]).replace({filename:i,src:twoDCodeImgUrl(n)})}]})}function vipModuleHtml(){for(var e=["project","vip","com"],t="https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_vip_yes.png",i=[["Mailbox Capacity","Unlimited","1G"],["Confidential mail",1,0],["Notice",1,0],["Custom Broadcast",1,0],["Attachment search",1,0],["Mail translation","Chinese and English; multi-language and real-time translation for Foxmail","Chinese and English; multi-language for Foxmail"],["Mail archive",1,0],["Mail backup",1,0],["Mail transfer",1,0],["Mail review",1,"Only some functions are available"],["Sending restrictions",1,"Only some functions are available"],["IP Restrictions",1,"Only some functions are available"],["Outbound restrictions",1,"Only some functions are available"]],n=[],a=0;a<i.length;a++){for(var o={},r=0;r<e.length;r++)o[e[r]]=i[a][r];o.style=a%2==0?2:1,n.push(o)}return getTop().TE(['<table style="border-spacing: 2px 0;border-collapse: separate;">',"<thead>","<tr>",'<td style="width:18%;text-align: right;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background-color: #F6F7FA;color: #384049;"> account</td>','<td style="width: 300px;text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background: #E5CA92;background: linear-gradient(to right, #E9CB8B,#C2A370);color: #754F00;">VIP Account</td>','<td style="width: 41%;text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background-color: #F6F7FA;color: #384049;">Basic Account</td>',"</tr>","</thead>","<tbody>","$@$for($items$)$@$","<tr>",'<td style="text-align: right;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #384049;',"$@$if($style$==1)$@$","background-color: #F6F7FA;","$@$else$@$","background-color: #FCFCFE;","$@$endif$@$",'">$project$</td>','<td style="text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #754F00;',"$@$if($style$==1)$@$","background-color: #F3EEE4;","$@$else$@$","background-color: #FBFAF6;","$@$endif$@$",'">',"$@$if($vip$==1)$@$",'<span style="display: inline-block;float: left;background-image: url(',t,');width: 14px;height: 10px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else if($vip$==0)$@$",'<span style="display: inline-block;float: left;background-image: url(',"https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_vip_no.png",');width: 10px;height: 11px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else$@$","$vip$","$@$endif$@$","</td>",'<td style="text-align: left;font-family: Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #384049;',"$@$if($style$==1)$@$","background-color: #F6F7FA;","$@$else$@$","background-color: #FCFCFE;","$@$endif$@$",'">',"$@$if($com$==1)$@$",'<span style="display: inline-block;float: left;background-image: url(',t,');width: 14px;height: 10px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else if($com$==0)$@$",'<span style="display: inline-block;float: left;background-image: url(',"https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_com_no.png",');width: 10px;height: 11px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else$@$","$com$","$@$endif$@$","</td>","</tr>","$@$endfor$@$","</tbody>","</table>"]).replace({items:n})}function versionModuleHtml(){for(var e=["project","vip","com","base"],t="https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_vip_yes.png",i="https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_vip_no.png",n=[[" account","VIP Account","Normal Account (Available to Upgrade to VIP Account)","Basic account for all employees"],["Mailbox Capacity","Unlimited","1G","1G"],["Confidential mail",1,0,0],["Notice",1,0,0],["Attachment search",1,0,0],["Mail translation","Chinese and English; multi-language and real-time translation for Foxmail","Chinese and English; multi-language for Foxmail","Chinese and English; multi-language for Foxmail"],["Mail backup",1,0,0],["Mail transfer",1,0,0],["Mail review",1,"Only some functions are available",0],["Sending restrictions",1,"Only some functions are available",0],["IP Restrictions",1,"Only some functions are available",0],["Outbound restrictions",1,"Only some functions are available",0],["Mail withdrawal","Emails sent in the last 15 days can be recalled.","Emails sent in the last 24 hours can be recalled.","Emails sent in the last 24 hours can be recalled."]],a=[],o=0;o<n.length;o++){for(var r={},s=0;s<e.length;s++)r[e[s]]=n[o][s];r.style=o%2==0?2:1,a.push(r)}return getTop().TE(['<table style="border-spacing: 2px 0;border-collapse: separate;">',"<thead>","<tr>",'<td style="width:17%;text-align: right;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background-color: #F6F7FA;color: #384049;">version</td>','<td colspan="2" style="width: 63%;text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background: #E5CA92;background: linear-gradient(to right, #E9CB8B,#C2A370);color: #754F00;">Professional Edition</td>','<td style="width: 20%;text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 14px;line-height: 20px;padding: 8px 20px;background-color: #F6F7FA;color: #384049;">Basic Edition</td>',"</tr>","</thead>","<tbody>","$@$for($items$)$@$","<tr>",'<td style="text-align: right;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #384049;',"$@$if($style$==1)$@$","background-color: #F6F7FA;","$@$else$@$","background-color: #FCFCFE;","$@$endif$@$",'">$project$</td>','<td style="text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #754F00;',"$@$if($style$==1)$@$","background-color: #F3EEE4;","$@$else$@$","background-color: #FBFAF6;","$@$endif$@$",'">',"$@$if($vip$==1)$@$",'<span style="display: inline-block;float: left;background-image: url(',t,');width: 14px;height: 10px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else if($vip$==0)$@$",'<span style="display: inline-block;float: left;background-image: url(',i,');width: 10px;height: 11px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else$@$","$vip$","$@$endif$@$","</td>",'<td style="text-align: left;font-family: PingFangSC-Medium, Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #754F00;',"$@$if($style$==1)$@$","background-color: #F3EEE4;","$@$else$@$","background-color: #FBFAF6;","$@$endif$@$",'">',"$@$if($com$==1)$@$",'<span style="display: inline-block;float: left;background-image: url(',t,');width: 14px;height: 10px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else if($com$==0)$@$",'<span style="display: inline-block;float: left;background-image: url(',i,');width: 10px;height: 11px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else$@$","$com$","$@$endif$@$","</td>",'<td style="text-align: left;font-family: Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,sans-serif;font-size: 12px;line-height: 20px;padding: 8px 20px;color: #384049;',"$@$if($style$==1)$@$","background-color: #F6F7FA;","$@$else$@$","background-color: #FCFCFE;","$@$endif$@$",'">',"$@$if($base$==1)$@$",'<span style="display: inline-block;float: left;background-image: url(',t,');width: 14px;height: 10px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else if($base$==0)$@$",'<span style="display: inline-block;float: left;background-image: url(',"https://rescdn.qqmail.com/node/wwqy/qymng/style/images/sass/independent/icon_biz_com_no.png",');width: 10px;height: 11px;background-size: 100%;margin-top: 5px;margin-bottom: 5px;"></span>',"$@$else$@$","$base$","$@$endif$@$","</td>","</tr>","$@$endfor$@$","</tbody>","</table>"]).replace({items:a})}function getUrlParam(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);if(null==i)return null;if(/^[\u4e00-\u9fa5]+$/.test(decodeURIComponent(i[2])))return i[2];var n=document.createElement("div");return n.innerText=i[2],n.innerHTML}function ckDns(e){E(e,function(e,t){(new Image).src=["http://",e,"/zh_CN/htmledition/images/spacer.gif"].join("")})}function beginStatTime(e){var t=parseInt(e.location.hash.split("stattime=").pop());!isNaN(t)&&13==t.toString().length&&t>(getTop().gnStatTimeStamp||0)&&(e.gnBeginTime=getTop().gnStatTimeStamp=t,e.gnStatTimeStart=now())}function endStatTime(e,t){var i=e.gnBeginTime,n=e.gnStatTimeStart,a=now();isNaN(n)||isNaN(i)||addEvent(e,"load",function(){var e=now();ossLog("delay","sample",T(["stat=cgipagespeed&type=$type$&t1=$t1$&t2=$t2$&t3=$t3$","&rcgi=$appname$&rt=$t$&rs=$s$&allt=$allt$&flowid=$wm_flowid$"]).replace(extend(t,{t1:n-i,t2:a-n,t3:e-a,allt:[i,n,a,e].join("|")})))})}function ossLog(){var e=getTop().ossLog;return e._ossLog.apply(e,arguments)}function LogKvEx(e){var t=getTop().extend({type:"session_statistics"},e);return!(!t.businame||!t.item)&&(!!("session_statistics"!=t.type&&"session_str_statistics"!=t.type||t.sid)&&void((new Image).src="/cgi-bin/sellonlinestatic?type="+t.type+"&businame="+t.businame+"&item="+t.item+"&r="+Math.random()+(t.sid?"&sid="+t.sid:"")))}function LogKvNode(e){var t=getTop().extend({uin:getTop().getUin(),value:1},e);if(!t.type||!t.itemName)return!1;(new Image).src="/qy_mng_logic/reportKV?type="+t.type+"&itemName="+t.itemName+"&uin="+t.uin+"&value="+t.value}function isdLog(e,t,i){var n=T([window.location.protocol,"//isdspeed.qq.com/cgi-bin/r.cgi?flag1=6000&flag2=101&flag3=$flag$&$key$=$value$&r=$r$"]),a=new Image;setTimeout(function(){a.src=n.replace({flag:e,key:t,value:i||"1",r:Math.random()})})}function detectversiontwi(){(new Date).getTime()}function detectversiontwitest(){(new Date).getTime()}function detectversiontwitest2(){(new Date).getTime()}function all_js(){}function hideEditorMenu(){getTop().QMEditor&&getTop().QMEditor.hideEditorMenu()}function OprMouseDown(e){hideMenuEvent(e),getTop().OprATagForDistributeDomain(e),hideCalendar(e)}function hideCalendar(e){getTop()._oCalendar&&(getTop().removeSelf(getTop()._oCalendar.calendar),getTop()._oCalendar=null)}function hideMenuEvent(e){var t=getEventTarget(e),i=getTop().QMMenu&&getTop().QMMenu();for(var n in i)!i[n].isContain(t)&&i[n].close()}function confirmBox(r){var s=2,l=r.defaultChecked||!1,e=r.confirmBtnTxt||"OK",t=r.cancelBtnTxt||"cancel",i=r.neverBtnTxt;_sFootTipsText=r.footTipsText||"",new(getTop().QMDialog)({bAlignCenter:r.bAlignCenter,sId:r.id||"QMconfirm",sTitle:r.title||"confirm",sBodyHtml:TE(['<div class="$sStyle$" style="$sCustomStyle$">','$@$if($sType$=="custom")$@$',"$msg$","$@$else$@$",'<div class="cnfx_content">','<span class="dialog_icon $icon$"></span>','<div class="dialog_f_c">$msg$</div>',"</div>",'<div class="cnfx_status" style="display:$statusdisp$;">','<input id="recordstatus" class="cnfx_status_checkbox" type="checkbox" $checked$/><label for="recordstatus">$recordinfo$</label>',"</div>","$@$endif$@$","</div>"]).replace({sStyle:r.style||"",sType:r.sType||"",sCustomStyle:r.sCustomStyle||"",msg:r.msg,caceldisp:"alert"==r.mode?"none":"",imgdisp:"prompt"==r.mode?"none":"block",recordinfo:r.recordInfo,statusdisp:r.enableRecord?"":"none",checked:r.defaultChecked?"checked":"",confrim:e,confirmcss:5<getAsiiStrLen(e)?"":"wd2",cancel:t,cancelcss:5<getAsiiStrLen(t)?"":"wd2",never:i,neverdisp:i?"":"none",nevercss:5<getAsiiStrLen(i)?"":"wd2",icon:r.icon||"icon_info_b"}),sFootHtml:TE(['<div class=" txt_right cnfx_btn">',"$@$if($footTipsText$)$@$",'<span class="gray_info_icon" style="float: left;margin-top: 5px;"></span>','<span style="float: left;margin-left: 8px;font-size: 12px;color: #787878">$footTipsText$</span>',"$@$endif$@$",'<input class="btn_blue btn_input" type="button" id="confirm" value="$confirm$" />','<input class="btn_gray btn_input" type="button" id="cancel" style="display:$caceldisp$;" value="$cancel$" />','<input class="btn_gray btn_input" type="button" id="never" style="display:$neverdisp$;" value="$never$" />',"</div>"]).replace({caceldisp:"alert"==r.mode?"none":"",confirm:e,confirmcss:5<getAsiiStrLen(e)?"":"wd2",cancel:t,cancelcss:5<getAsiiStrLen(t)?"":"wd2",never:i,neverdisp:i?"":"none",nevercss:5<getAsiiStrLen(i)?"":"wd2",footTipsText:_sFootTipsText}),nWidth:r.width,nHeight:r.height,onload:function(){var n=this,a=n.S("confirm"),e=n.S("cancel"),o=n.S("never");addEvents([a,e,o],{click:function(e){var t=getEventTarget(e);if(t==a?(n.S("recordstatus")&&(l=n.S("recordstatus").checked),s=1):t==o&&(s=3),t==a&&n.S("folder_needValid"))try{callBack.call(n,r.onreturn,[1==s,l,s])&&n.close()}catch(i){}else n.close()}}),callBack.call(n,r.onload)},onshow:function(){gbIsMac||this.S("confirm").focus(),callBack.call(this,r.onshow)},onclose:function(){callBack.call(this,r.onclose)},onbeforeclose:function(){try{this.S("folder_needValid")||callBack.call(this,r.onreturn,[1==s,l,s])}catch(e){}return!0}})}function alertBox(e){confirmBox(extend({mode:"alert"},e))}function promptBox(o){var i=!1,n=o.onreturn;getTop().userFolderTree=getTop().userFolderTree||[],0<getTop().userFolderTree.children.length&&o.isSelect&&1==o.isSelect?(o.onreturn=function(e){var t=this;return callBack.call(t,n,[i||e,t.S("txt").value,"undefined"==t.S("folderid").value?0:t.S("folderid").value,t])},o.msg=T(['<div class="dialog_select_input_wrap txt_left">','<div style="font-weight:bold;float:left;margin-right:10px;margin-bottom:8px;">$msg$</div>','<div id="folder_needValid" class="f_size red"></div>','<div style="clear:both;"><input type="text" id="txt" class="dialog_input" value="$defaultValue$"/></div>','<input type="hidden" id="folderid" value="0"/>',"</div>",'<div class="dialog_select_wrap txt_left">','<p style="margin-left:20px;font-weight:bold;">$msgselect$</p>','<div class="selectContainer popFolderTree">','<ul class="fdul" id="selectContainer" style="overflow:hidden;">',"</ul>","</div>","</div>"]).replace(o)):0<getTop().userFolderTree.children.length&&o.isRenameFolder&&1==o.isRenameFolder?(o.onreturn=function(e){return callBack.call(this,n,[i||e,this.S("txt").value,0,this])},o.msg=T(['<div class="dialog_input_wrap txt_left">','<div style="float:left;margin-right:10px;margin-bottom:8px;">$msg$</div>','<div id="folder_needValid" class="f_size red"></div>','<div style=""><input type="text" id="txt" class="dialog_input" value="$defaultValue$"/></div>',"</div>"]).replace(o)):(o.onreturn=function(e){callBack.call(this,n,[i||e,this.S("txt").value])},o.msg=T(['<div class="dialog_input_wrap txt_left">',"<p>$msg$</p>",'<div style=""><input type="text" id="txt" class="dialog_input" value="$defaultValue$"/></div>','<div style="" class="f_size addrtitle">$description$</div>',"</div>"]).replace(o)),confirmBox(extend({sType:"custom",height:o.height||null,onload:function(){var t=this;addEvent(t.S("txt"),"focus",function(e){t.S("folder_needValid")&&(t.S("folder_needValid").innerHTML="")}),addEvent(t.S("txt"),"keydown",function(e){t.S("folder_needValid")||13==e.keyCode&&(i=!0,t.close())})},onshow:function(){var r=this;if(r.S("txt").select(),r.S("txt").focus(),0<getTop().userFolderTree.children.length&&r.S("selectContainer")){var s,l,d,e;r.S("selectContainer").innerHTML=getTop().folderTree.renderFolder("Pop",getTop().userFolderTree),addEvent(this._moPanelDom,"click",function(e){for(var t=getEventTarget(e);"BODY"!=t.tagName;){if("LI"==t.tagName&&t.id.match(/folder_.*/)&&10!=t.getAttribute("level")){if(d=t.id.replace("folder_","").replace("_td",""),l=t,s&&l.id!=s.id)try{s.classList.remove("fn"),s.classList.add("fs")}catch(o){0<=s.className.indexOf("fn")&&(s.className=s.className.replace("fn","")),s.className=s.className+" fs"}try{t.classList.remove("fs"),t.classList.add("fn")}catch(o){0<=t.className.indexOf("fs")&&(t.className=t.className.replace("fs","")),t.className=t.className+" fn"}s=l;break}if("LI"==t.tagName&&t.id.match(/folder_.*/)&&10==t.getAttribute("level")){getTop().showError("Up to ten level folders are supported.");break}if("IMG"==t.tagName){var i=t.parentNode.nextElementSibling,n=t;if(t.parentNode.getAttribute("level")&&0==t.parentNode.getAttribute("level")&&(i=t.parentNode.parentNode.nextElementSibling),i&&"LI"!=i.tagName){if(i&&n){var a;setClass(n,(a=!("fd_off"==n.className))?"fd_off":"fd_on"),show(i,a)}}else setClass(n,(a=!("fd_off"==n.className))?"fd_off":"fd_on");break}t=t.parentNode}""!=d&&(r.S("folderid").value=d)}),o.selectedId||(o.selectedId="personal");for(var t=0;t<r.S("selectContainer").getElementsByTagName("li").length;t++)if(r.S("selectContainer").getElementsByTagName("li")[t].id=="folder_"+o.selectedId+"_td"){var i=r.S("selectContainer").getElementsByTagName("li")[t].getAttribute("level");"10"==i?e=r.S("selectContainer").getElementsByTagName("li")[t].parentNode.previousSibling:0<=+i&&+i<=9&&(e=r.S("selectContainer").getElementsByTagName("li")[t]);try{e.click()}catch(a){}try{e.fireEvent("onclick")}catch(a){}try{var n=document.createEvent("Event");n.initEvent("click",!0,!0),e.dispatchEvent(n)}catch(a){}e.scrollIntoView(!0);break}}}},o))}function loadingBox(t){if(callBack(t.oncheck))callBack(t.onload);else{var i=new QMDialog({sId:"LoAdINgBOx",sTitle:t.model+"The module is loading.",nWidth:400,nHeight:"auto",sBodyHtml:T(['<div style="text-align:center;padding:58px;">','<img id="load" src="$images_path$ico_loading2.gif">','<span id="err" style="display:none;">$model$ module failed to load</span>',"</div>"]).replace(extend(t,{images_path:getPath("image")})),onclose:function(){i=null}});if(t.js){var n=[];E("string"==typeof t.js?[t.js]:t.js,function(e){n.push(e)}),loadJsFileToTop(n)}waitFor(function(){return callBack(t.oncheck)},function(e){i&&(e?(i.close(!0),callBack(t.onload)):(show(i.S("load"),!1),show(i.S("err"),!0)))})}}function getQMPluginInfo(e){return gbIsWin&&(gbIsFF&&gsFFVer&&3<=gsFFVer.split(".")[0]&&(0<gsFFVer.split(".")[1]||8<=gsFFVer.split(".")[2]||20090701<=parseInt(navigator.buildID.substr(0,8)))||gbIsChrome&&6<=(""+gsChromeVer).split(".")[0]||gbIsSafari&&gsAgent.indexOf("se 2.x metasr 1.0")<0||gbIsOpera||gbIsQPlus||gbIsQBWebKit&&0<getQMPluginInfo._compareVersion(gsQBVer,"6.5"))||gbIsMac&&0<=getQMPluginInfo._compareVersion(gsMacVer,e)&&(gbIsFF&&3.6<=parseFloat(gsFFVer)||gbIsChrome&&8<=parseFloat(gsChromeVer)||gbIsSafari&&5<=parseFloat(gsSafariVer)||gbIsQBWebKit)}QMFtnRen._TEMPLATE={DLG:T(['<div class="dialog_input_wrap">',"Please enter a new file name:","<div>",'<input id="dlgtxt" type="text" class="dialog_input" value="$name$" />',"</div>","</div>"]),DLG_FOOT:T(['<a id="dlgok" class="btn_blue" href="javascript:;">OK</a>']),MINDLG:T(['<div class="dialog_input_wrap">',"Please enter a new file name:","<div>",'<input id="dlgtxt" type="text" class="dialog_input" value="$name$" style="width:110px;" />&nbsp;','<a id="dlgok" class="btn_blue" href="javascript:;">OK</a>',"</div>","</div>"])},QMFtnRen.prototype.init=function(e){this._moConfig=e||{}},QMFtnRen.prototype.checkFileName=function(e){if(""==trim(e))return showError("File name cannot be empty"),!1;var t='\\ / : * ? " < > |',i=t.split(" ");for(var n in i)if(-1!=e.indexOf(i[n]))return showError("File name cannot contain"+t),!1;return!0},QMFtnRen.prototype.ren=function(a){var o=this;function r(e,t){var i,n=new QMAjax;e!=a.filename?o.checkFileName(e)&&(i=T("sid=$sid$&oper=filealter&bus=$bus$&filename=$filename$&fid=$fid$&t=re_ftnfilefunc&resp_charset=UTF8").replace({sid:getSid(),filename:encodeURIComponent(e),fid:a.fid,bus:a.appid}),n.url="/cgi-bin/ftnTagMgr",n.method="POST",n.onComplete=n.onError=function(e){var t=null;if(e)if(0==e.responseText.indexOf("({"))"0"==(t=evalValue(e.responseText)).error?(showInfo("File renamed successfully"),a.okCallBack()):"-2"==t.error&&showError("The file of the old network disk does not support renaming");else{var i=getActionWin().document;i.open(),i.write(e.responseText),i.close()}},n.send(i),t.close(),"MINDLG"==o._moConfig.skin?showInfo("The file is being renamed."):showProcess(1,!0,"The file is being renamed. Please wait a moment.","",!0)):t.close()}var e=this._moConfig;new(getTop().QMDialog)({sTitle:"File rename",sBodyHtml:QMFtnRen._TEMPLATE[e.skin||"DLG"].replace({name:a.filename||""}),sFootHtml:QMFtnRen._TEMPLATE.DLG_FOOT,nWidth:e.width||null,nHeight:e.height||180,onshow:function(){var e=this.S("dlgtxt"),t=e.value.lastIndexOf(".");if(window.getSelection)e.selectionStart=0,e.selectionEnd=t;else{var i=e.createTextRange();i.moveStart("character",0),i.moveEnd("character",t-e.value.length),i.select()}e.focus()},onload:function(){var n=this;addEvent(n.S("dlgok"),"click",function(){r(n.S("dlgtxt").value,n)}),n.S("dlgtxt").onkeydown=function(e){var t=(n.option("oEmbedWin").event||e).keyCode,i=n.S("dlgtxt").value;13!=t&&9!=t||r(i,n)}}})},ossLog._ossLog=function(e,t,i,n){var a=this,o=e||"realtime",r=a._pasteLog(i),s=a._oLogList||(a._oLogList=[]),l="number"==typeof t?t:{all:1}[t||"all"]||.1;"realtime"==o?a._isSample(l)&&a._doReport(r):(a._isSample(l)&&s.push(["delayurl","=",encodeURIComponent(r)].join("")),1e3<=s.length?a._doReport():!a._nTimer&&0<s.length&&(a._nTimer=setTimeout(a._doReport,5e3)))},ossLog._doReport=function(e){var t=ossLog,i=t._oLogList;(e||0<i.length)&&(QMAjax.send("/cgi-bin/getinvestigate",{method:"POST",timeout:500,content:T("sid=$sid$&$rl$&$ls$").replace({sid:getSid(),rl:e,ls:i.join("&")})}),i.length=0,t._nTimer&&clearTimeout(t._nTimer),t._nTimer=null)},ossLog._isSample=function(e){return(this._nTimeStamp||(this._nTimeStamp=now()))%100<100*e},ossLog._pasteLog=function(e){var i=[];return"string"==typeof e?i.push("&",e):E(e,function(e,t){i.push("&",t,"=",encodeURIComponent(e))}),i.shift()&&i.join("")},function(){var a=getTop();var e=TE(['<div id="mask" class="editor_mask opa50Mask editor_maskAtt" ></div>','<div id="out" style="z-index:1000;position: absolute;width:$width$%;height:$height$%;margin-top:$offsetTop$%;margin-left:$offsetLeft$%;outline:0;" tabindex="-1" hidefocus="hidefocus">','<a id="close" href="javascript:;" title="shut down" style="$@$if($noclose$)$@$display:none$@$endif$@$;position:absolute;right:0;top:16px;width:23px;height:23px;margin:-24px -9px 0 0;background:url($images_path$newicon/login.png) no-repeat 0 0;"></a>','<div id="body" style="width:100%;height:100%">$html$</div>',"</div>"]);window.maskPanel=function i(t){!function n(e,t){if(e="weixinCss",!a.S(e)){var i=a.document.createElement("style");i.type="text/css",i.id=e,a.gbIsIE?i.styleSheet.cssText=t:i.innerHTML=t,a.document.getElementsByTagName("head")[0].appendChild(i)}}(t.sId,t.sCssRule),new QMPanel({oEmbedWin:a,sStyle:"position:absolute;width:100%; height:100%; left:0; top:0; margin-top:-2px",nWidth:"auto",nHeight:"auto",sId:"weixinnote",sBodyHtml:e.replace({noclose:t.bNoCloseBtn,html:t.sBodyHtml,images_path:getPath("image"),offsetTop:(100-t.nHeightPercent)/2,offsetLeft:(100-t.nWidthPercent)/2,width:t.nWidthPercent,height:t.nHeightPercent}),onclose:t.onclose,onload:function(){var e=this;e.S("mask").onclick=e.S("close").onclick=function(){e.close()},t.onload&&callBack.call(e,t.onload,[e])}})}}(),getQMPluginInfo._compareVersion=function(e,t){for(var i=e.split("."),n=i.length,a=t.split("."),o=a.length,r=0;r<n&&r<o;r++){var s=parseInt(i[r]),l=parseInt(a[r]);if(s!=l)return l<s?1:-1}return r<n?1:r<o?-1:0};var QMAXInfo={_moInfos:{path:"/activex/",cab:["TencentMailActiveX.cab","TencentMailActiveX_2.cab"],exe:"TencentMailActiveXInstall.exe",obj:[["TXGYMailActiveX.ScreenCapture","TXGYMailActiveX.UploadFilePartition","TXGYMailActiveX.Uploader","TXFTNActiveX.FTNUpload","TXGYMailActiveX.DropFile"]],available:["ScreenCapture","Uploader","FTNUpload","DropFile","UploadFilePartition"],lastVer:["1.0.1.53","1.0.1.29","1.0.1.53","1.0.0.29","1.0.0.53"],miniVer:["foxmail.com"==getDomain()?"1.0.0.5":"1.0.1.28","1.0.1.28","1.0.1.28","1.0.0.13","1.0.0.7"]},_moInfos_FF:{path:"/xpi/",xpi:"TencentMailPlugin.xpi",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in","QQMail Plugin"],type:function(){var e="application/txftn-webkit";return["application/x-tencent-qmail","","application/x-tencent-qmail","undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes[e]?e:"application/txftn","application/x-tencent-qmail"]}(),lastVer:["1.0.1.53","","1.0.1.53","1.0.0.4","1.0.0.0"],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.4","1.0.0.0"]},_moInfos_WebKit:{path:"/crx/",crx:"TencentMailPlugin.crx",exe:"QQMailWebKitPlugin.exe",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn-webkit",""],lastVer:["1.0.1.53","","1.0.1.53","1.0.0.4",""],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.4",""]},_moInfos_WebKitForMac:{path:"/crx/",pkg:"TencentMailPluginForMac.pkg",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader"],name:["QQMailPlugin","","QQMailPlugin","Tencent FTN Plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn",""],lastVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""],miniVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""]},mbAblePlugin:getQMPluginInfo("10.6.8"),mbAbleUsePlugin:getQMPluginInfo("10.6.8"),_mbIsChecked:!0,getTitle:function(){return gbIsIE?"Controls":"Plugin"},getinfo:function(){if(QMAXInfo.mbAblePlugin){if(gbIsWin){if(gbIsIE)return QMAXInfo._moInfos.available;if(gbIsFF)return QMAXInfo._moInfos_FF.available;if(gbIsChrome||gbIsSafari||gbIsOpera||gbIsQBWebKit)return QMAXInfo._moInfos_WebKit.available}if(gbIsMac)return QMAXInfo._moInfos_WebKitForMac.available}return[]},_grayUpdate:function(){},installer:function(e,t){var i=this.get("whole",t),n="";if(/^online/.test(e)?n=i.cab?this.get("cab"):i.xpi||gbIsChrome&&parseInt(gsChromeVer)<21&&i.crx:/^download/.test(e)&&i&&(("FF"==t||!t&&gbIsFF)&&(i=this.get("whole","WebKit")),n=i.exe||i.pkg),n){var a=n.split(".");n=[[a[0]].concat(i.lastVer[0].split(".")).join("_"),a[1]].join(".")}return n&&/Abs$/.test(e)&&(n=i.path+n),n},get:function(e,t){t||(gbIsIE&&(t="IE"),gbIsFF&&(t="FF"),(gbIsChrome||gbIsSafari||gbIsOpera||gbIsQBWebKit)&&(t="WebKit"),!gbIsIE&&gbIsMac&&(t="mac"));var i={IE:this._moInfos,FF:this._moInfos_FF,chrome:this._moInfos_WebKit,WebKit:this._moInfos_WebKit,mac:this._moInfos_WebKitForMac}[t];if(this._mbIsChecked||this._grayUpdate(),"whole"==e)return i;if("cab"!=e)return i[e];var n=createActiveX(0),a=n?"":"_2.dll";try{a=n.GetDLLFileName()}catch(o){}return i.cab[a&&-1!=a.indexOf("_2.dll")?0:1]}};function createActiveX(e,t){if(!gbIsIE)return createPlugin(e,!1,t);if(0<=e&&e<=4)for(var i=QMAXInfo.get("obj"),n=0,a=i.length;n<a;n++){if(3==e)try{new ActiveXObject(i[n][0])}catch(o){}try{return new ActiveXObject(i[n][e])}catch(o){}}return null}function detectActiveX(e,t,i,n){if(!gbIsIE)return detectPlugin(e,t,i,n);var a=void 0===i,o=!1,r=a?createActiveX(e):i,s=getActiveXVer(r);return r&&s&&(1!=t&&2!=t?o=!0:0<=getQMPluginInfo._compareVersion(s,QMAXInfo.get(1==t?"miniVer":"lastVer")[e])&&(o=!0),a&&(delete r,r=null)),o}function getActiveXVer(e){if(!gbIsIE)return getPluginVer(e);var t,i="";try{i=(t="number"==typeof e?createActiveX(e):e)&&(t.version?t.version:"1.0.0.8")||""}catch(n){}return i}function checkInstallPlugin(e){if(!QMAXInfo.mbAbleUsePlugin)return!1;try{navigator.plugins.refresh(!1)}catch(s){}var t=QMAXInfo.get("name")[e],i=QMAXInfo.get("type")[e],n=navigator.plugins;if(n&&t)for(var a=n.length-1;0<=a;a--)for(var o=n[a].length-1;0<=o;o--)if(-1!=n[a].name.indexOf(t)&&n[a][o].type==i){if(3!=e&&(-1<gsAgent.indexOf("vista")||/nt 6/gi.test(gsAgent))&&"application/x-tencent-qmail"==i)if(!(r=n[a].description.split("#")[1]))continue;var r=/(\d+(?:\.\d+)+)/.test(n[a].description||"")?RegExp.$1:"1.0.0.0";if(gbIsMac&&3!=e&&"1.0.0.0"==r)continue;if(gbIsMac&&gbIsChrome&&21<parseFloat(gsChromeVer)&&getQMPluginInfo._compareVersion(r,"1.0.2.0")<0)continue;return!0}return!1}function createPlugin(e,t,i,n){var a=null;switch(i=i||getMainWin(),e){case 0:case 2:case 4:gbIsSafari&&createPlugin._createQQMailPlugin(e,i,n),a=createPlugin._createQQMailPlugin(e,getTop(),n);break;case 3:a=createFTNPlugin(i,n)}return!t&&checkInstallPlugin(e)&&getTop().ossLog("delay","all",T(["stat=ff_addon","&type=%type%&info=%info%"],"%").replace({type:a?"successcreatePlugin":"failcreatePlugin",info:["ver:",gsFFVer,",pluginId:",e,",brtpe:",gbIsFF?1:gbIsChrome?2:gbIsSafari?3:gbIsOpera?4:5].join("")})),a}function createFTNPlugin(e,t){if(!checkInstallPlugin(3))return null;createPlugin._createFTNPlugin(e,t);var i=createPlugin._createFTNPlugin(getTop(),t);return t&&getTop().ossLog("delay","all",T(["stat=ff_addon","&type=%type%&info=%info%"],"%").replace({type:i&&i.Version?"successcreatePlugin":"failcreatePlugin",info:["ver:",gsFFVer,",pluginId:3,insId:",t].join("")})),i.Version?i:null}function detectPlugin(e,t,i,n){var a=!1,o=i||createPlugin(e,!0,null,n),r=getPluginVer(o);return o&&r&&(1!=t&&2!=t?a=!0:3==e&&!gbIsMac&&gbIsSafari?a=!1:0<=getQMPluginInfo._compareVersion(r,QMAXInfo.get(1==t?"miniVer":"lastVer")[e])&&(a=!0)),a}function getPluginVer(e){var t,i="";try{i=(t="number"==typeof e?createPlugin(e,!0):e)&&t.Version||""}catch(n){}return i}function initDialog(e,t,i,n,a){new(getTop().QMDialog)({sid:e,sTitle:t,sUrl:i,nWidth:n,nHeight:a})}function requestShowTip(e,t,n,a){var i=T("/cgi-bin/tip?sid=$sid$&args=$dom$,$tip$&r=$r$").replace({sid:getSid(),dom:e,tip:t,r:Math.random()});QMAjax.send(i,{method:"GET",onload:function(e,t,i){e&&0<t.indexOf("oTop.QMTip")&&(a&&!a(t,i)||globalEval(t,n))}})}function detectCapsLock(e,a,o){if(e){var n=-1;addEvents(e,{keydown:function(e){20==(e.keyCode||e.charCode)&&(0==n?(r(e),n=1):1==n&&(s(),n=0))},keypress:function(e){var t=e.keyCode||e.charCode,i=e.shiftKey;65<=t&&t<=90&&!i||97<=t&&t<=122&&i?(n=1,r(e)):((97<=t&&t<=122&&!i||65<=t&&t<=90&&i)&&(n=0),s())},blur:function(){s()}})}function r(e){var t=calcPos(e.target||e.srcElement),i=a||S("capTip");function n(){return["z-index:20;position:absolute;background:#fdf6aa;padding:1px;","border:1px solid #dbc492;border-right:1px solid #b49366;border-bottom:1px solid #b49366;","left:",t[3],"px;","top:",t[2]+1,"px;"].join("")}i?i.style.cssText=n():insertHTML((o||document).body,"afterBegin",'<div id="capTip" style="'+n()+'">Caps lock is on</div>')}function s(){show(S("capTip",o||document),!1)}}createPlugin._createQQMailPlugin=function(e,t,i){var n,a=null,o=gbIsFF?"application/x-tencent-qmail":"application/x-tencent-qmail-webkit";if(t=t||getTop(),checkInstallPlugin(e)){var r=i||"QQMailFFPluginIns";(n=S(r,t))||(insertHTML(t.document.body,"beforeEnd",T('<embed id="$id$" type="$type$" hidden="true"></embed>').replace({type:o,id:r})),n=S(r,t));var s={0:"CreateScreenCapture",2:"CreateUploader",4:"CreateDragDropManager"}[e];"undefined"!=typeof n[s]&&(a=n[s](),0==e?a.OnCaptureFinished=function(){}:2==e&&(a.OnEvent=function(){}))}return a},createPlugin._createFTNPlugin=function(e,t){var i=null,n=QMAXInfo.get("whole").type[3],a=t||"npftnPlugin";return(i=S(a,e=e||getTop()))||(insertHTML(e.document.body,"beforeEnd",T('<embed id="$id$" type="$type$" style="z-index:99999;position:absolute;top:0;left:0;width:1px;height:1px;"></embed>').replace({type:n,id:a})),(i=S(a,e))&&(i.onEvent=function(){})),i};var folderTree=function(){var d=getTop();function l(e){var t=[];!function n(e,t){for(var i=0;i<e.children.length;++i)0==e.children[i].children.length||(n(e.children[i],t),e.children[i].children=[]),t.push(e.children[i])}(e,t),e.children=t}function i(e,t,i){i=i||!1;t=t||{id:"0",fatherid:"",children:[],level:0};(e=JSON.parse(JSON.stringify(e))).push(t);for(var n=e.length,a=[],o=0;o<n;o++)a.push(e[o].id);for(o=0;o<n-1;o++)-1==a.indexOf(e[o].fatherid)&&(e[o].fatherid="0");for(var r=0;r<n-1;r++)for(var s=r+1;s<n;s++)if(e[r].id==e[s].fatherid){for(var l=!0,d=0;d<e[r].children.length;d++)e[r].children[d].id==e[s].id&&(l=!1);l&&e[r].children.push(e[s])}else if(e[r].fatherid==e[s].id){for(l=!0,d=0;d<e[s].children.length;d++)e[s].children[d].id==e[r].id&&(l=!1);l&&e[s].children.push(e[r])}if(i&&0<t.children.length){var c=[],p=[];for(r=0;r<t.children.length;++r)0<t.children[r].unread?c.push(t.children[r]):p.push(t.children[r]);t.children=[].concat(c,p)}return t}function n(n,e){var a="",o="",r="";return"Pop"==n&&(a+=d.TE(['<ul class="fdul" style="margin-left: 0;">','<li class="fs level_root" id="folder_personal_td" dr="personal" dp="personal" level="0">','<a nowrap="" id="folder_personal" hidefocus="">my file</a>','<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_personal" class="fd_off" hidefocus="">',"</li>","</ul>",'<ul class="fdul fdul_children" style="margin-left: 10px;">'])),function s(e,t){if(0!=t&&("Left"==n?o=d.TE(['<li class="fs" id="folder_$id$_td" dr="$id$" dp="personal" level="$depth$">','<a href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=$id$&page=0" target="mainFrame" id="folder_$id$" data-unread="$@$if($unread$>0)$@$$unread$$@$else$@$0$@$endif$@$" data-name="$name$" name="personal" onClick="switchFolder($id$);" title="$name$ $@$if($unread$>0)$@$unread mail $unread$  seal$@$endif$@$" hidefocus class="fdlist_width">',"$@$if($unread$>0)$@$",'<div class="max_width"><b>$@$eval trimLeftLetter($name$,5)$@$($unread$)</b></div>',"$@$else$@$",'<div class="txtflow fdwidthmax">$name$</div>',"$@$endif$@$","</a>","$@$if($depth$<10)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_on" onClick="showFolders($id$);" hidefocus />',"$@$endif$@$","</li>"]):"Pop"==n&&(o=d.TE(['<li class="fs" id="folder_$id$_td" dr="$id$" dp="personal" level="$depth$" alias="$name$">','<a target="mainFrame" id="folder_$id$" name="personal" hidefocus class="fdlist_width" >','<div class="txtflow popfdwidthmax">$name$</div>',"</a>","$@$if($depth$<10)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_off" data-id="$id$" hidefocus />',"$@$endif$@$","</li>"])),a+=o.replace({id:e.id,unread:e.unread,name:e.name,depth:t,isLeaf:!(0<e.children.length)})),0<e.children.length){0!=t&&("Left"==n?r=d.TE(['<ul class="fdul" id="$id$folders" style="overflow:hidden;$@$if($depth$>0)$@$display:none;$@$endif$@$">']):"Pop"==n&&(r=d.TE(['<ul class="fdul" id="$id$folders" style="overflow:hidden;">'])),a+=r.replace({id:e.id,depth:t})),9<=t&&l(e);for(var i=0;i<e.children.length;++i)s(e.children[i],t+1);0!=t&&(a+="</ul>")}}(e,0),"Pop"==n&&(a+="</ul>"),a}function e(e){}return e.initTree=i,e.renderFolder=n,e.renderSetFolder=function r(e,t){t&&!function n(e){if(!e.children)return parseInt(e.filtercount||0);for(var t=e.children,i=0;i<t.length;i++)e.filtercount=parseInt(e.filtercount)+n(t[i]);return parseInt(e.filtercount||0)}(e);var a="";return a+=d.TE(['<tr id="folder_root"  data-child="$@$eval $oFolder$.length$@$"></tr>']).replace({oFolder:e.children}),function o(e,t,i){if(0!=t&&(a+=d.TE(['<tr id="folder_$id$" alias="$name$" data-child="$@$eval $children$.length$@$" name="father-$@$if($depth$==1)$@$root$@$else$@$$fatherid$$@$endif$@$" index="$index$" class="$@$if($depth$==1)$@$border2$@$endif$@$ $@$if($index$==0&&$depth$==1)$@$border2no$@$endif$@$" level="$depth$" onmouseover="getTop().addClass(this,',"'attbg'",');" onmouseout="getTop().rmClass(this, ',"'attbg'",");getTop().rmClass(this, ","'bold'",');" >','<td class="lh1 settingtd" style="padding-right: 0px;">','<div class="td1_txt" style="margin-left:$td_margin$px;">',"$@$if($depth$<10)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_off" onClick="showSetFolders(this,$id$);" hidefocus />',"$@$endif$@$",'<a title="$name$" href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=$id$&page=0" class="txt_width">',"$@$if($type$==2)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/ico_a_b.gif" align="absmiddle" class="pop"/>',"$@$endif$@$","$@$if($acctid$==0)$@$","$@$else$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/ico_a.gif" align="absmiddle" class="pop"/>',"$@$endif$@$","$name$</a>","</div>","</td>",'<td class="settingtd" align="center">$@$if($unread$>0)$@$','<a href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&s=unread&folderid=$id$&flag=new&page=0"><b>$unread$</b></a>',"$@$else$@$$unread$$@$endif$@$","</td>",'<td class="settingtd" align="center">$total$</td>','<td class="settingtd" align="center">$usedsize$</td>','<td class="settingtd">&nbsp;</td>','<td align="right" class="f_family normal settingtd">','<a href="javascript:void(0)" onClick="return getTop().renameFolder($id$,',"'folder'",",window,","'$name$'",')">[rename]</a>&nbsp;','<a target="actionFrame" href="javascript:void(0)" $@$if($type$==2)$@$onclick="return doDelete($id$,0,$filtercount$,\'$name$\');"$@$else$@$ onclick="return doDelete($id$,1,$filtercount$,\'$name$\')"$@$endif$@$>[delete]</a>&nbsp;','<a target="actionFrame" href="javascript:void(0)" onClick="return doEmpty($id$);" >[emptying]</a>&nbsp;&nbsp;','<a href="javascript:void(0)" onClick="return mv($id$,0,0)" title="Move folder up">\u2191</a>&nbsp;','<a href="javascript:void(0)" onClick="return mv($id$,0,1)" title="Move folder down">\u2193</a>',"</td>","</tr>"]).replace({id:e.id,fatherid:e.fatherid,index:i,unread:e.unread,children:e.children,name:e.name,depth:t,type:e.type,total:e.total,usedsize:e.usedsize,acctid:e.acctid,isLeaf:!(0<e.children.length),td_margin:10==t?110:10*(t-1),filtercount:e.filtercount})),0<e.children.length){9<=t&&l(e);for(var n=0;n<e.children.length;++n)o(e.children[n],t+1,n)}}(e,0,0),a},e.getFolderPath=function t(e){var n=[];return function a(e,t){if(t=""==t?"":t+"/",n.push({sId:"fid_"+e.id,sItemValue:t+e.name}),0<e.children.length)for(var i=0;i<e.children.length;++i)a(e.children[i],t+e.name)}(i(e,{id:"0",name:"",fatherid:"",children:[],path:"",level:"-1"}),""),n.shift(),n},e.addFolderNode=function c(e,t,i,n){var a=i;if("personal"==i&&!d.S("folder_"+i+"_td")){var o=document.createElement("ul");S("personalfoldersDiv",getLeftWin()).insertBefore(o,S("personalfoldersDiv",getLeftWin()).firstChild),o.className="fdul",o.innerHTML=d.TE(['<li class="fs" id="folder_personal_td" dataunread="0" style="*margin-bottom:-2px;" dr="personal" dp="personal" nowrap>','<a nowrap id="folder_personal" onClick="switchFolder($id$);showFolders("$name$", true)" href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=personal&page=0&stype=myfolders&loc=folderlist,,,21" target="mainFrame"  hidefocus>my file</a>','<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_personal" class="fd_off" onClick="showFolders("$name$");" hidefocus />',"</li>"]).replace({id:e,name:i})}d.S("folder_"+i+"_td")&&"10"==d.S("folder_"+i+"_td").getAttribute("level")&&(a=d.S("folder_"+i+"_td").parentNode.id.replace("folders",""));var r={id:e,name:t,fatherid:a,unread:0,children:[],level:"-1",newLevel:!1};"personal"==a?(r.level="1",r.fatherid="0",userFolderTree.children.push(r)):function s(e,t){if(e.id==a)return r.level=t+1,0==e.children.length&&(r.newLevel=!0),void e.children.push(r);for(var i=0;i<e.children.length;++i)s(e.children[i],t+1)}(userFolderTree,0);if(originUserFolders.push(r),"1"==r.level)o=document.createElement("li"),S("personalfolders",getLeftWin()).appendChild(o),o.id="folder_"+r.id+"_td",o.setAttribute("dr",r.id),o.setAttribute("dp","personal"),o.setAttribute("level",r.level),o.className="fs",o.innerHTML=d.TE(['<a href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=$id$&page=0" target="mainFrame" id="folder_$id$" data-unread="0" data-name="$name$" name="personal" onClick="switchFolder($id$);" title="$name$$@$if($unreadCnt$>0)$@$ unread mail $unreadCnt$  seal$@$endif$@$" hidefocus class="fdlist_width" >','<div class="txtflow fdwidthmax">$@$if($unreadCnt$>0)$@$<b>$name$</b><b>($unreadCnt$)</b>$@$else$@$$name$$@$endif$@$</div>',"</a>",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_on" onClick="showFolders($id$);" hidefocus />']).replace({id:r.id,name:r.name,unreadCnt:n});else if(1==r.newLevel){o=document.createElement("ul"),S("folder_"+r.fatherid+"_td",getLeftWin()).parentNode.insertBefore(o,S("folder_"+r.fatherid+"_td",getLeftWin()).nextSibling),o.id=r.fatherid+"folders",o.className="fdul";try{o.style="overflow:hidden;display:none;"}catch(l){o.style.display="none",o.style.overflow="hidden"}o.innerHTML=d.TE(['<li class="fs" id="folder_$id$_td" dr="$id$" dp="personal" level="$level$">','<a href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=$id$&page=0" target="mainFrame" id="folder_$id$" data-unread="0" data-name="$name$" name="personal" onClick="switchFolder($id$);" title="$name$$@$if($unreadCnt$>0)$@$ unread mail $unreadCnt$  seal$@$endif$@$" hidefocus class="fdlist_width" >','<div class="txtflow fdwidthmax">$@$if($unreadCnt$>0)$@$<b>$name$</b><b>($unreadCnt$)</b>$@$else$@$$name$$@$endif$@$</div>',"</a>","$@$if($level$!=10)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_on" onClick="showFolders($id$);" hidefocus />',"$@$endif$@$","</li>"]).replace({id:r.id,level:r.level,name:r.name,unreadCnt:n})}else o=document.createElement("li"),S(r.fatherid+"folders",getLeftWin()).appendChild(o),o.id="folder_"+r.id+"_td",o.setAttribute("dr",r.id),o.setAttribute("dp","personal"),o.setAttribute("level",r.level),o.className="fs",o.innerHTML=d.TE(['<a href="/cgi-bin/mail_list?sid=$@$eval getSid()$@$&folderid=$id$&page=0" target="mainFrame" id="folder_$id$" data-unread="0" data-name="$name$" name="personal" onClick="switchFolder($id$);" title="$name$$@$if($unreadCnt$>0)$@$ unread mail $unreadCnt$  seal$@$endif$@$" hidefocus class="fdlist_width" >','<div class="txtflow fdwidthmax">$@$if($unreadCnt$>0)$@$<b>$name$</b><b>($unreadCnt$)</b>$@$else$@$$name$$@$endif$@$</div>',"</a>","$@$if($level$!=10)$@$",'<img src="https://res.mail.qq.com/bizmail/zh_CN/htmledition/images/spacer.gif" id="icon_$id$" class="fd_on" onClick="showFolders($id$);" hidefocus />',"$@$endif$@$"]).replace({id:r.id,level:r.level,name:r.name,unreadCnt:n});d.showFolderTrace(r.id)},e.getFilterFolder=function a(e){var t=n("Pop",i(e,{id:"0",name:"",fatherid:"",children:[],path:"",level:"-1"}));return d.TE(["$@$for($default_folders$)$@$",'<li class="fs level_root" id="folder_$id$_td" dr="$id$" dp="personal" level="0" alias="$name$" path="$path$">','<a target="mainFrame" id="folder_$id$" name="personal" hidefocus class="fdlist_width">','<div class="txtflow popfdwidthmax">$name$</div>',"</a>","</li>","$@$endfor$@$",t]).replace({default_folders:[{id:1,name:"inbox",path:"inbox",level:0,fatherid:0,children:[]},{id:5,name:"Deleted",path:"Deleted",level:0,fatherid:0,children:[]},{id:6,name:"Trash can",path:"Trash can",level:0,fatherid:0,children:[]}]})},e}();function appendEditorFileContent(e,t,i){var n=getTop();if(n.trim(e)){if(i){if(1048576<e.length)return;e='<pre style="word-wrap: break-word; white-space: pre-wrap;">'+n.htmlEncode(e)+"</pre>"}if((n.gbIsChrome||n.gbIsFF)&&"html"==t.getContentType())if(!i&&n.gbIsChrome){var a=t.getEditWin(),o=a.document,r="__style__"+n.now(),s=[],l=document.createElement("div");l.innerHTML=e,n.E(l.getElementsByTagName("style"),function(e){s.push(e.innerHTML)}),s.length?e+='<div id="'+r+'" style="display:none;">\u200d</div>':n.debug("Import file has no sytle tag"),t.execCmd("insertHTML",e,function(){if(s.length){var e=n.S(r,a)||o.body;if(e){var t=o.createElement("style");t.innerHTML=s.join(""),e.appendChild(t)}}})}else t.execCmd("insertHTML",e);else t.appendContent(e);return!0}}var getOfficeRealContent=function(){var _oTop=getTop(),_nQmboxIndex=0;function getOfficeRealContent(e,n){if(-1==(e=clearFixTag(e)).indexOf('xmlns:w="urn:schemas-microsoft-com:office:word"')){if(-1!=e.indexOf('xmlns:x="urn:schemas-microsoft-com:office:excel"')){var t=e.replace(/frameset/gi,"ul").replace(/frame/gi,"li"),i=document.createElement("div");i.innerHTML=t;var a=!0,o=!1,r={};if(_oTop.E(i.getElementsByTagName("li"),function(e){var t=getURL(_oTop.attr(e,"src"));n&&n.charset&&(t=t+"&resp_charset="+n.charset);var i={frSheet:"sheet",frTabs:"tab"}[_oTop.attr(e,"Name")];t&&i?(o=!0,r[i]=t):a=!1}),a&&o)return void dealExcel(r,n);_oTop.debug("excel has no frame")}else{if(-1!=e.indexOf('xmlns:p="urn:schemas-microsoft-com:office:powerpoint"'))return void dealPPT(e,n);if(-1==e.indexOf("qmbox"))return void dealPDF(_oTop.evalValue(e),n)}n.onload(!0,e)}else dealWord(e,n)}function dealFrameset(e){var t=e.replace(/frameset/gi,"ul").replace(/frame/gi,"li"),i=document.createElement("div");i.innerHTML=t;var n={};return _oTop.E(i.getElementsByTagName("li"),function(e){n[_oTop.attr(e,"Name")]=getURL(_oTop.attr(e,"src"))}),n}function getQmboxName(){return"qmbox"+_nQmboxIndex++}function dealWord(e,t){var i=document.createElement("div");i.innerHTML=e;for(var n=0;++n;){var a=_oTop.CN("Section"+n,i);if(!a.length)break;_oTop.E(a,function(e){var t=_oTop.getStyle(e,"position");e.style.cssText="position:"+t,e.className="",e.id="",t=_oTop.getStyle(e,"position");var i=e.parentNode;i.style.cssText="position:"+t,i.className="",i.id=""})}t.onload(!0,i.innerHTML)}function dealExcel(e,o){_oTop.QMAjax.send(e.tab,{onload:function(e,t){if(e&&t&&0!==(""+t).indexOf("\x3c!--cgi exception--\x3e")){var i=createTempNode(t),n=[],a=[];_oTop.E(i.getElementsByTagName("a"),function(e){n.push(_oTop.trim(e.getElementsByTagName("*")[0].innerHTML));var t=e.href;o&&o.charset&&(t=t+"&resp_charset="+o.charset),a.push(getURL(t))}),a.length?loadIframes(a,n,{getBody:function(e,t){if(e.getElementsByTagName("td").length)return e.getElementsByTagName("table")[0]}},o.onload):o.onload(!1,"NoContent")}else o.onload(!1,"PartFileError")}})}function dealPPT(_asContent,_aoCfg){var _oIframeSrc=dealFrameset(_asContent);function _load(e,t,i){loadIframes(e,t,{getBody:function(e,t){var i=_oTop.finds("#SlideObj",e)[0];if(i)return i.style.position="relative",i.style.top=0,i.style.left=0,i.style.visibility="visible",i.style.overflow="hidden",i}},i.onload)}_oIframeSrc.outline||_oIframeSrc.slide?_oIframeSrc.outline?_oTop.QMAjax.send(_oIframeSrc.outline,{onload:function(_abOK,_asData){if(_abOK&&_asData&&0!==(""+_asData).indexOf("\x3c!--cgi exception--\x3e")){var _oTempElem=createTempNode(_asData),_oNames=[];_oTop.E(_oTempElem.getElementsByTagName("a"),function(e){_oNames.push(_oTop.trim(e.innerHTML))});var _oSrcs=[];_oTop.E(_oTempElem.getElementsByTagName("script"),function(_aoItem){var _oSlide,_sUrl;-1!=_aoItem.innerHTML.indexOf("_oSlide")&&(eval(_aoItem.innerHTML),_sUrl=_sUrl||"/cgi-bin/viewfile?sid="+_oTop.getSid()+"&f=",_oTop.E(_oSlide||{},function(e){_oSrcs.push(_sUrl+e)}))}),_oSrcs.length?_load(_oSrcs,_oNames,_aoCfg):_aoCfg.onload(!1,"NoContent")}else _aoCfg.onload(!1,"PartFileError")}}):_load([_oIframeSrc.slide],[],_aoCfg):_aoCfg.onload(!1,"NoContent")}function dealPDF(e,t){var i=[];_oTop.E(e.page,function(e){t&&t.charset&&e&&(e=e+"&resp_charset="+t.charset),e&&i.push(e)}),loadIframes(i,[],{getBody:function(e,t){return e.style.display="block",e}},t.onload)}function clearFixTag(e){return e.replace(/<!--\[if gte vml( \d+)?\]>[\s\S]*?<!\[endif\]-->/g,"").replace(/<!(?:--)? *\[if !vml\] *(?:--)?>([\s\S]*?)<!(?:--)? *\[endif\] *(?:--)?>/g,"$1")}function clearStyle(e){return e.replace(/;(\s*;)+/g,";").replace(/\{(\s*;)+/g,"{")}function replaceNobrTag(e){for(var t=e.getElementsByTagName("nobr"),i=e.ownerDocument,n=t.length;n--;){var a=i.createElement("div");a.style.cssText="display:inline;white-space: nowrap;",a.innerHTML=t[n].innerHTML,t[n].parentNode.replaceChild(a,t[n])}}function transformStyleFontName(e){return e.replace(/(\\[\dA-F]{4,4})+/gi,transformStyleFontName._replace)}function createTempNode(e){var t=document.createElement("div");return t.style.display="none",e&&(t.innerHTML=""+e),t}transformStyleFontName._replace=function(e){var i=[],n=!1;return _oTop.E(e.match(/[\d\w]{4,4}/g),function(e){var t=String.fromCharCode(parseInt(e,16));1==t.length?i.push(t):n=!0}),n?e:'"'+i.join("")+'"'};var _sContentWarpStyle=' style="word-wrap:normal; font-size:1em; font-weight:normal; line-height:normal;"';function loadIframe(e,f){_oTop.QMAjax.send(e,{onload:function(e,t){if(e&&!f.isEnd()&&t&&0!==(""+t).indexOf("\x3c!--cgi exception--\x3e")){var i=createTempNode(t=clearFixTag(t)),a=[];_oTop.E(i.getElementsByTagName("style"),function(e){var t=""+e.innerHTML;t?a.push(t):_oTop.debug("import word: no style content")});var n=f.getBody(i,t);if(n){n=n.cloneNode(!0),_oTop.E(n.getElementsByTagName("script"),_oTop.removeSelf),_oTop.E(n.getElementsByTagName("link"),_oTop.removeSelf),_oTop.E(n.getElementsByTagName("style"),_oTop.removeSelf),replaceNobrTag(n),_oTop.E(n.getElementsByTagName("*"),function(e){if(3!=e.nodeType){var t=_oTop.attr(e,"style");if(t){var i=transformStyleFontName(""+t).replace(/(^|;)[^;]*?[\?\\][^;]*/g,"$1").replace(/(^|;)\s*mso-[^;]*/g,"$1").replace(/"/g,"'");i!=t&&_oTop.attr(e,"style",clearStyle(i))}var n=e.className;n&&(e.className=n+" "+n.toLowerCase())}}),i.innerHTML="",i.appendChild(n);for(var o=i.innerHTML,r=/(<link [^>]*href=(["'])([^\2>]+)\2[^>]*>)/gi,s=/rel=(["'])stylesheet\1/i,l=[];r.test(t);){var d=RegExp.$3,c=RegExp.$1;s.test(c)&&l.push(d)}var p=l.length+1,u=[],g=function(n){--p<1?(a.length&&!n&&(n=getQmboxName()),o=n||u.length?(n&&u.push(n),"<div"+_sContentWarpStyle+' class="'+u.join(" ")+'">'+o+"</div>"):"<div"+_sContentWarpStyle+">"+o+"</div>",a.length&&(a=transformStyleFontName(a=a.join("").replace(/\/\*[\s\S]*?\*\//g,"").replace(/[\n\r]/g,"").replace(/(^|\})([^\{\}]+?)\{/g,function(e,t,i){return t+"."+n+" "+i.split(",").join(", ."+n+" ")+"{"})).replace(/([;\{])[^;\{]*?[\?\\][^;\}]*/g,"$1").replace(/([;\{])\s*mso-[^;\}]*/g,"$1"),o="<style>"+clearStyle(a)+"</style>"+o),f.onload(!0,o)):n&&u.push(n)};_oTop.E(l,function(e){if(f.getLoadedStyleId(e))g(f.getLoadedStyleId(e));else{var i=getQmboxName();f.saveLoadedStyle(e,i),_oTop.QMAjax.send(e,{onload:function(e,t){e&&!f.isEnd()&&t&&0!==(""+t).indexOf("\x3c!--cgi exception--\x3e")?(a.push(t),g(i)):f.onload(!1)}})}}),g()}else _oTop.debug("Iframe content is empty"),f.onload(!0,"")}else f.onload(!1)}})}function loadIframes(e,o,t,r){var s=[],l=!1,i={},d=setTimeout(function(){r(!1,"Timeout"),l=!0},18e3),n={isEnd:function(){return l},getLoadedStyleId:function(e){return i[getViewFileId(e)]},saveLoadedStyle:function(e,t){i[getViewFileId(e)]=t}},c=e.length;_oTop.E(e,function(e,a){loadIframe(e,_oTop.extend({},n,t||{},{onload:function(e,t){if(clearTimeout(d),e){if(s[a]=t,0==--c){var i=[],n=_oTop.TE("$@$if($name$)$@$<h1>$name$</h1>$@$endif$@$<div>$content$</div>");_oTop.E(s,function(e,t){e&&i.push(n.replace({name:_oTop.htmlEncode(o[t]||""),content:e}))}),i.length?r(!0,i.join("")):r(!1,"NoContent")}}else l||r(!(l=!0),"PartFileError")}}))})}function getViewFileId(e){var t=e.match(/f=([^&$]+)/);return t&&t[1]}function getURL(e){return e}return getOfficeRealContent}();!function(t,r){var o={frame_html:["all","qmtool","profile_tips","qqmaileditor/editor","qmaddress","readmail2"]},s={compose:{target:"frame_html"}};function e(e){e=e||{},this._init(e)}e.getRawTargetJsList=function(e){var t=(s[e]||{}).target;if(t&&o[t]){for(var i=o[t],n={},a=0;a<i.length;a++)n[i[a]]=1;return n}return{}},e.prototype={_init:function(e){if(this._cfg=e||{},this._cfg.page_id=this._cfg.page_id||"default",r.versionToolMap=r.versionToolMap||{},r.versionToolMap[this._cfg.page_id])return!1;this._compareVersion()},_initConfig:function(){},_compareVersion:function(){var e=this._cfg.target_gLn||r.gLn,t=this._cfg.current_gLn||{},i=!0;for(var n in t)if("placeholder"!==n){var a=e[n],o=t[n];this._versionValid(a)&&this._versionValid(o)&&a!==o&&(i=!1)}!i&&this._allowReload()&&(this._doLog(),this._doOsslog(),this._doReload())},_versionValid:function(e){return/^[a-zA-Z0-9]{6}$/.test(e)},_allowReload:function(){return r.goExpers&&r.goExpers.jsReload&&this._getReloadCnt()<2},_doLog:function(){r.setCookie("qy_vt_reload",parseInt(this._getReloadCnt())+1,new Date(+new Date+6e5),"/",r.document.domain)},_doOsslog:function(){(new Image).src="https://exmail.qq.com/qy_mng_logic/logKVAuto?key=bizmail_js_reload&itemName="+this._cfg.page_id},_doReload:function(){try{t.location.reload()}catch(e){}},_getReloadCnt:function(){var e=r.getCookie("qy_vt_reload");return isNaN(e)&&(e=0),e}},t.Versiontool=e}(window,getTop());var _oTop=getTop(),_oOidbAccountBase={enterPress:function(e,t){var i=e||window.event;return 13===i.keyCode&&(t&&"1"===t?this.goStep({step:"2"}):this.doAction(),getTop().preventDefault(i)),!1},checkPopInput:function(){var e=getTop(),t=this,i=t._oDialog.S("div_username"),n=t._oDialog.S("ipt_pwd"),a=i.innerHTML||"",o=n.value||"";return""==e.trim(o)?(t.showWarn("You have not entered your password!"),t._oDialog.S("ipt_pwd").focus(),!1):!!t.checkMail(a)},checkMail:function(e){var t=getTop().QMAddrParser,i=0<e.indexOf("@"),n=t.parseAddr(e);return 0==n.length?(this.showWarn("Please fill in the email address"),!1):!i||1==n.length&&!n[0].valid?(this.showWarn("Please enter the correct email account!"),!1):!(1<n.length)||(this.showWarn("You can only enter one email address, please re-enter"),!1)},BindPwdEvents:function(e,t,n){var i=getTop();if(e){var a=-1;i.addEvents(e,{keydown:function(e){20==(e.keyCode||e.charCode)&&(0==a?(o(),a=1):1==a&&(r(),a=0)),n(e)},keypress:function(e){var t=e.keyCode||e.charCode,i=e.shiftKey;65<=t&&t<=90&&!i||97<=t&&t<=122&&i?(a=1,o()):((97<=t&&t<=122&&!i||65<=t&&t<=90&&i)&&(a=0),r()),n()},blur:function(){r()}})}function o(e){i.show(t,!0)}function r(){i.show(t,!1)}},_PTLOGIN_TEMP:getTop().T(["https://xui.ptlogin2.qq.com/cgi-bin/xlogin?appid=522005705&daid=4&s_url=$topHost$/cgi-bin/pt_check?","sid=$sid$%26t=pt_next%26ptfun=$ptfun$%26id=&style=25&low_login=1&proxy_url=$topProtocol$","//mail.qq.com/proxy.html&need_qr=0&hide_border=1&border_radius=0&self_regurl=http://zc.qq.com/chs/index.html?","type=1&app_id=11005?t=regist&pt_feedback_link=http://support.qq.com/discuss/350_1.shtml&css=https://","res.mail.qq.com/zh_CN/htmledition/style/$cssFilename$$ver$.css&target=self&hide_title_bar","=1&default_uin=$uin$&regmaster=4&login_text=$loginDesc$&enable_qlogin=0"]),getPtloginUrl:function(e){return this._PTLOGIN_TEMP.replace(_oTop.extend(this.getDefaultCfg(),e))},isQQMail:function(e){var t=e.toLowerCase();return-1<t.indexOf("@foxmail")||-1<t.indexOf("@vip.qq")||-1<t.indexOf("@qq.")},showWarn:function(e){getTop();var t=this._oDialog.S("div_warning");t&&(t.innerHTML=e,t.style.visibility="")},hideWarn:function(){getTop();var e=this._oDialog.S("div_warning");e&&(e.innerHTML="",e.style.visibility="hidden")},encrypt:function(e){var t=new RSAKey;t.setPublic("CF87D7B4C864F4842F1D337491A48FFF54B73A17300E8E42FA365420393AC0346AE55D8AFAD975DFA175FAF0106CBA81AF1DDE4ACEC284DAC6ED9A0D8FEB1CC070733C58213EFFED46529C54CEA06D774E3CC7E073346AEBD6C66FC973F299EB74738E400B22B1E7CDC54E71AED059D228DFEB5B29C530FF341502AE56DDCFE9","10001");var i=t.encrypt(e+"\n"+Math.floor(+new Date/1e3)+"\n");return i?hex2b64(i):e}};function toAddAccountPage(){var e=getTop(),t=arguments.callee;e.loadCssFile(e.getPath("css")+e.getFullResSuffix("login/addAccount.css"),!0,e.document),t._oDialog=new e.QMDialog({sId:"id_AddAccount",sTitle:"Add email account",nWidth:440,sBodyHtml:t._oTmpl.replace({step:"1"}),bAnimation:!1,onshow:function(){var e=this;e.S("ipt_username").focus(),e.S("geConfirmBtn").onclick=function(){t.goStep({step:"2"})},e.S("geCancelBtn").onclick=function(){e.close()}},onclose:function(){this.reloadLeftWin&&reloadLeftWin()},onbeforeclose:function(){this.S("importFrame")&&removeSelf(this.S("importFrame"))}}),t._oStepEventMap={1:t.showAccountItem,2:t.showPwdItem,3:t.doAction}}function toBindAccountPage(){var e=getTop(),t=arguments.callee,i=t.getPtloginUrl({uin:"0"});e.loadCssFile("$css_path$login/bindAccount.css",!0,e.document),t._oDialog=new e.QMDialog({sId:"id_bindAccount",sTitle:"Link existing mailbox",nWidth:440,sBodyHtml:t._oTmpl.replace({step:"1",ptloginurl:i}),bAnimation:!1,onload:function(){e.ptlogin2_onResize=t.ptlogin2OnResize(this),e.ptloginResize()},onshow:function(){var e=this;e.S("geCancelBtn").onclick=function(){e.close()}},onbeforeclose:function(){this.S("importFrame")&&removeSelf(this.S("importFrame"))}})}function str2JSON(str){return eval("var __pt_json="+str),__pt_json}function ptloginResize(){"undefined"!=typeof window.postMessage&&(window.onmessage=function(e){var t,i=e||window.event;switch((t="undefined"!=typeof JSON?JSON.parse(i.data):window.str2JSON(i.data)).action){case"close":break;case"resize":window.ptlogin2_onResize(t.width,t.height)}})}function closeAccount(){var e=getTop(),t=e.S("closeMailPtlogin_wrapper",e.getMainWin());e.getMainWin()._bUnfresh=!0,t&&(t.style.display="none"),e.getMainWin().document.body.className="qui_funcOpa0",e.goUrlMainFrm(e.T(["/cgi-bin/doaccount?sid=$sid$&step=1&ts=&pwd=$pwd$&rawpwd=&pwdtype=1&t=closeaccount"]).replace({sid:e.getSid()})),e.waitFor(function(){return!e.getMainWin()._bUnfresh},function(e){oTop.getMainWin().document.body.className=""},100)}function toAuthorizeWeiyun(){var e=getTop(),t=arguments.callee;e.loadCssFile("$css_path$login/addAccount.css",!0,e.document),t._oDialog=new e.QMDialog({sId:"id_AuthorizeWeiyun",sTitle:"Authorized Weiyun",nWidth:440,sBodyHtml:t._oTmpl.replace({username:e.getUin(),ptloginurl:t.getPtloginUrl({uin:e.getUin()})}),bAnimation:!1,onshow:function(){var e=this;getTop().ptlogin2_onResize=t.ptlogin2OnResize(e),getTop().ptloginResize(),e.S("geCancelBtn").onclick=function(){e.close()}},onclose:function(){this.reloadLeftWin&&reloadLeftWin()},onbeforeclose:function(){this.S("importFrame")&&removeSelf(this.S("importFrame"))}})}getTop().extend(toAddAccountPage,_oOidbAccountBase,{_oTmpl:getTop().TE(['$@$if($step$=="1")$@$','<div class="addAccount_step addAccount_step_Username">','<div id="div_warning" class="addAccount_errorTip"></div>','<div id="div_frame_container" class="addAccount_text">','<div class="addAccount_label">Add account</div><input type="text" id="ipt_username" class="addAccount_ipt" value="$username$" onkeydown="getTop().toAddAccountPage.enterPress(event,\'1\');" onkeypress="getTop().toAddAccountPage.enterPress(event,\'1\');"/>',"</div>","</div>",'$@$else if($step$=="2")$@$','<div id="div_stepPassword" class="addAccount_step addAccount_step_Password" style="text-align: left;">','<div id="div_warning" class="addAccount_errorTip"></div>','<div id="div_username" class="addAccount_step_usernameShow">$username$</div>','<div class="addAccount_login" id="div_addAccount_login">','<div class="addAccount_text">','<div class="addAccount_label">password</div>','<input type="password" class="addAccount_ipt" tabindex="2" id="ipt_pwd" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);"/>','<div id="capTip" class="qui_cntIndent_captip" style="display:none;"><span class="qui_cntIndent_captip_row"></span>Caps lock is on</div>',"</div>",'<div id="div_verifycode" style="display:none; padding-bottom:16px;">','<div class="addAccount_label">Captcha</div>','<input type="text" id="loginVerify" name="loginVerify" value="" class="addAccount_ipt" style="margin-bottom:5px;" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<img id="verifyImage" src="" style="display:block;clear:both;margin-left:57px;border:1px solid #eee;"/>','<input type="hidden" id="loginData" name="loginData" value="" />','<input type="hidden" id="loginCookies" name="loginCookies" value="" />',"</div>",'<div id="div_challenge" style="display:none;padding-bottom:16px;">','<div class="addAccount_label">Authentication</div>','<input type="text" id="secondPin" name="secondPin" value="" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="phoneNumber" name="phoneNumber" value="" style="display:none;" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="verifySmsChallengeAnswer" name="VerifySmsChallengeAnswer" value="" class="addAccount_ipt" style="display:none;" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="androidTablet" name="androidTablet" value="" style="display:none;" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="emailAnswer" name="emailAnswer" value="" style="display:none;" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="deviceAddress" name="deviceAddress" value="" style="display:none;" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<input type="text" id="secretAnswer" name="secretAnswer" value="" style="display:none;" class="addAccount_ipt" onkeydown="getTop().toAddAccountPage.enterPress(event);" onkeypress="getTop().toAddAccountPage.enterPress(event);">','<div id="challengeTip" style="font-size:12px;clear:both;color:#999;padding-top:5px;margin-left:57px;"></div>','<input type="hidden" id="challengeData" name="challengeData" value="" />','<input type="hidden" id="challengeCookies" name="challengeCookies" value="" />','<input type="hidden" id="challengeAction" name="challengeAction" value="" />',"</div>",'<div id="div_popsvr" style="display:none">','<div class="addAccount_text">','<div class="addAccount_label">POP server address</div>','<input type="text" class="addAccount_ipt" tabindex="3" id="ipt_popserver" onkeydown="getTop().toAddAccountPage.enterPress(event)" onkeypress="getTop().toAddAccountPage.enterPress(event)"/>',"</div>",'<div class="addAccount_text" id="div_port">','<div class="addAccount_label">POP server port</div>','<input type="text" class="addAccount_ipt" tabindex="4" id="ipt_port" value="110" onkeydown="getTop().toAddAccountPage.enterPress(event)" onkeypress="getTop().toAddAccountPage.enterPress(event)"/>',"</div>",'<div class="addAccount_text" id="div_ssl" style="padding-left: 108px;margin-top: -15px;padding-bottom: 0px;">','<input type="checkbox" name="ckb_ssl" id="ckb_ssl" class="ckb_ssl"><label for="ckb_ssl">Enable SSL secure connection</label>',"</div>","</div>",'<div style="color:gray;">Note: you need to use authorization code to add QQ Mail or 126mailbox.</div>',"</div>","</div>",'<div class="addAccount_loadingWrap" style="display: none;" id="div_loading">','<span class="addAccount_loading"></span>',"</div>","$@$else$@$",'<div class="addAccount_step_Finish">','<div class="qui_clear addAccount_step_succeedTip"><span class="addAccount_step_succeedImg"></span><span class="addAccount_step_succeedDesc">Congratulations on your successful addition<span class="qui_txtBold">$username$</span></span></div>','<ul class="addAccount_finishSetting">','<li class="addAccount_finishSetting_item"><input class="addAccount_finishSetting_radio" type="radio" name="mailReceive" id="radio_7" value="7" checked/><label for="radio_7">Receive mail for the last 7 days</label></li>','<li class="addAccount_finishSetting_item"><input class="addAccount_finishSetting_radio" type="radio" name="mailReceive" id="radio_all" value="all"/><label for="radio_all">Receive all mail</label></li>','<li class="addAccount_finishSetting_item"><input class="addAccount_finishSetting_radio" type="radio" name="mailReceive" id="radio_0" value="0"/><label for="radio_0">do not charge this mailbox for now</label></li>',"</ul>","</div>","$@$endif$@$",'<div class="dialog_operate addAccount_foot" id="div_foot">','<a href="javascript:;"  id="geConfirmBtn" class="qui_btn qui_btn_Blue">$@$if($step$=="1")$@$ Next step $@$else if($step$=="2")$@$ verification $@$else$@$ View $@$endif$@$</a>','<a href="javascript:;"  id="geCancelBtn" class="qui_btn addAccount_foot_cancel">$@$if($step$=="1")$@$ cancel $@$else if($step$=="2")$@$ Previous $@$else$@$ Complete more settings $@$endif$@$</a>',"</div>"]),getCssVer:function(){if(!this._msVer){var e=getTop().getRes("$css_path$addAccountPtlogin.css"),t=/addAccountPtlogin(.*)\.css/.test(e)&&RegExp.$1||"";this._msVer=t}return this._msVer},getDefaultCfg:function(){return this._oDefaultCfg||(this._oDefaultCfg={topHost:_oTop.getTopHost(),sid:_oTop.getSid(),topProtocol:_oTop.location.protocol,ver:this.getCssVer(),loginDesc:encodeURIComponent("verification"),ptfun:"addother",cssFilename:"addAccountPtlogin"}),this._oDefaultCfg},ptlogin2OnResize:function(d){return function(e,t){var i=d.S("importFrame"),n=d._moPanelDom,a=d.S("div_stepPassword"),o=d.S("div_username"),r=d.S("geCancelBtn"),s=d.S("btlogin");if(i){if(i.style.height=t+"px",288<=t&&t<=295&&0<i.contentWindow.frames.length){getTop().addClass(n,"qm_dialog_HideChild"),r.style.display="none",a.style.height=t+"px",function l(){setTimeout(function(){0==i.contentWindow.frames.length?(getTop().rmClass(n,"qm_dialog_HideChild"),r.style.display="inline-block",a.style.height="95px",i.style.height="166px"):getTop().hasClass(n,"qm_dialog_HideChild")&&l()},100)}()}else getTop().rmClass(n,"qm_dialog_HideChild"),r.style.display="inline-block",a.style.height=t-66+"px";o.style.marginTop=171<=t&&t<=290?"15px":"0"}r&&(r.style.zoom="normal",r.style.zoom="1"),s&&(s.style.zoom="normal",s.style.zoom="1")}},showAccountItem:function(e){var t=this,i=t._oDialog;i.setHtml("_body_",t._oTmpl.replace({step:e.step,username:e.username})),e.failtype&&t.showError(e.failtype),i.S("geConfirmBtn").style.display="",i.S("geConfirmBtn").onclick=function(){t.goStep({step:"2"})},i.S("geCancelBtn").onclick=function(){i.close()}},showPwdItem:function(e){var t=this._oDialog;if(_sEmail=t.S("ipt_username")&&t.S("ipt_username").value||e.username||"0",!checkMail(_sEmail))return!1;_oTop.extend(e,{username:_sEmail}),this.showNotQQPwdItem(e)},showQQPwdItem:function(e){var t=this,i=t._oDialog;getTop().ptlogin2_onResize=t.ptlogin2OnResize(i),i.setHtml("_body_",t._oTmpl.replace({step:e.step,username:e.username,uInfo:"qq",ptloginurl:t.getPtloginUrl({uin:e.username})})),i.S("geConfirmBtn").style.display="none",i.S("geCancelBtn").onclick=function(){t.goStep({step:"1",username:e.username})},getTop().ptloginResize()},showNotQQPwdItem:function(e){var t,i,n=this,a=n._oDialog;_oTop.loadJsFile("$js_path$safeauth.js",!0),a.setHtml("_body_",n._oTmpl.replace({step:e.step,username:e.username,uInfo:"other"})),(t=a.S("ckb_ssl"))&&(t.onchange=function(){i=a.S("ipt_port"),this.checked?"110"==i.value&&(i.value="995"):"995"==i.value&&(i.value="110")}),new n.BindPwdEvents(a.S("ipt_pwd"),a.S("capTip"),n.enterPress),a.S("geConfirmBtn").onclick=function(){n.goStep({step:"3",username:e.username})},a.S("geCancelBtn").onclick=function(){n.goStep({step:"1",username:e.username})},setTimeout(function(){a.S("ipt_pwd").focus()})},goStep:function(e){if(e&&e.step){getTop();this._oStepEventMap[e.step].call(this,e)}},doAddQQAction:function(a){var o=getTop(),r=this;r._oDialog.S("div_foot").style.display="none",r._oDialog.S("div_username").style.display="none",o.showInfo("Adding mailbox account.",500),o.QMAjax.send("/cgi-bin/foldermgr",{content:o.T(["sid=#sid#&enter=new&fun=createpop&folderid=&acctid=0&taskid=&step=","&fromtips=&popfolder=#popmail#&popnickname=#popnickname#&popmail=#popmail#&addstep=2&ptfun=addother&poppwd=","&popsvr=&popport=&timeflag=1&delflag=0&isenddef=1&needspam=1&smtpneedpwd=0&showsmtppanel=0","&agentsend=0&smtpsvr=&smtpport=25&nosmtppwd=#nosmtppwd#&smtppwd=&t=mailpotl.json&secpwd=#secpwd#"],"#").replace({sid:o.getSid(),popmail:a.sLoginaccount,popnickname:encodeURIComponent(o.S("useralias")&&o.S("useralias").innerHTML||""),nosmtppwd:encodeURIComponent("Use email password"),secpwd:a.secpwd}),method:"POST",onload:function(e,t){if(e){var i=o.evalValue(t);try{"0"==i.succ?r.goStep({step:"1",username:a.sLoginaccount,failtype:i.failtype}):"1"==i.succ&&r.succ({step:"1",username:a.sLoginaccount,folderid:i.folderid,acctid:i.acctid})}catch(n){o.showError("Failed to add mailbox account.")}}else o.showError("Failed to add mailbox account.")}})},doAction:function(e,t){var i=getTop(),n=this;if(this.checkPopInput()){var a={_sTaskid:e||"",_sPopmail:n._oDialog.S("div_username").innerHTML||"",_sPoppwd:n._oDialog.S("ipt_pwd").value||"",_sPopsvr:n._oDialog.S("ipt_popserver").value||"",_sPopport:n._oDialog.S("ipt_port").value||110,_nIspopssl:n._oDialog.S("ckb_ssl").checked?1:0};!("string"==typeof e)&&a._sPopmail.indexOf("@gmail"),i.showInfo("Verifying other email accounts.",6e3),n.doRealAction(a,t)}},doRealAction:function(a,o){var r=getTop(),s=this,l=s._oDialog.S("geConfirmBtn"),e=T("poppwd=$poppwd$&ispopssl=$ispopssl$").replace({poppwd:encodeURIComponent(s.encrypt(a._sPoppwd)),ispopssl:encodeURIComponent(a._nIspopssl)});if(o){var t=[];for(var i in o)t.push("google_"+i+"="+encodeURIComponent(o[i]));e=t.push(e)&&t.join("&")}r.QMAjax.send(r.T("/cgi-bin/foldermgr?sid=#sid#&enter=new&fun=createpop&folderid=&acctid=0&step=&fromtips=&popmail=#popmail#&popfolder=#popmail#&popnickname=&popsvr=#popsvr#&popport=#popport#&timeflag=1&delflag=&isenddef=1&needspam=1&smtpneedpwd=0&showsmtppanel=0&agentsend=&smtpsvr=&smtpport=25&nosmtppwd=&smtppwd=&taskid=#taskid#&t=mailpotl.json","#").replace({sid:r.getSid(),popmail:encodeURIComponent(a._sPopmail),popsvr:encodeURIComponent(a._sPopsvr),popport:encodeURIComponent(a._sPopport),taskid:a._sTaskid||""}),{content:e,method:"POST",onload:function(e,t){if(e){var i=r.evalValue(t);try{"true"==i.waiting?setTimeout(function(){o?s.doAction(i.taskid,o):s.doAction(i.taskid)},5e3):"0"==i.succ?(s.showError(i.failtype,-1<a._sPopmail.indexOf("@gmail")),-1<a._sPopmail.indexOf("@gmail")&&(r.attr(l,"oauth","false"),r.rmClass(l,"qui_btn_BlueDisabled"))):"1"!=i.succ&&"false"!=i.waiting||(-1<a._sPopmail.indexOf("@gmail")&&(r.attr(l,"oauth","false"),r.rmClass(l,"qui_btn_BlueDisabled")),s.succ({step:"1",username:a._sPopmail,folderid:i.folderid,acctid:i.acctid}))}catch(n){r.showError("Failed to add mailbox account.")}}else r.showError("Failed to add mailbox account.")}})},doGoogleOauth:function(n,a){var o=getTop(),r=this,e=n._sPopmail,t=n._sPoppwd,s=r._oDialog.S("ipt_pwd"),i=r._oDialog.S("geConfirmBtn");if("true"!=o.attr(i,"oauth")){var l=function(){o.attr(i,"oauth","false"),o.rmClass(i,"qui_btn_BlueDisabled")},d=r._oDialog.S("div_verifycode"),c=r._oDialog.S("verifyImage"),p=r._oDialog.S("loginData"),u=r._oDialog.S("loginCookies"),g=r._oDialog.S("loginVerify"),f=r._oDialog.S("div_challenge"),m=r._oDialog.S("challengeData"),h=r._oDialog.S("challengeCookies"),_=r._oDialog.S("challengeAction"),v=r._oDialog.S("secondPin"),b=r._oDialog.S("phoneNumber"),y=r._oDialog.S("androidTablet"),T=r._oDialog.S("verifySmsChallengeAnswer"),$=r._oDialog.S("emailAnswer"),x=r._oDialog.S("deviceAddress"),w=r._oDialog.S("secretAnswer"),S=r._oDialog.S("challengeTip"),M=function(e,t){v.style.display="none",T.style.display="none",b.style.display="none",y.style.display="none",x.style.display="none",w.style.display="none",$.style.display="none","VerifySmsChallenge"==e?(T.style.display="",T.value="",S.innerHTML="(Enter the SMS verification code received on the mobile number bound to your Gmail account)",T.focus()):"SecondChallenge"==e?(v.style.display="",v.value="",S.innerHTML="(Since you have enabled two-step verification, enter the Google verification code you have received)",v.focus()):"PhoneVerificationChallenge"==e?(b.style.display="",b.value="",S.innerHTML="(Enter the mobile number bound to your Gmail account to complete identity verification)",b.focus()):"AndroidTabletChallenge"==e?(y.style.display="",y.value="",S.innerHTML='(Go to "Google Settings" app on your Android or tablet device and enter the "Security Code" obtained from the "Security" options)',y.focus()):"UnverifiedPhoneChallenge"==e?(x.style.display="",x.value="",S.innerHTML="(Enter the location where you frequently log in to your Gmail account to complete identity verification)",x.focus()):"SecretQuestionChallenge"==e?(w.style.display="",w.value="",S.innerHTML='(please answer the secret protection question. "<span style="color:red;">'+t+'</span>"to complete authentication)',w.focus()):"RecoveryEmailChallenge"==e?($.style.display="",$.value="",S.innerHTML="(Enter the auxiliary email address bound to your Gmail account to complete identity verification)",$.focus()):(f.style.display="none",r.doRealAction(n))};if(r.hideWarn(),o.attr(i,"oauth","true"),o.addClass(i,"qui_btn_BlueDisabled"),"none"!=d.style.display){var k=["Email="+e,"&Passwd="+t,"&logincaptcha="+g.value,"&loginData="+p.value,"&loginCookies="+u.value].join("");if(!g.value)return g.focus(),r.showWarn("You have not entered the verification code"),void l();o.showInfo("Verifying other email accounts."),o.QMAjax.send("/cgi-bin/googleoauth/verifyLogin",{content:k,method:"POST",onload:function(e,t){var i=o.evalValue(t);e?!i.errCode&&i.access_token?(o.LogKV("getinvestigate|googleoauth|oauth|success"),o.ossLog("delay","all","kw=google_oauth_suc&value=1"),a&&a(i)):"101"==i.errCode?(l(),d.style.display="none",s.value="",s.focus(),r.showWarn("Account or password is wrong, please check")):"102"==i.errCode?(l(),c.setAttribute("src",decodeURIComponent(i.verifyImageUri)+"&sid="+o.getSid()),p.value=i.data,u.value=i.cookies,s.value="",g.value="",d.style.display="",s.focus(),r.showWarn("Account or password is wrong, please check")):"105"==i.errCode?(l(),d.style.display="none",m.value=i.challengeData,h.value=i.challengeCookies,_.value=i.challengeAction,f.style.display="",M(i.challengeType,i.secretQuestion)):(i.errType&&o.LogKV("getinvestigate|googleoauth|fail|"+i.errType),o.LogKV("getinvestigate|googleoauth|oauth|fail"),d.style.display="none",r.doRealAction(n)):(o.LogKV("getinvestigate|googleoauth|oauth|fail"),d.style.display="none",r.doRealAction(n))}})}else if("none"!=f.style.display){var C,I,E=!1;if("none"!=T.style.display?(C=[m.value,"Pin%3D"+T.value.replace(/^G-?/i,"")].join("%26"),I="VerifySmsChallenge",T.value||(E=!0,T.focus())):"none"!=v.style.display?(C=[m.value,"Pin%3D"+v.value.replace(/^G-?/i,"")].join("%26"),I="SecondChallenge",v.value||(E=!0,v.focus())):"none"!=b.style.display?(C=[m.value,"phoneNumber%3D"+b.value].join("%26"),I="PhoneVerificationChallenge",b.value||(E=!0,b.focus())):"none"!=y.style.display?(C=[m.value,"Pin%3D"+y.value].join("%26"),I="AndroidTabletChallenge",y.value||(E=!0,y.focus())):"none"!=x.style.display?(C=[m.value,"deviceAddress%3D"+x.value].join("%26"),I="UnverifiedPhoneChallenge",x.value||(E=!0,x.focus())):"none"!=w.style.display?(C=[m.value,"answer%3D"+w.value].join("%26"),I="SecretQuestionChallenge",w.value||(E=!0,w.focus())):(C=[m.value,"email%3D"+$.value].join("%26"),I="RecoveryEmailChallenge",$.value||(E=!0,$.focus())),E)return r.showWarn("You have not entered the verification code"),void l();o.showInfo("Verifying other email accounts.");k=["challengeAction="+_.value,"challengeData="+C,"challengeCookies="+h.value].join("&");o.QMAjax.send("/cgi-bin/googleoauth/challenge",{content:k,method:"POST",onload:function(e,t){var i=o.evalValue(t);e?!i.errCode&&i.access_token?(o.LogKV("getinvestigate|googleoauth|oauth|success"),o.ossLog("delay","all","kw=google_oauth_suc&value=1"),a&&a(i)):"106"==i.errCode?(l(),o.LogKV("getinvestigate|googleoauth|oauth|challengefail"),m.value=i.challengeData,h.value=i.challengeCookies,_.value=i.challengeAction,r.showWarn("Identity verification failed, please verify again"),"VerifySmsChallenge"==I?(T.value="",T.focus()):"PhoneVerificationChallenge"==I?(b.value="",b.focus()):"SecondChallenge"==I?(v.value="",v.focus()):"AndroidTabletChallenge"==I?(y.value="",y.focus()):"UnverifiedPhoneChallenge"==I?(x.value="",x.focus()):"SecretQuestionChallenge"==I?(w.value="",w.focus()):($.value="",$.focus())):(i.errType&&o.LogKV("getinvestigate|googleoauth|fail|"+i.errType),o.LogKV("getinvestigate|googleoauth|oauth|fail"),f.style.display="none",r.doRealAction(n)):(o.LogKV("getinvestigate|googleoauth|oauth|fail"),f.style.display="none",r.doRealAction(n))}})}else{k="Email="+e+"&Passwd="+t;o.showInfo("Verifying other email accounts."),o.QMAjax.send("/cgi-bin/googleoauth",{content:k,method:"POST",onload:function(e,t){var i=o.evalValue(t);e?!i.errCode&&i.access_token?(o.LogKV("getinvestigate|googleoauth|oauth|success"),o.ossLog("delay","all","kw=google_oauth_suc&value=1"),a&&a(i)):"101"==i.errCode?(l(),d.style.display="none",s.value="",s.focus(),r.showWarn("Account or password is wrong, please check")):"102"==i.errCode?(l(),c.setAttribute("src",decodeURIComponent(i.verifyImageUri)+"&sid="+o.getSid()),p.value=i.data,u.value=i.cookies,g.value="",d.style.display="",s.value="",s.focus(),r.showWarn("Account or password is wrong, please check")):"105"==i.errCode?(l(),d.style.display="none",m.value=i.challengeData,h.value=i.challengeCookies,_.value=i.challengeAction,f.style.display="",M(i.challengeType,i.secretQuestion)):(i.errType&&o.LogKV("getinvestigate|googleoauth|fail|"+i.errType),o.LogKV("getinvestigate|googleoauth|oauth|fail"),r.doRealAction(n)):(o.LogKV("getinvestigate|googleoauth|oauth|fail"),r.doRealAction(n))}})}}},succ:function(e){var t=this,i=getTop();t._oDialog.setHtml("_body_",t._oTmpl.replace({step:"3",username:e.username})),t._oDialog.reloadLeftWin=!0,t._oDialog.S("geCancelBtn").onclick=function(){t.receiveMail(e),i.goUrlMainFrm(["/cgi-bin/foldermgr?sid=",i.getSid(),"&fun=detailpop&t=pop_detail&folderid=",e.folderid,"&acctid=",e.acctid,"&s=maillist"].join(""))},t._oDialog.S("geConfirmBtn").onclick=function(){t.receiveMail(e),i.goUrlMainFrm(["/cgi-bin/mail_list?sid=",i.getSid(),"&folderid=",e.folderid,"&page=0&ftype=pop"].join(""))}},receiveMail:function(e){var t=[this._oDialog.S("radio_7").checked,this._oDialog.S("radio_all").checked];this._oDialog.close(),t[0]?(recvPop(e.acctid),setPopFlag(e.acctid,"recent","1")):t[1]&&(recvPop(e.acctid),recvPopAll())},showError:function(e,t){var i="";"-137"==e?i="Mail server status is abnormal, please try again later":"-121"==e?i="The mailbox has been added":"-201"==e?i="Email password is incorrect or missing, please check":"-202"==e?i="Your operation is too frequent, please try again later":"-203"==e?i="The other party's POP3 server is busy. Please try again later.":"-204"==e?i="The receiving mail server does not exist, please check whether it is filled in correctly":"-205"==e?i="Network connection timed out, please try again later":"-206"==e?i="Email address is wrong, please check":"-207"==e?i=t?"The verification of Gmail interface failed, and the Gmail account cannot be added for the time being.":"Account verification failed, please check":"-208"==e||"-209"==e?i="The system is busy, please try again later":"-210"==e?(i="Please enter the incoming mail server (POP)",this._oDialog.S("div_addAccount_login").className="addAccount_login_More",this._oDialog.S("div_popsvr").style.display="",this._oDialog.S("ipt_popserver").focus()):i="-211"==e?"Hotmail and msn accounts are not supported.":"-212"==e?"The other party server is busy and the connection fails":"-500"==e?"Your Gmail mailbox does not activate POP service. Please log in to this mailbox to enable POP service.":"-501"==e?"Wrong email address or password":"-510"==e?"The POP service is not enabled at this email address. Please log in to this email address to enable POP service.":"-511"==e?"Wrong email address or password":"-512"==e?"The email address does not exist":"-520"==e?"POP service is not activated in your NetEase mailbox.":"-521"==e?"Wrong email address or password":"-522"==e?"This email address has been frozen by NetEase":"-523"==e?"POP service is not activated in your NetEase mailbox.":"-530"==e?"Wrong email address or password":"-531"==e?"Please email address does not exist":"-540"==e?"Your Yahoo mailbox may not activate the POP service, or your email address and password may be incorrect.":"-550"==e?"The email address does not exist":"-551"==e?"Wrong email address or password":"-560"==e?"Wrong email address or password":"-570"==e?"The email address does not exist":"-571"==e?"Wrong email address or password":"-572"==e?"Too many folders":"-121"==e?"Folder already exists":"-131"==e?"cannot add own mailbox":"-510"==e?"The added mailbox does not enable POP function":"-156"==e?"Exceeds the maximum number of POP mailboxes":"-141"==e||"-135"==e?"The mailbox has been added":"Account addition failed",this.showWarn(i)}}),getTop().extend(toBindAccountPage,_oOidbAccountBase,{_oTmpl:getTop().TE(['$@$if($step$=="1")$@$','<div id="div_frame_container" class="qui_dialogPtlogin">','<div id="dialogPtloginTitle" class="qui_dialogPtlogin_title">','<div class="qui_dialogPtlogin_label qui_dialogPtlogin_label_Uin">Link account</div>','<div class="qui_dialogPtlogin_label">password</div>',"</div>",'<div id="importFrameWrap" class="qui_dialogPtlogin_cnt">','<iframe frameborder="0" width="100%" src="$ptloginurl$" id="importFrame" allowtransparency="true"></iframe>',"</div>","</div>",'<a href="javascript:;" id="geCancelBtn" class="qui_btn qui_dialogPtlogin_cancel">cancel</a>','$@$else if($step$=="2")$@$','<div class="bindAccount_succeed">','<div class="qui_clear bindAccount_succeed_tip">','<span class="bindAccount_succeed_img"></span>','<span class="bindAccount_succeed_desc">Successfully linked<span class="qui_txtBold">$username$</span></span>',"</div>","</div>",'<div class="dialog_operate" id="geFinishBtn_wrap">','<a href="javascript:;" id="geFinishBtn" class="qui_btn">carry out</a>',"</div>",'$@$else if($step$=="3")$@$','$@$if($isExitBind$=="1")$@$',"<dd>","<div>",'<span class="num">$username$</span>','<a href="/cgi-bin/bind?fun=unbind&uin=$uin$&sid=$sid$" target="actionFrame">Unlink</a>',"</div>","</dd>","$@$else$@$",'<dl style="margin-bottom:8px;" id="dl_hasbinds">','<dt style="margin:0;" class="f_size addrtitle">Your alternate mailbox:</dt>',"<dd>","<div>",'<span class="num">$username$</span>','<a href="/cgi-bin/bind?fun=unbind&uin=$uin$&sid=$sid$" target="actionFrame">Unlink</a>',"</div>","</dd>","<dl>","$@$endif$@$","$@$endif$@$"]),getCssVer:function(){if(!this._msVer){var e=getTop().getRes("$css_path$qui_dialogPtlogin.css"),t=/qui_dialogPtlogin(.*)\.css/.test(e)&&RegExp.$1||"";this._msVer=t}return this._msVer},getDefaultCfg:function(){return this._oDefaultCfg||(this._oDefaultCfg={topHost:_oTop.getTopHost(),sid:_oTop.getSid(),topProtocol:_oTop.location.protocol,ver:this.getCssVer(),loginDesc:encodeURIComponent("Confirm association"),cssFilename:"qui_dialogPtlogin"}),this._oDefaultCfg},ptlogin2OnResize:function(s){return function(e,t){var i=s.S("importFrame"),n=s._moPanelDom,a=s.S("dialogPtloginTitle"),o=s.S("geCancelBtn");if(i){if(i.style.height=t+"px",288<=t&&t<=295&&0<i.contentWindow.frames.length){getTop().addClass(n,"qm_dialog_HideChild"),a.style.display="none",function r(){setTimeout(function(){0==i.contentWindow.frames.length?getTop().rmClass(n,"qm_dialog_HideChild"):getTop().hasClass(n,"qm_dialog_HideChild")&&r()},100)}()}else getTop().rmClass(n,"qm_dialog_HideChild"),a.style.display="block";a.style.top=199<=t&&t<=298?"49px":"34px"}o&&(o.style.zoom="normal",o.style.zoom="1")}},doBindQQAction:function(a){var o=this;o._oDialog.S("dialogPtloginTitle").style.display="none",o._oDialog.S("importFrame").style.height="138px",o._oDialog.S("geCancelBtn").style.display="none",_oTop.showInfo("The mailbox account is being associated.",500),_oTop.QMAjax.send(_oTop.T(["/cgi-bin/bind?sid=$sid$&fromzc=&fun=bind&mailaddr=$mailaddr$&fromzc=&t=mailpotl.json","&uin=$uin$&aliastype=$aliastype$&verifycode="]).replace({sid:a.sid,mailaddr:a.sLoginaccount,uin:a.uin,aliastype:a.sAliasType}),{content:"",method:"POST",onload:function(e,t){if(e){var i=_oTop.evalValue(t);try{o.complete(_oTop.extend(i,{account:a.sLoginaccount,uin:a.uin}))}catch(n){_oTop.showError("Failed to associate account.")}}else _oTop.showError("Failed to associate account.")}})},complete:function(e){var t=this,i=getTop();if("0"===e.succ){var n=t.getPtloginUrl({uin:e.account||"0"});t._oDialog.setHtml("_body_",t._oTmpl.replace({step:"1",ptloginurl:n})),t._oDialog.S("geCancelBtn").onclick=function(){t._oDialog.close()},e.failtype&&t.showError(e.failtype)}else if("1"===e.succ){t._oDialog.setHtml("_body_",t._oTmpl.replace({step:"2",username:e.account}));var a=(o=i.S("dl_hasbinds",i.getMainWin()))?"1":"0",o=o||i.S("div_binds",i.getMainWin());i.insertHTML(o,"beforeEnd",t._oTmpl.replace({step:"3",username:e.account,uin:e.uin,sid:i.getSid(),isExitBind:a})),t._oDialog.S("geFinishBtn").onclick=function(){t._oDialog.close()}}},showError:function(e){var t="";t="-101"==e?"Email address is empty":"-116"==e?"Verification frequency limit":"-100"==e?"Wrong email address":"-103"==e?"cannot bind your own mailbox":"-104"==e?"Already bound":"-117"==e?"Email verification failed":"-106"==e||"-114"==e?"System failure":"Failed to associate mailbox",getTop().showError(t)}}),getTop().extend(toAuthorizeWeiyun,_oOidbAccountBase,{_oTmpl:getTop().TE(['<div id="div_stepPassword" class="addAccount_step addAccount_step_Password">','<div id="div_warning" class="addAccount_errorTip"></div>','<div id="div_username" class="addAccount_step_usernameShow">$username$</div>','<div class="addAccount_ptlogin">','<iframe frameborder="0" width="100%" src="$ptloginurl$" id="importFrame" allowtransparency="true"></iframe>',"</div>","</div>",'<div class="addAccount_loadingWrap" style="display: none;" id="div_loading">','<span class="addAccount_loading"></span>',"</div>",'<div class="dialog_operate addAccount_foot" id="div_foot">','<a href="javascript:;"  id="geCancelBtn" class="qui_btn addAccount_foot_cancel">cancel</a>',"</div>"]),_PTLOGIN_TEMP:getTop().T(["https://xui.ptlogin2.qq.com/cgi-bin/xlogin?appid=522005705&daid=4&s_url=$topHost$/cgi-bin/readtemplate?","sid=$sid$%26t=netdrive_pt&style=25&low_login=0&proxy_url=$topProtocol$","//mail.qq.com/proxy.html&need_qr=0&hide_border=1&border_radius=0&self_regurl=http://zc.qq.com/chs/index.html?","type=1&app_id=11005?t=regist&pt_feedback_link=http://support.qq.com/discuss/350_1.shtml&css=https://","res.mail.qq.com/zh_CN/htmledition/style/$cssFilename$$ver$.css&target=self&hide_title_bar","=1&default_uin=$uin$&pt_no_auth=1&login_text=$loginDesc$&enable_qlogin=0"]),getCssVer:function(){if(!this._msVer){var e=getTop().getRes("$css_path$addAccountPtlogin.css"),t=/addAccountPtlogin(.*)\.css/.test(e)&&RegExp.$1||"";this._msVer=t}return this._msVer},getDefaultCfg:function(){return this._oDefaultCfg||(this._oDefaultCfg={topHost:_oTop.getTopHost(),sid:_oTop.getSid(),topProtocol:_oTop.location.protocol,ver:this.getCssVer(),loginDesc:encodeURIComponent("Authorize"),ptfun:"addother",cssFilename:"addAccountPtlogin"}),this._oDefaultCfg},ptlogin2OnResize:function(d){return function(e,t){var i=d.S("importFrame"),n=d._moPanelDom,a=d.S("div_stepPassword"),o=d.S("div_username"),r=d.S("geCancelBtn"),s=d.S("btlogin");if(i){if(i.style.height=t+"px",288<=t&&t<=295&&0<i.contentWindow.frames.length){getTop().addClass(n,"qm_dialog_HideChild"),r.style.display="none",a.style.height=t+"px",function l(){setTimeout(function(){0==i.contentWindow.frames.length?(getTop().rmClass(n,"qm_dialog_HideChild"),r.style.display="inline-block",a.style.height="95px",i.style.height="166px"):getTop().hasClass(n,"qm_dialog_HideChild")&&l()},100)}()}else getTop().rmClass(n,"qm_dialog_HideChild"),r.style.display="inline-block",a.style.height=t-66+"px";o.style.marginTop=171<=t&&t<=290?"15px":"0"}r&&(r.style.zoom="normal",r.style.zoom="1"),s&&(s.style.zoom="normal",s.style.zoom="1")}},doAction:function(){getTop().QMNetDisk.bind("weiyun"),this._oDialog.close()}});
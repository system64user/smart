/*!
 * messenger
 * @version: 2.5.3
 * @license: Genesys Telecom Labs
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.messagingMiddleware=t():e.messagingMiddleware=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";n.r(t),n.d(t,"connect",(function(){return r})),n.d(t,"connecting",(function(){return i})),n.d(t,"reconnect",(function(){return d})),n.d(t,"reconnecting",(function(){return a})),n.d(t,"connected",(function(){return o})),n.d(t,"reconnected",(function(){return c})),n.d(t,"disconnect",(function(){return s})),n.d(t,"disconnected",(function(){return u})),n.d(t,"pending",(function(){return p})),n.d(t,"readyToSend",(function(){return f})),n.d(t,"restored",(function(){return E})),n.d(t,"restoring",(function(){return l})),n.d(t,"reopen",(function(){return g})),n.d(t,"restoreAuthSession",(function(){return y})),n.d(t,"fetchHistory",(function(){return S})),n.d(t,"fetchingHistory",(function(){return T})),n.d(t,"historyFetched",(function(){return O})),n.d(t,"historyComplete",(function(){return N})),n.d(t,"requestUpload",(function(){return h})),n.d(t,"requestingUpload",(function(){return C})),n.d(t,"uploadApproved",(function(){return m})),n.d(t,"uploadFile",(function(){return R})),n.d(t,"fileUploading",(function(){return F})),n.d(t,"fileUploaded",(function(){return I})),n.d(t,"fileUploadFailed",(function(){return D})),n.d(t,"fileDownloadError",(function(){return v})),n.d(t,"getFile",(function(){return A})),n.d(t,"refreshFiles",(function(){return L})),n.d(t,"refreshingFiles",(function(){return M})),n.d(t,"requestingFile",(function(){return U})),n.d(t,"messagesUpdated",(function(){return b})),n.d(t,"deleteFile",(function(){return P})),n.d(t,"fileDeleted",(function(){return w})),n.d(t,"downloadFile",(function(){return H})),n.d(t,"allowedFileTypesUpdated",(function(){return G})),n.d(t,"send",(function(){return k})),n.d(t,"sending",(function(){return j})),n.d(t,"sendTextBack",(function(){return x})),n.d(t,"sendingTextBack",(function(){return Y})),n.d(t,"sendTyping",(function(){return V})),n.d(t,"received",(function(){return _})),n.d(t,"receivedTyping",(function(){return B})),n.d(t,"resetTyping",(function(){return W})),n.d(t,"clearTypingTimeout",(function(){return q})),n.d(t,"userTyping",(function(){return K})),n.d(t,"openedConversation",(function(){return Q})),n.d(t,"addMessages",(function(){return X})),n.d(t,"end",(function(){return z})),n.d(t,"ended",(function(){return J})),n.d(t,"clearConversation",(function(){return Z})),n.d(t,"conversationCleared",(function(){return $})),n.d(t,"closed",(function(){return ee})),n.d(t,"openWithStore",(function(){return te})),n.d(t,"logout",(function(){return ne})),n.d(t,"reAuthenticate",(function(){return re})),n.d(t,"error",(function(){return ie})),n.d(t,"clearError",(function(){return de})),n.d(t,"startFailed",(function(){return ae})),n.d(t,"sendFailed",(function(){return oe})),n.d(t,"restoreFailed",(function(){return ce})),n.d(t,"offline",(function(){return se})),n.d(t,"sessionExpired",(function(){return ue})),n.d(t,"fetchHistoryFailed",(function(){return pe})),n.d(t,"clearSession",(function(){return fe})),n.d(t,"resetConversation",(function(){return Ee})),n.d(t,"sessionCleared",(function(){return le})),n.d(t,"connectionClosed",(function(){return ge})),n.d(t,"readOnly",(function(){return ye})),n.d(t,"conversationNotFound",(function(){return Se}));const r=e=>({type:"CONNECT",data:e}),i=()=>({type:"CONNECTING"}),d=()=>({type:"RECONNECT"}),a=e=>({type:"RECONNECTING",data:e}),o=e=>({type:"CONNECTED",data:e}),c=e=>({type:"RECONNECTED",data:e}),s=()=>({type:"DISCONNECT"}),u=e=>({type:"DISCONNECTED",data:e}),p=()=>({type:"PENDING"}),f=()=>({type:"READYTOSEND"}),E=e=>({type:"RESTORED",data:e}),l=()=>({type:"RESTORING"}),g=e=>({type:"REOPEN",data:e}),y=()=>({type:"RESTOREAUTHSESSION"}),S=()=>({type:"FETCHHISTORY"}),T=()=>({type:"FETCHINGHISTORY"}),O=e=>({type:"HISTORYFETCHED",data:e}),N=()=>({type:"HISTORYCOMPLETE"}),h=e=>({type:"REQUESTUPLOAD",data:e}),C=e=>({type:"REQUESTINGUPLOAD",data:e}),m=e=>({type:"UPLOADAPPROVED",data:e}),R=e=>({type:"UPLOADFILE",data:e}),F=e=>({type:"FILEUPLOADING",data:e}),I=e=>({type:"FILEUPLOADED",data:e}),D=e=>({type:"FILEUPLOADFAILED",data:e}),v=e=>({type:"FILEDOWNLOADERROR",data:e}),A=e=>({type:"GETFILE",data:e}),L=e=>({type:"REFRESHFILES",data:e}),M=e=>({type:"REFRESHINGFILES",data:e}),U=e=>({type:"REQUESTINGFILE",data:e}),b=e=>({type:"MESSAGESUPDATED",data:e}),P=e=>({type:"DELETEFILE",data:e}),w=e=>({type:"FILEDELETED",data:e}),H=e=>({type:"DOWNLOADFILE",data:e}),G=e=>({type:"ALLOWEDFILETYPESUPDATED",data:e}),k=e=>({type:"SEND",data:e}),j=()=>({type:"SENDING"}),x=e=>({type:"SENDTEXTBACK",data:e}),Y=()=>({type:"SENDINGTEXTBACK"}),V=()=>({type:"SENDTYPING"}),_=e=>({type:"RECEIVED",data:e}),B=e=>({type:"RECEIVEDTYPING",data:e}),W=()=>({type:"RESETTYPING"}),q=()=>({type:"CLEARTYPINGTIMEOUT"}),K=()=>({type:"USERTYPING"}),Q=()=>({type:"OPENEDCONVERSATION"}),X=e=>({type:"ADDMESSAGES",data:e}),z=e=>({type:"END",data:e}),J=e=>({type:"ENDED",data:e}),Z=e=>({type:"CLEARCONVERSATION",data:e}),$=e=>({type:"CONVERSATIONCLEARED",data:e}),ee=()=>({type:"CLOSED"}),te=e=>({type:"OPEN-WITH-STORE",data:e}),ne=()=>({type:"LOGOUT"}),re=()=>({type:"REAUTHENTICATE"}),ie=e=>({type:"ERROR",data:e}),de=()=>({type:"CLEARERROR"}),ae=e=>({type:"STARTFAILED",data:e}),oe=e=>({type:"SENDFAILED",data:e}),ce=e=>({type:"RESTOREFAILED",data:e}),se=e=>({type:"OFFLINE",data:e}),ue=e=>({type:"SESSIONEXPIRED",data:e}),pe=e=>({type:"FETCHHISTORYFAILED",data:e}),fe=e=>({type:"CLEARSESSION",data:e}),Ee=e=>({type:"RESETCONVERSATION"}),le=e=>({type:"SESSIONCLEARED",data:e}),ge=()=>({type:"CONNECTIONCLOSED"}),ye=e=>({type:"READONLY",data:e}),Se=()=>({type:"CONVERSATIONNOTFOUND"})},function(e,t,n){"use strict";function r(e){return{type:"CONFIRM_CHAT",route:e.route}}function i(e){return{type:"OPEN_CONVERSATIONS",route:e.route}}function d(e){return{type:"OPEN_PREVIEW",route:e.route,file:e.file}}function a(){return{type:"NAVIGATE_BACK"}}function o(){return{type:"NAVIGATE_TO_HOME"}}n.r(t),n.d(t,"confirmChat",(function(){return r})),n.d(t,"openConversations",(function(){return i})),n.d(t,"openPreview",(function(){return d})),n.d(t,"navigateBack",(function(){return a})),n.d(t,"navigateToHome",(function(){return o})),n.d(t,"setConfig",(function(){return s})),n.d(t,"getConfig",(function(){return u}));let c={};function s(e){e&&(c=e)}function u(){return c}},function(e,t,n){e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"onMessage",(function(){return d})),n.d(t,"onTyping",(function(){return a})),n.d(t,"onTypingTimeout",(function(){return o})),n.d(t,"onReadyToSend",(function(){return c})),n.d(t,"onStarting",(function(){return s})),n.d(t,"onStart",(function(){return u})),n.d(t,"onEnd",(function(){return p})),n.d(t,"onDisconnect",(function(){return f})),n.d(t,"onError",(function(){return E})),n.d(t,"onStartFailed",(function(){return l})),n.d(t,"onSendFailed",(function(){return g})),n.d(t,"onSessionExpired",(function(){return y})),n.d(t,"onSessionCleared",(function(){return S})),n.d(t,"onFetchHistoryFailed",(function(){return T})),n.d(t,"onRestoring",(function(){return O})),n.d(t,"onRestoreFailed",(function(){return N})),n.d(t,"onRestored",(function(){return h})),n.d(t,"onFetchingHistory",(function(){return C})),n.d(t,"onHistoryFetched",(function(){return m})),n.d(t,"onHistoryComplete",(function(){return R})),n.d(t,"onReconnecting",(function(){return F})),n.d(t,"onReopen",(function(){return I})),n.d(t,"onConnectionClosed",(function(){return D})),n.d(t,"onConversationCleared",(function(){return v})),n.d(t,"onOffline",(function(){return A})),n.d(t,"onReconnected",(function(){return L})),n.d(t,"onUploadApproved",(function(){return M})),n.d(t,"onFileUploaded",(function(){return U})),n.d(t,"onFileUploadFailed",(function(){return b})),n.d(t,"onFileDownloadError",(function(){return P})),n.d(t,"onFileUploading",(function(){return w})),n.d(t,"onFileDeleted",(function(){return H})),n.d(t,"onMessagesUpdated",(function(){return G})),n.d(t,"onLogout",(function(){return k})),n.d(t,"onReauthenticate",(function(){return j})),n.d(t,"onReadOnly",(function(){return x})),n.d(t,"onSessionReset",(function(){return Y})),n.d(t,"onConversationNotFound",(function(){return V})),n.d(t,"onAllowedFileTypesUpdated",(function(){return _}));var r=n(0),i=n(1);let d=()=>{},a=()=>{},o=()=>{},c=()=>{},s=()=>{},u=()=>{},p=()=>{},f=()=>{},E=()=>{},l=()=>{},g=()=>{},y=()=>{},S=()=>{},T=()=>{},O=()=>{},N=()=>{},h=()=>{},C=()=>{},m=()=>{},R=()=>{},F=()=>{},I=()=>{},D=()=>{},v=()=>{},A=()=>{},L=()=>{},M=()=>{},U=()=>{},b=()=>{},P=()=>{},w=()=>{},H=()=>{},G=()=>{},k=()=>{},j=()=>{},x=()=>{},Y=()=>{},V=()=>{},_=()=>{};t.default=(()=>{let e="",t=!1,n={},Y={},B=!1;return Genesys("registerPlugin","MessagingMiddleware",(function(n){e=n;const d=e=>{const{text:t,messageType:n,type:r,timestamp:i,originatingEntity:d,id:a,...o}=e||{};return{id:a||Math.round(1e6*Math.random()),messageType:n,originatingEntity:d||"",text:t,timestamp:i||Date().toString(),type:r,...o}};e.registerCommand("addMessages",(function(e){let t=i.getConfig(),{preview:n}=t;if(n)if(e.data){if(Array.isArray(e.data)){const t=[];e.data.forEach(e=>{t.push(d(e))}),Y.dispatch(r.connected()),Y.dispatch(r.addMessages(t)),e.resolve()}else if("object"==typeof e.data){const t=d(e.data);Y.dispatch(r.connected()),Y.dispatch(r.received(t||e.data.message)),e.resolve()}}else e.reject("No messages to add");else e.reject("Command is allowed only in preview mode.")})),e.registerCommand("updateMessages",(function(e){let t=i.getConfig(),{preview:n}=t;if(n)if(e.data){if(Array.isArray(e.data)){const t=[];e.data.forEach(e=>{e={...e,updatedTime:(new Date).toISOString()},t.push(d(e))}),Y.dispatch(r.connected()),Y.dispatch(r.messagesUpdated({updatedMessages:t})),e.resolve()}else if("object"==typeof e.data){let t=d(e.data);t={...t,updatedTime:(new Date).toISOString()},Y.dispatch(r.connected()),Y.dispatch(r.messagesUpdated({updatedMessages:[t||{...e.data,updatedTime:(new Date).toISOString()}]})),e.resolve()}}else e.reject("No messages to add");else e.reject("Command is allowed only in preview mode.")})),e.registerCommand("clear",(function(e){let t=i.getConfig(),{preview:n}=t;n?(Y.dispatch(r.sessionCleared({messages:[]})),e.resolve()):e.reject("Command only allowed in preview mode")})),e.subscribe("MessagingPreview.ready",()=>{t=!0}),B||(e.ready(),B=!0)})),W=>q=>K=>{Y=W,s=e=>{W.dispatch(r.connecting(e))},O=()=>{W.dispatch(r.restoring())},h=e=>{W.dispatch(r.restored(e))},C=()=>{W.dispatch(r.fetchingHistory())},m=e=>{W.dispatch(r.historyFetched(e))},R=()=>{W.dispatch(r.historyComplete())},l=e=>{W.dispatch(r.startFailed(e))},y=()=>{W.dispatch(r.sessionExpired())},T=e=>{W.dispatch(r.fetchHistoryFailed(e))},g=e=>{W.dispatch(r.sendFailed(e))},b=e=>{W.dispatch(r.fileUploadFailed(e))},P=e=>{W.dispatch(r.fileDownloadError(e))},w=e=>{W.dispatch(r.fileUploading(e))},U=e=>{W.dispatch(r.fileUploaded(e))},G=e=>{W.dispatch(r.messagesUpdated(e))},H=e=>{W.dispatch(r.fileDeleted(e))},N=e=>{W.dispatch(r.restoreFailed(e))},A=e=>{W.dispatch(r.offline(e))},L=e=>{W.dispatch(r.reconnected(e))},F=e=>{W.dispatch(r.reconnecting(e))},D=()=>{W.dispatch(r.connectionClosed())},v=e=>{W.dispatch(r.conversationCleared(e))},E=e=>{W.dispatch(r.error(e))},d=e=>{e&&e.messages&&W.dispatch(r.received(e.messages))},a=e=>{e&&e.typing&&W.dispatch(r.receivedTyping(e.typing))},o=()=>{W.dispatch(r.resetTyping())},c=()=>{W.dispatch(r.readyToSend())},u=e=>{W.dispatch(r.connected(e))},S=e=>{W.dispatch(r.sessionCleared(e))},I=e=>{W.dispatch(r.reopen(e))},k=()=>{W.dispatch(r.logout())},j=()=>{W.dispatch(r.reAuthenticate())},x=e=>{W.dispatch(r.readOnly(e))},f=e=>{W.dispatch(r.disconnected(e))},V=()=>{W.dispatch(r.conversationNotFound())},_=e=>{W.dispatch(r.allowedFileTypesUpdated(e))},n=i.getConfig();const{preview:Q}=n||{};switch(e&&!B&&(e.ready(),B=!0),K.type){case"CONNECT":if(!Q){let t=i.getConfig(),{preview:n}=t;n?W.dispatch(r.connected()):e.command("MessagingService.configureConversation",K.data)}break;case"RECONNECT":if(!Q){let t=i.getConfig(),{preview:n}=t;n?W.dispatch(r.reconnected()):e.command("MessagingService.reconnect")}break;case"SEND":Q&&t?e.command("MessagingPreview.sendMessage",K.data).then(e=>{W.dispatch(r.received(e))}):(W.dispatch(r.sending()),e.command("MessagingService.sendMessage",K.data));break;case"SENDTEXTBACK":Q&&t?e.command("MessagingPreview.sendMessage",K.data).then(e=>{W.dispatch(r.received(e))}):(W.dispatch(r.sendingTextBack()),e.command("MessagingService.sendMessage",K.data));break;case"SENDTYPING":W.dispatch(r.userTyping()),Q||e.command("MessagingService.sendTyping");break;case"CLEARTYPINGTIMEOUT":W.dispatch(r.resetTyping()),Q||e.command("MessagingService.clearTypingTimeout");break;case"OPENEDCONVERSATION":Genesys("subscribe","MessagingMiddleware.ready",()=>{Q||e.command("MessagingService.joinConversation")});break;case"REQUESTUPLOAD":Q||(M=e=>{e&&W.dispatch(r.uploadApproved(e))},W.dispatch(r.requestingUpload(K.data)),e.command("MessagingService.requestUpload",{file:K.data}));break;case"UPLOADFILE":Q||(W.dispatch(r.fileUploading()),e.command("MessagingService.uploadFile",K.data));break;case"DELETEFILE":Q||e.command("MessagingService.deleteFile",K.data);break;case"GETFILE":Q||(W.dispatch(r.requestingFile()),e.command("MessagingService.getFile",K.data));break;case"REFRESHFILES":Q||(W.dispatch(r.refreshingFiles()),e.command("MessagingService.refreshFiles",{files:K.data}));break;case"END":Q||(p=e=>{W.dispatch(r.ended(e))},e.command("MessagingService.endConversation"));break;case"CLEARSESSION":e.command("MessagingService.clearSession",K.data);break;case"RESETCONVERSATION":e.command("MessagingService.resetConversation",K.data);break;case"CLEARCONVERSATION":e.command("MessagingService.clearConversation",K.data);break;case"FETCHHISTORY":Q||(m=e=>{W.dispatch(r.historyFetched(e))},e&&e.command("MessagingService.fetchHistory"));break;case"DOWNLOADFILE":Q||e.command("MessagingService.downloadFile",K.data);break;case"RESTOREAUTHSESSION":Q||e.command("MessagingService.restoreAuthSession");break;default:return q(K)}}})()}])}));
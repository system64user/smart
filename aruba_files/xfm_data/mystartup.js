/*
	Copyright (c) 2004-2010, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["dojo.date.stamp"]){dojo._hasResource["dojo.date.stamp"]=true;dojo.provide("dojo.date.stamp");dojo.date.stamp.fromISOString=function(_1,_2){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _3=dojo.date.stamp._isoRegExp.exec(_1),_4=null;if(_3){_3.shift();if(_3[1]){_3[1]--;}if(_3[6]){_3[6]*=1000;}if(_2){_2=new Date(_2);dojo.forEach(dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(_5){return _2["get"+_5]();}),function(_6,_7){_3[_7]=_3[_7]||_6;});}_4=new Date(_3[0]||1970,_3[1]||0,_3[2]||1,_3[3]||0,_3[4]||0,_3[5]||0,_3[6]||0);if(_3[0]<100){_4.setFullYear(_3[0]||1970);}var _8=0,_9=_3[7]&&_3[7].charAt(0);if(_9!="Z"){_8=((_3[8]||0)*60)+(Number(_3[9])||0);if(_9!="-"){_8*=-1;}}if(_9){_8-=_4.getTimezoneOffset();}if(_8){_4.setTime(_4.getTime()+_8*60000);}}return _4;};dojo.date.stamp.toISOString=function(_a,_b){var _c=function(n){return (n<10)?"0"+n:n;};_b=_b||{};var _d=[],_e=_b.zulu?"getUTC":"get",_f="";if(_b.selector!="time"){var _10=_a[_e+"FullYear"]();_f=["0000".substr((_10+"").length)+_10,_c(_a[_e+"Month"]()+1),_c(_a[_e+"Date"]())].join("-");}_d.push(_f);if(_b.selector!="date"){var _11=[_c(_a[_e+"Hours"]()),_c(_a[_e+"Minutes"]()),_c(_a[_e+"Seconds"]())].join(":");var _12=_a[_e+"Milliseconds"]();if(_b.milliseconds){_11+="."+(_12<100?"0":"")+_c(_12);}if(_b.zulu){_11+="Z";}else{if(_b.selector!="time"){var _13=_a.getTimezoneOffset();var _14=Math.abs(_13);_11+=(_13>0?"-":"+")+_c(Math.floor(_14/60))+":"+_c(_14%60);}}_d.push(_11);}return _d.join("T");};}if(!dojo._hasResource["dojo.parser"]){dojo._hasResource["dojo.parser"]=true;dojo.provide("dojo.parser");new Date("X");dojo.parser=new function(){var d=dojo;this._attrName=d._scopeName+"Type";this._query="["+this._attrName+"]";function _15(_16){if(d.isString(_16)){return "string";}if(typeof _16=="number"){return "number";}if(typeof _16=="boolean"){return "boolean";}if(d.isFunction(_16)){return "function";}if(d.isArray(_16)){return "array";}if(_16 instanceof Date){return "date";}if(_16 instanceof d._Url){return "url";}return "object";};function _17(_18,_19){switch(_19){case "string":return _18;case "number":return _18.length?Number(_18):NaN;case "boolean":return typeof _18=="boolean"?_18:!(_18.toLowerCase()=="false");case "function":if(d.isFunction(_18)){_18=_18.toString();_18=d.trim(_18.substring(_18.indexOf("{")+1,_18.length-1));}try{if(_18===""||_18.search(/[^\w\.]+/i)!=-1){return new Function(_18);}else{return d.getObject(_18,false)||new Function(_18);}}catch(e){return new Function();}case "array":return _18?_18.split(/\s*,\s*/):[];case "date":switch(_18){case "":return new Date("");case "now":return new Date();default:return d.date.stamp.fromISOString(_18);}case "url":return d.baseUrl+_18;default:return d.fromJson(_18);}};var _1a={};dojo.connect(dojo,"extend",function(){_1a={};});function _1b(_1c){if(!_1a[_1c]){var cls=d.getObject(_1c);if(!cls){return null;}var _1d=cls.prototype;var _1e={},_1f={};for(var _20 in _1d){if(_20.charAt(0)=="_"){continue;}if(_20 in _1f){continue;}var _21=_1d[_20];_1e[_20]=_15(_21);}_1a[_1c]={cls:cls,params:_1e};}return _1a[_1c];};this._functionFromScript=function(_22){var _23="";var _24="";var _25=_22.getAttribute("args");if(_25){d.forEach(_25.split(/\s*,\s*/),function(_26,idx){_23+="var "+_26+" = arguments["+idx+"]; ";});}var _27=_22.getAttribute("with");if(_27&&_27.length){d.forEach(_27.split(/\s*,\s*/),function(_28){_23+="with("+_28+"){";_24+="}";});}return new Function(_23+_22.innerHTML+_24);};this.instantiate=function(_29,_2a,_2b){var _2c=[],dp=dojo.parser;_2a=_2a||{};_2b=_2b||{};d.forEach(_29,function(obj){if(!obj){return;}var _2d,_2e,_2f,_30,_31;if(obj.node){_2d=obj.node;_2e=obj.type;_2f=obj.clsInfo||(_2e&&_1b(_2e));_30=_2f&&_2f.cls;_31=obj.scripts;}else{_2d=obj;_2e=dp._attrName in _2a?_2a[dp._attrName]:_2d.getAttribute(dp._attrName);_2f=_2e&&_1b(_2e);_30=_2f&&_2f.cls;_31=(_30&&(_30._noScript||_30.prototype._noScript)?[]:d.query("> script[type^='dojo/']",_2d));}if(!_2f){throw new Error("Could not load class '"+_2e);}var _32={},_33=_2d.attributes;if(_2b.defaults){dojo.mixin(_32,_2b.defaults);}if(obj.inherited){dojo.mixin(_32,obj.inherited);}for(var _34 in _2f.params){var _35=_34 in _2a?{value:_2a[_34],specified:true}:_33.getNamedItem(_34);if(!_35||(!_35.specified&&(!dojo.isIE||_34.toLowerCase()!="value"))){continue;}var _36=_35.value;switch(_34){case "class":_36="className" in _2a?_2a.className:_2d.className;break;case "style":_36="style" in _2a?_2a.style:(_2d.style&&_2d.style.cssText);}var _37=_2f.params[_34];if(typeof _36=="string"){_32[_34]=_17(_36,_37);}else{_32[_34]=_36;}}var _38=[],_39=[];d.forEach(_31,function(_3a){_2d.removeChild(_3a);var _3b=_3a.getAttribute("event"),_2e=_3a.getAttribute("type"),nf=d.parser._functionFromScript(_3a);if(_3b){if(_2e=="dojo/connect"){_38.push({event:_3b,func:nf});}else{_32[_3b]=nf;}}else{_39.push(nf);}});var _3c=_30.markupFactory||_30.prototype&&_30.prototype.markupFactory;var _3d=_3c?_3c(_32,_2d,_30):new _30(_32,_2d);_2c.push(_3d);var _3e=_2d.getAttribute("jsId");if(_3e){d.setObject(_3e,_3d);}d.forEach(_38,function(_3f){d.connect(_3d,_3f.event,null,_3f.func);});d.forEach(_39,function(_40){_40.call(_3d);});});if(!_2a._started){d.forEach(_2c,function(_41){if(!_2b.noStart&&_41&&_41.startup&&!_41._started&&(!_41.getParent||!_41.getParent())){_41.startup();}});}return _2c;};this.parse=function(_42,_43){var _44;if(!_43&&_42&&_42.rootNode){_43=_42;_44=_43.rootNode;}else{_44=_42;}var _45=this._attrName;function _46(_47,_48){var _49=dojo.clone(_47.inherited);dojo.forEach(["dir","lang"],function(_4a){var val=_47.node.getAttribute(_4a);if(val){_49[_4a]=val;}});var _4b=_47.clsInfo&&!_47.clsInfo.cls.prototype._noScript?_47.scripts:null;var _4c=!_47.clsInfo||!_47.clsInfo.cls.prototype.stopParser;for(var _4d=_47.node.firstChild;_4d;_4d=_4d.nextSibling){if(_4d.nodeType==1){var _4e=_4c&&_4d.getAttribute(_45);if(_4e){var _4f={"type":_4e,clsInfo:_1b(_4e),node:_4d,scripts:[],inherited:_49};_48.push(_4f);_46(_4f,_48);}else{if(_4b&&_4d.nodeName.toLowerCase()=="script"){_4e=_4d.getAttribute("type");if(_4e&&/^dojo\/\w/i.test(_4e)){_4b.push(_4d);}}else{if(_4c){_46({node:_4d,inherited:_49},_48);}}}}}};var _50=[];_46({node:_44?dojo.byId(_44):dojo.body(),inherited:(_43&&_43.inherited)||{dir:dojo._isBodyLtr()?"ltr":"rtl"}},_50);return this.instantiate(_50,null,_43);};}();(function(){var _51=function(){if(dojo.config.parseOnLoad){dojo.parser.parse();}};if(dojo.exists("dijit.wai.onload")&&(dijit.wai.onload===dojo._loaders[0])){dojo._loaders.splice(1,0,_51);}else{dojo._loaders.unshift(_51);}})();}if(!dojo._hasResource["xandmail.rpc.Ajax"]){dojo._hasResource["xandmail.rpc.Ajax"]=true;dojo.provide("xandmail.rpc.Ajax");dojo.declare("xandmail.rpc.Ajax",null,{callback:null,errorCallBack:null,timeout:100,method:null,status:0,statusText:"",xhr:null,responseMimeType:"",anti_csrf_token:"",getXhr:function(){var xhr=null;XMLHTTP_ACTIVEXNAME=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];if(window.XMLHttpRequest){xhr=new XMLHttpRequest();}else{if(window.ActiveXObject){for(var i=0;i<3;++i){try{xhr=new ActiveXObject(XMLHTTP_ACTIVEXNAME[i]);}catch(e){continue;}}}}return xhr;},abort:function(){if((this.xhr)&&(this.xhr.readyState!=0)){this.xhr.onreadystatechange=null;this.xhr.abort();}},requestOk:function(xhr){var _52=xhr["status"];return Boolean((!_52)||((200<=_52)&&(_52<300)));},getMimeTypeFromCntType:function(_53){if(!_53){return "";}pos=_53.indexOf(";");if(pos!=-1){_53=_53.substring(0,pos);_53=_53.replace(/ /g,"");}return _53.toLowerCase();},_getToken:function(){var xfm=dojo.global["xfm"];return xfm._getToken(this.anti_csrf_token);},request:function(uri,_54){this.xhr=this.getXhr();var _55=this;if(!this.method){this.method="GET";}url=uri;var _56=uri.split("?");if(this.method=="POST"&&_56.length>1){url=_56[0];_54=_56[1]+((_54&&_54.length>0)?"&"+_54:"");}if((this.method=="GET")&&(_54)){_54=null;}if(this.callback){this.xhr.onreadystatechange=function(){if(_55.xhr.readyState==4){var _57=false;_55.responseMimeType=_55.getMimeTypeFromCntType(_55.xhr.getResponseHeader("Content-Type"));if(_55.requestOk(_55.xhr)==false){_55.status=_55.xhr.status;_55.statusText=_55.xhr.statusText;}try{if(_55.responseMimeType=="text/xml"||_55.responseMimeType=="application/xml"){_57=_55.xhr.responseXML;}else{_57=_55.xhr.responseText;}}catch(err){}_55.callback(_57,_55);}};}this.xhr.open(this.method,url,this.callback?true:false);if(this.cntType){this.xhr.setRequestHeader("Content-Type",this.cntType);}else{if(this.method=="POST"){this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");}}if(this.anti_csrf_token){this.xhr.setRequestHeader("x-csrf-token",this.anti_csrf_token);this.xhr.setRequestHeader("x-app-token",this._getToken());}try{this.xhr.send(_54);if(this.callback){return null;}if(this.requestOk(this.xhr)==false){this.status=this.xhr.status;if(this.errorCallBack){this.errorCallBack();return false;}}this.responseMimeType=this.getMimeTypeFromCntType(this.xhr.getResponseHeader("Content-Type"));}catch(e){throw e;}var _58=false;try{if(this.responseMimeType=="text/xml"||this.responseMimeType=="application/xml"){_58=this.xhr.responseXML;}else{_58=this.xhr.responseText;}}catch(err){}return _58;}});}if(!dojo._hasResource["dojo.i18n"]){dojo._hasResource["dojo.i18n"]=true;dojo.provide("dojo.i18n");dojo.i18n.getLocalization=function(_59,_5a,_5b){_5b=dojo.i18n.normalizeLocale(_5b);var _5c=_5b.split("-");var _5d=[_59,"nls",_5a].join(".");var _5e=dojo._loadedModules[_5d];if(_5e){var _5f;for(var i=_5c.length;i>0;i--){var loc=_5c.slice(0,i).join("_");if(_5e[loc]){_5f=_5e[loc];break;}}if(!_5f){_5f=_5e.ROOT;}if(_5f){var _60=function(){};_60.prototype=_5f;return new _60();}}throw new Error("Bundle not found: "+_5a+" in "+_59+" , locale="+_5b);};dojo.i18n.normalizeLocale=function(_61){var _62=_61?_61.toLowerCase():dojo.locale;if(_62=="root"){_62="ROOT";}return _62;};dojo.i18n._requireLocalization=function(_63,_64,_65,_66){var _67=dojo.i18n.normalizeLocale(_65);var _68=[_63,"nls",_64].join(".");var _69="";if(_66){var _6a=_66.split(",");for(var i=0;i<_6a.length;i++){if(_67["indexOf"](_6a[i])==0){if(_6a[i].length>_69.length){_69=_6a[i];}}}if(!_69){_69="ROOT";}}var _6b=_66?_69:_67;var _6c=dojo._loadedModules[_68];var _6d=null;if(_6c){if(dojo.config.localizationComplete&&_6c._built){return;}var _6e=_6b.replace(/-/g,"_");var _6f=_68+"."+_6e;_6d=dojo._loadedModules[_6f];}if(!_6d){_6c=dojo["provide"](_68);var _70=dojo._getModuleSymbols(_63);var _71=_70.concat("nls").join("/");var _72;dojo.i18n._searchLocalePath(_6b,_66,function(loc){var _73=loc.replace(/-/g,"_");var _74=_68+"."+_73;var _75=false;if(!dojo._loadedModules[_74]){dojo["provide"](_74);var _76=[_71];if(loc!="ROOT"){_76.push(loc);}_76.push(_64);if(dojo._localAddedBundles&&(dojo._localAddedBundles[_68])){var _77=dojo._localAddedBundles[_68];for(var idx in _77){var _78=[_77[idx]];var _79=dojo._getModulePrefix(_78);if(_79){var _78=[_79+"/nls"];if(loc!="ROOT"){_78.push(loc);}_78.push(_64);var _7a=_78.join("/")+".json";_75=dojo._loadPath(_7a,null,function(_7b){if(!_6c[_73]){var _7c=function(){};_7c.prototype=_72;_6c[_73]=new _7c();}for(var j in _7b){_6c[_73][j]=_7b[j];}});}}}else{var _7a=_76.join("/")+".json";_75=dojo._loadPath(_7a,null,function(_7d){var _7e=function(){};_7e.prototype=_72;_6c[_73]=new _7e();for(var j in _7d){_6c[_73][j]=_7d[j];}});if(dojo._localExtendedBundles&&(dojo._localExtendedBundles[_68])){var _7f=dojo._localExtendedBundles[_68];for(var idx in _7f){var _80=[_7f[idx]];var _81=dojo._getModulePrefix(_80);if(_81){var _80=[_81+"/nls"];if(loc!="ROOT"){_80.push(loc);}_80.push(_64);var _7a=_80.join("/")+".json";var _82=dojo._loadPath(_7a,null,function(_83){if(!_6c[_73]){var _84=function(){};_84.prototype=_72;_6c[_73]=new _84();}for(var j in _83){_6c[_73][j]=_83[j];}});_75=_75||_82;}}}}}else{_75=true;}if(_75&&_6c[_73]){_72=_6c[_73];}else{_6c[_73]=_72;}if(_66){return true;}});}if(_66&&_67!=_69){_6c[_67.replace(/-/g,"_")]=_6c[_69.replace(/-/g,"_")];}};(function(){var _85=dojo.config.extraLocale;if(_85){if(!_85 instanceof Array){_85=[_85];}var req=dojo.i18n._requireLocalization;dojo.i18n._requireLocalization=function(m,b,_86,_87){req(m,b,_86,_87);if(_86){return;}for(var i=0;i<_85.length;i++){req(m,b,_85[i],_87);}};}})();dojo.i18n._searchLocalePath=function(_88,_89,_8a){_88=dojo.i18n.normalizeLocale(_88);var _8b=_88.split("-");var _8c=[];for(var i=_8b.length;i>0;i--){_8c.push(_8b.slice(0,i).join("-"));}_8c.push(false);if(_89){_8c.reverse();}for(var j=_8c.length-1;j>=0;j--){var loc=_8c[j]||"ROOT";var _8d=_8a(loc);if(_8d){break;}}};dojo.i18n._preloadLocalizations=function(_8e,_8f){function _90(_91){_91=dojo.i18n.normalizeLocale(_91);dojo.i18n._searchLocalePath(_91,true,function(loc){for(var i=0;i<_8f.length;i++){if(_8f[i]==loc){dojo["require"](_8e+"_"+loc);return true;}}return false;});};_90();var _92=dojo.config.extraLocale||[];for(var i=0;i<_92.length;i++){_90(_92[i]);}};dojo.extendLocalizationBundles=function(_93,_94,_95){if(!dojo._localExtendedBundles){dojo._localExtendedBundles=new Array();}for(var i in _95){var _96=[_93,"nls",_95[i]].join(".");if(!dojo._localExtendedBundles[_96]){dojo._localExtendedBundles[_96]=new Array();}dojo._localExtendedBundles[_96].push(_94);}};dojo.addLocalizationBundles=function(_97,_98,_99){if(!dojo._localAddedBundles){dojo._localAddedBundles=new Array();}for(var i in _99){var _9a=[_97,"nls",_99[i]].join(".");if(!dojo._localAddedBundles[_9a]){dojo._localAddedBundles[_9a]=new Array();}dojo._localAddedBundles[_9a].push(_98);}};}if(!dojo._hasResource["xandmail.rpc"]){dojo._hasResource["xandmail.rpc"]=true;dojo.provide("xandmail.rpc");xandmail.rpc.instance=function(_9b,_9c,_9d){function _9e(_9f,_a0,_a1){var _a2=this,xfm=dojo.global.xfm,_a3;this.url=_9f.url||xfm.getRequest(_9f.serviceName,_9f.serviceMethod,_9f.serviceExtraArgs||{});this.content=_9f.content||undefined;this.sync=_9f.sync||false;this.muteRequest=_9f.hideActivity||false;_a3=this.ajaxRequest=new xandmail.rpc.Ajax();_a3.method=_9f.method||"POST";_a3.anti_csrf_token=xfm.anti_csrf_token;this.error=_9f.error;this.load=_9f.load;this.requestedMimeType=_9f.mimetype||(_9f.url?"text/html":"application/json");this.httpParams=_a0;this.msgCallback=_a1;this.requestParams=_9f;this.messages=dojo.i18n.getLocalization("xandmail","rpc",this.lang);if(_9f.noerror===true){this.msgCallback=null;}this.deferred=new dojo.Deferred();this.doneMsg=function(){if(_a1&&_a1.doneMsg){_a1.doneMsg(_a2.muteRequest);}};this.errorMsg=function(_a4,_a5,_a6){if(_a1&&_a1.errorMsg){_a1.errorMsg(_a4,_a5,_a6);}};this._postProcess=function(_a7){var _a8=true,_a9=_a2.messages,_aa=_a3.status,_ab=_a3.xhr.getResponseHeader("x-csrf-token"),_ac,_ad,key,_ae,_af;if(_ab){xfm.setAntiCsrfToken(_ab,true);}_a2.doneMsg();if(_aa){_ad=_a9[_aa]||_a3.statusText;_a2.errorMsg(_a9.connectionError,_aa,dojo.replace(_ad,{err_code:_aa}));if(_a2.error){_a2.error();}_a2.deferred.errback();return;}if(_a2.requestedMimeType=="application/json"){try{_ae=xandmail.rpc.evalJson(_a7);_af=_ae.status;if(_af&&_af.err_code){_ac=xandmail.rpc.getJsonErrorHandler(_af.err_code);if(_ac){try{_a8=_ac(_ae,_a2.requestParams);}catch(e){console.log("jsonErrorHandler error:"+e);}}if(_a8){_ad=_af.err_text?_af.err_text:xandmail.rpc.getExtErrorText(_af.err_code);_a2.errorMsg(_a9.error,_af.err_code,_ad);}}else{for(key in xandmail.rpc.jsonEventHandler){if((_ae[key])&&(xandmail.rpc.jsonEventHandler[key])){try{xandmail.rpc.jsonEventHandler[key](_ae);}catch(e){console.log("jsonEventHandler error:"+e);}}}}}catch(e){_a2.errorMsg(_a9.error,1,_a9.interpretresponse);_a2.deferred.errback(new Error("Error while proceeding ajax request"));return;}}else{_ae=_a7;}if(_a2.load){_a2.load(_ae,_a2);}delete _a2.ajaxRequest;_a2.ajaxRequest=null;_a2.deferred.callback(_ae);};this.abort=function(){_a2.doneMsg();if(_a3){_a3.abort();}delete _a2.ajaxRequest;_a2.ajaxRequest=null;};if((this.msgCallback)&&(this.msgCallback.loadingMsg)){this.msgCallback.loadingMsg(this.muteRequest);}if(this.sync){_a2._postProcess(_a3.request(_a2.url,_a2.httpParams));}else{_a3.callback=this._postProcess;_a3.request(this.url,this.httpParams);}};var rpc=new _9e(_9b,_9c,_9d);return rpc;};xandmail.rpc.evalJson=function(str){if(str){return eval("("+str+")");}return "";};xandmail.rpc.getRequest=function(_b0,_b1,_b2,_b3){nocache="&nocache="+Math.random()*1000000;this.arg=function(){var _b4=null;var _b5=_b3;if(!_b3||!arguments.length){return "";}try{for(var i=0;i<arguments.length;i++){_b5=_b5[arguments[i]];}_b4=_b5;}catch(e){console.debug(arguments[i]+" not found.");}if(_b4==null){return "";}return this.testHttpData(_b4);};this.httpArray=function(_b6,_b7){if((!_b3)||(!_b3[_b7])){return "";}var ar=_b3[_b7];var ret="";for(var i=0;i<ar.length;++i){if(i){ret+="&";}ret+=_b6+"="+this.testHttpData(ar[i]);}return ret;};this.httpNameArray=function(_b8,_b9){if((!_b3)||(_b3[_b9]==null)){return "";}var ar=_b3[_b9];var _ba=_b3[_b8];var ret="";for(var i=0;i<ar.length;++i){if(i){ret+="&";}ret+=_ba[i]+"="+this.testHttpData(ar[i]);}return ret;};this.httpIdxArray=function(_bb,_bc,_bd){if((!_b3)||(_b3[_bc]==null)){return "";}if(!_bd){_bd=0;}var ar=_b3[_bc];var ret="";for(var i=0;i<ar.length;++i){index=_bd+i;if(ar[i]){if(ret){ret+="&";}ret+=_bb+index+"="+this.testHttpData(ar[i]);}}return ret;};this.testHttpData=function(_be){if(typeof _be=="string"){return encodeURIComponent(_be);}else{if(_be===undefined||isNaN(_be)){return "";}else{return _be;}}};this.httpABIdxArray=function(_bf){if(!_b3){return "";}var ret="";var _c0=_b3[_bf];for(var i=0;i<_c0.length;++i){var _c1=_c0[i].objClass=="contact"?"CID":"GID";if(i){ret+="&";}ret+=_c1+"="+_c0[i].objectId+"&"+"LABEL"+"="+_c0[i].label;}return ret;};this.httpABIdxSearchArray=function(_c2){if(!_b3){return "";}var ret="";var _c3=_b3[_c2];for(var i=0;i<_c3.length;++i){var _c4=_c3[i].objClass=="contact"?"CID":"GID";var _c5=_c3[i].objClass=="contact"?"CLABEL":"GLABEL";var _c6=_c3[i].objClass=="contact"?"CABID":"GABID";if(i){ret+="&";}ret+=_c4+"="+_c3[i].objectId+"&"+_c5+"="+_c3[i].label;if(_c3[i].abid!==undefined){ret+="&"+_c6+"="+_c3[i].abid;}}return ret;};return eval("with(this){"+_b0[_b1][_b2]+"}");};xandmail.rpc.jsonErrorHandler=[];xandmail.rpc.addJsonErrorHandler=function(_c7,_c8){if((!_c7)||(!_c8)){return;}xandmail.rpc.jsonErrorHandler.push({err:_c7,hdl:_c8});};xandmail.rpc.getJsonErrorHandler=function(_c9){for(var i in xandmail.rpc.jsonErrorHandler){if(xandmail.rpc.jsonErrorHandler[i].err==_c9){return xandmail.rpc.jsonErrorHandler[i].hdl;}}return null;};xandmail.rpc.delJsonErrorHandler=function(_ca){for(var i in xandmail.rpc.jsonErrorHandler){if(xandmail.rpc.jsonErrorHandler[i].err==_ca){xandmail.rpc.jsonErrorHandler.splice(i,1);break;}}};xandmail.rpc.jsonEventHandler={};xandmail.rpc.addJsonEventHandler=function(_cb,_cc){if((!_cb)||(!_cc)){return;}xandmail.rpc.jsonEventHandler[_cb]=_cc;};xandmail.rpc.getJsonEventHandler=function(_cd){if(xandmail.rpc.jsonEventHandler[_cd]){return xandmail.rpc.jsonEventHandler[_cd];}return null;};xandmail.rpc.delJsonEventHandler=function(_ce){if(xandmail.rpc.jsonEventHandler[_ce]){delete xandmail.rpc.jsonEventHandler[_ce];}};xandmail.rpc.extErrorResources={};xandmail.rpc.getExtErrorText=function(_cf){if(xandmail.rpc.extErrorResources){for(var x in xandmail.rpc.extErrorResources){if(x==_cf){return xandmail.rpc.extErrorResources[x];}}}return "";};}if(!dojo._hasResource["xandmail.xfm.DataCom"]){dojo._hasResource["xandmail.xfm.DataCom"]=true;dojo.provide("xandmail.xfm.DataCom");dojo.declare("xandmail.xfm.DataCom",null,{listeners:null,constructor:function(_d0){this.listeners=new Array();},unsubscribe:function(id){if(!this.listeners[id]){return;}delete this.listeners[id];},subscribe:function(_d1){if(!_d1.id){console.debug("DataCom : missing mandatory id");return;}if((_d1.path)&&(_d1.path.charAt(_d1.path.length-1)!="/")){_d1.path=_d1.path+"/";}this.listeners[_d1.id]=_d1;},notify:function(_d2){var _d3=this._getListeners(_d2.path);if((!_d3)||(_d3.length==0)){return;}for(var i=0;i<_d3.length;++i){if((_d3[i].action)&&(_d2.action)&&(_d3[i].action!=_d2.action)){continue;}console.debug("notify "+_d3[i].id);if(!_d3[i].callback){continue;}_d3[i].callback(_d3[i],_d2.action,_d2.params);}},_getListeners:function(_d4){function _d5(_d6){var _d7="";var _d8="";if(_d6.charAt(0)!="*"){_d7="^";}var _d6=_d6.replace(/^\*|\*$/,"");return new RegExp(_d7+_d6);};if(!_d4){return null;}var _d9=new Array();if(dojo.isArray(_d4)){dojo.forEach(_d4,function(_da){_d9.push(_d5(_da));});}else{_d9.push(_d5(_d4));}var _db=new Array();for(var x in this.listeners){for(var i=0;i<_d9.length;++i){if(_d9[i].test(this.listeners[x].path)){_db.push(this.listeners[x]);}}}return _db;}});}if(!dojo._hasResource["xandmail.url"]){dojo._hasResource["xandmail.url"]=true;dojo.provide("xandmail.url");xandmail.url.getParam=function(url,_dc){var sep=url.indexOf("?");if(sep<0){return "";}var req=url.substring(sep+1);var _dd=req.split("&");for(var i=0;i<_dd.length;i++){sep=_dd[i].indexOf("=");if(sep<0){continue;}if(_dd[i].substring(0,sep)==_dc){return _dd[i].substring(sep+1);}}return "";};xandmail.url.getPath=function(url){var sep=url.indexOf("?");if(sep<0){return url;}else{return url.substring(0,sep);}};xandmail.url.addParameter=function(url,_de){var sep=url.indexOf("?");if(sep<0){return url+"?"+_de;}else{return url+"&"+_de;}};}if(!dojo._hasResource["xandmail.xfm.FileDesc"]){dojo._hasResource["xandmail.xfm.FileDesc"]=true;dojo.provide("xandmail.xfm.FileDesc");dojo.declare("xandmail.xfm.FileDesc",null,{_fileIndex:null,_location:"",_rootUrl:"",_descriptors:{},_fileType:{},_version:null,_httpVersionId:"_v_",constructor:function(_df,_e0,_e1){this._rootUrl=_df;if(_e1){this._version=_e1;}if(_e0){this._fileIndex=this._load_descriptor(_e0);if(this._fileIndex){this._location=_e0;}}},init:function(_e2,_e3,_e4){if((!_e3)&&((_e2)&&(this._location==_e2))){return;}if(_e4){this._version=_e4;}if(this._fileIndex){delete this._fileIndex;this._fileIndex=null;}if(this._descriptors!={}){delete this._descriptors;this._descriptors={};}if(this._descriptors!={}){delete this._descriptors;this._descriptors={};}this._fileIndex=this._load_descriptor(_e2);if(this._fileIndex){this._location=_e2;}},_loadFile:function(url){if(this._version){url=xandmail.url.addParameter(url,this._httpVersionId+"="+this._version);}var req=new xandmail.rpc.Ajax();var _e5=req.request(url);delete req;return _e5;},_load_descriptor:function(_e6){if(!this._descriptors[_e6]){var _e7=this._loadFile(this._rootUrl+"/"+_e6);try{this._descriptors[_e6]=xandmail.rpc.evalJson(_e7);}catch(e){console.log("Error in "+_e6+". Bad json format : "+e);this._descriptors[_e6]=null;return null;}}var _e8="";var pos=_e6.lastIndexOf("/");if(pos){_e8=_e6.substring(0,pos);}return this._parse_descriptor(this._descriptors[_e6],_e8);},_parse_descriptor:function(_e9,_ea,_eb,_ec){var _ed=null;var _ee=null;var _ef;if(_ec){_ef=_ec;}else{_ef={};}if(!_e9){return;}if(_e9._location){if(_e9._location.substring(0,1)=="."){_ea+=_e9._location.substring(1,_e9._location.length);}else{_ea=_e9._location;}}if(_e9._types){for(var i in _e9._types){if(this._fileType[i]){console.log("File type "+i+" already described (ignored)");continue;}this._fileType[_e9._types[i]._name]=_e9._types[i];}}if(_e9._depend){if((typeof _e9._depend)=="string"){_ee=this._load_descriptor(_e9._depend);}else{_ee=this._parse_descriptor(_e9._depend,_ea,_eb);}}if(_e9._nodep){if((typeof _e9._nodep)=="string"){_ed=this._load_descriptor(_e9._nodep);}else{_ed=this._parse_descriptor(_e9._nodep,_ea,_eb);}}for(var key in _e9){switch(key){case "_location":case "_types":case "_depend":case "_nodep":continue;break;}var _f0=_e9[key];if(!_eb){if(this._isType(key)){this._parse_descriptor(_f0,_ea,key,_ef);}else{if(typeof _f0=="object"){this._parse_descriptor(_f0,_ea,_eb,_ef);}else{continue;}}}else{if(typeof _f0=="string"){if(!_ef[_eb]){_ef[_eb]={};}_ef[_eb][key]={path:_ea+"/"+_f0};}else{if(typeof _f0=="object"){this._parse_descriptor(_f0,_ea,_eb,_ef);}}}}if(_ee){for(var _f1 in _ee){if((_eb)&&(_eb!=_f1)){continue;}if(!_ef[_f1]){_ef[_f1]=_ee[_f1];}else{for(var _f2 in _ee[_f1]){if(!_ef[_f1][_f2]){_ef[_f1][_f2]=_ee[_f1][_f2];}else{_ef[_f1][_f2].dep=_ee[_f1][_f2];}}}}}if(_ed){for(var _f3 in _ed){if((_eb)&&(_eb!=_f1)){continue;}if(!_ef[_f3]){_ef[_f3]=_ed[_f3];}else{for(var _f4 in _ed[_f3]){if(!_ef[_f3][_f4]){_ef[_f3][_f4]=_ed[_f3][_f4];}else{_ef[_f3][_f4]=_ed[_f3][_f4];}}}}}delete _ee;delete _ed;return _ef;},_isType:function(key){if(this._fileType[key]){return true;}else{return false;}},getFilePaths:function(_f5,key){if((!this._fileIndex[_f5])||(!this._fileIndex[_f5][key])){console.log("FileDesc : cannot find the key "+key);return false;}var _f6=[];var _f7=this._fileIndex[_f5][key];do{var _f8=this._rootUrl+"/"+_f7.path;_f6.push(_f8);_f7=_f7.dep;}while(_f7);_f6.reverse();return _f6;},getFilePath:function(_f9,key){if((!this._fileIndex[_f9])||(!this._fileIndex[_f9][key])){console.log("FileDesc : cannot find the key "+key);return false;}if(this._version){return this._rootUrl+"/"+this._fileIndex[_f9][key].path+"?"+this._httpVersionId+"="+this._version;}else{return this._rootUrl+"/"+this._fileIndex[_f9][key].path;}},_getFileContent:function(_fa,_fb){var cnt=this._loadFile(_fa);switch(_fb){case "json":cnt=xandmail.rpc.evalJson(cnt);break;case "text":default:break;}return cnt;},getContent:function(_fc,key,_fd){var _fe=true;if(_fd){_fe=false;}if((!this._fileIndex[_fc])||(!this._fileIndex[_fc][key])){return null;}if(!this._fileIndex[_fc][key].content){var _ff=this._fileType[_fc]._merge;var _100=this._fileType[_fc]._type;if(!_ff){this._fileIndex[_fc][key].content=this._getFileContent(this._rootUrl+"/"+this._fileIndex[_fc][key].path,_100);}else{var _101=this._fileIndex[_fc][key];var _102=[];do{_102.push(this._getFileContent(this._rootUrl+"/"+_101.path,_100));_101=_101.dep;}while(_101);var _103=null;switch(_ff){case "obj":var _104={};for(var i=(_102.length-1);i>=0;i--){var obj=_102[i];if(typeof obj!="object"){console.log("Cannot merge content of "+this._fileIndex[_fc][key][path]+" : Not an object.");break;}this._mergObj(obj,_104);}_103=_104;break;case "cat":_103="";for(var i=(_102.length-1);i>=0;i--){_103+=_102[i];}break;}this._fileIndex[_fc][key].content=_103;}}return this._fileIndex[_fc][key].content;},_mergObj:function(_105,_106){for(var _107 in _105){if(_106[_107]&&_105[_107]&&(typeof _106[_107]=="object")&&(typeof _105[_107]=="object")){this._mergObj(_105[_107],_106[_107]);}else{_106[_107]=_105[_107];}}}});}if(!dojo._hasResource["xandmail.xfm.Xfm"]){dojo._hasResource["xandmail.xfm.Xfm"]=true;dojo.provide("xandmail.xfm.Xfm");dojo.declare("xandmail.xfm.Xfm",null,{rootUrl:null,layoutUrl:null,moduleUrl:null,mainFrame:null,sessionId:null,sessionHID:null,conf:null,display:null,services:null,modules:[],datacom:null,filedesc:null,jstpl:[],loaded:false,_evalJson:function(str){return xandmail.rpc.evalJson(str);},constructor:function(self){if(!self){reqConf=new xandmail.rpc.Ajax();pathToConf=window.name!="xfmFrame"?"../../../":"";this.conf=this._evalJson(reqConf.request(pathToConf+"xfmconf.php?_v_=4.2.88.20230724_1029"));delete reqConf;this.rootUrl=this.conf.rootUrl;this.layoutUrl=this.rootUrl+"/"+this.conf.layoutBase+"/"+this.conf.theme;this.loadedScripts=[];this.loadedResources=[];this.resources=null;this.servicePath=this.conf.servicePath;this.appName="ajax version";if(this.conf.descriptor){this.filedesc=new xandmail.xfm.FileDesc(this.rootUrl,this.conf.descriptor);}else{this.filedesc=new xandmail.xfm.FileDesc(this.rootUrl);}}else{this.rootUrl=self.rootUrl;this.layoutUrl=self.layoutUrl;this.moduleUrl=self.moduleUrl;this.sessionId=self.sessionId;this.sessionHID=self.sessionHID;this.conf=self.conf;this.display=self.display;this.services=self.services;this.modules=self.modules;this.loadedScripts=self.loadedScripts;this.loadedResources=self.loadedResources;this.resources=self.resources;this.filedesc=self.filedesc;this.anti_csrf_token=self.anti_csrf_token;this.appName=self.appName;this.servicePath=self.servicePath;}this.datacom=new xandmail.xfm.DataCom();window.onstorage=dojo.hitch(this,"_onStorageItem");},appKey:function(){return this.appName;},setAntiCsrfToken:function(_108,_109){dojo.global.xfm.anti_csrf_token=_108;if(_109){var key=xfm.sessionId+":x-csrf-token";localStorage.setItem(key,_108);localStorage.removeItem(key);}},_getToken:function(_10a){_10a=_10a||this.anti_csrf_token;var _10b={stringify:function(_10c){var _10d={ct:_10c.ciphertext.toString(CryptoJS.enc.Base64)};if(_10c.iv){_10d.iv=_10c.iv.toString();}if(_10c.salt){_10d.s=_10c.salt.toString();}return JSON.stringify(_10d);},parse:function(_10e){var _10f=JSON.parse(_10e);var _110=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(_10f.ct)});if(_10f.iv){_110.iv=CryptoJS.enc.Hex.parse(_10f.iv);}if(_10f.s){_110.salt=CryptoJS.enc.Hex.parse(_10f.s);}return _110;}};var o=CryptoJS.MD5(this.appKey()+_10a);return o.toString();},_onStorageItem:function(e){if(e.key==this.sessionId+":x-csrf-token"&&e.newValue){this.setAntiCsrfToken(e.newValue,false);}},loadDescriptor:function(_111,_112){if(_111){if(this.conf.version){this.filedesc.init(_111,_112,this.conf.version);}else{this.filedesc.init(_111,_112);}}else{if(this.conf.version){this.filedesc.init(this.conf.filedesc,_112,this.conf.version);}else{this.filedesc.init(this.conf.filedesc,_112);}}this.services=this.filedesc.getContent("conf","xfmrequest");},init:function(_113,_114){this.mainFrame=_113;this.moduleUrl=this.rootUrl+"/"+_114;this.loaded=true;},rpc:function(_115,_116){return xandmail.rpc.instance(_115,_116,this.display);},addRpcJsonErrorHandler:xandmail.rpc.addJsonErrorHandler,delRpcJsonErrorHandler:xandmail.rpc.delJsonErrorHandler,getRpcJsonErrorHandler:xandmail.rpc.getJsonErrorHandler,addJsonEventHandler:xandmail.rpc.addJsonEventHandler,getJsonEventHandler:xandmail.rpc.getJsonEventHandler,delJsonEventHandler:xandmail.rpc.delJsonEventHandler,ajax:function(){var _117=new xandmail.rpc.Ajax();return _117;},getRequest:function(_118,_119,args){var url=xandmail.rpc.getRequest(this.services,_118,_119,args);var xfm=dojo.global.xfm;if(xfm.servicePath){url=url.replace("cgi-bin",xfm.servicePath);}return url;},_appendScript:function(_11a){var _11b=this.mainFrame.document;var _11c=_11b.getElementsByTagName("head");var head=null;if(!_11c){var _11d=_11b.createElement("head");head=_11b.documentElement.insertBefore(_11d,_11b.body);}else{head=_11c[_11c.length-1];}var n=_11b.createElement("script");n.type="text/javascript";head.appendChild(n);n.text=_11a;},loadFileScript:function(url){if(this.loadedScripts[url]){return;}var req=new xandmail.rpc.Ajax();var path=url;var js=req.request(path);this._appendScript(js);delete req;this.loadedScripts[url]=true;},loadResource:function(_11e,key){try{var _11f=this.filedesc.getFilePath(_11e,key);if(this.loadedResources[_11f]){return this.loadedResources[_11f];}var _120=this.filedesc.getContent(_11e,key);if(!_120){console.log("Cannot load the script ("+_11e+","+key+")");return;}this.loadedResources[_11f]=_120;return _120;}catch(e){console.debug("cannot load the script "+key+" : "+e);}},loadScript:function(_121,key){try{var _122=this.filedesc.getFilePaths(_121,key);for(var i in _122){var path=_122[i];if(this.loadedScripts[path]){continue;}var _123=this.filedesc._loadFile(path);if(!_123){console.log("Cannot load the script ("+_121+","+key+")");return;}this._appendScript(_123);this.loadedScripts[path]=true;}}catch(e){console.debug("cannot load the script "+key+" : "+e);}},use:function(_124,path){try{var req=new xandmail.rpc.Ajax();var js=req.request(path);eval("this."+_124+" = new "+js);delete req;}catch(e){console.debug(e);}},getLocalization:function(_125,_126,_127){_127=dojo.i18n.normalizeLocale(_127);var _128=dojo.i18n.getLocalization(_125,_126,_127);if(this._dynamicCustomization&&this._dynamicCustomization[_126]&&this._dynamicCustomization[_126][_127]){return dojo.mixin({},_128,this._dynamicCustomization[_126][_127]);}else{return _128;}},getLayoutPath:function(name){return this.layoutUrl+"/"+name;}});}if(!dojo._hasResource["xandmail.xfm.package"]){dojo._hasResource["xandmail.xfm.package"]=true;dojo.provide("xandmail.xfm.package");}dojo.i18n._preloadLocalizations("dojo.nls.mystartup",["ROOT","cz","en","es","hu","it","pl","xx"]);
